(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{86249:function(e,t,n){var i=n(65491).w_;e.exports.s=function(e){return i({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm144.1 454.9L437.7 677.8a8.02 8.02 0 0 1-12.7-6.5V353.7a8 8 0 0 1 12.7-6.5L656.1 506a7.9 7.9 0 0 1 0 12.9z"}}]})(e)}},4398:function(e,t,n){var i=n(65491).w_;e.exports.R=function(e){return i({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M505.7 661a8 8 0 0 0 12.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]})(e)}},59179:function(e,t,n){var i=n(65491).w_;e.exports.Q=function(e){return i({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M64 480H48a32 32 0 01-32-32V112a32 32 0 0132-32h16a32 32 0 0132 32v336a32 32 0 01-32 32zm176-304a32 32 0 00-32-32h-64a32 32 0 00-32 32v28a4 4 0 004 4h120a4 4 0 004-4zM112 448a32 32 0 0032 32h64a32 32 0 0032-32v-30a2 2 0 00-2-2H114a2 2 0 00-2 2z"}},{tag:"rect",attr:{width:"128",height:"144",x:"112",y:"240",rx:"2",ry:"2"}},{tag:"path",attr:{d:"M320 480h-32a32 32 0 01-32-32V64a32 32 0 0132-32h32a32 32 0 0132 32v384a32 32 0 01-32 32zm175.89-34.55l-32.23-340c-1.48-15.65-16.94-27-34.53-25.31l-31.85 3c-17.59 1.67-30.65 15.71-29.17 31.36l32.23 340c1.48 15.65 16.94 27 34.53 25.31l31.85-3c17.59-1.67 30.65-15.71 29.17-31.36z"}}]})(e)}},24034:function(e,t,n){var i=n(65491).w_;e.exports.G=function(e){return i({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}}]})(e)}},753:function(e,t,n){var i=n(65491).w_;e.exports.F=function(e){return i({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}}]})(e)}},92895:function(e,t,n){"use strict";function requiredArgs(e,t){if(t.length<e)throw TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}n.d(t,{Z:function(){return requiredArgs}})},37274:function(e,t,n){"use strict";function toInteger(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}n.d(t,{Z:function(){return toInteger}})},11257:function(e,t,n){"use strict";n.d(t,{Z:function(){return addDays}});var i=n(37274),r=n(75725),o=n(92895);function addDays(e,t){(0,o.Z)(2,arguments);var n=(0,r.Z)(e),a=(0,i.Z)(t);return isNaN(a)?new Date(NaN):(a&&n.setDate(n.getDate()+a),n)}},75725:function(e,t,n){"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.d(t,{Z:function(){return toDate}});var i=n(92895);function toDate(e){(0,i.Z)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===_typeof(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):(("string"==typeof e||"[object String]"===t)&&"undefined"!=typeof console&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(Error().stack)),new Date(NaN))}},78607:function(e,t,n){Promise.resolve().then(n.bind(n,48558))},48558:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Page}});var i=n(57437),r=n(2265),o=n(37684),a=n(59179),s=n(47900),l=n(4398),c=n(24033),u=n(93054),d=n(7951),f=n(10137);function MissingEpisodes(){let e=(0,c.useRouter)(),{missingEpisodes:t,isLoading:n}=(0,f.qn)();return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(u.ce,{spacing:"lg",children:[(0,i.jsxs)("h2",{className:"flex gap-3 items-center",children:[(0,i.jsx)(a.Q,{})," Missing from your library"]}),(0,i.jsxs)(d.i,{children:[!n&&t.map(t=>{var n,r,o,a,c,u;return(0,i.jsx)(s.S,{image:null===(n=t.episodeMetadata)||void 0===n?void 0:n.image,topTitle:null===(o=t.basicMedia)||void 0===o?void 0:null===(r=o.title)||void 0===r?void 0:r.userPreferred,title:t.displayTitle,meta:null!==(u=null===(a=t.episodeMetadata)||void 0===a?void 0:a.airDate)&&void 0!==u?u:void 0,actionIcon:(0,i.jsx)(l.R,{}),onClick:()=>{var n;e.push("/entry?id=".concat(null===(n=t.basicMedia)||void 0===n?void 0:n.id,"&download=").concat(t.episodeNumber))}},t.displayTitle+(null===(c=t.basicMedia)||void 0===c?void 0:c.id))}),n&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.O,{className:"rounded-md h-auto overflow-hidden aspect-[4/2] w-96 relative flex items-end flex-none"}),(0,i.jsx)(o.O,{className:"rounded-md h-auto overflow-hidden aspect-[4/2] w-96 relative flex items-end flex-none"}),(0,i.jsx)(o.O,{className:"rounded-md h-auto overflow-hidden aspect-[4/2] w-96 relative flex items-end flex-none"})]}),!n&&!t.length&&(0,i.jsx)("div",{className:"rounded-md h-auto overflow-hidden aspect-[4/2] w-96 relative flex items-center justify-center flex-none bg-gray-900 text-[--muted]",children:"No missing episodes"})]})]})})}var g=n(23130),m=n(5790),p=n(16691),v=n.n(p),h=n(61396),y=n.n(h),x=n(38038),b=n(68260);function ComingUpNext(){let e=(0,x.NL)(),{anilistLists:t}=(0,b.uJ)(),n=(0,r.useMemo)(()=>{var e;let n=null!==(e=null==t?void 0:t.map(e=>null==e?void 0:e.entries).flat())&&void 0!==e?e:[];return n.filter(Boolean).map(e=>e.media)},[t]),o=n.filter(e=>{var t;return!!(null===(t=e.nextAiringEpisode)||void 0===t?void 0:t.episode)}).sort((e,t)=>e.nextAiringEpisode.timeUntilAiring-t.nextAiringEpisode.timeUntilAiring);return((0,r.useEffect)(()=>{(async()=>{console.log(await e.fetchQuery({queryKey:["get-anilist-collection"]}))})()},[]),0===o.length)?null:(0,i.jsxs)(u.ce,{children:[(0,i.jsx)("h2",{children:"Coming up next"}),(0,i.jsx)("p",{className:"text-[--muted]",children:"Based on your anime list"}),(0,i.jsx)(d.i,{children:o.map(e=>{var t,n,r,o;return(0,i.jsxs)("div",{className:"rounded-md border border-gray-800 overflow-hidden aspect-[4/2] w-96 relative flex items-end flex-none group/missed-episode-item",children:[(0,i.jsxs)("div",{className:"absolute w-full h-full rounded-md rounded-b-none overflow-hidden z-[1]",children:[e.bannerImage?(0,i.jsx)(v(),{src:e.bannerImage,alt:"",fill:!0,quality:100,sizes:"20rem",className:"object-cover object-center transition opacity-20"}):(0,i.jsx)("div",{className:"h-full block absolute w-full bg-gradient-to-t from-gray-800 to-transparent z-[2]"}),(0,i.jsx)("div",{className:"z-[1] absolute bottom-0 w-full h-[80%] bg-gradient-to-t from-[--background-color] to-transparent"})]}),(0,i.jsxs)("div",{className:"relative z-[3] w-full p-4 space-y-1",children:[(0,i.jsx)(y(),{href:"/entry?id=".concat(e.id),className:"w-[80%] line-clamp-1 text-[--muted] font-semibold cursor-pointer",children:null===(t=e.title)||void 0===t?void 0:t.userPreferred}),(0,i.jsxs)("div",{className:"w-full justify-between flex items-center",children:[(0,i.jsxs)("p",{className:"text-xl font-semibold",children:["Episode ",null===(n=e.nextAiringEpisode)||void 0===n?void 0:n.episode]}),(null===(r=e.nextAiringEpisode)||void 0===r?void 0:r.timeUntilAiring)&&(0,i.jsx)("p",{className:"text-[--muted]",children:(0,m.Z)((0,g.Z)(new Date,null===(o=e.nextAiringEpisode)||void 0===o?void 0:o.timeUntilAiring),{addSuffix:!0})})]})]})]},e.id)})})]})}var w=n(94152),E=n(40300),L=n(11257),N=n(92895),S=n(37274);function subDays(e,t){(0,N.Z)(2,arguments);var n=(0,S.Z)(t);return(0,L.Z)(e,-n)}var A=n(29222);async function getRecentMediaAirings(e){let{page:t,perPage:n,airingAt_greater:i,airingAt_lesser:r}=e;try{var o;let e=await A.Z.post("https://graphql.anilist.co",{query:"\n    query ListRecentMedia($page: Int, $perPage: Int, $airingAt_greater: Int, $airingAt_lesser: Int){\n        Page(page: $page, perPage: $perPage){\n            pageInfo{\n                hasNextPage\n                total\n                perPage\n                currentPage\n                lastPage\n            },\n            airingSchedules(notYetAired: false, sort: TIME_DESC, airingAt_greater: $airingAt_greater, airingAt_lesser: $airingAt_lesser){\n                id\n                airingAt\n                episode\n                timeUntilAiring\n                media {\n                    isAdult\n                    ...basicMedia\n                }\n            }\n        }\n    }\n    fragment basicMedia on Media {\n      id\n      idMal\n      siteUrl\n      status(version: 2)\n      season\n      type\n      format\n      bannerImage\n      episodes\n      synonyms\n      isAdult\n      countryOfOrigin\n      title {\n        userPreferred\n        romaji\n        english\n        native\n      }\n      coverImage {\n        extraLarge\n        large\n        medium\n        color\n      }\n      startDate {\n        year\n        month\n        day\n      }\n      endDate {\n        year\n        month\n        day\n      }\n      nextAiringEpisode {\n        airingAt\n        timeUntilAiring\n        episode\n      }\n    }\n  ",variables:{page:t,perPage:n,airingAt_greater:i,airingAt_lesser:r}});return null===(o=e.data)||void 0===o?void 0:o.data}catch(e){console.error(e);return}}function RecentReleases(){var e,t;let n=(0,c.useRouter)(),{data:r}=(0,w.a)({queryKey:["recent-released"],queryFn:async()=>getRecentMediaAirings({page:1,perPage:50,airingAt_lesser:Math.floor(new Date().getTime()/1e3),airingAt_greater:Math.floor(subDays(new Date,14).getTime()/1e3)}),placeholderData:E.Wk,gcTime:6e5});return(0,i.jsxs)(u.ce,{children:[(0,i.jsx)("h2",{children:"Recent releases"}),(0,i.jsx)(d.i,{children:null==r?void 0:null===(t=r.Page)||void 0===t?void 0:null===(e=t.airingSchedules)||void 0===e?void 0:e.filter(e=>{var t,n,i,r;return(null==e?void 0:null===(t=e.media)||void 0===t?void 0:t.isAdult)===!1&&(null==e?void 0:null===(n=e.media)||void 0===n?void 0:n.type)==="ANIME"&&(null==e?void 0:null===(i=e.media)||void 0===i?void 0:i.countryOfOrigin)==="JP"&&(null==e?void 0:null===(r=e.media)||void 0===r?void 0:r.format)!=="TV_SHORT"}).filter(Boolean).map(e=>{var t,r,o,a,l;return(0,i.jsx)(s.S,{title:"Episode ".concat(e.episode),image:(null===(t=e.media)||void 0===t?void 0:t.bannerImage)||(null===(o=e.media)||void 0===o?void 0:null===(r=o.coverImage)||void 0===r?void 0:r.large),topTitle:null===(l=e.media)||void 0===l?void 0:null===(a=l.title)||void 0===a?void 0:a.userPreferred,meta:e.airingAt?(0,m.Z)((0,g.Z)(new Date,e.timeUntilAiring),{addSuffix:!0}):void 0,onClick:()=>{var t;return n.push("/entry?id=".concat(null===(t=e.media)||void 0===t?void 0:t.id))},actionIcon:null},e.id)})})]})}function Page(){return(0,i.jsxs)("div",{className:"px-4 pt-8 space-y-10 pb-10",children:[(0,i.jsx)(MissingEpisodes,{}),(0,i.jsx)(ComingUpNext,{}),(0,i.jsx)(RecentReleases,{})]})}},95518:function(e,t,n){"use strict";n.d(t,{Iw:function(){return useAtomicLibraryCollectionLoader},uN:function(){return u},yh:function(){return c}});var i=n(77665),r=n(97726),o=n(23890),a=n(2265),s=n(51472),l=n(57638);let c=(0,r.O4)("sea-library-collection",void 0,void 0,{unstable_getOnInit:!0}),u=(0,i.cn)(e=>e(c),(e,t,n)=>{var i;let r=null===(i=e(c))||void 0===i?void 0:i.lists;if(r)return r.flatMap(e=>e.entries).find(e=>e.mediaId===n)});function useAtomicLibraryCollectionLoader(){let e=(0,o.b9)(c),{data:t,status:n}=(0,s.tZ)({endpoint:l.E.LIBRARY_COLLECTION,queryKey:["get-library-collection"]});return(0,a.useEffect)(()=>{"success"===n&&e(t)},[t,n]),null}},70226:function(e,t,n){"use strict";n.d(t,{Oh:function(){return useListenToMissingEpisodes},VK:function(){return useMissingEpisodeCount},wS:function(){return c}});var i=n(57638),r=n(77665),o=n(23890),a=n(51472),s=n(2265),l=n(24033);let c=(0,r.cn)([]),u=(0,r.cn)(e=>e(c).length);function useMissingEpisodeCount(){return(0,o.Dv)(u)}function useListenToMissingEpisodes(){let e=(0,l.usePathname)(),t=(0,o.b9)(c),{data:n}=(0,a.tZ)({endpoint:i.E.MISSING_EPISODES,queryKey:["get-missing-episodes"],enabled:"/schedule"!==e});return(0,s.useEffect)(()=>{t(null!=n?n:[])},[n]),null}},59346:function(e,t,n){"use strict";n.d(t,{t:function(){return imageShimmer}});let imageShimmerEffect=(e,t)=>'\n<svg width="'.concat(e,'" height="').concat(t,'" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n  <defs>\n    <linearGradient id="g">\n      <stop stop-color="#333" offset="20%" />\n      <stop stop-color="#222" offset="50%" />\n      <stop stop-color="#333" offset="70%" />\n    </linearGradient>\n  </defs>\n  <rect width="').concat(e,'" height="').concat(t,'" fill="#333" />\n  <rect id="r" width="').concat(e,'" height="').concat(t,'" fill="url(#g)" />\n  <animate xlink:href="#r" attributeName="x" from="-').concat(e,'" to="').concat(e,'" dur="1s" repeatCount="indefinite"  />\n</svg>'),toBase64=e=>window.btoa(e),imageShimmer=(e,t)=>"data:image/svg+xml;base64,".concat(toBase64(imageShimmerEffect(e,t)))},10137:function(e,t,n){"use strict";n.d(t,{Jx:function(){return useScanLibrary},Kg:function(){return useMediaEntryBulkAction},Ye:function(){return useRemoveEmptyDirectories},_U:function(){return useUpdateLocalFile},d3:function(){return useLibraryCollection},qn:function(){return useMissingEpisodes},ss:function(){return useLocalFileBulkAction}});var i=n(38038),r=n(51472),o=n(57638),a=n(2265),s=n(5925),l=n(23890),c=n(95518),u=n(70226);function useScanLibrary(){let e=(0,i.NL)(),{mutate:t,isPending:n}=(0,r.$U)({endpoint:o.E.SCAN_LIBRARY,mutationKey:["scan-library"],onSuccess:async()=>{s.ZP.success("Library scanned"),await e.refetchQueries({queryKey:["get-library-collection"]}),await e.refetchQueries({queryKey:["get-missing-episodes"]})}});return{scanLibrary:t,isScanning:n}}function useLibraryCollection(){var e,t,n,i;let[s,u]=(0,l.KO)(c.yh),{data:d,isLoading:f,refetch:g}=(0,r.tZ)({endpoint:o.E.LIBRARY_COLLECTION,queryKey:["get-library-collection"],placeholderData:s});(0,a.useEffect)(()=>{d&&u(d)},[d]);let m=(0,a.useMemo)(()=>d?[d.lists.find(e=>"current"===e.type),d.lists.find(e=>"paused"===e.type),d.lists.find(e=>"planned"===e.type),d.lists.find(e=>"completed"===e.type),d.lists.find(e=>"dropped"===e.type)].filter(Boolean):[],[d]);return{libraryCollectionList:m,continueWatchingList:null!==(e=null==d?void 0:d.continueWatchingList)&&void 0!==e?e:[],isLoading:f,unmatchedLocalFiles:null!==(t=null==d?void 0:d.unmatchedLocalFiles)&&void 0!==t?t:[],ignoredLocalFiles:null!==(n=null==d?void 0:d.ignoredLocalFiles)&&void 0!==n?n:[],unmatchedGroups:null!==(i=null==d?void 0:d.unmatchedGroups)&&void 0!==i?i:[]}}function useMissingEpisodes(){let e=(0,l.b9)(u.wS),{data:t,isLoading:n,status:i}=(0,r.tZ)({endpoint:o.E.MISSING_EPISODES,queryKey:["get-missing-episodes"]});return(0,a.useEffect)(()=>{"success"===i&&e(null!=t?t:[])},[t]),{missingEpisodes:null!=t?t:[],isLoading:n}}function useMediaEntryBulkAction(e){let t=(0,i.NL)(),{mutate:n,isPending:a}=(0,r.$U)({endpoint:o.E.MEDIA_ENTRY_BULK_ACTION,mutationKey:["media-entry-bulk-action"],method:"patch",onSuccess:async()=>{await t.refetchQueries({queryKey:["get-library-collection"]}),e&&await t.refetchQueries({queryKey:["get-media-entry",e]})}});return{toggleLock:e=>n({mediaId:e,action:"toggle-lock"}),unmatchAll:e=>n({mediaId:e,action:"unmatch"},{onSuccess:()=>{s.ZP.success("Files unmatched")}}),isPending:a}}function useLocalFileBulkAction(){let e=(0,i.NL)(),{mutate:t,isPending:n}=(0,r.$U)({endpoint:o.E.LOCAL_FILES,mutationKey:["local-file-bulk-action"],method:"post",onSuccess:async()=>{await e.refetchQueries({queryKey:["get-library-collection"]})}});return{lockFiles:()=>t({action:"lock"},{onSuccess:()=>{s.ZP.success("Files locked")}}),unlockFiles:()=>t({action:"unlock"},{onSuccess:()=>{s.ZP.success("Files unlocked")}}),isPending:n}}function useRemoveEmptyDirectories(){let{mutate:e,isPending:t}=(0,r.$U)({endpoint:o.E.EMPTY_DIRECTORIES,mutationKey:["remove-empty-directories"],method:"delete",onSuccess:async()=>{s.ZP.success("Empty directories removed")}});return{removeEmptyDirectories:()=>e(),isPending:t}}function getDefaultLocalFileVariables(e){return{path:e.path,metadata:e.metadata,locked:e.locked,ignored:e.ignored,mediaId:e.mediaId}}function useUpdateLocalFile(e){let t=(0,i.NL)(),{mutate:n,isPending:a}=(0,r.$U)({endpoint:o.E.LOCAL_FILE,mutationKey:["patch-local-file"],method:"patch",onSuccess:async()=>{await t.refetchQueries({queryKey:["get-library-collection"]}),e&&await t.refetchQueries({queryKey:["get-media-entry",e]})}});return{updateLocalFile:(e,t,i)=>{n({...getDefaultLocalFileVariables(e),...t},{onSuccess:()=>{i&&i()}})},isPending:a}}},66169:function(e,t,n){"use strict";function on(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e&&e.addEventListener&&e.addEventListener.apply(e,t)}function off(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e&&e.removeEventListener&&e.removeEventListener.apply(e,t)}n.d(t,{S1:function(){return off},jU:function(){return i},on:function(){return on}});var i="undefined"!=typeof window},64723:function(e,t,n){"use strict";var i=n(2265),r=n(66169).jU?i.useLayoutEffect:i.useEffect;t.Z=r},28979:function(e,t,n){"use strict";n.d(t,{Z:function(){return esm_useUpdateEffect}});var i=n(2265);function useFirstMountState(){var e=(0,i.useRef)(!0);return e.current?(e.current=!1,!0):e.current}var esm_useUpdateEffect=function(e,t){var n=useFirstMountState();(0,i.useEffect)(function(){if(!n)return e()},t)}}},function(e){e.O(0,[492,890,999,17,726,669,912,700,971,472,744],function(){return e(e.s=78607)}),_N_E=e.O()}]);