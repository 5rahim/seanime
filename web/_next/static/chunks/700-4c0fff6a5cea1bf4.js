"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[700],{67998:function(e,t,r){r.d(t,{DN:function(){return n},SN:function(){return useWebsocketMessageListener},oJ:function(){return o}});var s=r(2265),l=r(77665);let n=(0,s.createContext)(null),o=(0,l.cn)(null);function useWebsocketMessageListener(e){let{type:t,onMessage:r}=e,l=(0,s.useContext)(n);return(0,s.useEffect)(()=>{if(l){let messageHandler=e=>{try{let s=JSON.parse(e.data);s.type&&s.type===t&&r(s.payload)}catch(e){}};return l.addEventListener("message",messageHandler),()=>{l.removeEventListener("message",messageHandler)}}},[l,r]),null}},47900:function(e,t,r){r.d(t,{S:function(){return LargeEpisodeListItem}});var s=r(57437);r(2265);var l=r(54487),n=r(16691),o=r.n(n),i=r(86249),a=r(59346);let LargeEpisodeListItem=e=>{let{children:t,actionIcon:r=null!==e.actionIcon?(0,s.jsx)(i.s,{}):void 0,image:n,onClick:c,topTitle:u,meta:d,title:p,larger:m=!1,...g}=e;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:(0,l.cn)("rounded-md border border-[--border] overflow-hidden aspect-[4/2] w-96 relative flex items-end flex-none group/missed-episode-item cursor-pointer",{"w-[30rem]":m}),onClick:c,...g,children:[(0,s.jsxs)("div",{className:"absolute w-full h-full overflow-hidden z-[1]",children:[n?(0,s.jsx)(o(),{src:n,alt:"",fill:!0,quality:100,placeholder:(0,a.t)(700,475),sizes:"20rem",className:"object-cover object-center transition group-hover/missed-episode-item:scale-110"}):(0,s.jsx)("div",{className:"h-full block absolute w-full bg-gradient-to-t from-gray-800 to-transparent z-[2]"}),(0,s.jsx)("div",{className:"z-[1] absolute bottom-0 w-full h-[80%] bg-gradient-to-t from-[--background-color] to-transparent"})]}),(0,s.jsx)("div",{className:(0,l.cn)("group-hover/missed-episode-item:opacity-100 text-6xl text-gray-200","cursor-pointer opacity-0 transition-opacity bg-gray-900 bg-opacity-50 backdrop-blur-md z-[2] absolute w-full h-full flex items-center justify-center"),children:r&&r}),(0,s.jsxs)("div",{className:"relative z-[3] w-full p-4 space-y-1",children:[u&&(0,s.jsx)("p",{className:"w-[80%] line-clamp-1 text-[--muted] font-semibold",children:u}),(0,s.jsxs)("div",{className:"w-full justify-between flex items-center",children:[(0,s.jsx)("p",{className:"text-xl font-semibold line-clamp-2",children:p}),d&&(0,s.jsx)("p",{className:"text-[--muted]",children:d})]})]})]})})}},7951:function(e,t,r){r.d(t,{i:function(){return Slider}});var s=r(57437),l=r(2265),n=r(64723);function useDraggableScroll(e){let t,r,s,o,i,a,c,{decayRate:u=.95,safeDisplacement:d=10,applyRubberBandEffect:p=!1,activeMouseButton:m="Left",isMounted:g=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},f=(0,l.useRef)({isMouseDown:!1,isDraggingX:!1,isDraggingY:!1,initialMouseX:0,initialMouseY:0,lastMouseX:0,lastMouseY:0,scrollSpeedX:0,scrollSpeedY:0,lastScrollX:0,lastScrollY:0}),h=!1,y=!1,x=0,b=0,w=1/60*1e3;(0,n.Z)(()=>{g&&(h="scroll"===window.getComputedStyle(e.current).overflowX,y="scroll"===window.getComputedStyle(e.current).overflowY,x=e.current.scrollWidth-e.current.clientWidth,b=e.current.scrollHeight-e.current.clientHeight,t=window.getComputedStyle(e.current).cursor,r=[],s=[],o=[],e.current.childNodes.forEach(e=>{r.push(window.getComputedStyle(e).cursor),s.push("none"===window.getComputedStyle(e).transform?"":window.getComputedStyle(e).transform),o.push("none"===window.getComputedStyle(e).transition?"":window.getComputedStyle(e).transition)}))},[g]);let runScroll=()=>{let t=f.current.scrollSpeedX*w,r=f.current.scrollSpeedY*w,s=e.current.scrollLeft+t,l=e.current.scrollTop+r;e.current.scrollLeft=s,e.current.scrollTop=l,f.current.lastScrollX=s,f.current.lastScrollY=l},rubberBandCallback=t=>{let r=t.clientX-f.current.initialMouseX,s=t.clientY-f.current.initialMouseY,{clientWidth:l,clientHeight:n}=e.current,o=0,i=0;h&&y?(o=.3*l*Math.sign(r)*Math.log10(1+.5*Math.abs(r)/l),i=.3*n*Math.sign(s)*Math.log10(1+.5*Math.abs(s)/n)):h?o=.3*l*Math.sign(r)*Math.log10(1+.5*Math.abs(r)/l):y&&(i=.3*n*Math.sign(s)*Math.log10(1+.5*Math.abs(s)/n)),e.current.childNodes.forEach(e=>{e.style.transform="translate3d(".concat(o,"px, ").concat(i,"px, 0px)"),e.style.transition="transform 0ms"})},recoverChildStyle=()=>{e.current.childNodes.forEach((e,t)=>{e.style.transform=s[t],e.style.transition=o[t]})},callbackMomentum=()=>{a=setInterval(()=>{let t=f.current.scrollSpeedX,r=t*u;f.current.scrollSpeedX=r;let s=e.current.scrollLeft<=0,l=e.current.scrollLeft>=x;runScroll(),(.05>Math.abs(r)||f.current.isMouseDown||s||l)&&(f.current.scrollSpeedX=0,clearInterval(a))},w),c=setInterval(()=>{let t=f.current.scrollSpeedY,r=t*u;f.current.scrollSpeedY=r;let s=e.current.scrollTop<=0,l=e.current.scrollTop>=b;runScroll(),(.05>Math.abs(r)||f.current.isMouseDown||s||l)&&(f.current.scrollSpeedY=0,clearInterval(c))},w),f.current.isDraggingX=!1,f.current.isDraggingY=!1,p&&(e.current.childNodes.forEach(e=>{e.style.transform="translate3d(0px, 0px, 0px)",e.style.transition="transform ".concat(250,"ms")}),i=setTimeout(recoverChildStyle,250))},preventClick=e=>{e.preventDefault(),e.stopImmediatePropagation()},getIsMousePressActive=e=>"Left"===m&&1===e||"Middle"===m&&4===e||"Right"===m&&2===e,onMouseUp=s=>{let l=f.current.isDraggingX||f.current.isDraggingY,n=f.current.initialMouseX-s.clientX,o=f.current.initialMouseY-s.clientY,i=l&&(Math.abs(n)>d||Math.abs(o)>d);i?e.current.childNodes.forEach(e=>{e.addEventListener("click",preventClick)}):e.current.childNodes.forEach(e=>{e.removeEventListener("click",preventClick)}),f.current.isMouseDown=!1,f.current.lastMouseX=0,f.current.lastMouseY=0,e.current.style.cursor=t,e.current.childNodes.forEach((e,t)=>{e.style.cursor=r[t]}),i&&callbackMomentum()},onMouseMove=t=>{if(!f.current.isMouseDown)return;t.preventDefault();let r=f.current.lastMouseX-t.clientX;f.current.lastMouseX=t.clientX,f.current.scrollSpeedX=r/w,f.current.isDraggingX=!0;let s=f.current.lastMouseY-t.clientY;f.current.lastMouseY=t.clientY,f.current.scrollSpeedY=s/w,f.current.isDraggingY=!0,e.current.style.cursor="grabbing",e.current.childNodes.forEach(e=>{e.style.cursor="grabbing"});let l=e.current.scrollLeft<=0&&h,n=e.current.scrollLeft>=x&&h,o=e.current.scrollTop<=0&&y,i=e.current.scrollTop>=b&&y;(l||n||o||i)&&p&&rubberBandCallback(t),runScroll()},handleResize=()=>{x=e.current.scrollWidth-e.current.clientWidth,b=e.current.scrollHeight-e.current.clientHeight};return(0,l.useEffect)(()=>(g&&(window.addEventListener("mouseup",onMouseUp),window.addEventListener("mousemove",onMouseMove),window.addEventListener("resize",handleResize)),()=>{window.removeEventListener("mouseup",onMouseUp),window.removeEventListener("mousemove",onMouseMove),window.removeEventListener("resize",handleResize),clearInterval(a),clearInterval(c),clearTimeout(i)}),[g]),{events:{onMouseDown:e=>{let t=getIsMousePressActive(e.buttons);t&&(f.current.isMouseDown=!0,f.current.lastMouseX=e.clientX,f.current.lastMouseY=e.clientY,f.current.initialMouseX=e.clientX,f.current.initialMouseY=e.clientY)}}}}var o=r(24034),i=r(753),a=r(54487),c=r(28979);let Slider=e=>{let{children:t,onSlideEnd:r,...u}=e,d=(0,l.useRef)(),{events:p}=useDraggableScroll(d,{decayRate:.96,safeDisplacement:20}),[m,g]=(0,l.useState)(!0),[f,h]=(0,l.useState)(!1),[y,x]=(0,l.useState)(!1);function slideLeft(){let e=d.current;e&&e.scrollTo({left:e.scrollLeft-500,behavior:"smooth"})}function slideRight(){let e=d.current;e&&e.scrollTo({left:e.scrollLeft+500,behavior:"smooth"})}return(0,c.Z)(()=>{if(!m&&f){r&&r();let e=setTimeout(()=>{let e=d.current;e&&e.scrollTo({left:e.scrollLeft+500,behavior:"smooth"})},1e3);return()=>clearTimeout(e)}},[m,f]),(0,n.Z)(()=>{d.current.clientWidth<d.current.scrollWidth?x(!0):x(!1)},[d.current]),(0,s.jsxs)("div",{className:(0,a.cn)("relative flex items-center lg:gap-2",e.containerClassName),children:[(0,s.jsx)("div",{onClick:slideLeft,className:"flex items-center cursor-pointer hover:text-action absolute left-0 bg-gradient-to-r from-[--background-color] z-40 h-full w-16 hover:opacity-100 ".concat(m?"invisible":"lg:visible"),children:(0,s.jsx)(o.G,{className:"w-7 h-7 stroke-2 mx-auto"})}),(0,s.jsx)("div",{onScroll:()=>{let e=d.current;if(e){let t=0===e.scrollLeft,r=e.scrollLeft+e.clientWidth===e.scrollWidth;g(t),h(r)}},className:"flex max-w-full w-full space-x-3 overflow-x-scroll scrollbar-hide scroll",...p,ref:d,children:t}),(0,s.jsx)("div",{onClick:slideRight,className:(0,a.cn)("flex items-center invisible cursor-pointer hover:text-action absolute right-0 bg-gradient-to-l from-[--background-color] z-40 h-full w-16 hover:opacity-100",{"lg:visible":!f&&y}),children:(0,s.jsx)(i.F,{className:"w-7 h-7 stroke-2 mx-auto"})})]})}},93054:function(e,t,r){r.d(t,{LN:function(){return w},RD:function(){return y},ce:function(){return b},S8:function(){return M},FV:function(){return AppSidebarProvider},AO:function(){return j}});var s=r(57437),l=r(2265),n=r(54487),o=r(96061);let i=(0,n.xH)({root:(0,o.j)(["UI-AppLayout__root","flex w-full min-h-screen group","group-[.with-sidebar]:group-[.sidebar-slim]:md:pl-20","group-[.with-sidebar]:group-[.sidebar-sm]:md:pl-48","group-[.with-sidebar]:group-[.sidebar-md]:md:pl-64","group-[.with-sidebar]:group-[.sidebar-lg]:md:pl-[20rem]","group-[.with-sidebar]:group-[.sidebar-xl]:md:pl-[25rem]"],{variants:{withSidebar:{true:"flex-row with-sidebar",false:"flex-col"},sidebarSize:{slim:"sidebar-slim",sm:"sidebar-sm",md:"sidebar-md",lg:"sidebar-lg",xl:"sidebar-xl"}},defaultVariants:{withSidebar:!1,sidebarSize:"md"}})}),a=(0,n.xH)({root:(0,o.j)(["UI-AppLayoutHeader__root","block w-full"])}),c=(0,n.xH)({root:(0,o.j)(["UI-AppLayoutSidebar__root","hidden md:fixed md:inset-y-0 md:flex md:flex-col grow-0 shrink-0 basis-0 z-[10]","group-[.sidebar-slim]:md:w-20","group-[.sidebar-sm]:md:w-48","group-[.sidebar-md]:md:w-64","group-[.sidebar-lg]:md:w-[20rem]","group-[.sidebar-xl]:md:w-[25rem]"])}),u=(0,n.xH)({root:(0,o.j)(["UI-AppLayoutContent__root"])}),d=(0,n.xH)({root:(0,o.j)(["UI-AppLayoutFooter__root"])}),p=(0,n.xH)({root:(0,o.j)(["UI-AppLayoutStack__root"],{variants:{spacing:{sm:"space-y-2",md:"space-y-4",lg:"space-y-8",xl:"space-y-10"}},defaultVariants:{spacing:"md"}})}),m=(0,n.xH)({root:(0,o.j)(["UI-AppLayoutGrid__root","block"],{variants:{breakBelow:{sm:"sm:grid sm:space-y-0",md:"md:grid md:space-y-0",lg:"lg:grid lg:space-y-0",xl:"xl:grid xl:space-y-0"},spacing:{sm:"space-y-2 gap-2",md:"space-y-4 gap-4",lg:"space-y-8 gap-8",xl:"space-y-10 gap-10"},cols:{1:"grid-cols-1",2:"grid-cols-2",3:"grid-cols-3",4:"grid-cols-4",5:"grid-cols-5",6:"grid-cols-6"}},defaultVariants:{breakBelow:"xl",spacing:"md",cols:3}})}),_AppLayout=e=>{let{children:t,rootClassName:r,className:l,ref:o,withSidebar:a,sidebarSize:c,...u}=e;return(0,s.jsx)("div",{className:(0,n.cn)(i.root({withSidebar:a,sidebarSize:c}),r,l),...u,ref:o,children:t})};_AppLayout.displayName="AppLayout";let g=l.forwardRef((e,t)=>{let{children:r,rootClassName:l,className:o,...i}=e;return(0,s.jsx)("header",{className:(0,n.cn)(a.root(),l,o),...i,ref:t,children:r})});g.displayName="AppLayoutHeader";let f=l.forwardRef((e,t)=>{let{children:r,rootClassName:l,className:o,...i}=e;return(0,s.jsx)("aside",{className:(0,n.cn)(c.root(),l,o),...i,ref:t,children:r})});f.displayName="AppLayoutSidebar";let h=l.forwardRef((e,t)=>{let{children:r,rootClassName:l,className:o,...i}=e;return(0,s.jsx)("main",{className:(0,n.cn)(u.root(),l,o),...i,ref:t,children:r})});h.displayName="AppLayoutContent";let y=l.forwardRef((e,t)=>{let{children:r,rootClassName:l,className:o,breakBelow:i,cols:a,spacing:c,...u}=e;return(0,s.jsx)("section",{className:(0,n.cn)(m.root({breakBelow:i,cols:a,spacing:c}),l,o),...u,ref:t,children:r})});y.displayName="AppLayoutGrid";let x=l.forwardRef((e,t)=>{let{children:r,rootClassName:l,className:o,...i}=e;return(0,s.jsx)("footer",{className:(0,n.cn)(d.root(),l,o),...i,ref:t,children:r})});x.displayName="AppLayoutFooter";let b=l.forwardRef((e,t)=>{let{children:r,rootClassName:l,className:o,spacing:i,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)(p.root({spacing:i}),l,o),...a,ref:t,children:r})});b.displayName="AppLayoutStack",_AppLayout.Header=g,_AppLayout.Sidebar=f,_AppLayout.Content=h,_AppLayout.Footer=x,_AppLayout.Grid=y,_AppLayout.Stack=b;let w=(0,n.Fm)(_AppLayout);w.displayName="AppLayout";var v=r(33538);let N=l.createContext({open:!1,setOpen:()=>{}}),useAppSidebarContext=()=>l.useContext(N),L=(0,n.xH)({sidebar:(0,o.j)(["UI-AppSidebar__sidebar","flex flex-grow flex-col"])}),S=(0,n.xH)({trigger:(0,o.j)(["UI-AppSidebarTrigger__trigger","block md:hidden","items-center justify-center rounded-[--radius] p-2 text-[--muted] hover:bg-[--highlight] hover:text-[--text-color]","focus:outline-none focus:ring-2 focus:ring-inset focus:ring-[--ring]"])}),M=l.forwardRef((e,t)=>{let{children:r,sidebarClassName:l,className:o,...i}=e,a=useAppSidebarContext();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:(0,n.cn)(L.sidebar(),l),...i,ref:t,children:(0,s.jsx)("div",{className:(0,n.cn)(o),children:r})}),(0,s.jsx)(v.dy,{isOpen:a.open,onClose:()=>a.setOpen(!1),placement:"left",isClosable:!0,className:"md:hidden",containerClassName:"w-[85%]",bodyClassName:(0,n.cn)("p-0 md:p-0",o),headerClassName:"absolute p-2 sm:p-2 md:p-2 lg:p-2 right-0",closeButtonIntent:"white-outline",children:r})]})});M.displayName="AppSidebar";let j=l.forwardRef((e,t)=>{let{children:r,triggerClassName:l,className:o,...i}=e,a=useAppSidebarContext();return(0,s.jsxs)("button",{className:(0,n.cn)(S.trigger(),l,o),onClick:()=>a.setOpen(e=>!e),...i,ref:t,children:[(0,s.jsx)("span",{className:"sr-only",children:"Open main menu"}),a.open?(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"block h-6 w-6",children:[(0,s.jsx)("line",{x1:"18",x2:"6",y1:"6",y2:"18"}),(0,s.jsx)("line",{x1:"6",x2:"18",y1:"6",y2:"18"})]}):(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"block h-6 w-6",children:[(0,s.jsx)("line",{x1:"4",x2:"20",y1:"12",y2:"12"}),(0,s.jsx)("line",{x1:"4",x2:"20",y1:"6",y2:"6"}),(0,s.jsx)("line",{x1:"4",x2:"20",y1:"18",y2:"18"})]})]})});j.displayName="AppSidebarTrigger";let AppSidebarProvider=e=>{let{children:t,open:r}=e,[n,o]=(0,l.useState)(null!=r&&r);return(0,l.useEffect)(()=>{void 0!==r&&o(r)},[r]),(0,s.jsx)(N.Provider,{value:{open:n,setOpen:o},children:t})}},37684:function(e,t,r){r.d(t,{O:function(){return a}});var s=r(57437),l=r(54487),n=r(96061),o=r(2265);let i=(0,l.xH)({skeleton:(0,n.j)("UI-Skeleton__skeleton",{variants:{type:{box:"h-14 bg-gray-100 dark:bg-gray-800 w-full rounded-[--radius] animate-pulse",text:"h-2 bg-gray-100 dark:bg-gray-800 rounded-[--radius] animate-purple"}},defaultVariants:{}})}),a=o.forwardRef((e,t)=>{let{children:r,className:n,type:o="box",skeletonClassName:a,...c}=e;return"text"===o?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsx)("div",{className:(0,l.cn)("w-full",i.skeleton({type:o}),a,n),...c,ref:t}),(0,s.jsx)("div",{className:(0,l.cn)("w-full",i.skeleton({type:o}),a,n),...c,ref:t}),(0,s.jsx)("div",{className:(0,l.cn)("w-full",i.skeleton({type:o}),a,n),...c,ref:t}),(0,s.jsx)("div",{className:(0,l.cn)("w-[98%]",i.skeleton({type:o}),a,n),...c,ref:t}),(0,s.jsx)("div",{className:(0,l.cn)("w-[95%]",i.skeleton({type:o}),a,n),...c,ref:t}),(0,s.jsx)("div",{className:(0,l.cn)("w-[90%]",i.skeleton({type:o}),a,n),...c,ref:t})]})}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:(0,l.cn)(i.skeleton({type:o}),a,n),...c,ref:t})})});a.displayName="Skeleton"},68260:function(e,t,r){r.d(t,{Jg:function(){return useMediaDetails},Pe:function(){return useManuallyMatchLocalFiles},Tc:function(){return useAnilistCollectionListener},X7:function(){return useMediaEntry},bo:function(){return useFetchMediaEntrySuggestions},du:function(){return useRefreshAnilistCollection},uJ:function(){return useAnilistCollection}});var s=r(51472),l=r(57638),n=r(38038),o=r(5925),i=r(67998);function useAnilistCollectionListener(){let e=(0,n.NL)();(0,i.SN)({type:l.f.REFRESHED_ANILIST_COLLECTION,onMessage:t=>{(async()=>{await e.refetchQueries({queryKey:["get-library-collection"]}),await e.refetchQueries({queryKey:["get-anilist-collection"]}),await e.refetchQueries({queryKey:["get-missing-episodes"]})})()}})}function useMediaEntry(e){let t="string"==typeof e?Number(e):e,{data:r,isLoading:n}=(0,s.tZ)({endpoint:l.E.MEDIA_ENTRY.replace("{id}",String(t)),queryKey:["get-media-entry",t],enabled:!!t});return{mediaEntry:r,mediaEntryLoading:n}}function useAnilistCollection(){var e,t;let{data:r,isLoading:n}=(0,s.tZ)({endpoint:l.E.ANILIST_COLLECTION,queryKey:["get-anilist-collection"]});return{anilistLists:null!==(t=null==r?void 0:null===(e=r.MediaListCollection)||void 0===e?void 0:e.lists)&&void 0!==t?t:[],isLoading:n}}function useRefreshAnilistCollection(){let e=(0,n.NL)(),{mutate:t,isPending:r}=(0,s.$U)({endpoint:l.E.ANILIST_COLLECTION,mutationKey:["refresh-anilist-collection"],onSuccess:async()=>{o.ZP.success("AniList is up-to-date"),await e.refetchQueries({queryKey:["get-library-collection"]}),await e.refetchQueries({queryKey:["get-anilist-collection"]}),await e.refetchQueries({queryKey:["get-missing-episodes"]})}});return{refreshAnilistCollection:t,isPending:r}}function useMediaDetails(e){let t="string"==typeof e?Number(e):e,{data:r,isLoading:n}=(0,s.tZ)({endpoint:l.E.ANILIST_MEDIA_DETAILS.replace("{id}",String(t)),queryKey:["get-anilist-media-details",t],enabled:!!t});return{mediaDetails:r,mediaDetailsLoading:n}}function useFetchMediaEntrySuggestions(){let{mutate:e,data:t,isPending:r,reset:n}=(0,s.$U)({endpoint:l.E.MEDIA_ENTRY_SUGGESTIONS,mutationKey:["media-entry-suggestions"]});return{fetchSuggestions:t=>e({dir:t}),suggestions:null!=t?t:[],isPending:r,resetSuggestions:n}}function useManuallyMatchLocalFiles(){let e=(0,n.NL)(),{mutate:t,isPending:r}=(0,s.$U)({endpoint:l.E.MEDIA_ENTRY_MANUAL_MATCH,mutationKey:["media-entry-manual-match"],onSuccess:async()=>{await e.refetchQueries({queryKey:["get-library-collection"]})}});return{manuallyMatchEntry:(r,s)=>{t(r,{onSuccess:async()=>{r.mediaId&&await e.refetchQueries({queryKey:["get-media-entry",r.mediaId]}),s()}})},isPending:r}}}}]);