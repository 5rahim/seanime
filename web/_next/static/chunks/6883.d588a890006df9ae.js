"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6883],{62634:(t,e,s)=>{s.d(e,{R:()=>a});var i=s(7311);class a{Cb(){(0,i.i)(this.da)&&this.Pe()}sa(){(0,i.c)(this.da)&&window.cancelAnimationFrame(this.da),this.da=void 0}Pe(){this.da=window.requestAnimationFrame(()=>{(0,i.i)(this.da)||(this.Da(),this.Pe())})}constructor(t){this.Da=t}}},86883:(t,e,s)=>{s.r(e),s.d(e,{GoogleCastProvider:()=>u});var i=s(7311),a=s(85594),l=s(62634),h=s(33926);s(12115);class r{build(){return this.El}dm(t){return t.includes("live")?this.El.streamType=chrome.cast.media.StreamType.LIVE:this.El.streamType=chrome.cast.media.StreamType.BUFFERED,this}em(t){return this.El.tracks=t.map(this.fm),this}gm(t,e){return this.El.metadata=new chrome.cast.media.GenericMediaMetadata,this.El.metadata.title=t,this.El.metadata.images=[{url:e}],this}fm(t,e){let s=new chrome.cast.media.Track(e,chrome.cast.media.TrackType.TEXT);return s.name=t.label,s.trackContentId=t.src,s.trackContentType="text/vtt",s.language=t.language,s.subtype=t.kind.toUpperCase(),s}constructor(t){this.El=new chrome.cast.media.MediaInfo(t.src,t.type)}}let n=chrome.cast.media.TrackType.TEXT,c=chrome.cast.media.TrackType.AUDIO;class o{mk(){let t=this.Ql.bind(this);(0,i.l)(this.b.audioTracks,"change",t),(0,i.l)(this.b.textTracks,"mode-change",t),(0,i.g)(this.hm.bind(this))}Hl(){return this.b.$state.textTracks().filter(t=>t.src&&"vtt"===t.type)}Rl(){return this.b.$state.audioTracks()}Gl(t){var e,s;let i=null!=(s=null==(e=this.Il.mediaInfo)?void 0:e.tracks)?s:[];return t?i.filter(e=>e.type===t):i}im(){let t=[],e=this.Rl().find(t=>t.selected),s=this.Hl().filter(t=>"showing"===t.mode);if(e){let s=this.Gl(c),i=this.Kl(s,e);i&&t.push(i.trackId)}if(null==s?void 0:s.length){let e=this.Gl(n);if(e.length)for(let i of s){let s=this.Kl(e,i);s&&t.push(s.trackId)}}return t}hm(){let t=this.Hl();if(!this.Il.isMediaLoaded)return;let e=this.Gl(n);for(let s of t)if(!this.Kl(e,s)){(0,i.z)(()=>{var t;return null==(t=this.Ll)?void 0:t.call(this)});break}}jm(t){if(!this.Il.isMediaLoaded)return;let e=this.Rl(),s=this.Hl(),i=this.Gl(c),l=this.Gl(n);for(let s of i){var h;if(this.Sl(e,s))continue;let i={id:s.trackId.toString(),label:s.name,language:s.language,kind:null!=(h=s.subtype)?h:"main",selected:!1};this.b.audioTracks[a.L.pa](i,t)}for(let e of l){if(this.Sl(s,e))continue;let i={id:e.trackId.toString(),src:e.trackContentId,label:e.name,language:e.language,kind:e.subtype.toLowerCase()};this.b.textTracks.add(i,t)}}Ql(t){if(!this.Il.isMediaLoaded)return;let e=this.im(),s=new chrome.cast.media.EditTracksInfoRequest(e);this.km(s).catch(t=>{})}km(t){let e=(0,h.g)();return new Promise((s,i)=>null==e?void 0:e.editTracksInfo(t,s,i))}Sl(t,e){return t.find(t=>this.Tl(t,e))}Kl(t,e){return t.find(t=>this.Tl(e,t))}Tl(t,e){return e.name===t.label&&e.language===t.language&&e.subtype.toLowerCase()===t.kind.toLowerCase()}constructor(t,e,s){this.Il=t,this.b=e,this.Ll=s}}class u{get c(){return this.b.delegate.c}get type(){return"google-cast"}get currentSrc(){return this.W}get player(){return this.ba}get cast(){return(0,h.a)()}get session(){return(0,h.b)()}get media(){return(0,h.g)()}get hasActiveSession(){return(0,h.h)(this.W)}setup(){this.lm(),this.mm(),this.zb.mk(),this.c("provider-setup",this)}lm(){(0,h.l)(cast.framework.CastContextEventType.CAST_STATE_CHANGED,this.Vl.bind(this))}mm(){let t=cast.framework.RemotePlayerEventType,e={[t.IS_CONNECTED_CHANGED]:this.Vl,[t.IS_MEDIA_LOADED_CHANGED]:this.Wl,[t.CAN_CONTROL_VOLUME_CHANGED]:this.Xl,[t.CAN_SEEK_CHANGED]:this.Yl,[t.DURATION_CHANGED]:this.xg,[t.IS_MUTED_CHANGED]:this.bb,[t.VOLUME_LEVEL_CHANGED]:this.bb,[t.IS_PAUSED_CHANGED]:this.nm,[t.LIVE_SEEKABLE_RANGE_CHANGED]:this.jc,[t.PLAYER_STATE_CHANGED]:this.om};this.Ul=e;let s=this.pm.bind(this);for(let t of(0,i.A)(e))this.ba.controller.addEventListener(t,s);(0,i.v)(()=>{for(let t of(0,i.A)(e))this.ba.controller.removeEventListener(t,s)})}async play(){var t;if(this.ba.isPaused||this.Ml){if(this.Ml)return void await this.Zl(!1,0);null==(t=this.ba.controller)||t.playOrPause()}}async pause(){var t;this.ba.isPaused||null==(t=this.ba.controller)||t.playOrPause()}getMediaStatus(t){return new Promise((e,s)=>{var i;null==(i=this.media)||i.getStatus(t,e,s)})}setMuted(t){var e;(t&&!this.ba.isMuted||!t&&this.ba.isMuted)&&(null==(e=this.ba.controller)||e.muteOrUnmute())}setCurrentTime(t){var e;this.ba.currentTime=t,this.c("seeking",t),null==(e=this.ba.controller)||e.seek()}setVolume(t){var e;this.ba.volumeLevel=t,null==(e=this.ba.controller)||e.setVolumeLevel()}async loadSource(t){var e;if((null==(e=this.Cl)?void 0:e.src)!==t&&(this.Cl=null),(0,h.h)(t)){this.qm(),this.W=t;return}this.c("load-start");let s=this.rm(t),i=await this.session.loadMedia(s);if(i){this.W=null,this.c("error",Error((0,h.c)(i)));return}this.W=t}destroy(){this.I(),this._l()}I(){this.Cl||(this.Ga=0,this.Ha=new a.T(0,0),this.Ib=new a.T(0,0)),this.Ea.sa(),this.Wa=0,this.Cl=null}qm(){var t,e,s;let a=new i.D("resume-session",{detail:this.session});this.Wl(a);let{muted:l,volume:h,remotePlaybackInfo:r}=this.b.$state,n=r();this.setCurrentTime(Math.max(this.ba.currentTime,null!=(s=null==n||null==(t=n.savedState)?void 0:t.currentTime)?s:0)),this.setMuted(l()),this.setVolume(h()),(null==n||null==(e=n.savedState)?void 0:e.paused)===!1&&this.play()}_l(){this.cast.endCurrentSession(!0);let{remotePlaybackLoader:t}=this.b.$state;t.set(null)}sm(){this.b.$state.remotePlaybackInfo.set({savedState:{paused:this.ba.isPaused,currentTime:this.ba.currentTime}}),this._l()}cd(){this.tm()}pm(t){this.Ul[t.type].call(this,t)}Vl(t){let e=this.cast.getCastState(),s=e===cast.framework.CastState.CONNECTED?"connected":e===cast.framework.CastState.CONNECTING?"connecting":"disconnected";if(this.nc===s)return;let i=this.Fl(t);this.nc=s,this.c("remote-playback-change",{type:"google-cast",state:s},i),"disconnected"===s&&this.sm()}Wl(t){if(!this.ba.isMediaLoaded)return;let e=(0,i.p)(this.b.$state.source);Promise.resolve().then(()=>{if(e!==(0,i.p)(this.b.$state.source)||!this.ba.isMediaLoaded)return;this.I();let s=this.ba.duration;this.Ib=new a.T(0,s);let l={provider:this,duration:s,buffered:this.Ha,seekable:this.$l()},h=this.Fl(t);this.c("loaded-metadata",void 0,h),this.c("loaded-data",void 0,h),this.c("can-play",l,h),this.Xl(),this.Yl(t);let{volume:r,muted:n}=this.b.$state;this.setVolume(r()),this.setMuted(n()),this.Ea.Cb(),this.zb.jm(h),this.zb.Ql(h)})}Xl(){this.b.$state.canSetVolume.set(this.ba.canControlVolume)}Yl(t){let e=this.Fl(t);this.c("stream-type-change",this.um(),e)}um(){var t;return(null==(t=this.ba.mediaInfo)?void 0:t.streamType)===chrome.cast.media.StreamType.LIVE?this.ba.canSeek?"live:dvr":"live":"on-demand"}tm(){if(this.Cl)return;let t=this.ba.currentTime;if(t===this.Wa)return;let e=this.Ga,s=this.Ek(t);this.c("time-update",{currentTime:t,played:s}),t>e&&this.jc(),this.b.$state.seeking()&&this.c("seeked",t),this.Wa=t}Ek(t){return this.Ga>=t?this.Ha:this.Ha=new a.T(0,this.Ga=t)}xg(t){if(!this.ba.isMediaLoaded||this.Cl)return;let e=this.ba.duration,s=this.Fl(t);this.Ib=new a.T(0,e),this.c("duration-change",e,s)}bb(t){if(!this.ba.isMediaLoaded)return;let e={muted:this.ba.isMuted,volume:this.ba.volumeLevel},s=this.Fl(t);this.c("volume-change",e,s)}nm(t){let e=this.Fl(t);this.ba.isPaused?this.c("pause",void 0,e):this.c("play",void 0,e)}jc(t){let e={seekable:this.$l(),buffered:this.Ha},s=t?this.Fl(t):void 0;this.c("progress",e,s)}om(t){let e=this.ba.playerState,s=chrome.cast.media.PlayerState;if(this.Ml=e===s.IDLE,e===s.PAUSED)return;let i=this.Fl(t);switch(e){case s.PLAYING:this.c("playing",void 0,i);break;case s.BUFFERING:this.c("waiting",void 0,i);break;case s.IDLE:this.Ea.sa(),this.c("pause"),this.c("end")}}$l(){return this.ba.liveSeekableRange?new a.T(this.ba.liveSeekableRange.start,this.ba.liveSeekableRange.end):this.Ib}Fl(t){return t instanceof Event?t:new i.D(t.type,{detail:t})}vm(t){let{streamType:e,title:s,poster:i}=this.b.$state;return new r(t).gm(s(),i()).dm(e()).em(this.zb.Hl()).build()}rm(t){var e,s,i,a,l,h,r;let n=this.vm(t),c=new chrome.cast.media.LoadRequest(n),o=this.b.$state.remotePlaybackInfo();return c.autoplay=(null!=(l=null==(e=this.Cl)?void 0:e.paused)?l:null==o||null==(s=o.savedState)?void 0:s.paused)===!1,c.currentTime=null!=(r=null!=(h=null==(i=this.Cl)?void 0:i.time)?h:null==o||null==(a=o.savedState)?void 0:a.currentTime)?r:0,c}async Zl(t,e){let s=(0,i.p)(this.b.$state.source);this.Cl={src:s,paused:t,time:e},await this.loadSource(s)}Ll(){this.Zl(this.ba.isPaused,this.ba.currentTime).catch(t=>{})}constructor(t,e){this.ba=t,this.b=e,this.$$PROVIDER_TYPE="GOOGLE_CAST",this.scope=(0,i.h)(),this.W=null,this.nc="disconnected",this.Wa=0,this.Ga=0,this.Ha=new a.T(0,0),this.Ib=new a.T(0,0),this.Ea=new l.R(this.cd.bind(this)),this.Cl=null,this.Ml=!1,this.zb=new o(this.ba,this.b,this.Ll.bind(this))}}}}]);