"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1749],{4130:(e,t,n)=>{n.d(t,{ZY:()=>tX,ry:()=>nh,sY:()=>nm,jw:()=>nl,yN:()=>na,R3:()=>tJ,GN:()=>ne,M3:()=>t5,G7:()=>nn,pS:()=>tq,sN:()=>t9,Dw:()=>nu,z6:()=>tH,LD:()=>t6,W3:()=>t0,Uk:()=>tQ,VW:()=>no,p6:()=>t7,x4:()=>t8,Sg:()=>t1,my:()=>t$,Qp:()=>nr,Dr:()=>ns,bc:()=>tY,BH:()=>tG,FY:()=>t2,TS:()=>t3,OP:()=>nd,J4:()=>nc,uT:()=>ni,iY:()=>t4,Eg:()=>nt,xX:()=>tW,BI:()=>tZ});var i=n(95155),a=n(19749),r=n(45886),l=n(74889),s=n(3196),o=n(91360),c=n(42500),d=n(29724),u=n(84218),m=n(12115),h=n(28002);let p=(0,c.eU)(null),f=(0,c.eU)(null),v=(0,c.eU)(null,(e,t,n)=>{var i,a;let r=Date.now().toString(),l=e(f),s=e(t8);t(p,{id:r,message:n.message,timestamp:Date.now(),type:null!=(i=n.type)?i:"message"}),l&&clearTimeout(l);let o=setTimeout(()=>{t(p,null),t(f,null)},null!=(a=n.duration)?a:"icon"===n.type?200:s?1e3:500);t(f,o)});function g(){let e,t,n=(0,a.c)(18),[r]=(0,d.fp)(p),l=(0,d.md)(t7);if(!r)return null;if("icon"===r.type){let e,t,a,s,c,d,m;return n[0]===Symbol.for("react.memo_cache_sentinel")?(e={opacity:.2,scale:1},t={opacity:.5,scale:1.6},a={opacity:1,scale:1},s={duration:.06,ease:"easeOut"},n[0]=e,n[1]=t,n[2]=a,n[3]=s):(e=n[0],t=n[1],a=n[2],s=n[3]),n[4]!==l||n[5]!==r.message?(c="PLAY"===r.message&&(0,i.jsx)(h.IrE,{className:(0,o.cn)("size-24 text-white",l&&"size-10"),style:{textShadow:"0 1px 10px rgba(0, 0, 0, 0.8)"}}),n[4]=l,n[5]=r.message,n[6]=c):c=n[6],n[7]!==l||n[8]!==r.message?(d="PAUSE"===r.message&&(0,i.jsx)(h.olp,{className:(0,o.cn)("size-24 text-white",l&&"size-10"),style:{textShadow:"0 1px 10px rgba(0, 0, 0, 0.8)"}}),n[7]=l,n[8]=r.message,n[9]=d):d=n[9],n[10]!==c||n[11]!==d?(m=(0,i.jsxs)(u.P.div,{initial:e,animate:t,exit:a,transition:s,className:"absolute w-full h-full pointer-events-none flex z-[50] items-center justify-center",children:[c,d]}),n[10]=c,n[11]=d,n[12]=m):m=n[12],m}let s=l&&"text-sm";return n[13]!==s?(e=(0,o.cn)("text-white px-2 py-1 !text-xl font-semibold rounded-lg bg-black/50 backdrop-blur-sm tracking-wide",s),n[13]=s,n[14]=e):e=n[14],n[15]!==r.message||n[16]!==e?(t=(0,i.jsx)("div",{className:"absolute top-16 left-1/2 transform -translate-x-1/2 z-50 pointer-events-none",children:(0,i.jsx)("div",{className:e,children:r.message})}),n[15]=r.message,n[16]=e,n[17]=t):t=n[17],t}var b=n(93715),y=n(21842);let x=(0,b.v)("VIDEO CORE ANIME 4K"),k=(0,y.tG)("sea-video-core-anime4k","off",void 0,{getOnInit:!0}),w=()=>{let e,t,n,i,r,l,s=(0,a.c)(20),o=(0,d.md)(tG),c=(0,d.md)(t2),u=(0,d.md)(t7),h=(0,d.md)(t1),p=(0,d.md)(nt);(0,d.md)(t8);let f=(0,d.md)(nl),[v]=(0,d.fp)(k);return s[0]!==f||s[1]!==(null==p?void 0:p.videoHeight)||s[2]!==(null==p?void 0:p.videoWidth)?(e=()=>{f&&f.updateCanvasSize({width:(null==p?void 0:p.videoWidth)||0,height:(null==p?void 0:p.videoHeight)||0})},s[0]=f,s[1]=null==p?void 0:p.videoHeight,s[2]=null==p?void 0:p.videoWidth,s[3]=e):e=s[3],s[4]!==f||s[5]!==p?(t=[f,p],s[4]=f,s[5]=p,s[6]=t):t=s[6],m.useEffect(e,t),s[7]!==u||s[8]!==h||s[9]!==f||s[10]!==c||s[11]!==v||s[12]!==p?(n=()=>{p&&f&&(x.info("Setting Anime4K option",v),f.setOption(v,{isMiniPlayer:u,isPip:h,seeking:c}))},i=[p,f,v,u,h,c],s[7]=u,s[8]=h,s[9]=f,s[10]=c,s[11]=v,s[12]=p,s[13]=n,s[14]=i):(n=s[13],i=s[14]),m.useEffect(n,i),s[15]!==f||s[16]!==p?(r=()=>{p&&f&&f.resize()},s[15]=f,s[16]=p,s[17]=r):r=s[17],s[18]!==o?(l=[o],s[18]=o,s[19]=l):l=s[19],m.useLayoutEffect(r,l),null},E=[{value:"off",label:"Off",description:"Disabled",performance:"light"},{value:"mode-a",label:"Mode A",description:"Removes compression artifacts then upscales",performance:"light"},{value:"mode-b",label:"Mode B",description:"Gentle artifact removal then upscales",performance:"light"},{value:"mode-c",label:"Mode C",description:"Upscales with denoising then upscales again",performance:"light"},{value:"mode-aa",label:"Mode A+A",description:"Enhanced restoration for better quality",performance:"medium"},{value:"mode-bb",label:"Mode B+B",description:"Double soft restoration",performance:"medium"},{value:"mode-ca",label:"Mode C+A",description:"Denoising + restoration hybrid",performance:"medium"},{value:"cnn-2x-medium",label:"CNN 2x M",description:"Balanced speed and quality",performance:"medium"},{value:"cnn-2x-very-large",label:"CNN 2x VL",description:"High quality neural network",performance:"heavy"},{value:"denoise-cnn-2x-very-large",label:"Denoise CNN 2x VL",description:"Removes noise while upscaling",performance:"heavy"},{value:"cnn-2x-ultra-large",label:"CNN 2x UL",description:"Maximum CNN quality",performance:"heavy"},{value:"gan-3x-large",label:"GAN 3x L",description:"Generative adversarial network for perceptual quality",performance:"heavy"},{value:"gan-4x-ultra-large",label:"GAN 4x UL",description:"Maximum upscaling with GAN technology",performance:"heavy"}],S=e=>E.find(t=>t.value===e);var T=n(23909);let C=(0,b.v)("VIDEO CORE ANIME 4K MANAGER");class j{updateCanvasSize(e){let t=this.getRenderedVideoContentSize(this.videoElement);this._boxSize={width:(null==t?void 0:t.displayedWidth)||e.width,height:(null==t?void 0:t.displayedHeight)||e.height},this.canvas&&(this.canvas.width=this._boxSize.width,this.canvas.height=this._boxSize.height,C.info("Updating canvas size",{...this._boxSize}))}resize(){let e=this.getRenderedVideoContentSize(this.videoElement);this._boxSize={width:(null==e?void 0:e.displayedWidth)||0,height:(null==e?void 0:e.displayedHeight)||0},this.canvas&&(this.canvas.width=this._boxSize.width,this.canvas.height=this._boxSize.height,this.canvas.style.width=this._boxSize.width+"px",this.canvas.style.height=this._boxSize.height+"px")}registerOnCanvasCreated(e){this._onCanvasCreatedCallbacks.add(e)}registerOnCanvasCreatedOnce(e){this._onCanvasCreatedCallbacksOnce.add(e)}async setOption(e,t){let n=this._currentOption;if(this._currentOption=e,"off"===e)return void this.destroy();if(t){if(t.isMiniPlayer||t.isPip){C.info("Destroying canvas due to PIP/mini player mode"),this.destroy();return}if(t.seeking)return void this._hideCanvas()}if(0!==this._boxSize.width&&0!==this._boxSize.height){if(this.canvas&&this._isCanvasHidden()){C.info("Showing previously hidden canvas"),this._showCanvas();return}if(n!==e||!this.canvas){C.info("Change detected, reinitializing canvas"),this.destroy();try{await this._initialize()}catch(e){C.error("Failed to initialize Anime4K",e),this._handleError(e instanceof Error?e.message:"Unknown error")}}}}destroy(){var e;this._initialized=!1,this._initializationTimeout&&(clearTimeout(this._initializationTimeout),this._initializationTimeout=null),this.canvas&&(this.canvas.remove(),this.canvas=null),this._renderLoopId&&(cancelAnimationFrame(this._renderLoopId),this._renderLoopId=null),(null==(e=this._webgpuResources)?void 0:e.device)&&(this._webgpuResources.device.destroy(),this._webgpuResources=null),this._abortController&&(this._abortController.abort(),this._abortController=null),this._frameDropState.frameDropCount=0,this._frameDropState.lastFrameTime=0}async _initialize(){if(!this._initialized&&"off"!==this._currentOption){C.info("Initializing Anime4K",this._currentOption),this._abortController=new AbortController,this._frameDropState={...this._frameDropState,frameDropCount:0,initTime:performance.now(),lastFrameTime:0};try{if(!await this.getGPUInfo())throw Error("WebGPU not supported");if(this._abortController.signal.aborted||(this._createCanvas(),this._abortController.signal.aborted))return;await this._startRendering(),this._initialized=!0,C.info("Anime4K initialized")}catch(t){var e;if(!(null==(e=this._abortController)?void 0:e.signal.aborted))throw C.error("Initialization failed",t),t}}}getRenderedVideoContentSize(e){let t,n,i=e.clientWidth,a=e.clientHeight,r=e.videoWidth,l=e.videoHeight;if(!r||!l)return null;let s=i/a,o=r/l,c=getComputedStyle(e).objectFit||"fill";return"cover"===c?o>s?(n=a,t=a*o):(t=i,n=i/o):"contain"===c?o>s?(t=i,n=i/o):(n=a,t=a*o):(t=i,n=a),{displayedWidth:t,displayedHeight:n}}_createCanvas(){var e,t;null!=(e=this._abortController)&&e.signal.aborted||(this.canvas=document.createElement("canvas"),this.canvas.width=this._boxSize.width,this.canvas.height=this._boxSize.height,this.canvas.style.objectFit="cover",this.canvas.style.position="absolute",this.canvas.style.pointerEvents="none",this.canvas.style.zIndex="2",this.canvas.style.objectFit="contain",this.canvas.style.objectPosition="center",this.canvas.style.width=this._boxSize.width+"px",this.canvas.style.height=this._boxSize.height+"px",this.canvas.style.top="",this.canvas.style.display="block",this.canvas.className="vc-anime4k-canvas",C.info("Creating canvas",{width:this.canvas.width,height:this.canvas.height,top:this.canvas.style.top}),null==(t=this.videoElement.parentElement)||t.appendChild(this.canvas))}async _startRendering(){if(!this.canvas||!this.videoElement||"off"===this._currentOption)return void console.warn("stopped started");let e={width:this.videoElement.videoWidth,height:this.videoElement.videoHeight},t={width:this.canvas.width,height:this.canvas.height};C.info("Rendering started"),await (0,T.render)({video:this.videoElement,canvas:this.canvas,pipelineBuilder:(n,i)=>(this._webgpuResources={device:n},this.createPipeline({device:n,inputTexture:i,nativeDimensions:e,targetDimensions:t}))}),setTimeout(()=>{if(this.canvas){for(let e of this._onCanvasCreatedCallbacks)e(this.canvas);for(let e of this._onCanvasCreatedCallbacksOnce)e(this.canvas);this._onCanvasCreatedCallbacksOnce.clear()}},100),this._frameDropState.enabled&&this._isOptionSelected(this._currentOption)&&this._startFrameDropDetection()}createPipeline(e){switch(this._currentOption){case"mode-a":default:return[new T.ModeA(e)];case"mode-b":return[new T.ModeB(e)];case"mode-c":return[new T.ModeC(e)];case"mode-aa":return[new T.ModeAA(e)];case"mode-bb":return[new T.ModeBB(e)];case"mode-ca":return[new T.ModeCA(e)];case"cnn-2x-medium":return[new T.CNNx2M(e)];case"cnn-2x-very-large":return[new T.CNNx2VL(e)];case"denoise-cnn-2x-very-large":return[new T.DenoiseCNNx2VL(e)];case"cnn-2x-ultra-large":return[new T.CNNx2UL(e)];case"gan-3x-large":return[new T.GANx3L(e)];case"gan-4x-ultra-large":return[new T.GANx4UUL(e)]}}_startFrameDropDetection(){let e=()=>{this._isOptionSelected(this._currentOption)&&null!==this._renderLoopId&&(this._detectFrameDrops(),this._renderLoopId=requestAnimationFrame(e))};this._renderLoopId=requestAnimationFrame(e)}_detectFrameDrops(){if(!this._isOptionSelected(this._currentOption))return;let e=performance.now();if(e-this._frameDropState.initTime<this._frameDropState.performanceGracePeriod){this._frameDropState.lastFrameTime=e;return}if(this._frameDropState.lastFrameTime>0)if(e-this._frameDropState.lastFrameTime>1.5*this._frameDropState.targetFrameTime){if(this._frameDropState.frameDropCount++,this._frameDropState.frameDropCount>=this._frameDropState.frameDropThreshold){C.warning("Detected ".concat(this._frameDropState.frameDropCount," consecutive frame drops. Falling back to 'off' mode.")),this._handlePerformanceFallback();return}}else this._frameDropState.frameDropCount=0;this._frameDropState.lastFrameTime=e}_handlePerformanceFallback(){var e,t;null==(e=this._onFallback)||e.call(this,"Performance degraded. Turning off Anime4K."),this.setOption("off"),null==(t=this._onOptionChanged)||t.call(this,"off")}_handleError(e){var t,n;null==(t=this._onFallback)||t.call(this,"Anime4K: ".concat(e)),this.setOption("off"),null==(n=this._onOptionChanged)||n.call(this,"off")}async getGPUInfo(){if(!navigator.gpu)return null;try{let e=await navigator.gpu.requestAdapter();if(!e)return null;let t=await e.requestDevice();if(!t)return null;let n=e.info||{};return{gpu:n.vendor||n.architecture||"Unknown GPU",vendor:n.vendor||"Unknown",device:t}}catch(e){return null}}_isOptionSelected(e){return"off"!==e}_hideCanvas(){this.canvas&&(this.canvas.style.display="none")}_showCanvas(){this.canvas&&(this.canvas.style.display="block")}_isCanvasHidden(){return!!this.canvas&&"none"===this.canvas.style.display}constructor({videoElement:e,settings:t,onFallback:n,onOptionChanged:i}){this.canvas=null,this._currentOption="off",this._webgpuResources=null,this._renderLoopId=null,this._abortController=null,this._frameDropState={enabled:!0,frameDropThreshold:5,frameDropCount:0,lastFrameTime:0,targetFrameTime:62.5,performanceGracePeriod:1e3,initTime:0},this._boxSize={width:0,height:0},this._initializationTimeout=null,this._initialized=!1,this._onCanvasCreatedCallbacks=new Set,this._onCanvasCreatedCallbacksOnce=new Set,this.videoElement=e,this.settings=t,this._onFallback=n,this._onOptionChanged=i,C.info("Anime4K manager initialized")}}let _=(0,b.v)("AUDIO");class P{_selectDefaultTrack(){for(let i of this.settings.preferredAudioLanguage.split(",").map(e=>e.trim()).filter(e=>e.length>0)){var e,t,n;let a=null==(n=this.playbackInfo.mkvMetadata)||null==(t=n.audioTracks)||null==(e=t.filter)?void 0:e.call(t,e=>(e.language||"eng")===i);if(null==a?void 0:a.length){let e=a.findIndex(e=>e.forced);this.selectTrack(a[e>=0?e:0].number);return}}}selectTrackByLabel(e){var t,n,i;let a=null==(i=this.playbackInfo.mkvMetadata)||null==(n=i.audioTracks)||null==(t=n.find)?void 0:t.call(n,t=>t.name===e);a?this.selectTrack(a.number):_.error("Audio track not found",e)}selectTrack(e){if(!this.videoElement.audioTracks)return;let t=!1;for(let n=0;n<this.videoElement.audioTracks.length;n++){let i=this.videoElement.audioTracks[n].id===e.toString();this.videoElement.audioTracks[n].enabled!==i&&(this.videoElement.audioTracks[n].enabled=i,t=!0)}t&&this.videoElement.audioTracks.dispatchEvent&&this.videoElement.audioTracks.dispatchEvent(new Event("change"))}getSelectedTrack(){if(!this.videoElement.audioTracks)return null;for(let e=0;e<this.videoElement.audioTracks.length;e++)if(this.videoElement.audioTracks[e].enabled)return Number(this.videoElement.audioTracks[e].id);return null}constructor({videoElement:e,settings:t,playbackInfo:n,onError:i}){if(this.videoElement=e,this.settings=t,this.playbackInfo=n,this.onError=i,this.videoElement.audioTracks){if(this.videoElement.audioTracks.length<=0)return void this.onError("The video element does not support the media's audio codec. Please try another media.");_.info("Audio tracks",this.videoElement.audioTracks)}this._selectDefaultTrack()}}var N=n(46383);let F=(0,b.v)("VIDEO CORE FULLSCREEN"),I=(0,c.eU)(null);class D{setContainer(e){this.containerElement=e}isFullscreen(){return!!this.isElectron()&&!!this.isElectronNativeFullscreen||!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}async toggleFullscreen(){this.isFullscreen()?await this.exitFullscreen():await this.enterFullscreen()}async exitFullscreen(){try{if(this.isElectron()&&this.shouldUseElectronFullscreen())return void await this.exitElectronFullscreen();document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.mozCancelFullScreen?await document.mozCancelFullScreen():document.msExitFullscreen&&await document.msExitFullscreen(),F.info("Exited fullscreen")}catch(e){F.error("Failed to exit fullscreen",e)}}async enterFullscreen(){if(!this.containerElement)return void F.warning("Container element not set");try{if(this.isElectron()&&this.shouldUseElectronFullscreen())return void await this.enterElectronFullscreen();this.containerElement.requestFullscreen?await this.containerElement.requestFullscreen():this.containerElement.webkitRequestFullscreen?await this.containerElement.webkitRequestFullscreen():this.containerElement.mozRequestFullScreen?await this.containerElement.mozRequestFullScreen():this.containerElement.msRequestFullscreen&&await this.containerElement.msRequestFullscreen(),F.info("Entered fullscreen")}catch(e){F.error("Failed to enter fullscreen",e)}}destroy(){this.controller.abort(),this.containerElement=null}isElectron(){var e;return!!(null==(e=window)?void 0:e.electron)}shouldUseElectronFullscreen(){return this.isElectron()}async enterElectronFullscreen(){var e,t,n;if(!(null==(n=window)||null==(t=n.electron)||null==(e=t.window)?void 0:e.setFullscreen))return void F.warning("Electron fullscreen API not available");try{await window.electron.window.setFullscreen(!0),this.isElectronNativeFullscreen=!0,F.info("Entered Electron native fullscreen")}catch(e){F.error("Failed to enter Electron fullscreen",e)}}async exitElectronFullscreen(){var e,t,n,i;if(!(null==(t=window.electron)||null==(e=t.window)?void 0:e.setFullscreen))return void F.warning("Electron fullscreen API not available");try{await (null==(i=window.electron)||null==(n=i.window)?void 0:n.setFullscreen(!1)),this.isElectronNativeFullscreen=!1,F.info("Exited Electron native fullscreen")}catch(e){F.error("Failed to exit Electron fullscreen",e)}}attachElectronListeners(){var e,t;if(!this.isElectron())return;let n=null==(t=window.electron)||null==(e=t.on)?void 0:e.call(t,"window:fullscreen",e=>{this.isElectronNativeFullscreen=e,F.info("Electron fullscreen state changed:",e),this.onFullscreenChange(e)});if(n){let e=this.controller.abort.bind(this.controller);this.controller.abort=()=>{n(),e()}}}attachDocumentListeners(){document.addEventListener("fullscreenchange",this.handleFullscreenChange,{signal:this.controller.signal}),document.addEventListener("webkitfullscreenchange",this.handleFullscreenChange,{signal:this.controller.signal}),document.addEventListener("mozfullscreenchange",this.handleFullscreenChange,{signal:this.controller.signal}),document.addEventListener("msfullscreenchange",this.handleFullscreenChange,{signal:this.controller.signal})}constructor(e){this.containerElement=null,this.controller=new AbortController,this.isElectronNativeFullscreen=!1,this.handleFullscreenChange=()=>{let e=this.isFullscreen();F.info("Fullscreen state changed:",e),this.onFullscreenChange(e)},this.onFullscreenChange=e,this.attachDocumentListeners(),this.attachElectronListeners()}}var L=n(51532),M=n(84127),R=n(76049),A=n(76136),O=n(57073),U=n(53712);let z=(0,c.eU)(!1),V=m.memo(e=>{let t,n=(0,a.c)(4),{actionKey:r,value:l,onValueChange:s}=e,o=r.includes("Speed")?.25:1;return n[0]!==s||n[1]!==o||n[2]!==l?(t=(0,i.jsx)(A.Q,{value:l,onValueChange:s,size:"sm",fieldClass:"w-16",hideControls:!0,min:0,step:o,onKeyDown:q,onInput:$}),n[0]=s,n[1]=o,n[2]=l,n[3]=t):t=n[3],t});function K(){let e,t,n,r,l,s,c,u,h,p,f,v,g,b,y,x,k,w,E,S,T,C,j,_=(0,a.c)(58),[P,N]=(0,d.fp)(z),[F,I]=(0,d.fp)(L.ZM),[D,A]=(0,m.useState)(F),[K,H]=(0,m.useState)(null),[q,$]=(0,d.fp)(L.gw),[Y,J]=(0,m.useState)(q.preferredSubtitleLanguage),[Q,Z]=(0,m.useState)(q.preferredAudioLanguage);_[0]!==F||_[1]!==P||_[2]!==q.preferredAudioLanguage||_[3]!==q.preferredSubtitleLanguage?(e=()=>{P&&(A(F),J(q.preferredSubtitleLanguage),Z(q.preferredAudioLanguage))},_[0]=F,_[1]=P,_[2]=q.preferredAudioLanguage,_[3]=q.preferredSubtitleLanguage,_[4]=e):e=_[4],_[5]!==F||_[6]!==P||_[7]!==q?(t=[P,F,q],_[5]=F,_[6]=P,_[7]=q,_[8]=t):t=_[8],(0,m.useEffect)(e,t),_[9]===Symbol.for("react.memo_cache_sentinel")?(n=e=>{H(e);let t=n=>{n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation(),A(t=>({...t,[e]:{...t[e],key:n.code}})),H(null),document.removeEventListener("keydown",t,!0)};document.addEventListener("keydown",t,!0)},_[9]=n):n=_[9];let ee=n;_[10]!==Q||_[11]!==D||_[12]!==Y||_[13]!==I||_[14]!==N||_[15]!==$||_[16]!==q?(r=()=>{I(D),$({...q,preferredSubtitleLanguage:Y,preferredAudioLanguage:Q}),N(!1)},_[10]=Q,_[11]=D,_[12]=Y,_[13]=I,_[14]=N,_[15]=$,_[16]=q,_[17]=r):r=_[17];let et=r;_[18]===Symbol.for("react.memo_cache_sentinel")?(l=()=>{A(L.Rk),J(L.Eb.preferredSubtitleLanguage),Z(L.Eb.preferredAudioLanguage)},_[18]=l):l=_[18];let en=l;_[19]!==D||_[20]!==K?(s=e=>{var t,n;let{action:a,actionKey:r,hasValue:l,valueLabel:s}=e;return(0,i.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-border/50 last:border-b-0",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("div",{className:"font-medium text-sm",children:a}),void 0!==l&&l&&(0,i.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,i.jsxs)("span",{className:"text-xs text-muted-foreground",children:[void 0===s?"":s,":"]}),(0,i.jsx)(V,{actionKey:r,value:"value"in D[r]?D[r].value:0,onValueChange:e=>A(t=>({...t,[r]:{...t[r],value:e||0}}))})]})]}),(0,i.jsx)("div",{className:"flex items-center gap-2",children:(0,i.jsx)(M.$n,{intent:K===r?"white-subtle":"gray-outline",size:"sm",onClick:()=>ee(r),className:(0,o.cn)("h-8 px-3 text-lg font-mono",K===r&&"!text-xs text-white"),children:K===r?"Press key...":function(e){return({KeyA:"A",KeyB:"B",KeyC:"C",KeyD:"D",KeyE:"E",KeyF:"F",KeyG:"G",KeyH:"H",KeyI:"I",KeyJ:"J",KeyK:"K",KeyL:"L",KeyM:"M",KeyN:"N",KeyO:"O",KeyP:"P",KeyQ:"Q",KeyR:"R",KeyS:"S",KeyT:"T",KeyU:"U",KeyV:"V",KeyW:"W",KeyX:"X",KeyY:"Y",KeyZ:"Z",ArrowUp:"↑",ArrowDown:"↓",ArrowLeft:"←",ArrowRight:"→",BracketLeft:"[",BracketRight:"]",Space:"⎵"})[e]||e}(null!=(n=null==D||null==(t=D[r])?void 0:t.key)?n:"")})})]})},_[19]=D,_[20]=K,_[21]=s):s=_[21];let ei=s;return _[22]===Symbol.for("react.memo_cache_sentinel")?(c=(0,i.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Language Preferences"}),_[22]=c):c=_[22],_[23]===Symbol.for("react.memo_cache_sentinel")?(u=(0,i.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Preferred Subtitle Language"}),_[23]=u):u=_[23],_[24]!==Y?(h=(0,i.jsxs)("div",{className:"space-y-2",children:[u,(0,i.jsx)(U.k,{value:Y,onValueChange:J,placeholder:"eng,jpn,spa",onKeyDown:G,onInput:W})]}),_[24]=Y,_[25]=h):h=_[25],_[26]===Symbol.for("react.memo_cache_sentinel")?(p=(0,i.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Preferred Audio Language"}),_[26]=p):p=_[26],_[27]!==Q?(f=(0,i.jsxs)("div",{className:"space-y-2",children:[p,(0,i.jsx)(U.k,{value:Q,onValueChange:Z,placeholder:"jpn,eng,kor",onKeyDown:X,onInput:B})]}),_[27]=Q,_[28]=f):f=_[28],_[29]!==f||_[30]!==h?(v=(0,i.jsxs)("div",{className:"space-y-3",children:[c,(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[h,f]})]}),_[29]=f,_[30]=h,_[31]=v):v=_[31],_[32]===Symbol.for("react.memo_cache_sentinel")?(g=(0,i.jsx)(O.w,{}),_[32]=g):g=_[32],_[33]===Symbol.for("react.memo_cache_sentinel")?(b=(0,i.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Keyboard Shortcuts"}),_[33]=b):b=_[33],_[34]!==ei?(y=(0,i.jsx)("div",{children:(0,i.jsxs)("div",{className:"space-y-0",children:[(0,i.jsx)(ei,{action:"Seek Forward",description:"Seek forward",actionKey:"seekForward",hasValue:!0,valueLabel:"Seconds"}),(0,i.jsx)(ei,{action:"Seek Backward",description:"Seek backward",actionKey:"seekBackward",hasValue:!0,valueLabel:"Seconds"}),(0,i.jsx)(ei,{action:"Seek Forward (Fine)",description:"Seek forward (fine)",actionKey:"seekForwardFine",hasValue:!0,valueLabel:"Seconds"}),(0,i.jsx)(ei,{action:"Seek Backward (Fine)",description:"Seek backward (fine)",actionKey:"seekBackwardFine",hasValue:!0,valueLabel:"Seconds"}),(0,i.jsx)(ei,{action:"Increase Speed",description:"Increase playback speed",actionKey:"increaseSpeed",hasValue:!0,valueLabel:"increment"}),(0,i.jsx)(ei,{action:"Decrease Speed",description:"Decrease playback speed",actionKey:"decreaseSpeed",hasValue:!0,valueLabel:"increment"})]})}),_[34]=ei,_[35]=y):y=_[35],_[36]!==ei?(x=(0,i.jsx)("div",{children:(0,i.jsxs)("div",{className:"space-y-0",children:[(0,i.jsx)(ei,{action:"Next Chapter",description:"Skip to next chapter",actionKey:"nextChapter"}),(0,i.jsx)(ei,{action:"Previous Chapter",description:"Skip to previous chapter",actionKey:"previousChapter"}),(0,i.jsx)(ei,{action:"Next Episode",description:"Play next episode",actionKey:"nextEpisode"}),(0,i.jsx)(ei,{action:"Previous Episode",description:"Play previous episode",actionKey:"previousEpisode"}),(0,i.jsx)(ei,{action:"Cycle Subtitles",description:"Cycle through subtitle tracks",actionKey:"cycleSubtitles"}),(0,i.jsx)(ei,{action:"Fullscreen",description:"Toggle fullscreen",actionKey:"fullscreen"}),(0,i.jsx)(ei,{action:"Picture in Picture",description:"Toggle picture in picture",actionKey:"pictureInPicture"}),(0,i.jsx)(ei,{action:"Take Screenshot",description:"Take screenshot",actionKey:"takeScreenshot"})]})}),_[36]=ei,_[37]=x):x=_[37],_[38]!==ei?(k=(0,i.jsx)("div",{children:(0,i.jsxs)("div",{className:"space-y-0",children:[(0,i.jsx)(ei,{action:"Volume Up",description:"Increase volume",actionKey:"volumeUp",hasValue:!0,valueLabel:"Percent"}),(0,i.jsx)(ei,{action:"Volume Down",description:"Decrease volume",actionKey:"volumeDown",hasValue:!0,valueLabel:"Percent"}),(0,i.jsx)(ei,{action:"Mute",description:"Toggle mute",actionKey:"mute"}),(0,i.jsx)(ei,{action:"Cycle Audio",description:"Cycle through audio tracks",actionKey:"cycleAudio"})]})}),_[38]=ei,_[39]=k):k=_[39],_[40]!==y||_[41]!==x||_[42]!==k?(w=(0,i.jsxs)("div",{className:"space-y-3",children:[b,(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-8",children:[y,x,k]})]}),_[40]=y,_[41]=x,_[42]=k,_[43]=w):w=_[43],_[44]===Symbol.for("react.memo_cache_sentinel")?(E=(0,i.jsx)(M.$n,{intent:"gray-outline",onClick:en,children:"Reset all"}),_[44]=E):E=_[44],_[45]!==N?(S=(0,i.jsx)(M.$n,{intent:"gray-outline",onClick:()=>N(!1),children:"Cancel"}),_[45]=N,_[46]=S):S=_[46],_[47]!==et?(T=(0,i.jsx)(M.$n,{intent:"primary",onClick:et,children:"Save"}),_[47]=et,_[48]=T):T=_[48],_[49]!==S||_[50]!==T?(C=(0,i.jsxs)("div",{className:"flex items-center justify-between pt-6 mt-6 border-t border-border",children:[E,(0,i.jsxs)("div",{className:"flex gap-2",children:[S,T]})]}),_[49]=S,_[50]=T,_[51]=C):C=_[51],_[52]!==P||_[53]!==N||_[54]!==v||_[55]!==w||_[56]!==C?(j=(0,i.jsxs)(R.a,{title:"Keybinds and Defaults",description:"Customize the keyboard shortcuts and defaults for the player",open:P,onOpenChange:N,contentClass:"max-w-5xl focus:outline-none focus-visible:outline-none outline-none bg-black/80 backdrop-blur-sm z-[101]",children:[v,g,w,C]}),_[52]=P,_[53]=N,_[54]=v,_[55]=w,_[56]=C,_[57]=j):j=_[57],j}function B(e){return e.stopPropagation()}function X(e){return e.stopPropagation()}function W(e){return e.stopPropagation()}function G(e){return e.stopPropagation()}function H(e){let{active:t,videoRef:n,chapterCues:i,introEndTime:r,introStartTime:l,endingEndTime:s,endingStartTime:o}=e,[c]=(0,d.fp)(L.ZM),u=(0,d.md)(z),h=(0,d.md)(t0),p=(0,d.md)(t1),f=(0,d.md)(tZ),g=(0,d.Xr)(L.bM),y=(0,d.md)(tQ),x=(0,d.Xr)(L.cW),{flashAction:w}=function(){let e,t=(0,a.c)(2),[,n]=(0,d.fp)(v);return t[0]!==n?(e={flashAction:n},t[0]=n,t[1]=e):e=t[1],e}(),E=(0,d.Xr)(nu),S=(0,d.md)(ni),T=(0,d.md)(na),C=(0,d.md)(I),j=(0,m.useRef)(0);function _(e){var t,i,a;let r=null==(t=n.current)?void 0:t.paused;r||null==(i=n.current)||i.pause(),E({type:"seek",payload:{time:e,flashTime:!0}}),r||null==(a=n.current)||a.play()}function P(e){var t,i,a;let r=null==(t=n.current)?void 0:t.paused;r||null==(i=n.current)||i.pause(),E({type:"seekTo",payload:{time:e,flashTime:!0}}),r||null==(a=n.current)||a.play()}let{takeScreenshot:N}=function(){let e=(0,d.md)(nt),t=(0,d.md)(ni),n=(0,d.Xr)(v),i=(0,d.md)(nl),a=(0,d.md)(k),r=m.useRef(null);async function l(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],await navigator.clipboard.write([new ClipboardItem({[e.type]:e})]),n({message:"Screenshot saved to clipboard",type:"message"})}async function s(e){let n=null==t?void 0:t.libassRenderer;if(!n)return;let i=e.getContext("2d");if(i)return new Promise(t=>{n.resize(e.width,e.height),r.current=setTimeout(()=>{i.drawImage(n._canvas,0,0,e.width,e.height),n.resize(0,0,0,0),t()},300)})}async function o(e){return new Promise(async t=>{if(e instanceof HTMLCanvasElement)e.toBlob(t,"image/png");else{let n=document.createElement("canvas"),i=n.getContext("2d");if(!i)return t(null);n.width=e.videoWidth,n.height=e.videoHeight,i.drawImage(e,0,0),await s(n),n.toBlob(e=>{n.remove(),t(e)})}})}async function c(e){return new Promise(t=>{let n=new Image;n.onload=async()=>{let e=document.createElement("canvas"),i=e.getContext("2d");if(!i)return t(null);e.width=n.width,e.height=n.height,i.drawImage(n,0,0),await s(e),e.toBlob(i=>{e.remove(),URL.revokeObjectURL(n.src),t(i)})},n.src=URL.createObjectURL(e)})}return{takeScreenshot:async function(){if(r.current&&clearTimeout(r.current),!e)return;let s=e.paused;e.pause(),n({message:"Taking screenshot..."});try{let n=null,r=!1;if("off"!==a&&(null==i?void 0:i.canvas)){let e=await o(i.canvas);e&&(n=(null==t?void 0:t.libassRenderer)?await c(e):e,r=!0)}n||(n=await o(e)),n&&await l(n,r)}catch(e){console.error("Screenshot failed:",e),n({message:"Screenshot failed"})}finally{s||e.play()}}}}(),F=(0,m.useCallback)(async i=>{if(u||i.target instanceof HTMLInputElement||i.target instanceof HTMLTextAreaElement||i.ctrlKey||i.shiftKey||i.altKey||i.metaKey||!n.current||!t)return;let a=n.current;if("Space"===i.code||"Enter"===i.code){i.preventDefault(),a.paused?(await a.play(),w({message:"PLAY",type:"icon"})):(a.pause(),w({message:"PAUSE",type:"icon"}));return}if("Home"===i.code){i.preventDefault(),P(0),w({message:"Beginning"});return}if("End"===i.code){i.preventDefault(),P(a.duration),w({message:"End"});return}if("Escape"===i.code&&h){i.preventDefault(),document.exitFullscreen();return}if(i.code.startsWith("Digit")&&6===i.code.length){i.preventDefault();let e=parseInt(i.code.slice(-1));P(Math.max(0,Math.min(a.duration,a.duration*(10*e)/100)));return}if("Comma"===i.code){i.preventDefault(),_(-1/24),w({message:"Previous Frame"});return}if("Period"===i.code){i.preventDefault(),_(1/24),w({message:"Next Frame"});return}let r=()=>{let e=Date.now();return!(e-j.current<100)&&(j.current=e,!0)};if(i.code===c.seekForward.key){if(i.preventDefault(),!r())return;if(e.introEndTime&&e.introStartTime&&a.currentTime<e.introEndTime&&a.currentTime>=e.introStartTime){P(e.introEndTime),w({message:"Skipped Opening"});return}if(e.endingEndTime&&e.endingStartTime&&a.currentTime<e.endingEndTime&&a.currentTime>=e.endingStartTime){P(e.endingEndTime),w({message:"Skipped Ending"});return}_(c.seekForward.value),a.dispatchEvent(new Event("seeked"))}else if(i.code===c.seekBackward.key){if(i.preventDefault(),!r())return;_(-c.seekBackward.value),a.dispatchEvent(new Event("seeked"))}else if(i.code===c.seekForwardFine.key)i.preventDefault(),a.dispatchEvent(new Event("seeking")),_(c.seekForwardFine.value),a.dispatchEvent(new Event("seeked"));else if(i.code===c.seekBackwardFine.key)i.preventDefault(),a.dispatchEvent(new Event("seeking")),_(-c.seekBackwardFine.value),a.dispatchEvent(new Event("seeked"));else if(i.code===c.nextChapter.key)i.preventDefault(),D();else if(i.code===c.previousChapter.key)i.preventDefault(),M();else if(i.code===c.volumeUp.key)i.preventDefault(),g(Math.min(1,f+c.volumeUp.value/100));else if(i.code===c.volumeDown.key)i.preventDefault(),g(Math.max(0,f-c.volumeDown.value/100));else if(i.code===c.mute.key)i.preventDefault(),x(!y);else if(i.code===c.cycleSubtitles.key)i.preventDefault(),R();else if(i.code===c.cycleAudio.key)i.preventDefault(),A();else if(i.code===c.nextEpisode.key)i.preventDefault(),U();else if(i.code===c.previousEpisode.key)i.preventDefault(),V();else if(i.code===c.fullscreen.key)i.preventDefault(),K();else if(i.code===c.pictureInPicture.key)i.preventDefault(),B();else if(i.code===c.increaseSpeed.key){i.preventDefault();let e=Math.min(8,a.playbackRate+c.increaseSpeed.value);a.playbackRate=e,w({message:"Speed: ".concat(e.toFixed(2),"x")})}else if(i.code===c.decreaseSpeed.key){i.preventDefault();let e=Math.max(.2,a.playbackRate-c.decreaseSpeed.value);a.playbackRate=e,w({message:"Speed: ".concat(e.toFixed(2),"x")})}else i.code===c.takeScreenshot.key&&(i.preventDefault(),N())},[c,f,y,_,t,h,p,w,r,l,u]),D=(0,m.useCallback)(()=>{if(!n.current||!i)return;let e=n.current.currentTime,t=[...i].sort((e,t)=>e.startTime-t.startTime),a=t.find(t=>t.startTime>e+1);if(a){P(a.startTime);let e=a.text;w({message:e?"Chapter: ".concat(e):"Chapter ".concat(t.indexOf(a)+1)})}else{let e=t[t.length-1];e&&e.endTime&&(P(e.endTime),w({message:"End of chapters"}))}},[i,P,w]),M=(0,m.useCallback)(()=>{if(!n.current||!i)return;let e=n.current.currentTime,t=[...i].sort((e,t)=>e.startTime-t.startTime),a=t.findIndex((n,i)=>{let a=t[i+1];return n.startTime<=e&&(!a||e<a.startTime)});if(a>0){let e=t[a-1];P(e.startTime);let n=e.text;w({message:n?"Chapter: ".concat(n):"Chapter ".concat(a)})}else if(0===a){P(0);let e=t[0].text;w({message:e?"Chapter: ".concat(e):"Chapter 1"})}else P(0),w({message:"Beginning"})},[i,P,w]),R=(0,m.useCallback)(()=>{if(!n.current)return;let e=Array.from(n.current.textTracks).filter(e=>"subtitles"===e.kind);if(0===e.length)return void w({message:"No subtitle tracks"});let t=-1;for(let n=0;n<e.length;n++)if("showing"===e[n].mode){t=n;break}let i=t+1;for(let t=0;t<e.length;t++)e[t].mode="disabled";if(i<e.length){e[i].mode="showing",null==S||S.selectTrack(Number(e[i].id));let t=e[i].label||"Track ".concat(i+1);w({message:"Subtitles: ".concat(t)})}else null==S||S.setNoTrack(),w({message:"Subtitles: Off"})},[S]),A=(0,m.useCallback)(()=>{if(!n.current)return;let e=n.current.audioTracks;if(!e||e.length<=1)return void w({message:"No additional audio tracks"});let t=-1;for(let n=0;n<e.length;n++)if(e[n].enabled){t=n;break}let i=(t+1)%e.length;for(let t=0;t<e.length;t++)e[t].enabled=!1;e[i].enabled=!0,null==T||T.selectTrack(i);let a=e[i].label||e[i].language||"Track ".concat(i+1);w({message:"Audio: ".concat(a)})},[]),O=(0,b.v)("VideoCoreKeybindings"),U=(0,m.useCallback)(()=>{O.info("Next episode shortcut pressed - not implemented yet")},[]),V=(0,m.useCallback)(()=>{O.info("Previous episode shortcut pressed - not implemented yet")},[]),K=(0,m.useCallback)(()=>{null==C||C.toggleFullscreen(),m.startTransition(()=>{setTimeout(()=>{var e;null==(e=n.current)||e.focus()},100)})},[C]),B=(0,m.useCallback)(()=>{m.startTransition(()=>{setTimeout(()=>{var e;null==(e=n.current)||e.focus()},100)})},[p]);return(0,m.useEffect)(()=>{if(t)return document.addEventListener("keydown",F),()=>{document.removeEventListener("keydown",F)}},[F,t]),(0,m.useEffect)(()=>{if(!t)return;let e=()=>{setTimeout(()=>{document.fullscreenElement&&n.current&&n.current.focus()},100)};return document.addEventListener("fullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e)}},[t]),null}function q(e){return e.stopPropagation()}function $(e){return e.stopPropagation()}var Y=n(75435),J=n(97400),Q=n(78453),Z=n(43994);let ee=(0,c.eU)(null),et=(0,c.eU)(null);function en(e){let t,n,r,l,s,o,c=(0,a.c)(18),{trigger:u,children:h,name:p}=e,[f,v]=(0,d.fp)(ee),[,g]=(0,d.fp)(et),b=(0,d.md)(t0),y=(0,d.md)(nn),x=(0,m.useRef)(null);c[0]!==f||c[1]!==g?(t=()=>(f||(x.current=setTimeout(()=>{g(null)},300)),()=>{x.current&&clearTimeout(x.current)}),c[0]=f,c[1]=g,c[2]=t):t=c[2],c[3]!==f?(n=[f],c[3]=f,c[4]=n):n=c[4],m.useEffect(t,n);let k=f===p;c[5]!==p||c[6]!==v?(r=e=>{v(e?p:null)},c[5]=p,c[6]=v,c[7]=r):r=c[7],c[8]!==u?(l=(0,i.jsx)("div",{children:u}),c[8]=u,c[9]=l):l=c[9];let w=b&&y||void 0;return c[10]!==h?(s=(0,i.jsx)("div",{className:"h-auto",children:h}),c[10]=h,c[11]=s):s=c[11],c[12]!==k||c[13]!==r||c[14]!==l||c[15]!==w||c[16]!==s?(o=(0,i.jsx)(Y.A,{open:k,onOpenChange:r,trigger:l,sideOffset:4,align:"center",modal:!1,className:"bg-black/85 rounded-xl p-3 backdrop-blur-sm w-[20rem] z-[100]",portalContainer:w,children:s}),c[12]=k,c[13]=r,c[14]=l,c[15]=w,c[16]=s,c[17]=o):o=c[17],o}function ei(e){let t,n,r,l=(0,a.c)(6);return l[0]!==e?({children:t,...n}=e,l[0]=e,l[1]=t,l[2]=n):(t=l[1],n=l[2]),l[3]!==t||l[4]!==n?(r=(0,i.jsx)("div",{className:"text-white/70 font-bold text-sm pb-3 text-center border-b mb-3",...n,children:t}),l[3]=t,l[4]=n,l[5]=r):r=l[5],r}function ea(e){let t,n,r=(0,a.c)(5),{children:l}=e,[s]=(0,d.fp)(et);return r[0]!==l||r[1]!==s?(t=!s&&(0,i.jsx)(u.P.div,{className:"h-auto",initial:{opacity:0,scale:1,x:-10},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:1,x:-10},transition:{duration:.15},children:l},"section-body"),r[0]=l,r[1]=s,r[2]=t):t=r[2],r[3]!==t?(n=(0,i.jsx)("div",{className:"vc-menu-section-body",children:t}),r[3]=t,r[4]=n):n=r[4],n}function er(e){let t,n=(0,a.c)(2),{children:r}=e;return n[0]!==r?(t=(0,i.jsx)("div",{className:"max-h-[18rem] overflow-y-auto",children:r}),n[0]=r,n[1]=t):t=n[1],t}function el(e){let t,n,r=(0,a.c)(5),{children:l}=e,[s]=(0,d.fp)(et);return r[0]!==l||r[1]!==s?(t=s&&(0,i.jsx)(u.P.div,{className:"h-auto",initial:{opacity:0,scale:1,x:10},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:1,x:10},transition:{duration:.15},children:l},"section-body"),r[0]=l,r[1]=s,r[2]=t):t=r[2],r[3]!==t?(n=(0,i.jsx)("div",{className:"vc-menu-submenu-body",children:t}),r[3]=t,r[4]=n):n=r[4],n}function es(e){let t,n,r,l,s=(0,a.c)(18),{children:o,title:c,icon:u,onClick:m,value:h}=e,[p,f]=(0,d.fp)(et);s[0]!==m||s[1]!==f||s[2]!==c?(t=function(){if(m)return void m();f(c)},s[0]=m,s[1]=f,s[2]=c,s[3]=t):t=s[3];let v=t;return s[4]!==u||s[5]!==v||s[6]!==p||s[7]!==c||s[8]!==h?(n=!p&&(0,i.jsxs)("button",{role:"button",className:"w-full p-2 h-10 flex items-center justify-between rounded-lg group/vc-menu-option hover:bg-white/10 active:bg-white/20 transition-colors",onClick:v,children:[(0,i.jsx)("span",{className:"w-8 flex justify-start items-center h-full",children:(0,i.jsx)(u,{className:"text-xl"})}),(0,i.jsx)("span",{className:"w-full flex flex-1 text-sm font-medium",children:c}),h&&(0,i.jsx)("span",{className:"text-sm font-medium tracking-wide text-[--muted] mr-2",children:h}),(0,i.jsx)(Z.xCi,{className:"text-lg"})]}),s[4]=u,s[5]=v,s[6]=p,s[7]=c,s[8]=h,s[9]=n):n=s[9],s[10]!==o||s[11]!==p||s[12]!==f||s[13]!==c?(r=p===c&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("button",{role:"button",className:"w-full pb-2 h-10 mb-2 flex items-center justify-between rounded-lg transition-colors border-b",onClick:()=>f(null),children:[(0,i.jsx)("span",{className:"w-8 flex justify-start items-center h-full",children:(0,i.jsx)(Z.i84,{className:"text-lg"})}),(0,i.jsx)("span",{className:"w-full flex flex-1 text-sm font-medium",children:c})]}),(0,i.jsx)(er,{children:o})]},c),s[10]=o,s[11]=p,s[12]=f,s[13]=c,s[14]=r):r=s[14],s[15]!==n||s[16]!==r?(l=(0,i.jsxs)(i.Fragment,{children:[n,r]}),s[15]=n,s[16]=r,s[17]=l):l=s[17],l}function eo(e){let t,n,r=(0,a.c)(13),{options:l,value:s,onValueChange:o,isFullscreen:c,containerElement:d}=e;if(r[0]!==d||r[1]!==c||r[2]!==o||r[3]!==l||r[4]!==s){let e;r[6]!==d||r[7]!==c||r[8]!==o||r[9]!==s?(e=e=>(0,i.jsxs)("div",{role:"button",className:"w-full p-2 flex items-center justify-between rounded-lg group/vc-menu-option hover:bg-white/10 active:bg-white/20 transition-colors",onClick:()=>{o(e.value)},children:[(0,i.jsx)("span",{className:"w-8 flex justify-start items-center h-full flex-none",children:s===e.value&&(0,i.jsx)(Z.sk9,{className:"text-lg"})}),(0,i.jsx)("span",{className:"w-full flex flex-1 text-sm font-medium line-clamp-2",children:e.label}),(e.moreInfo||e.description)&&(0,i.jsxs)("div",{className:"w-fit flex-none ml-2 flex gap-2 items-center",children:[e.moreInfo&&(0,i.jsx)("span",{className:"text-xs font-medium tracking-wide text-[--muted]",children:e.moreInfo}),e.description&&(0,i.jsx)(J.m_,{trigger:(0,i.jsx)(Q.app,{className:"text-sm"}),portalContainer:c&&d||void 0,className:"z-[150]",children:e.description})]})]},e.value),r[6]=d,r[7]=c,r[8]=o,r[9]=s,r[10]=e):e=r[10],t=l.map(e),r[0]=d,r[1]=c,r[2]=o,r[3]=l,r[4]=s,r[5]=t}else t=r[5];return r[11]!==t?(n=(0,i.jsx)("div",{className:"block",children:t}),r[11]=t,r[12]=n):n=r[12],n}let ec=(0,b.v)("VIDEO CORE PIP"),ed=(0,c.eU)(null),eu=(0,c.eU)(null);class em{setVideo(e,t){this.video=e,this.video&&(this.video.addEventListener("play",this.handleMainVideoPlay,{signal:this.controller.signal}),this.video.addEventListener("pause",this.handleMainVideoPause,{signal:this.controller.signal})),this.playbackInfo=t}setSubtitleManager(e){this.subtitleManager=e}togglePip(e){let t=null!==document.pictureInPictureElement;(void 0!==e?e:!t)?this.enterPip():this.exitPip()}exitPip(){document.pictureInPictureElement&&document.exitPictureInPicture().catch(e=>{ec.error("Failed to exit PiP",e)})}async enterPip(){if(document.pictureInPictureElement||!this.video)return void ec.warning("PiP already in use or video not set");try{var e,t;if((null==(t=this.subtitleManager)||null==(e=t.getSelectedTrack)?void 0:e.call(t))===null){ec.info("Entering PiP without subtitles"),await this.video.requestPictureInPicture();return}ec.info("Entering PiP with subtitle burning"),await this.enterPipWithSubtitles()}catch(e){ec.error("Failed to enter PiP",e)}}destroy(){var e;this.exitPip(),null==(e=this.canvasController)||e.abort(),this.controller.abort(),this.video=null,this.subtitleManager=null}newPipVideo(){let e=document.createElement("video");return e.muted=!0,e.addEventListener("enterpictureinpicture",this.handleEnterPip,{signal:this.controller.signal}),e.addEventListener("leavepictureinpicture",this.handleLeavePip,{signal:this.controller.signal}),e}async enterPipWithSubtitles(){var e,t,n,i;if(!this.video||!this.subtitleManager)return;let a=document.createElement("canvas"),r=a.getContext("2d");if(!r)return void ec.error("Failed to get canvas context");let l=this.newPipVideo();l.srcObject=a.captureStream(),l.muted=!0,this.pipProxy=l,a.width=this.video.videoWidth,a.height=this.video.videoHeight,(null==(e=this.subtitleManager)?void 0:e.libassRenderer)&&this.subtitleManager.libassRenderer.resize(this.video.videoWidth,this.video.videoHeight),this.canvasController=new AbortController,l.addEventListener("play",()=>{this.video&&this.video.paused&&(this.isSyncingFromPip=!0,this.video.play().catch(e=>{ec.error("Failed to play main video from PiP overlay",e)}).finally(()=>{this.isSyncingFromPip=!1}))},{signal:this.canvasController.signal}),l.addEventListener("pause",()=>{this.video&&!this.video.paused&&(this.isSyncingFromPip=!0,this.video.pause(),this.isSyncingFromPip=!1)},{signal:this.canvasController.signal});let s={current:0};r.drawImage(this.video,0,0);let o=null==(n=this.subtitleManager)||null==(t=n.libassRenderer)?void 0:t._canvas;o&&a.width&&a.height&&r.drawImage(o,0,0,a.width,a.height),await new Promise((e,t)=>{let n=setTimeout(()=>{t(Error("Timeout waiting for PiP video metadata"))},5e3);l.addEventListener("loadedmetadata",()=>{clearTimeout(n),e()},{once:!0}),l.addEventListener("error",()=>{clearTimeout(n),t(Error("Error loading PiP video metadata"))},{once:!0})}),this.canvasController.signal.addEventListener("abort",()=>{var e;(null==(e=this.subtitleManager)?void 0:e.libassRenderer)&&this.subtitleManager.libassRenderer.resize(),s.current&&this.video&&this.video.cancelVideoFrameCallback(s.current),a.remove(),l.remove(),this.pipProxy=null}),this.controller.signal.addEventListener("abort",()=>{var e;null==(e=this.canvasController)||e.abort()}),l.addEventListener("leavepictureinpicture",()=>{var e;null==(e=this.canvasController)||e.abort()},{signal:this.canvasController.signal});try{this.renderToCanvas(l,r,s)(performance.now());try{await l.play(),this.video.paused&&l.pause()}catch(e){if(e instanceof DOMException&&"AbortError"===e.name);else throw e}let e=await l.requestPictureInPicture();e.addEventListener("resize",()=>{var t,n;let{width:i,height:a}=e;!(isNaN(i)||isNaN(a))&&isFinite(i)&&isFinite(a)&&(null==(n=this.subtitleManager)||null==(t=n.libassRenderer)||t.resize(i,a))},{signal:this.canvasController.signal}),ec.info("Successfully entered PiP")}catch(e){throw ec.error("Failed to enter PiP",e),null==(i=this.canvasController)||i.abort(),e}}constructor(e){this.video=null,this.subtitleManager=null,this.controller=new AbortController,this.canvasController=null,this.pipProxy=null,this.isSyncingFromMain=!1,this.isSyncingFromPip=!1,this.playbackInfo=null,this.handleEnterPip=()=>{let e=document.pictureInPictureElement;ec.info("Entered PiP",e),this.onPipElementChange(e)},this.handleLeavePip=()=>{ec.info("Left PiP"),this.onPipElementChange(null),this.video&&this.video.focus(),this.pipProxy=null},this.renderToCanvas=(e,t,n)=>(i,a)=>{var r,l;if(!this.video||!t)return;void 0!==i&&(this.video.paused&&!e.paused?this.isSyncingFromPip||e.pause():this.video.paused||!e.paused||this.isSyncingFromPip||e.play().catch(()=>{})),t.drawImage(this.video,0,0);let s=null==(l=this.subtitleManager)||null==(r=l.libassRenderer)?void 0:r._canvas;s&&t.canvas.width&&t.canvas.height&&t.drawImage(s,0,0,t.canvas.width,t.canvas.height),n.current=this.video.requestVideoFrameCallback(this.renderToCanvas(e,t,n))},this.handleMainVideoPlay=()=>{!this.isSyncingFromPip&&this.pipProxy&&this.pipProxy.paused&&(this.isSyncingFromMain=!0,this.pipProxy.play().catch(()=>{}),this.isSyncingFromMain=!1)},this.handleMainVideoPause=()=>{this.isSyncingFromPip||this.pipProxy&&!this.pipProxy.paused&&(this.isSyncingFromMain=!0,this.pipProxy.pause(),this.isSyncingFromMain=!1)},this.onPipElementChange=e,document.addEventListener("enterpictureinpicture",this.handleEnterPip,{signal:this.controller.signal}),document.addEventListener("leavepictureinpicture",this.handleLeavePip,{signal:this.controller.signal}),window.addEventListener("visibilitychange",()=>{"visible"!==document.visibilityState&&this.video&&!this.video.paused&&this.togglePip(!0)},{signal:this.controller.signal})}}let eh=(e,t)=>e&&0!==e.length&&0!==t?ep(e.map((n,i)=>{var a;return{startTime:n.start/1e6,endTime:n.end?n.end/1e6:(null==(a=e[i+1])?void 0:a.start)?e[i+1].start/1e6:t,text:n.text||""}})):[],ep=e=>{if(!e||0===e.length)return[];let t=[...e].sort((e,t)=>{var n,i;return(null!=(n=e.startTime)?n:0)-(null!=(i=t.startTime)?i:0)}),n=[];for(let e=0;e<t.length;e++){var i,a,r,l;let s=t[e],o=t[e+1],c=null!=(i=s.startTime)?i:0,d="number"==typeof s.endTime?s.endTime:o&&null!=(a=o.startTime)?a:c;d<c&&(d=c),0===e&&c>1e-6&&n.push({startTime:0,endTime:c,text:""});let u=n[n.length-1];if(u){let e=null!=(r=u.endTime)?r:u.startTime;c>(null!=e?e:0)+1e-6&&n.push({startTime:null!=e?e:0,endTime:c,text:""})}n.push({startTime:c,endTime:d,text:null!=(l=s.text)?l:""})}return n};function ef(e){return!!e&&(/opening$|^opening\s|^op$/mi.test(e)?"Opening":/ending$|^ending\s|^ed$|^credits/mi.test(e)?"Ending":/^intro$|recap/mi.test(e)?"Intro":!!/^outro$/mi.test(e)&&"Outro")}let ev=e=>{let t=e<0?"-":"",n=Math.abs(e),i=Math.floor(n/3600),a=Math.floor(n%3600/60),r=Math.floor(n%60);return i>0?"".concat(t).concat(i,":").concat(a.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0")):"".concat(t).concat(a,":").concat(r.toString().padStart(2,"0"))},eg=e=>{if(!e)return;console.log("HEVC main ->",e.canPlayType('video/mp4;codecs="hev1.1.6.L120.90"')||"❌"),console.log("HEVC main 10 ->",e.canPlayType('video/mp4;codecs="hev1.2.4.L120.90"')||"❌"),console.log("HEVC main still-picture ->",e.canPlayType('video/mp4;codecs="hev1.3.E.L120.90"')||"❌"),console.log("HEVC range extensions ->",e.canPlayType('video/mp4;codecs="hev1.4.10.L120.90"')||"❌"),console.log("Dolby AC3 ->",e.canPlayType('audio/mp4; codecs="ac-3"')||"❌"),console.log("Dolby EC3 ->",e.canPlayType('audio/mp4; codecs="ec-3"')||"❌");let t=document.createElement("canvas"),n=t.getContext("webgl2")||t.getContext("webgl");if(n){let e=n.getExtension("WEBGL_debug_renderer_info");e&&(console.log("GPU Vendor ->",n.getParameter(e.UNMASKED_VENDOR_WEBGL)),console.log("GPU Renderer ->",n.getParameter(e.UNMASKED_RENDERER_WEBGL)))}console.log("Hardware concurrency ->",navigator.hardwareConcurrency),console.log("User agent ->",navigator.userAgent),navigator.gpu?navigator.gpu.requestAdapter().then(e=>{e?(console.log("WebGPU adapter ->",e),console.log("WebGPU adapter features ->",e.features)):console.log("⚠️ No WebGPU adapter found.")}):console.log("❌ WebGPU not supported.")};var eb=n(60695),ey=n(43826),ex=n(73594),ek=n(38628),ew=n(41452),eE=n(40568),eS=n(46753),eT=n(80893);let eC=(0,c.eU)(!1);function ej(e){let t,n,r,l,s,c,u,h,p,f,v,g,b,y,x,k,w,E,S,T=(0,a.c)(53),{children:C,timeRange:j}=e,_=(0,d.md)(t8),P=(0,d.md)(t7),N=(0,d.md)(t9),[F,I]=(0,d.fp)(eC),D=(0,d.md)(nn),L=(0,d.md)(t2),M=P?28:48,[R,A]=m.useState("outside"),O=!_&&"approaching"===R||_&&"outside"===R||_&&"approaching"===R,U=N||F?0:O?-M:"hover"===R?0:-300,z=P?!_:"hover"!==R&&!N,V=!O&&!N&&!F;T[0]!==D||T[1]!==P?(t=function(e){if(!D)return void A("outside");let t=D.getBoundingClientRect(),n=e instanceof PointerEvent?e.clientY-t.top:0,i=P?100:150;n>=t.height-i&&n<t.height-i+50?A("approaching"):n<t.height-i?A("outside"):A("hover")},T[0]=D,T[1]=P,T[2]=t):t=T[2];let K=t;T[3]===Symbol.for("react.memo_cache_sentinel")?(n=function(e){A("outside")},T[3]=n):n=T[3];let B=n;T[4]!==D||T[5]!==K?(r=()=>{if(D)return D.addEventListener("pointermove",K),D.addEventListener("pointerleave",B),D.addEventListener("pointercancel",B),()=>{D.removeEventListener("pointermove",K),D.removeEventListener("pointerup",B),D.removeEventListener("pointercancel",B)}},T[4]=D,T[5]=K,T[6]=r):r=T[6],T[7]!==D||T[8]!==F||T[9]!==P||T[10]!==_||T[11]!==L?(l=[D,_,P,L,F],T[7]=D,T[8]=F,T[9]=P,T[10]=_,T[11]=L,T[12]=l):l=T[12],m.useEffect(r,l);let X=P?"from-black/80 via-black/40":"from-black/40",W=P&&"h-20",G=!z&&"opacity-100";T[13]!==X||T[14]!==W||T[15]!==G?(s=(0,o.cn)("vc-control-bar-bottom-gradient pointer-events-none","absolute bottom-0 left-0 right-0 w-full z-[5] h-28 transition-opacity duration-300 opacity-0","bg-gradient-to-t to-transparent",X,W,G),T[13]=X,T[14]=W,T[15]=G,T[16]=s):s=T[16],T[17]!==s?(c=(0,i.jsx)("div",{className:s}),T[17]=s,T[18]=c):c=T[18],T[19]!==z||T[20]!==P||T[21]!==_||T[22]!==O?(u=!P&&(0,i.jsx)("div",{className:(0,o.cn)("vc-control-bar-bottom-gradient-time-range-only pointer-events-none","absolute bottom-0 left-0 right-0 w-full z-[5] h-14 transition-opacity duration-400 opacity-0","bg-gradient-to-t to-transparent",P?"from-black/60":"from-black/40",P&&"h-10",O&&_&&z&&"opacity-100")}),T[19]=z,T[20]=P,T[21]=_,T[22]=O,T[23]=u):u=T[23];let H=!V&&"opacity-100";T[24]!==H?(h=(0,o.cn)("vc-control-bar-section","absolute left-0 bottom-0 right-0 flex flex-col text-white","transition-all duration-300 opacity-0","z-[100] h-28",H,tX&&"bg-purple-500/20"),T[24]=H,T[25]=h):h=T[25];let q="".concat(U,"px");T[26]!==q?(p={bottom:q},T[26]=q,T[27]=p):p=T[27],T[28]!==I?(f=()=>{I(!0)},v=()=>{I(!1)},g=()=>{I(!1)},T[28]=I,T[29]=f,T[30]=v,T[31]=g):(f=T[29],v=T[30],g=T[31]),T[32]===Symbol.for("react.memo_cache_sentinel")?(b=(0,o.cn)("vc-control-bar","absolute bottom-0 w-full px-4",tX&&"bg-purple-800/40"),T[32]=b):b=T[32],T[33]===Symbol.for("react.memo_cache_sentinel")?(y=(0,o.cn)("vc-control-bar-main-section","transform-gpu duration-100 flex items-center pb-2"),T[33]=y):y=T[33];let $="".concat(M,"px");T[34]!==$?(x={height:$},T[34]=$,T[35]=x):x=T[35];let Y=x;return T[36]!==C||T[37]!==Y?(k=(0,i.jsx)("div",{className:y,style:Y,children:C}),T[36]=C,T[37]=Y,T[38]=k):k=T[38],T[39]!==k||T[40]!==j?(w=(0,i.jsxs)("div",{className:b,children:[j,k]}),T[39]=k,T[40]=j,T[41]=w):w=T[41],T[42]!==h||T[43]!==p||T[44]!==f||T[45]!==v||T[46]!==g||T[47]!==w?(E=(0,i.jsx)("div",{"data-vc-control-bar-section":!0,className:h,style:p,onPointerEnter:f,onPointerLeave:v,onPointerCancel:g,children:w}),T[42]=h,T[43]=p,T[44]=f,T[45]=v,T[46]=g,T[47]=w,T[48]=E):E=T[48],T[49]!==E||T[50]!==c||T[51]!==u?(S=(0,i.jsxs)(i.Fragment,{children:[c,u,E]}),T[49]=E,T[50]=c,T[51]=u,T[52]=S):S=T[52],S}function e_(e){let t,n,r,l,s,c=(0,a.c)(17),{icons:m,state:h,className:p,iconClass:f,onClick:v}=e,g=(0,d.md)(t7);c[0]===Symbol.for("react.memo_cache_sentinel")?(t={},c[0]=t):t=c[0];let b=g&&"text-2xl";if(c[1]!==p||c[2]!==b?(n=(0,o.cn)("vc-control-button flex items-center justify-center px-2 transition-opacity hover:opacity-80 relative h-full","text-3xl",b,p),c[1]=p,c[2]=b,c[3]=n):n=c[3],c[4]!==f||c[5]!==m||c[6]!==h){let e;c[8]!==f||c[9]!==h?(e=e=>{let[t,n]=e;return h!==t?null:(0,i.jsx)(u.P.span,{className:"block",initial:{opacity:0,y:10,position:"relative"},animate:{opacity:1,y:0,position:"relative"},exit:{opacity:0,y:10,position:"absolute"},transition:{duration:.15},children:(0,i.jsx)(n,{className:(0,o.cn)("vc-control-button-icon",f)})},t)},c[8]=f,c[9]=h,c[10]=e):e=c[10],r=m.map(e),c[4]=f,c[5]=m,c[6]=h,c[7]=r}else r=c[7];return c[11]!==r?(l=(0,i.jsx)(ey.N,{children:r}),c[11]=r,c[12]=l):l=c[12],c[13]!==v||c[14]!==n||c[15]!==l?(s=(0,i.jsx)("button",{role:"button",style:t,className:n,onClick:v,children:l}),c[13]=v,c[14]=n,c[15]=l,c[16]=s):s=c[16],s}function eP(){let e,t,n,r=(0,a.c)(6),l=(0,d.md)(t8),s=(0,d.Xr)(nu);r[0]===Symbol.for("react.memo_cache_sentinel")?(e=[["playing",eE.d5L],["paused",eE.djq]],r[0]=e):e=r[0];let o=l?"paused":"playing";return r[1]!==s?(t=()=>{s({type:"togglePlay"})},r[1]=s,r[2]=t):t=r[2],r[3]!==o||r[4]!==t?(n=(0,i.jsx)(e_,{icons:e,state:o,onClick:t}),r[3]=o,r[4]=t,r[5]=n):n=r[5],n}function eN(){let e,t,n,r,l,s,c,u,h,p,f,v,g,b,y,x,k,w,E=(0,a.c)(37),S=(0,d.md)(tZ),T=(0,d.md)(tQ),C=(0,d.Xr)(L.bM),j=(0,d.Xr)(L.cW),_=(0,d.md)(t7),[P,N]=m.useState(!1);E[0]===Symbol.for("react.memo_cache_sentinel")?(e=function(e){return Math.pow(e,2)},E[0]=e):e=E[0];let F=e;E[1]===Symbol.for("react.memo_cache_sentinel")?(t=function(e){e.stopPropagation(),e.currentTarget.setPointerCapture(e.pointerId),N(!0)},E[1]=t):t=E[1];let I=t;E[2]!==j||E[3]!==C?(n=function(e){let t=e.currentTarget.getBoundingClientRect(),n=F(Math.max(0,Math.min(1,(e.clientX-t.left)/e.currentTarget.clientWidth)));C(n),j(0===n)},E[2]=j,E[3]=C,E[4]=n):n=E[4];let D=n;E[5]!==D||E[6]!==P?(r=function(e){P&&(e.stopPropagation(),e.currentTarget.setPointerCapture(e.pointerId),N(!1),D(e))},E[5]=D,E[6]=P,E[7]=r):r=E[7];let M=r;E[8]!==D||E[9]!==P?(l=function(e){P&&(e.stopPropagation(),D(e))},E[8]=D,E[9]=P,E[10]=l):l=E[10];let R=l;E[11]===Symbol.for("react.memo_cache_sentinel")?(s=(0,o.cn)("vc-control-volume group/vc-control-volume","flex items-center justify-center h-full gap-2"),E[11]=s):s=E[11],E[12]===Symbol.for("react.memo_cache_sentinel")?(c=[["low",Z.m8L],["mid",Z.l$p],["high",Z.exc],["muted",Z.fLJ]],E[12]=c):c=E[12];let A=T?"muted":S>=.5?"high":S>.1?"mid":"low",O=_?"text-[1.3rem]":"text-2xl";E[13]!==j||E[14]!==C||E[15]!==S?(u=()=>{j(e=>(e&&0===S&&C(.1),!e))},E[13]=j,E[14]=C,E[15]=S,E[16]=u):u=E[16],E[17]!==A||E[18]!==O||E[19]!==u?(h=(0,i.jsx)(e_,{icons:c,state:A,className:O,onClick:u}),E[17]=A,E[18]=O,E[19]=u,E[20]=h):h=E[20],E[21]===Symbol.for("react.memo_cache_sentinel")?(p=(0,o.cn)("vc-control-volume-slider-container relative w-0 flex group-hover/vc-control-volume:w-[6rem] h-6","transition-[width] duration-300"),f=(0,o.cn)("vc-control-volume-slider","flex h-full w-full relative items-center","rounded-full","cursor-pointer","transition-all duration-300"),E[21]=p,E[22]=f):(p=E[21],f=E[22]),E[23]===Symbol.for("react.memo_cache_sentinel")?(v=(0,o.cn)("vc-control-volume-slider-progress h-1.5","absolute bg-white","rounded-full"),E[23]=v):v=E[23];let U="".concat(100*Math.pow(S,.5),"%");return E[24]!==U?(g=(0,i.jsx)("div",{className:v,style:{width:U}}),E[24]=U,E[25]=g):g=E[25],E[26]===Symbol.for("react.memo_cache_sentinel")?(b=(0,i.jsx)("div",{className:(0,o.cn)("vc-control-volume-slider-progress h-1.5 w-full","absolute bg-white/20","rounded-full")}),E[26]=b):b=E[26],E[27]!==R||E[28]!==M||E[29]!==g?(y=(0,i.jsxs)("div",{className:f,onPointerDown:I,onPointerMove:R,onPointerUp:M,onPointerCancel:M,children:[g,b]}),E[27]=R,E[28]=M,E[29]=g,E[30]=y):y=E[30],E[31]===Symbol.for("react.memo_cache_sentinel")?(x=(0,i.jsx)("div",{className:"w-4"}),E[31]=x):x=E[31],E[32]!==y?(k=(0,i.jsxs)("div",{className:p,children:[y,x]}),E[32]=y,E[33]=k):k=E[33],E[34]!==h||E[35]!==k?(w=(0,i.jsxs)("div",{className:s,children:[h,k]}),E[34]=h,E[35]=k,E[36]=w):w=E[36],w}function eF(e){let t,n,r=(0,a.c)(3),{onClick:l}=e;return(0,d.md)(t7)?null:(r[0]===Symbol.for("react.memo_cache_sentinel")?(t=[["default",Z.xCi]],r[0]=t):t=r[0],r[1]!==l?(n=(0,i.jsx)(e_,{icons:t,state:"default",onClick:l}),r[1]=l,r[2]=n):n=r[2],n)}function eI(e){let t,n,r=(0,a.c)(3),{onClick:l}=e;return(0,d.md)(t7)?null:(r[0]===Symbol.for("react.memo_cache_sentinel")?(t=[["default",Z.i84]],r[0]=t):t=r[0],r[1]!==l?(n=(0,i.jsx)(e_,{icons:t,state:"default",onClick:l}),r[1]=l,r[2]=n):n=r[2],n)}let eD=(0,y.tG)("sea-video-core-timestamp-type","elapsed",void 0,{getOnInit:!0});function eL(){let e,t,n,r,l=(0,a.c)(11),s=(0,d.md)(tH),o=(0,d.md)(tq),[c,u]=(0,d.fp)(eD);l[0]!==u?(e=function(){u(eM)},l[0]=u,l[1]=e):e=l[1];let m=e;if(s<=1||isNaN(s))return null;let h="remaining"===c?"-":"",p=Math.max(0,Math.min(s,"elapsed"===c?o:s-o));return l[2]!==p?(t=ev(p),l[2]=p,l[3]=t):t=l[3],l[4]!==s?(n=ev(s),l[4]=s,l[5]=n):n=l[5],l[6]!==m||l[7]!==h||l[8]!==t||l[9]!==n?(r=(0,i.jsxs)("p",{className:"font-medium text-sm opacity-100 hover:opacity-80 cursor-pointer",onClick:m,children:[h,t," / ",n]}),l[6]=m,l[7]=h,l[8]=t,l[9]=n,l[10]=r):r=l[10],r}function eM(e){return"elapsed"===e?"remaining":"elapsed"}function eR(){var e,t;let n,r,l,s,o,c,u,h,p,f,v=(0,a.c)(24),g=(0,d.Xr)(nu),b=(0,d.md)(t7),y=(0,d.md)(N.k),x=(0,d.md)(na),k=(0,d.md)(nt),[w,E]=m.useState(null),S=null==(t=y.playbackInfo)||null==(e=t.mkvMetadata)?void 0:e.audioTracks;v[0]!==x?(n=function(){var e,t;E(null!=(t=null==x||null==(e=x.getSelectedTrack)?void 0:e.call(x))?t:null)},v[0]=x,v[1]=n):n=v[1];let T=n;if(v[2]!==x||v[3]!==T||v[4]!==k?(r=()=>{var e,t;if(k&&x)return null==k||null==(t=k.audioTracks)||null==(e=t.addEventListener)||e.call(t,"change",T),()=>{var e,t;null==k||null==(t=k.audioTracks)||null==(e=t.removeEventListener)||e.call(t,"change",T)}},v[2]=x,v[3]=T,v[4]=k,v[5]=r):r=v[5],v[6]!==x||v[7]!==k?(l=[k,x],v[6]=x,v[7]=k,v[8]=l):l=v[8],m.useEffect(r,l),v[9]!==T?(s=()=>{T()},v[9]=T,v[10]=s):s=v[10],v[11]!==x?(o=[x],v[11]=x,v[12]=o):o=v[12],m.useEffect(s,o),b||!(null==S?void 0:S.length)||1===S.length)return null;v[13]===Symbol.for("react.memo_cache_sentinel")?(c=(0,i.jsx)(e_,{icons:[["default",Z.XhC]],state:"default",className:"text-2xl",onClick:eO}),u=(0,i.jsx)(ei,{children:"Audio"}),v[13]=c,v[14]=u):(c=v[13],u=v[14]),v[15]!==S?(h=S.map(eA),v[15]=S,v[16]=h):h=v[16],v[17]!==g||v[18]!==x?(p=e=>{null==x||x.selectTrack(e),g({type:"seek",payload:{time:-1}})},v[17]=g,v[18]=x,v[19]=p):p=v[19];let C=w||0;return v[20]!==h||v[21]!==p||v[22]!==C?(f=(0,i.jsxs)(en,{name:"audio",trigger:c,children:[u,(0,i.jsx)(er,{children:(0,i.jsx)(eo,{options:h,onValueChange:p,value:C})})]}),v[20]=h,v[21]=p,v[22]=C,v[23]=f):f=v[23],f}function eA(e){var t,n,i;return{label:"".concat(e.name||(null==(t=e.language)?void 0:t.toUpperCase())||(null==(n=e.languageIETF)?void 0:n.toUpperCase())),value:e.number,moreInfo:null==(i=e.language)?void 0:i.toUpperCase()}}function eO(){}function eU(){var e,t;let n,r,l,s,o,c,u,h,p,f,v=(0,a.c)(23);(0,d.Xr)(nu);let g=(0,d.md)(t7),b=(0,d.md)(N.k),y=(0,d.md)(ni),x=(0,d.md)(nt),[k,w]=m.useState(null),E=null==(t=b.playbackInfo)||null==(e=t.mkvMetadata)?void 0:e.subtitleTracks;v[0]!==y?(n=function(){var e,t;w(null!=(t=null==y||null==(e=y.getSelectedTrack)?void 0:e.call(y))?t:null)},v[0]=y,v[1]=n):n=v[1];let S=n;if(v[2]!==S||v[3]!==y||v[4]!==x?(r=()=>{var e,t;if(x&&y)return null==x||null==(t=x.textTracks)||null==(e=t.addEventListener)||e.call(t,"change",S),()=>{var e,t;null==x||null==(t=x.textTracks)||null==(e=t.removeEventListener)||e.call(t,"change",S)}},v[2]=S,v[3]=y,v[4]=x,v[5]=r):r=v[5],v[6]!==y||v[7]!==x?(l=[x,y],v[6]=y,v[7]=x,v[8]=l):l=v[8],m.useEffect(r,l),v[9]!==S?(s=()=>{S()},v[9]=S,v[10]=s):s=v[10],v[11]!==y?(o=[y],v[11]=y,v[12]=o):o=v[12],m.useEffect(s,o),g||!(null==E?void 0:E.length))return null;v[13]===Symbol.for("react.memo_cache_sentinel")?(c=(0,i.jsx)(e_,{icons:[["default",Z.Fqr]],state:"default",onClick:eV}),u=(0,i.jsx)(ei,{children:"Subtitles"}),v[13]=c,v[14]=u):(c=v[13],u=v[14]),v[15]!==E?(h=E.map(ez),v[15]=E,v[16]=h):h=v[16],v[17]!==y?(p=e=>{null==y||y.selectTrack(e)},v[17]=y,v[18]=p):p=v[18];let T=k||0;return v[19]!==h||v[20]!==p||v[21]!==T?(f=(0,i.jsxs)(en,{name:"subtitle",trigger:c,children:[u,(0,i.jsx)(er,{children:(0,i.jsx)(eo,{options:h,onValueChange:p,value:T})})]}),v[19]=h,v[20]=p,v[21]=T,v[22]=f):f=v[22],f}function ez(e){var t,n;return{label:"".concat(e.name||(null==(t=e.language)?void 0:t.toUpperCase())||(null==(n=e.languageIETF)?void 0:n.toUpperCase())),value:e.number,moreInfo:e.language?"".concat(e.language.toUpperCase()).concat(e.codecID?"/"+function(e){switch(e){case"S_TEXT/ASS":return"ASS";case"S_TEXT/SSA":return"SSA";case"S_TEXT/UTF8":return"TEXT";case"S_HDMV/PGS":return"PGS"}return"unknown"}(e.codecID):""):void 0}}function eV(){}function eK(){let e,t,n,r,l,s,o,c,u,h,p,f,v,g,b,y,x,w,T,C,j,_,P,N,F,I,D,M,R,A,O,U,V,K,B,X=(0,a.c)(85);(0,d.Xr)(nu);let W=(0,d.md)(t7),G=(0,d.md)(t$),H=(0,d.Xr)(L.Gn),[q,$]=(0,d.fp)(k);X[0]!==q?(e=S(q),X[0]=q,X[1]=e):e=X[1];let Y=e,[,J]=(0,d.fp)(z),[Q,er]=(0,d.fp)(L.RR),[ec,ed]=(0,d.fp)(L.y2),[eu,em]=(0,d.fp)(L.gI),[eh,ep]=(0,d.fp)(L.O_),[ef,ev]=(0,d.fp)(L.e4),[eg,ey]=(0,d.fp)(L.kF),[,eE]=(0,d.fp)(ee),[,eS]=(0,d.fp)(et);if(W)return null;X[2]!==G||X[3]!==eE||X[4]!==eS?(t=1!==G&&(0,i.jsx)("p",{className:"text-sm text-[--muted] cursor-pointer",onClick:()=>{eE("settings"),m.startTransition(()=>{eS("Playback Speed")})},children:"".concat(G.toFixed(2),"x")}),X[2]=G,X[3]=eE,X[4]=eS,X[5]=t):t=X[5],X[6]===Symbol.for("react.memo_cache_sentinel")?(n=(0,i.jsx)(e_,{icons:[["default",Z.ucQ]],state:"default",onClick:eX}),X[6]=n):n=X[6],X[7]===Symbol.for("react.memo_cache_sentinel")?(r=(0,i.jsx)(ei,{children:"Settings"}),X[7]=r):r=X[7];let eC="".concat(G.toFixed(2),"x");X[8]!==eC?(l=(0,i.jsx)(es,{title:"Playback Speed",icon:ew.BJM,value:eC}),X[8]=eC,X[9]=l):l=X[9];let ej=ef?"On":"Off";X[10]!==ej?(s=(0,i.jsx)(es,{title:"Auto Play",icon:ek.Rcw,value:ej}),X[10]=ej,X[11]=s):s=X[11];let eP=eh?"On":"Off";X[12]!==eP?(o=(0,i.jsx)(es,{title:"Auto Next",icon:ex.JgS,value:eP}),X[12]=eP,X[13]=o):o=X[13];let eN=eg?"On":"Off";X[14]!==eN?(c=(0,i.jsx)(es,{title:"Skip OP/ED",icon:eT.ySo,value:eN}),X[14]=eN,X[15]=c):c=X[15];let eF=(null==Y?void 0:Y.label)||"Off";X[16]!==eF?(u=(0,i.jsx)(es,{title:"Anime4K",icon:Z.rPP,value:eF}),X[16]=eF,X[17]=u):u=X[17],X[18]===Symbol.for("react.memo_cache_sentinel")?(h=(0,i.jsx)(es,{title:"Appearance",icon:Z.WdH}),X[18]=h):h=X[18],X[19]!==J?(p=(0,i.jsx)(es,{title:"Keybinds & Defaults",icon:Z.xjf,onClick:()=>J(!0)}),X[19]=J,X[20]=p):p=X[20],X[21]!==c||X[22]!==u||X[23]!==p||X[24]!==l||X[25]!==s||X[26]!==o?(f=(0,i.jsxs)(ea,{children:[r,l,s,o,c,u,h,p]}),X[21]=c,X[22]=u,X[23]=p,X[24]=l,X[25]=s,X[26]=o,X[27]=f):f=X[27],X[28]===Symbol.for("react.memo_cache_sentinel")?(v=[{label:"0.5x",value:.5},{label:"0.9x",value:.9},{label:"1x",value:1},{label:"1.1x",value:1.1},{label:"1.5x",value:1.5},{label:"2x",value:2}],X[28]=v):v=X[28],X[29]!==H?(g=e=>{H(e)},X[29]=H,X[30]=g):g=X[30],X[31]!==G||X[32]!==g?(b=(0,i.jsx)(es,{title:"Playback Speed",icon:ew.BJM,children:(0,i.jsx)(eo,{options:v,onValueChange:g,value:G})}),X[31]=G,X[32]=g,X[33]=b):b=X[33],X[34]===Symbol.for("react.memo_cache_sentinel")?(y=[{label:"On",value:1},{label:"Off",value:0}],X[34]=y):y=X[34],X[35]!==ev?(x=e=>{ev(!!e)},X[35]=ev,X[36]=x):x=X[36];let eI=+!!ef;X[37]!==x||X[38]!==eI?(w=(0,i.jsx)(es,{title:"Auto Play",icon:ek.Rcw,children:(0,i.jsx)(eo,{options:y,onValueChange:x,value:eI})}),X[37]=x,X[38]=eI,X[39]=w):w=X[39],X[40]===Symbol.for("react.memo_cache_sentinel")?(T=[{label:"On",value:1},{label:"Off",value:0}],X[40]=T):T=X[40],X[41]!==ep?(C=e=>{ep(!!e)},X[41]=ep,X[42]=C):C=X[42];let eD=+!!eh;X[43]!==C||X[44]!==eD?(j=(0,i.jsx)(es,{title:"Auto Next",icon:ex.JgS,children:(0,i.jsx)(eo,{options:T,onValueChange:C,value:eD})}),X[43]=C,X[44]=eD,X[45]=j):j=X[45],X[46]===Symbol.for("react.memo_cache_sentinel")?(_=[{label:"On",value:1},{label:"Off",value:0}],X[46]=_):_=X[46],X[47]!==ey?(P=e=>{ey(!!e)},X[47]=ey,X[48]=P):P=X[48];let eL=+!!eg;return X[49]!==P||X[50]!==eL?(N=(0,i.jsx)(es,{title:"Skip OP/ED",icon:eT.ySo,children:(0,i.jsx)(eo,{options:_,onValueChange:P,value:eL})}),X[49]=P,X[50]=eL,X[51]=N):N=X[51],X[52]===Symbol.for("react.memo_cache_sentinel")?(F=(0,i.jsx)("p",{className:"text-[--muted] text-sm mb-2",children:"Real-time upscaling. Do not enable if you have a low-end GPU or none."}),X[52]=F):F=X[52],X[53]===Symbol.for("react.memo_cache_sentinel")?(I=E.map(eB),X[53]=I):I=X[53],X[54]!==$?(D=e=>{$(e)},X[54]=$,X[55]=D):D=X[55],X[56]!==q||X[57]!==D?(M=(0,i.jsxs)(es,{title:"Anime4K",icon:Z.rPP,children:[F,(0,i.jsx)(eo,{options:I,onValueChange:D,value:q})]}),X[56]=q,X[57]=D,X[58]=M):M=X[58],X[59]!==er||X[60]!==Q?(R=(0,i.jsx)(eb.d,{label:"Show Chapter Markers",side:"right",fieldClass:"hover:bg-transparent hover:border-transparent px-0 ml-0 w-full",size:"sm",value:Q,onValueChange:er}),X[59]=er,X[60]=Q,X[61]=R):R=X[61],X[62]!==ec||X[63]!==ed?(A=(0,i.jsx)(eb.d,{label:"Highlight OP/ED Chapters",side:"right",fieldClass:"hover:bg-transparent hover:border-transparent px-0 ml-0 w-full",size:"sm",value:ec,onValueChange:ed}),X[62]=ec,X[63]=ed,X[64]=A):A=X[64],X[65]!==eu||X[66]!==em?(O=(0,i.jsx)(eb.d,{label:"Increase Saturation",side:"right",fieldClass:"hover:bg-transparent hover:border-transparent px-0 ml-0 w-full",size:"sm",value:eu,onValueChange:em}),X[65]=eu,X[66]=em,X[67]=O):O=X[67],X[68]!==R||X[69]!==A||X[70]!==O?(U=(0,i.jsxs)(es,{title:"Appearance",icon:Z.WdH,children:[R,A,O]}),X[68]=R,X[69]=A,X[70]=O,X[71]=U):U=X[71],X[72]!==b||X[73]!==w||X[74]!==j||X[75]!==N||X[76]!==M||X[77]!==U?(V=(0,i.jsxs)(el,{children:[b,w,j,N,M,U]}),X[72]=b,X[73]=w,X[74]=j,X[75]=N,X[76]=M,X[77]=U,X[78]=V):V=X[78],X[79]!==f||X[80]!==V?(K=(0,i.jsxs)(en,{name:"settings",trigger:n,children:[f,V]}),X[79]=f,X[80]=V,X[81]=K):K=X[81],X[82]!==t||X[83]!==K?(B=(0,i.jsxs)(i.Fragment,{children:[t,K]}),X[82]=t,X[83]=K,X[84]=B):B=X[84],B}function eB(e){return{label:"".concat(e.label),value:e.value,moreInfo:"heavy"===e.performance?"Heavy":void 0,description:e.description}}function eX(){}function eW(){let e,t,n,r=(0,a.c)(6),l=(0,d.md)(eu),s=(0,d.md)(t1);if((0,d.md)(t7))return null;r[0]===Symbol.for("react.memo_cache_sentinel")?(e=[["default",eT.c6i],["pip",eT.LWH]],r[0]=e):e=r[0];let o=s?"pip":"default";return r[1]!==l?(t=()=>{null==l||l.togglePip()},r[1]=l,r[2]=t):t=r[2],r[3]!==o||r[4]!==t?(n=(0,i.jsx)(e_,{icons:e,state:o,onClick:t}),r[3]=o,r[4]=t,r[5]=n):n=r[5],n}function eG(){let e,t,n,r=(0,a.c)(7),l=(0,d.md)(I),s=(0,d.md)(t0),[,o]=(0,d.fp)(t7);r[0]===Symbol.for("react.memo_cache_sentinel")?(e=[["default",eS.kc3],["fullscreen",eS.iRv]],r[0]=e):e=r[0];let c=s?"fullscreen":"default";return r[1]!==l||r[2]!==o?(t=()=>{o(!1),null==l||l.toggleFullscreen()},r[1]=l,r[2]=o,r[3]=t):t=r[3],r[4]!==c||r[5]!==t?(n=(0,i.jsx)(e_,{icons:e,state:c,onClick:t}),r[4]=c,r[5]=t,r[6]=n):n=r[6],n}var eH=n(94077),eq=n(58181),e$=n(83475),eY=n(21335);let eJ=(0,o.u)({overlay:(0,eY.F)(["UI-Drawer__overlay"]),content:(0,eY.F)(["UI-Drawer__content","fixed z-50 w-full","transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-500 data-[state=open]:duration-500","focus:outline-none focus-visible:outline-none outline-none",eH.X&&"select-none"],{variants:{side:{player:"w-full inset-x-0 top-0 data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",top:"w-full lg:w-[calc(100%_-_20px)] inset-x-0 top-0 border data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"w-full lg:w-[calc(100%_-_20px)] inset-x-0 bottom-0 border data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full lg:h-[calc(100%_-_20px)] border data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left",right:"inset-y-0 right-0 h-full lg:h-[calc(100%_-_20px)] border data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right"},size:{sm:null,md:null,lg:null,xl:null,full:null}},defaultVariants:{side:"right",size:"md"},compoundVariants:[{size:"sm",side:"left",className:"sm:max-w-sm"},{size:"sm",side:"right",className:"sm:max-w-sm"},{size:"md",side:"left",className:"sm:max-w-md"},{size:"md",side:"right",className:"sm:max-w-md"},{size:"lg",side:"left",className:"sm:max-w-2xl"},{size:"lg",side:"right",className:"sm:max-w-2xl"},{size:"xl",side:"left",className:"sm:max-w-5xl"},{size:"xl",side:"right",className:"sm:max-w-5xl"},{size:"full",side:"top",className:"h-dvh"},{size:"full",side:"bottom",className:"h-dvh"}]}),close:(0,eY.F)(["UI-Drawer__close","absolute right-4 top-4"]),header:(0,eY.F)(["UI-Drawer__header","flex flex-col space-y-1.5 text-center sm:text-left"]),footer:(0,eY.F)(["UI-Drawer__footer","flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2"]),title:(0,eY.F)(["UI-Drawer__title","text-xl font-semibold leading-none tracking-tight"]),description:(0,eY.F)(["UI-Drawer__description","text-sm text-[--muted]"])});function eQ(e){let{allowOutsideInteraction:t=!1,trigger:n,title:a,footer:r,description:l,children:s,closeButton:c,overlayClass:d,contentClass:u,closeClass:h,headerClass:p,footerClass:f,titleClass:v,descriptionClass:g,hideCloseButton:b,side:y="right",size:x,open:k,onOpenAutoFocus:w,onCloseAutoFocus:E,onEscapeKeyDown:S,onPointerDownCapture:T,onInteractOutside:C,portalContainer:j,miniPlayer:_,onMiniPlayerClick:P,...N}=e;m.useEffect(()=>{k&&"full"===x?document.body.setAttribute("data-scroll-locked","1"):"full"===x&&document.body.removeAttribute("data-scroll-locked")},[k,x]);let F=m.useRef(_);m.useEffect(()=>{setTimeout(()=>{F.current=_},500)},[_]);let I=m.useRef(null),D=m.useRef(null),L=m.useCallback(()=>{let e=window.innerWidth>=1024?400:300;return{x:window.innerWidth-e-X,y:window.innerHeight-9/16*e-X}},[]),[R,A]=m.useState({x:0,y:0}),[O,U]=m.useState(!1),[z,V]=m.useState(!1),K=m.useRef({x:0,y:0}),B=m.useRef({x:0,y:0}),X=20,W=m.useCallback(()=>{if(!I.current)return null;let e=I.current.offsetWidth||0,t=I.current.offsetHeight||0;return{leftBoundary:80+X,rightBoundary:window.innerWidth-e-X,topBoundary:X,bottomBoundary:window.innerHeight-t-X,width:e,height:t}},[]);return m.useLayoutEffect(()=>{_&&(A(L()),V(!1))},[_,L]),m.useEffect(()=>{var e;if(!_||!I.current)return;let t=e=>{U(!0),K.current={x:e.clientX,y:e.clientY},B.current={x:R.x,y:R.y}},n=e=>{if(!O||!I.current)return;let t=e.clientX-K.current.x,n=e.clientY-K.current.y,i=B.current.x+t,a=B.current.y+n,r=W();if(r){if(i>=window.innerWidth-.5*r.width){z||V(!0),A({x:window.innerWidth-.15*r.width,y:a});return}z&&V(!1),A({x:Math.max(r.leftBoundary,Math.min(i,1.25*r.rightBoundary)),y:Math.max(r.topBoundary,Math.min(a,r.bottomBoundary))})}},i=e=>{if(U(!1),z){let e=W();if(!e)return;R.x<window.innerWidth-.5*e.width?(V(!1),A({x:e.rightBoundary,y:R.y})):A({x:window.innerWidth-.1*e.width,y:R.y});return}if(10>Math.abs(R.x-B.current.x)&&10>Math.abs(R.y-B.current.y)&&e.target===D.current){null==P||P();return}let t=W();if(!t)return;let n=[{x:t.leftBoundary,y:t.topBoundary},{x:t.rightBoundary,y:t.topBoundary},{x:t.leftBoundary,y:t.bottomBoundary},{x:t.rightBoundary,y:t.bottomBoundary}],i=n[0],a=Number.MAX_VALUE;n.forEach(e=>{let t=Math.sqrt(Math.pow(R.x-e.x,2)+Math.pow(R.y-e.y,2));t<a&&(a=t,i=e)}),A({x:i.x,y:i.y})};return null==(e=D.current)||e.addEventListener("mousedown",t),window.addEventListener("mousemove",n),window.addEventListener("mouseup",i),()=>{var e;null==(e=D.current)||e.removeEventListener("mousedown",t),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",i)}},[_,O,R,W,z]),m.useEffect(()=>{if(!_)return;let e=()=>{let e=W();e&&A(t=>{let n=t.x,i=t.y;return z?n=window.innerWidth-.1*e.width:(n=Math.max(e.leftBoundary,Math.min(t.x,e.rightBoundary)),i=Math.max(e.topBoundary,Math.min(t.y,e.bottomBoundary))),{x:n,y:i}})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[_,W,z]),m.useEffect(()=>{if(!I.current||!_)return;let e=0===R.x&&0===R.y?L():R;return I.current.style.position="fixed",I.current.style.left="".concat(e.x,"px"),I.current.style.top="".concat(e.y,"px"),I.current.style.zIndex=z?"40":"50",I.current.style.opacity=z?"0.7":"1",I.current.style.transform=z?"scale(0.95)":"scale(1)",F.current&&(O?I.current.style.transition="opacity 0.2s ease-out, transform 0.2s ease-out":I.current.style.transition="left 0.3s cubic-bezier(0.4, 0, 0.2, 1), top 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.2s ease-out, transform 0.2s ease-out"),()=>{I.current&&(I.current.style.position="",I.current.style.left="",I.current.style.top="",I.current.style.transform="",I.current.style.cursor="",I.current.style.transition="",I.current.style.zIndex="",I.current.style.opacity="")}},[_,R,O,z,L]),(0,i.jsxs)(eq.bL,{modal:!t,open:k,...N,children:[n&&(0,i.jsx)(eq.l9,{asChild:!0,children:n}),(0,i.jsx)(eq.ZL,{container:j,children:(0,i.jsxs)(eq.UC,{className:(0,o.cn)(eJ.content({size:x,side:"player"}),u,"w-full h-full transition-all duration-300 overflow-hidden fixed",_&&"aspect-video w-[300px] lg:w-[400px] h-auto rounded-lg shadow-xl",z&&"ring-2 ring-brand-300"),ref:I,onOpenAutoFocus:e=>e.preventDefault(),onCloseAutoFocus:E,onEscapeKeyDown:S,onPointerDownCapture:T,onInteractOutside:e=>e.preventDefault(),tabIndex:-1,children:[a||l?(0,i.jsxs)("div",{className:(0,o.cn)(eJ.header(),p),children:[(0,i.jsx)(eq.hE,{className:(0,o.cn)(eJ.title(),eH.X&&"relative",v),children:a}),l&&(0,i.jsx)(eq.VY,{className:(0,o.cn)(eJ.description(),g),children:l})]}):(0,i.jsx)(e$.s6,{children:(0,i.jsx)(eq.hE,{children:"Drawer"})}),_&&(0,i.jsx)("div",{ref:D,className:"vc-drawer-draggable-area absolute inset-0 z-[6]"}),s,r&&(0,i.jsx)("div",{className:(0,o.cn)(eJ.footer(),f),children:r}),!b&&(0,i.jsx)(eq.bm,{className:(0,o.cn)(eJ.close(),h),asChild:!0,children:c||(0,i.jsx)(M.Jn,{})})]})})]})}eQ.displayName="NativePlayerDrawer",(0,b.v)("VIDEO CORE MEDIA SESSION");let eZ=(0,c.eU)(null),e0=["play","pause","seekforward","seekbackward","seekto"];class e1{setVideo(e){this.video=e,this.video&&this.isActive&&(this.setupVideoListeners(),this.updatePlaybackState())}setPlaybackInfo(e){this.playbackInfo=e,this.isActive&&this.updateMetadata()}activate(){this.checkSupport()&&!this.isActive&&(this.isActive=!0,this.setupActionHandlers(),this.updateMetadata(),this.video&&(this.setupVideoListeners(),this.updatePlaybackState()))}deactivate(){this.isActive&&(this.isActive=!1,"mediaSession"in navigator&&(navigator.mediaSession.playbackState="none"),this.onDisconnect(),this.controller.abort(),this.controller=new AbortController)}on(e,t){this.eventTarget.addEventListener(e,t)}off(e,t){this.eventTarget.removeEventListener(e,t)}destroy(){this.deactivate(),this.video=null,this.playbackInfo=null}checkSupport(){return"mediaSession"in navigator}dispatch(e,t){this.eventTarget.dispatchEvent(new CustomEvent(e,{detail:t}))}onDisconnect(){if("mediaSession"in navigator){for(let e of(console.warn("Media session disconnected"),e0))navigator.mediaSession.setActionHandler(e,null);navigator.mediaSession.metadata=new MediaMetadata({title:"",artist:"",artwork:[]}),"setPositionState"in navigator.mediaSession&&navigator.mediaSession.setPositionState()}}updateMetadata(){if(!this.isActive||!("mediaSession"in navigator))return;let e=this.createMetadata();navigator.mediaSession.metadata=e}updatePlaybackState(){if(!this.isActive||!("mediaSession"in navigator)||!this.video)return;let e=this.video.paused?"paused":"playing";navigator.mediaSession.playbackState=e}createMetadata(){var e,t,n,i,a,r;if(!this.playbackInfo)return null;let l=this.playbackInfo.episode,s=null==l?void 0:l.baseAnime,o=(null==l?void 0:l.displayTitle)||"Seanime",c=(null==s||null==(e=s.title)?void 0:e.userPreferred)||(null==s||null==(t=s.title)?void 0:t.romaji)||(null==s||null==(n=s.title)?void 0:n.english)||"Video Player",d=[],u=(null==l||null==(i=l.episodeMetadata)?void 0:i.image)||(null==s||null==(a=s.coverImage)?void 0:a.large)||(null==s||null==(r=s.coverImage)?void 0:r.medium);return u&&d.push({src:u,sizes:"512x512",type:"image/webp"}),new MediaMetadata({title:o,artist:c,artwork:d})}setupActionHandlers(){if(!("mediaSession"in navigator))return;let e=this.handleAction.bind(this);for(let t of e0)navigator.mediaSession.setActionHandler(t,e)}handleAction(e){switch(e.action){case"play":this.dispatch("media-play-request");break;case"pause":this.dispatch("media-pause-request");break;case"seekto":case"seekforward":case"seekbackward":let t;if(void 0!==e.seekTime)t=e.seekTime;else{var n;t=((null==(n=this.video)?void 0:n.currentTime)||0)+(e.seekOffset||("seekforward"===e.action?10:-10))}this.dispatch("media-seek-request",{seekTime:t})}}setupVideoListeners(){if(!this.video)return;let e={signal:this.controller.signal};this.video.addEventListener("play",this.updatePlaybackState.bind(this),e),this.video.addEventListener("pause",this.updatePlaybackState.bind(this),e),this.video.addEventListener("timeupdate",this.handleTimeUpdate.bind(this),e),this.video.addEventListener("loadedmetadata",this.updatePlaybackState.bind(this),e)}handleTimeUpdate(){this.isActive&&"mediaSession"in navigator&&this.video&&"setPositionState"in navigator.mediaSession&&navigator.mediaSession.setPositionState({duration:this.video.duration||0,playbackRate:this.video.playbackRate||1,position:this.video.currentTime||0})}constructor(){if(this.video=null,this.playbackInfo=null,this.isActive=!1,this.controller=new AbortController,this.eventTarget=new EventTarget,!this.checkSupport())return}}var e2=n(22264),e3=n(2159),e4=n(73499),e5=n(37614),e6=n(51441),e8=n(40845),e7=n(52029),e9=n(47363),te=n(82449),tt=n(75385),tn=n(93319),ti=n(85530),ta=n(69554);let tr=(0,b.v)("VIDEO CORE PLAYLIST"),tl=(0,c.eU)(null);function ts(e){return"main"===e.type}function to(){var e,t;let n,i,r,l=(0,a.c)(31),s=(0,d.md)(tl),o=null==(t=(0,d.md)(N.k))||null==(e=t.playbackInfo)?void 0:e.streamType,c=null==s?void 0:s.animeEntry,u=(0,d.Xr)(e9.N7),h=(0,d.Xr)(e9.Io),{handleStreamSelection:p,handleAutoSelectStream:f}=(0,te.w)(),{handleStreamSelection:v,handleAutoSelectStream:g}=(0,e6.u)(),{playMediaFile:b}=(0,tn.g)(),[y]=(0,d.fp)(tt.bj),[x]=(0,d.fp)(e8.RP),[k]=(0,d.fp)(tt.q6),[w]=(0,d.fp)(e8.mF),{setTorrentSearchStreamEpisode:E}=(0,e7.U)(),{autoPlayTorrent:S}=(0,e4.K1)(),{nextPlaylistEpisode:T,prevPlaylistEpisode:C,currentPlaylist:j,playEpisode:_}=(0,e5.n)();l[0]!==S||l[1]!==w||l[2]!==x||l[3]!==g||l[4]!==v||l[5]!==f||l[6]!==p||l[7]!==s||l[8]!==u||l[9]!==h||l[10]!==E||l[11]!==o||l[12]!==k||l[13]!==y?(n=function(e){var t,n;if((null==s?void 0:s.animeEntry)&&e.aniDBEpisode){if(tr.info("Stream requested for ",e.episodeNumber),"torrent"===o||"debrid"===o){if(tr.info("Auto selecting torrent for ",e.episodeNumber),"torrent"===o&&y)return void f({mediaId:s.animeEntry.mediaId,episodeNumber:e.episodeNumber,aniDBEpisode:e.aniDBEpisode});if("debrid"===o&&x)return void g({mediaId:s.animeEntry.mediaId,episodeNumber:e.episodeNumber,aniDBEpisode:e.aniDBEpisode})}if(null==S||null==(t=S.torrent)?void 0:t.isBatch){let t;if(tr.info("Previous torrent selected for auto play",S),null==S?void 0:S.batchFiles){let e=null==(n=S.batchFiles.files)?void 0:n.find(e=>e.index===S.batchFiles.current+1);e&&(t=e.index)}"torrent"===o?p({mediaId:s.animeEntry.mediaId,episodeNumber:e.episodeNumber,aniDBEpisode:e.aniDBEpisode,torrent:S.torrent,chosenFileIndex:t,batchEpisodeFiles:(null==S?void 0:S.batchFiles)&&void 0!==t?{...S.batchFiles,current:t,currentEpisodeNumber:e.episodeNumber,currentAniDBEpisode:e.aniDBEpisode}:void 0}):"debrid"===o&&v({mediaId:s.animeEntry.mediaId,episodeNumber:e.episodeNumber,aniDBEpisode:e.aniDBEpisode,torrent:S.torrent,chosenFileId:void 0!==t?String(t):"",batchEpisodeFiles:(null==S?void 0:S.batchFiles)&&void 0!==t?{...S.batchFiles,current:t,currentEpisodeNumber:e.episodeNumber,currentAniDBEpisode:e.aniDBEpisode}:void 0})}else h(e.episodeNumber),E(e),tr.info("Torrent search for ",e.episodeNumber),m.startTransition(()=>{"torrent"===o?u(k?"torrentstream-select":"torrentstream-select-file"):"debrid"===o&&u(w?"debridstream-select":"debridstream-select-file")})}},l[0]=S,l[1]=w,l[2]=x,l[3]=g,l[4]=v,l[5]=f,l[6]=p,l[7]=s,l[8]=u,l[9]=h,l[10]=E,l[11]=o,l[12]=k,l[13]=y,l[14]=n):n=l[14];let P=n;l[15]!==c||l[16]!==j||l[17]!==T||l[18]!==C||l[19]!==_||l[20]!==b||l[21]!==s||l[22]!==P||l[23]!==o?(i=e=>{var t,n,i,a;if(!s)return void ta.oR.error("Unexpected error: No playlist state");if(!c)return void ta.oR.error("Unexpected error: No entry");if(tr.info("Requesting episode",e),j){switch(tr.info("Playing global playlist episode",e),e){case"previous":C&&_("previous",!0);break;case"next":T&&_("next",!0)}return}let r=null;switch(e){case"previous":(null==s?void 0:s.previousEpisode)&&(r=s.previousEpisode);break;case"next":(null==s?void 0:s.nextEpisode)&&(r=s.nextEpisode);break;default:r=null!=(n=null==s||null==(t=s.episodes)?void 0:t.find(t=>t.aniDBEpisode===e))?n:null}if(!r)return void tr.info("Episode not found for",e);switch(tr.info("Playing episode",r),o){case"localfile":if(!(null==r||null==(i=r.localFile)?void 0:i.path))return void ta.oR.error("Local file not found");b({path:null==r||null==(a=r.localFile)?void 0:a.path,episode:r,mediaId:null==c?void 0:c.mediaId});break;case"torrent":case"debrid":P(r)}},l[15]=c,l[16]=j,l[17]=T,l[18]=C,l[19]=_,l[20]=b,l[21]=s,l[22]=P,l[23]=o,l[24]=i):i=l[24];let F=i,I=null==s?void 0:s.animeEntry,D=!!(null==s?void 0:s.previousEpisode),L=!!(null==s?void 0:s.nextEpisode);return l[25]!==F||l[26]!==s||l[27]!==I||l[28]!==D||l[29]!==L?(r={playlistState:s,animeEntry:I,hasPreviousEpisode:D,hasNextEpisode:L,playEpisode:F},l[25]=F,l[26]=s,l[27]=I,l[28]=D,l[29]=L,l[30]=r):r=l[30],r}function tc(){let e,t,n,r,l=(0,a.c)(21),{animeEntry:s,hasNextEpisode:o,hasPreviousEpisode:c,playEpisode:d}=to(),{nextPlaylistEpisode:u,prevPlaylistEpisode:m,currentPlaylist:h,playEpisode:p}=(0,e5.n)();if(h){let e,t,n;return l[0]!==p||l[1]!==m?(e=!!m&&(0,i.jsx)(eI,{onClick:()=>{p("previous",!0)}}),l[0]=p,l[1]=m,l[2]=e):e=l[2],l[3]!==u||l[4]!==p?(t=!!u&&(0,i.jsx)(eF,{onClick:()=>{p("next",!0)}}),l[3]=u,l[4]=p,l[5]=t):t=l[5],l[6]!==e||l[7]!==t?(n=(0,i.jsxs)(i.Fragment,{children:[e,t]}),l[6]=e,l[7]=t,l[8]=n):n=l[8],n}return l[9]!==c||l[10]!==d?(e=c&&(0,i.jsx)(eI,{onClick:()=>{d("previous")}}),l[9]=c,l[10]=d,l[11]=e):e=l[11],l[12]!==o||l[13]!==d?(t=o&&(0,i.jsx)(eF,{onClick:()=>{d("next")}}),l[12]=o,l[13]=d,l[14]=t):t=l[14],l[15]!==s?(n=s&&(0,i.jsx)(e9.qM,{entry:s}),l[15]=s,l[16]=n):n=l[16],l[17]!==e||l[18]!==t||l[19]!==n?(r=(0,i.jsxs)(i.Fragment,{children:[e,t,n]}),l[17]=e,l[18]=t,l[19]=n,l[20]=r):r=l[20],r}class td{_bindToVideoPlayer(){this.detachFromCurrentPlayer(),this.videoSyncController=new AbortController,this.videoElement.addEventListener("timeupdate",()=>{let e=this.calculateSegmentIndex(this.videoElement.currentTime);e===this.lastCapturedSegment||this.previewCache.has(e)||this.throttledCaptureFrame(e)},{signal:this.videoSyncController.signal})}changeMediaSource(e){e!==this.currentMediaSource&&e&&(this.clearPreviewCache(),this.resetOperationQueue(),this.loadMediaSource(e),this.lastCapturedSegment=-1,this.captureThrottleTimeout&&(clearTimeout(this.captureThrottleTimeout),this.captureThrottleTimeout=null))}cleanup(){this.detachFromCurrentPlayer(),this.resetOperationQueue(),this.clearPreviewCache(),this.captureThrottleTimeout&&(clearTimeout(this.captureThrottleTimeout),this.captureThrottleTimeout=null),this._dummyVideoElement.pause(),this._dummyVideoElement.removeAttribute("src"),this._dummyVideoElement.load(),this._dummyVideoElement.remove(),this.currentMediaSource=void 0,this.lastCapturedSegment=-1,this.highestCachedIndex=-1}async retrievePreviewForSegment(e){let t=this.previewCache.get(e);if(t)return t;let n=this.inFlightPromises.get(e);return n||await this.schedulePreviewGeneration(e)}getLastestCachedIndex(){return this.highestCachedIndex}calculateTimeFromIndex(e){return 4*e}throttledCaptureFrame(e){this.captureThrottleTimeout&&clearTimeout(this.captureThrottleTimeout),this.captureThrottleTimeout=window.setTimeout(()=>{if(!this.previewCache.has(e)&&!this.inFlightPromises.has(e)){let t=this.captureFrameFromCurrentVideo(e);this.inFlightPromises.set(e,t),t.finally(()=>this.inFlightPromises.delete(e)),this.lastCapturedSegment=e}this.captureThrottleTimeout=null},500)}initializeDummyVideoElement(){this._dummyVideoElement.crossOrigin="anonymous",this._dummyVideoElement.playbackRate=0,this._dummyVideoElement.muted=!0,this._dummyVideoElement.preload="none"}loadMediaSource(e){this._dummyVideoElement.src=this.currentMediaSource=e,this._dummyVideoElement.load()}detachFromCurrentPlayer(){this.videoSyncController.abort(),this.captureThrottleTimeout&&(clearTimeout(this.captureThrottleTimeout),this.captureThrottleTimeout=null)}calculateSegmentIndex(e){return Math.floor(e/4)}async captureFrameFromCurrentVideo(e){if(this.videoElement.readyState<2)return;let t=this.videoElement.videoWidth,n=this.videoElement.videoHeight;if(!t||!n)return;this.configureRenderingSurface(t,n),this._drawingContext.drawImage(this.videoElement,0,0,this._offscreenCanvas.width,this._offscreenCanvas.height);let i=await this._offscreenCanvas.convertToBlob({type:"image/webp",quality:.8}),a=URL.createObjectURL(i);return this.previewCache.set(e,a),e>this.highestCachedIndex&&(this.highestCachedIndex=e),a}addJob(e){let{promise:t,resolve:n}=Promise.withResolvers();return{segmentIndex:e,execute:()=>{this._dummyVideoElement.requestVideoFrameCallback(async(t,i)=>{n(await this.captureFrameAtSegment(this._dummyVideoElement,e,i.width,i.height)),this.processNextJob()}),this._dummyVideoElement.currentTime=4*e},promise:t}}processNextJob(){this.jobs.current=void 0,this.jobs.pending&&(this.jobs.current=this.jobs.pending,this.jobs.pending=void 0,this.jobs.current.execute())}schedulePreviewGeneration(e){return this.jobs.current?this.jobs.current.segmentIndex===e?this.jobs.current.promise:(this.jobs.pending&&this.jobs.pending.segmentIndex===e||(this.jobs.pending=this.addJob(e)),this.jobs.pending.promise):(this.jobs.current=this.addJob(e),this.jobs.current.execute(),this.jobs.current.promise)}async captureFrameAtSegment(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.videoWidth,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.videoHeight,a=this.previewCache.get(t);if(a)return a;if(!n||!i)return;this.configureRenderingSurface(n,i),this._drawingContext.drawImage(e,0,0,this._offscreenCanvas.width,this._offscreenCanvas.height);let r=await this._offscreenCanvas.convertToBlob({type:"image/webp",quality:.8}),l=URL.createObjectURL(r);return this.previewCache.set(t,l),t>this.highestCachedIndex&&(this.highestCachedIndex=t),l}configureRenderingSurface(e,t){this._offscreenCanvas.width=200,this._offscreenCanvas.height=t/e*200}clearPreviewCache(){this.previewCache.forEach(e=>URL.revokeObjectURL(e)),this.previewCache.clear(),this.inFlightPromises.clear()}resetOperationQueue(){this.jobs.current=void 0,this.jobs.pending=void 0}constructor(e,t){this.previewCache=new Map,this.inFlightPromises=new Map,this.jobs={current:void 0,pending:void 0},this.videoSyncController=new AbortController,this.lastCapturedSegment=-1,this.captureThrottleTimeout=null,this.highestCachedIndex=-1,this._dummyVideoElement=document.createElement("video"),this._offscreenCanvas=new OffscreenCanvas(0,0),this._drawingContext=this._offscreenCanvas.getContext("2d"),this.initializeDummyVideoElement(),t&&this.loadMediaSource(t+"&thumbnail=true"),this.videoElement=e,this._bindToVideoPlayer()}}var tu=n(90711),tm=n(55226),th=n(9242);let tp=(0,b.v)("SUBTITLE");class tf{selectTrackByLabel(e){var t,n,i;let a=null==(i=this.playbackInfo.mkvMetadata)||null==(n=i.subtitleTracks)||null==(t=n.find)?void 0:t.call(n,t=>t.name===e);a?this.selectTrack(a.number):(tp.error("Track not found",e),this.setNoTrack())}setNoTrack(){var e,t,n;this.currentTrackNumber=-1,null==(e=this.libassRenderer)||e.setTrack(this.defaultSubtitleHeader),null==(n=this.libassRenderer)||null==(t=n.resize)||t.call(n)}selectTrack(e){var t,n,i,a,r,l,s,o,c;if(tp.info("Track selection requested",e),this._init(),this.currentTrackNumber===e)return void tp.info("Track already selected",e);if(-1===e){tp.info("No track selected",e),this.setNoTrack();return}let d=null==(n=this._getTracks())||null==(t=n.find)?void 0:t.call(n,t=>t.info.number===e);if(tp.info("Selecting track",e,d),this.videoElement.textTracks){for(let e of(tp.info("Updating video element's textTracks",this.videoElement.textTracks),this.videoElement.textTracks))d&&e.id===d.info.number.toString()?e.mode="showing":e.mode="disabled";this.videoElement.textTracks.dispatchEvent(new Event("change"))}if(!d){tp.info("Track not found",e),this.setNoTrack();return}let u=(null==(a=d.info.codecPrivate)||null==(i=a.slice)?void 0:i.call(a,0,-1))||this.defaultSubtitleHeader;this.currentTrackNumber=d.info.number,null==(r=this.libassRenderer)||r.setTrack(u);let m=null==(l=this.tracks[d.info.number])?void 0:l.events;if(m){for(let{assEvent:e}of(tp.info("Found",m.size,"events for track",d.info.number),m.values()))null==(c=this.libassRenderer)||c.createEvent(e);null==(o=this.libassRenderer)||null==(s=o.resize)||s.call(o)}}onSubtitleEvent(e){let{isNew:t,assEvent:n}=this._recordSubtitleEvent(e);n&&this.libassRenderer&&t&&e.trackNumber===this.currentTrackNumber&&this.libassRenderer.createEvent(n)}onTrackAdded(e){var t,n;tp.info("Subtitle track added",e),ta.oR.info("Subtitle track added: ".concat(e.name)),this._addTrack(e),this._storeTrackStyles();let i=document.createElement("track");i.id=e.number.toString(),i.kind="subtitles",i.label=e.name||"",i.srclang=e.language||"eng",this.videoElement.appendChild(i),this._selectDefaultTrack(),this._init(),null==(n=this.libassRenderer)||null==(t=n.resize)||t.call(n)}destroy(){var e;for(let t in tp.info("Destroying subtitle manager"),null==(e=this.libassRenderer)||e.destroy(),this.libassRenderer=null,this.tracks)this.tracks[t].events.clear();this.tracks={},this.currentTrackNumber=-1}_selectDefaultTrack(){var e,t,n,i,a;if(-1!==this.currentTrackNumber)return;let r=this._getTracks();if(!(null==r?void 0:r.length))return void this.setNoTrack();if(1===r.length)return void this.selectTrack(r[0].info.number);for(let e of this.settings.preferredSubtitleLanguage.split(",").map(e=>e.trim()).filter(e=>e.length>0)){let t=null==r||null==(i=r.filter)?void 0:i.call(r,t=>t.info.language===e);if(null==t?void 0:t.length){let e=t.findIndex(e=>e.info.forced);this.selectTrack(t[e>=0?e:0].info.number);return}if("none"===e)return void this.selectTrack(-1)}let l=null==r||null==(e=r.filter)?void 0:e.call(r,e=>"eng"===(e.info.language||"eng")||"en"===e.info.language);if(null==l?void 0:l.length){let e=l.findIndex(e=>e.info.forced||e.info.default);this.selectTrack(l[e>=0?e:0].info.number);return}this.selectTrack(null!=(a=null==r||null==(n=r[0])||null==(t=n.info)?void 0:t.number)?a:-1)}_addTrack(e){return this.tracks[e.number]={info:e,events:new Map,styles:{}},this.tracks[e.number]}_getTracks(){return Object.values(this.tracks).sort((e,t)=>e.info.number-t.info.number)}getSelectedTrack(){if(!this.videoElement.textTracks)return null;for(let e=0;e<this.videoElement.textTracks.length;e++)if("showing"===this.videoElement.textTracks[e].mode)return Number(this.videoElement.textTracks[e].id);return null}_storeTrackStyles(){var e,t,n,i;if(null==(t=this.playbackInfo)||null==(e=t.mkvMetadata)?void 0:e.subtitleTracks)for(let e of this.playbackInfo.mkvMetadata.subtitleTracks){let t=((null==(i=e.codecPrivate)||null==(n=i.slice)?void 0:n.call(i,0,-1))||this.defaultSubtitleHeader).replaceAll("\r\n","\n").split("\n").filter(e=>e.startsWith("Style:")),a=1,r={};for(let n of(this.tracks[e.number].styles=r,t)){let e=n.split("Style:")[1];(e=(e.split(",")[0]||"").trim())&&!r[e]&&(r[e]=a++)}this.tracks[e.number].styles=r}}__eventMapKey(e){var t,n,i,a,r,l,s,o;return"".concat(e.trackNumber,"-").concat(e.startTime,"-").concat(e.duration,"-").concat(null==(t=e.extraData)?void 0:t.style,"-").concat(null==(n=e.extraData)?void 0:n.name,"-").concat(null==(i=e.extraData)?void 0:i.marginL,"-").concat(null==(a=e.extraData)?void 0:a.marginR,"-").concat(null==(r=e.extraData)?void 0:r.marginV,"-").concat(null==(l=e.extraData)?void 0:l.effect,"-").concat(null==(s=e.extraData)?void 0:s.readOrder,"-").concat(null==(o=e.extraData)?void 0:o.layer)}_init(){var e,t,n;if(this.libassRenderer)return;tp.info("Initializing libass renderer");let i=new URL("/jassub/jassub-worker.wasm",window.location.origin).toString(),a=new URL("/jassub/jassub-worker.js",window.location.origin).toString(),l=new URL("/jassub/jassub-worker-modern.wasm",window.location.origin).toString(),s=(0,tu.yU)("/jassub/jassub-worker.wasm.js"),o="/jassub/Roboto-Medium.ttf";for(let c of(this.libassRenderer=new th.default({video:this.videoElement,subContent:this.defaultSubtitleHeader,wasmUrl:i,workerUrl:a,legacyWasmUrl:s,modernWasmUrl:l,offscreenRender:!(0,tm.f8)()&&this.jassubOffscreenRender,prescaleFactor:.8,onDemandRender:!1,fonts:this.fonts,fallbackFont:"roboto medium",availableFonts:{"roboto medium":o},libassGlyphLimit:60500}),this.fonts=(null==(n=this.playbackInfo.mkvMetadata)||null==(t=n.attachments)||null==(e=t.filter(e=>"font"===e.type))?void 0:e.map(e=>"".concat((0,r.M)(),"/api/v1/directstream/att/").concat(e.filename)))||[],this.fonts=[o,...this.fonts],this.fonts))this.libassRenderer.addFont(c)}_createAssEvent(e,t){var n,i,a,r,l,s,o,c,d,u,m,h,p,f;return{Start:e.startTime,Duration:e.duration,Style:String((null==(n=e.extraData)?void 0:n.style)?null==(r=this.tracks[e.trackNumber])||null==(a=r.styles)?void 0:a[null!=(h=null==(i=e.extraData)?void 0:i.style)?h:"Default"]:1),Name:null!=(p=null==(l=e.extraData)?void 0:l.name)?p:"",MarginL:(null==(s=e.extraData)?void 0:s.marginL)?Number(e.extraData.marginL):0,MarginR:(null==(o=e.extraData)?void 0:o.marginR)?Number(e.extraData.marginR):0,MarginV:(null==(c=e.extraData)?void 0:c.marginV)?Number(e.extraData.marginV):0,Effect:null!=(f=null==(d=e.extraData)?void 0:d.effect)?f:"",Text:e.text,ReadOrder:(null==(u=e.extraData)?void 0:u.readOrder)?Number(e.extraData.readOrder):1,Layer:(null==(m=e.extraData)?void 0:m.layer)?Number(e.extraData.layer):0,_index:t}}_recordSubtitleEvent(e){var t,n;let i=null==(t=this.tracks[e.trackNumber])?void 0:t.events;if(!i)return{isNew:!1,assEvent:null};let a=this.__eventMapKey(e);if(i.has(a))return{isNew:!1,assEvent:null==(n=i.get(a))?void 0:n.assEvent};let r=this._createAssEvent(e,i.size);return i.set(a,{event:e,assEvent:r}),{isNew:!0,assEvent:r}}constructor({videoElement:e,jassubOffscreenRender:t,playbackInfo:n,settings:i}){var a,r;if(this.libassRenderer=null,this.defaultSubtitleHeader="[Script Info]\nTitle: English (US)\nScriptType: v4.00+\nWrapStyle: 0\nPlayResX: 640\nPlayResY: 360\nScaledBorderAndShadow: yes\n\n[V4+ Styles]\nFormat: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding\nStyle: Default, Roboto Medium,24,&H00FFFFFF,&H000000FF,&H00000000,&H00000000,0,0,0,0,100,100,0,0,1,1.3,0,2,20,20,23,0\n[Events]\n\n",this.tracks={},this.currentTrackNumber=-1,this.fonts=[],this.videoElement=e,this.jassubOffscreenRender=t,this.playbackInfo=n,this.settings=i,!(null==(r=this.playbackInfo)||null==(a=r.mkvMetadata)?void 0:a.subtitleTracks))return;for(let e of this.playbackInfo.mkvMetadata.subtitleTracks)this._addTrack(e);this._storeTrackStyles(),this._selectDefaultTrack(),tp.info("Text tracks",this.videoElement.textTracks),tp.info("Tracks",this.tracks)}}var tv=n(35089),tg=n(19022);let tb=(0,c.eU)(null);function ty(e){let{chapterCues:t}=e,n=(0,d.md)(nt),a=(0,d.md)(tq),r=(0,d.md)(tH),l=(0,d.md)(t5),[s,c]=(0,d.fp)(t3),[u,h]=(0,d.fp)(t2),[p,f]=(0,d.fp)(ns),g=(0,d.Xr)(nu),b=(0,d.md)(L.RR),y=(0,d.md)(L.kF),x=(0,d.Xr)(v),[k,w]=(0,d.fp)(nc),[E,S]=(0,d.fp)(nd),[T,C]=(0,d.fp)(no),j=m.useMemo(()=>l/r*100,[l]),_=m.useMemo(()=>{if(!(null==t?void 0:t.length))return[{width:100,percentageOffset:0,label:null,start:0,end:0}];let e=0;return t.toSorted((e,t)=>e.startTime-t.startTime).filter(e=>(e.startTime||e.endTime)&&!(e.endTime>0&&e.endTime<e.startTime)).map(t=>{var n,i;let a=null!=(n=t.startTime)?n:0,l=null!=(i=t.endTime)?i:r,s=(l-a)/r*100,o={width:s,percentageOffset:e,label:t.text||null,start:a,end:l};return e+=s,o})},[t,r]),[P,N]=m.useState(a/r*100);m.useEffect(()=>{N(a/r*100)},[a,r]);let F=function(e){let t=null,n=null,i=function(e){let t=e.map(e=>ef(e.label)).filter(Boolean);return t.includes("Intro")&&!t.includes("Opening")}(e);for(let a of e){let e=ef(a.label);if(t||i||"Opening"!==e||(t=a),!t&&i&&"Intro"===e&&(t=a),n||i||"Ending"!==e||(n=a),!n&&i&&"Outro"===e&&(n=a),t&&n)break}return{opening:t,ending:n}}(_);function I(e){u||c(0)}function D(e){let t=function(e){let t=e.currentTarget.getBoundingClientRect();return Math.max(0,Math.min(100,(e.clientX-t.left)/t.width*100))}(e);u&&(e.stopPropagation(),N(t)),c(t)}m.useEffect(()=>{var e,t;((null==(e=F.opening)?void 0:e.end)||(null==(t=F.ending)?void 0:t.end))&&(isNaN(r)||r<=1||(F.opening&&F.opening.end&&a>=F.opening.start&&a<F.opening.end?y&&!T?(console.log("auto skip",F.opening.end),g({type:"seekTo",payload:{time:F.opening.end}}),x({message:"Skipped OP",duration:1e3})):w(F.opening.end):w(0),F.ending&&F.ending.end&&a>=F.ending.start&&a<F.ending.end&&a<r?y&&!T?(console.log("auto skip",F.ending.end),g({type:"seekTo",payload:{time:F.ending.end}}),x({message:"Skipped ED",duration:1e3})):S(F.ending.end):S(0)))},[a,y,F,r,T]);let M=(0,d.Xr)(tb);return(0,i.jsxs)("div",{ref:e=>{M(e)},className:(0,o.cn)("vc-time-range","w-full relative group/vc-time-range z-[2] flex h-8","cursor-pointer outline-none"),role:"slider",tabIndex:0,"aria-valuemin":0,"aria-valuenow":0,"aria-valuetext":"0%","aria-orientation":"horizontal","aria-label":"Video playback time",onPointerDown:function(e){e.stopPropagation(),n&&0===e.button&&(e.currentTarget.setPointerCapture(e.pointerId),h(!0),f(n.paused),n.paused||n.pause(),D(e),null==n||n.dispatchEvent(new Event("seeking")))},onPointerUp:function(e){e.stopPropagation(),0===e.button&&(e.currentTarget.releasePointerCapture(e.pointerId),h(!1),g({type:"seekTo",payload:{time:r*s/100}}),p||null==n||n.play())},onPointerLeave:I,onPointerCancel:I,onPointerMove:D,children:[(0,i.jsx)(tS,{chapters:_}),_.map((e,t)=>(0,i.jsx)(tx,{idx:t,progressPercentage:P,bufferedPercentage:j,chapter:e,showMarker:t<_.length-1&&b},t))]})}function tx(e){let t,n,r,l,s,c,u,m,h,p,f,v,g,b,y,x,k,w,E,S=(0,a.c)(48),{idx:T,chapter:C,progressPercentage:j,bufferedPercentage:_,showMarker:P}=e,N=(0,d.md)(tH),F=(0,d.md)(t3),I=(0,d.Xr)(nu),D=(0,d.md)(L.y2),M=!!F&&C.percentageOffset<=F&&C.percentageOffset+C.width>=F,R=function(e,t){let n=(t-e.percentageOffset)*(100/e.width);return(n<=0?-3:n>=100?100:n)-100};S[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,o.cn)("vc-time-range-chapter-segment","relative","w-full h-full flex items-center",tX&&"bg-yellow-500/10"),S[0]=t):t=S[0];let A="".concat(C.width,"%");S[1]!==A?(n={width:A},S[1]=A,S[2]=n):n=S[2];let O=M&&"h-2";S[3]!==O?(r=(0,o.cn)("vc-time-range-chapter","relative h-1 transition-[height] flex items-center justify-center overflow-hidden rounded-lg",O,tX&&"bg-yellow-500/50"),S[3]=O,S[4]=r):r=S[4];let U=T>0?"calc(100% - ".concat(1.5,"px)"):"100%",z=T>0?"".concat(3,"px"):"0px";S[5]!==U||S[6]!==z?(l={width:U,marginLeft:z},S[5]=U,S[6]=z,S[7]=l):l=S[7],S[8]===Symbol.for("react.memo_cache_sentinel")?(s=(0,o.cn)("vc-time-range-chapter-progress-bar","bg-white absolute w-full h-full left-0 transform-gpu z-[10]"),S[8]=s):s=S[8];let V=N>1?"".concat(R(C,j),"%"):"-100%";S[9]!==V?(c={"--tw-translate-x":V},S[9]=V,S[10]=c):c=S[10];let K=c;S[11]!==K?(u=(0,i.jsx)("div",{className:s,style:K}),S[11]=K,S[12]=u):u=S[12],S[13]===Symbol.for("react.memo_cache_sentinel")?(m=(0,o.cn)("vc-time-range-chapter-seeking-target-bar","bg-white/30 absolute w-full h-full left-0 transform-gpu z-[9]"),S[13]=m):m=S[13];let B=N>1?"".concat(R(C,F),"%"):"-100%";S[14]!==B?(h={"--tw-translate-x":B},S[14]=B,S[15]=h):h=S[15];let X=h;S[16]!==X?(p=(0,i.jsx)("div",{className:m,style:X}),S[16]=X,S[17]=p):p=S[17],S[18]===Symbol.for("react.memo_cache_sentinel")?(f=(0,o.cn)("vc-time-range-chapter-buffer-bar","bg-white/10 absolute w-full h-full left-0 transform-gpu z-[8]"),S[18]=f):f=S[18];let W=N>1?"".concat(R(C,_),"%"):"-100%";S[19]!==W?(v={"--tw-translate-x":W},S[19]=W,S[20]=v):v=S[20];let G=v;return S[21]!==G?(g=(0,i.jsx)("div",{className:f,style:G}),S[21]=G,S[22]=g):g=S[22],S[23]!==C.label||S[24]!==D?(b=!!ef(C.label)&&D&&"bg-blue-300/50",S[23]=C.label,S[24]=D,S[25]=b):b=S[25],S[26]!==b?(y=(0,o.cn)("vc-time-range-chapter-bar","bg-white/20 absolute left-0 w-full h-full z-[1]",b),S[26]=b,S[27]=y):y=S[27],S[28]!==y?(x=(0,i.jsx)("div",{className:y}),S[28]=y,S[29]=x):x=S[29],S[30]!==u||S[31]!==p||S[32]!==g||S[33]!==x||S[34]!==r||S[35]!==l?(k=(0,i.jsxs)("div",{className:r,style:l,children:[u,p,g,x]}),S[30]=u,S[31]=p,S[32]=g,S[33]=x,S[34]=r,S[35]=l,S[36]=k):k=S[36],S[37]!==I||S[38]!==C.percentageOffset||S[39]!==C.width||S[40]!==N||S[41]!==T||S[42]!==P?(w=P&&(0,i.jsx)("button",{type:"button",onPointerDown:tw,onPointerUp:tk,onClick:e=>{e.stopPropagation(),I({type:"seekTo",payload:{time:N*(C.percentageOffset+C.width)/100}})},className:(0,o.cn)("vc-time-range-chapter-marker","absolute top-0 right-0 size-4 flex items-center justify-center -translate-y-1/2 translate-x-1/2 cursor-pointer z-[20] "),style:{right:"-".concat(1.5,"px")},"aria-label":"Seek to end of chapter ".concat(T+1),tabIndex:-1,children:(0,i.jsx)(tg.akn,{className:"size-2.5 text-white/20 hover:text-white/100 transition-colors duration-100"})}),S[37]=I,S[38]=C.percentageOffset,S[39]=C.width,S[40]=N,S[41]=T,S[42]=P,S[43]=w):w=S[43],S[44]!==n||S[45]!==k||S[46]!==w?(E=(0,i.jsxs)("div",{className:t,style:n,children:[k,w]}),S[44]=n,S[45]=k,S[46]=w,S[47]=E):E=S[47],E}function tk(e){return e.stopPropagation()}function tw(e){return e.stopPropagation()}let tE=(0,b.v)("VIDEO CORE / TIME PREVIEW");function tS(e){let t,n,r,l,s,c,u,h,p=(0,a.c)(26),{chapters:f}=e;(0,d.md)(nt);let v=(0,d.md)(tH),g=(0,d.md)(t7),b=(0,d.md)(t3),y=(0,d.md)(t2);(0,d.Xr)(nu);let x=(0,d.md)(nr),k=(0,d.md)(tb),[w,E]=m.useState(null),S=v*b/100;if(p[0]!==f||p[1]!==b){let e;p[3]!==b?(e=e=>e.percentageOffset<=b&&e.percentageOffset+e.width>=b,p[3]=b,p[4]=e):e=p[4],n=f.find(e),p[0]=f,p[1]=b,p[2]=n}else n=p[2];let T=n;t=null==T?void 0:T.label,p[5]!==v||p[6]!==x||p[7]!==k?(r=async e=>{if(!x||!v||!k)return;E(null),k.removeAttribute("data-preview-image");let t=k.getBoundingClientRect(),n=Math.max(0,Math.min(1,(e.clientX-t.left)/t.width))*v;if(n>=0&&n<=v){let e=Math.floor(n/4);try{let t=await x.retrievePreviewForSegment(e);t&&(k.setAttribute("data-preview-image",t),E(t))}catch(e){tE.error("Failed to get thumbnail",e)}}},p[5]=v,p[6]=x,p[7]=k,p[8]=r):r=p[8];let C=r;p[9]!==C||p[10]!==k?(l=()=>{if(!k)return;let e=()=>{k.removeAttribute("data-preview-image"),E(null)};return k.addEventListener("mouseleave",e),k.addEventListener("mousemove",C),()=>{k.removeEventListener("mouseleave",e),k.removeEventListener("mousemove",C)}},s=[C,k],p[9]=C,p[10]=k,p[11]=l,p[12]=s):(l=p[11],s=p[12]),m.useEffect(l,s);let j=!g&&x&&(y||!!S)&&S<=4*x.getLastestCachedIndex();return p[13]!==v||p[14]!==w||p[15]!==j||p[16]!==S?(c=j&&(0,i.jsx)("div",{className:(0,o.cn)("absolute bottom-full aspect-video overflow-hidden rounded-md bg-black border border-white/50"),style:{left:"clamp(".concat(100,"px, ").concat(S/v*100,"%, calc(100% - ").concat(100,"px))"),width:"200px",transform:"translateX(-50%) translateY(-54%)"},children:!!w&&(0,i.jsx)(tv.default,{src:w||"",alt:"Preview",fill:!0,sizes:"200px",className:"object-cover rounded-md",decoding:"async",loading:"lazy"})}),p[13]=v,p[14]=w,p[15]=j,p[16]=S,p[17]=c):c=p[17],p[18]!==t||p[19]!==v||p[20]!==y||p[21]!==S?(u=(y||!!S)&&(0,i.jsxs)("div",{className:(0,o.cn)("absolute bottom-full mb-3 px-2 py-1 bg-black/70 text-white text-center text-sm rounded-md","whitespace-nowrap z-20 pointer-events-none",""),style:{left:"".concat(S/v*100,"%"),transform:"translateX(-50%)"},children:[t&&(0,i.jsx)("p",{className:"text-xs font-medium max-w-2xl truncate",children:t}),(0,i.jsx)("p",{children:ev(S)}),(0,i.jsx)("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-black/70"})]}),p[18]=t,p[19]=v,p[20]=y,p[21]=S,p[22]=u):u=p[22],p[23]!==c||p[24]!==u?(h=(0,i.jsxs)(i.Fragment,{children:[c,u]}),p[23]=c,p[24]=u,p[25]=h):h=p[25],h}function tT(e){let t,n,r,l,s,c=(0,a.c)(13),{children:u}=e,m=(0,d.md)(ne),h=(0,d.md)(t8),p=(0,d.md)(t7),f=(0,d.md)(eC),v=(m||h||f)&&"opacity-100",g=p&&"top-0";c[0]!==v||c[1]!==g?(t=(0,o.cn)("vc-control-bar-top-section","top-8 absolute left-0 w-full py-4 px-5 duration-200 transition-opacity opacity-0 z-[999]",v,g),c[0]=v,c[1]=g,c[2]=t):t=c[2],c[3]!==u||c[4]!==t?(n=(0,i.jsx)("div",{"data-vc-control-bar-top-section":!0,className:t,children:u}),c[3]=u,c[4]=t,c[5]=n):n=c[5];let b=p&&h&&"opacity-100";return c[6]!==b?(r=(0,o.cn)("vc-control-bar-top-gradient pointer-events-none","absolute top-0 left-0 right-0 w-full z-[5] transition-opacity duration-300 opacity-0","bg-gradient-to-b from-black/60 to-transparent","h-20",b),c[6]=b,c[7]=r):r=c[7],c[8]!==r?(l=(0,i.jsx)("div",{className:r}),c[8]=r,c[9]=l):l=c[9],c[10]!==n||c[11]!==l?(s=(0,i.jsxs)(i.Fragment,{children:[n,l]}),c[10]=n,c[11]=l,c[12]=s):s=c[12],s}function tC(e){var t,n,r,l;let s,c,u,m,h=(0,a.c)(10),{state:p}=e;(0,d.md)(ne);let f=(0,d.md)(t8),v=(0,d.md)(t7),g=(0,d.md)(eC);if(v)return null;let b=(f||g)&&"opacity-100";h[0]!==b?(s=(0,o.cn)("transition-opacity duration-200 opacity-0",b),h[0]=b,h[1]=s):s=h[1];let y=null==(n=p.playbackInfo)||null==(t=n.episode)?void 0:t.displayTitle;h[2]!==y?(c=(0,i.jsx)("p",{className:"text-white font-bold text-lg",children:y}),h[2]=y,h[3]=c):c=h[3];let x=null==(l=p.playbackInfo)||null==(r=l.episode)?void 0:r.episodeTitle;return h[4]!==x?(u=(0,i.jsx)("p",{className:"text-white/50 text-base !font-normal",children:x}),h[4]=x,h[5]=u):u=h[5],h[6]!==s||h[7]!==c||h[8]!==u?(m=(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:s,children:[c,u]})}),h[6]=s,h[7]=c,h[8]=u,h[9]=m):m=h[9],m}var tj=n(96826),t_=n(24685),tP=n(25264),tN=n(58036),tF=n(78106),tI=n(70274),tD=n(2091),tL=n(46278),tM=n(31939),tR=n(78259),tA=n(70376),tO=n(75780),tU=n(62361),tz=n(49927),tV=n(61704);let tK=(0,tR.lR)(),tB=(0,b.v)("VIDEO CORE"),tX=!1,tW=(0,c.eU)({width:1,height:1}),tG=(0,c.eU)({width:0,height:0}),tH=(0,c.eU)(1),tq=(0,c.eU)(0),t$=(0,c.eU)(1),tY=(0,c.eU)(0),tJ=(0,c.eU)(!1),tQ=(0,c.eU)(!1),tZ=(0,c.eU)(1);(0,c.eU)(0);let t0=(0,c.eU)(!1),t1=(0,tM.C)([ed],e=>null!==e),t2=(0,c.eU)(!1),t3=(0,c.eU)(0),t4=(0,c.eU)(null),t5=(0,tM.C)([t4,tq],(e,t)=>{if(!e)return 0;let n=0;for(let i=0;i<e.length;i++){let a=e.start(i),r=e.end(i);if(t>=a&&t<=r)return r;r>=t&&n>r&&(n=r)}return n}),t6=(0,c.eU)(!1),t8=(0,c.eU)(!0),t7=(0,c.eU)(!1),t9=(0,tM.C)([eC,ee],(e,t)=>e||!!t);(0,c.eU)({x:0,y:0});let ne=(0,c.eU)(!0),nt=(0,c.eU)(null),nn=(0,c.eU)(null),ni=(0,c.eU)(null),na=(0,c.eU)(null),nr=(0,c.eU)(null),nl=(0,c.eU)(null),ns=(0,c.eU)(!1),no=(0,c.eU)(0),nc=(0,c.eU)(null),nd=(0,c.eU)(null),nu=(0,c.eU)(null,(e,t,n)=>{let i=e(nt),a=e(tH),r=0;if(i)switch(n.type){case"seekTo":if(isNaN(a)||a<=1)return;i.currentTime=r=Math.min(a,Math.max(0,n.payload.time)),t(tq,r),n.payload.flashTime&&t(v,{message:"".concat(ev(r)," / ").concat(ev(a)),type:"message"});break;case"seek":if(isNaN(a)||a<=1)return;i.currentTime=r=Math.min(a,Math.max(0,e(tq)+n.payload.time)),t(tq,r),n.payload.flashTime&&t(v,{message:"".concat(ev(r)," / ").concat(ev(a)),type:"message"});break;case"togglePlay":i.paused?i.play():i.pause();break;case"restoreProgress":t(no,Math.max(0,n.payload.time))}});function nm(e){let t,n=(0,a.c)(2),{children:r}=e;return n[0]!==r?(t=(0,i.jsx)(tK.Provider,{children:r}),n[0]=r,n[1]=t):t=n[1],t}function nh(e){var t,n,c,u,p,f,b,y,x,E,S,T,C,_,F,R,A,O,U,z,V,B,X;let W=(0,tj.v1)(),{state:G,aniSkipData:q,onTerminateStream:$,onEnded:Y,onPlay:J,onCompleted:Q,onPause:Z,onTimeUpdate:et,onLoadedData:en,onLoadedMetadata:ei,onVolumeChange:ea,onSeeking:er,onSeeked:el,onError:es,onPlaybackRateChange:eo,onFileUploaded:ec,...ep}=e,ef=(0,m.useRef)(null),ev=(0,m.useRef)(null),eb=(0,d.Xr)(nt),ey=(0,d.Xr)(tG);!function(e){let t,n,i=(0,a.c)(16),r=(0,d.md)(nt),l=(0,d.Xr)(tW),s=(0,d.Xr)(tH),o=(0,d.Xr)(tq),c=(0,d.Xr)(t$),u=(0,d.Xr)(tY),h=(0,d.Xr)(tJ),p=(0,d.Xr)(tQ),f=(0,d.Xr)(tZ),v=(0,d.Xr)(t4),g=(0,d.Xr)(t6),b=(0,d.Xr)(t8);i[0]!==v||i[1]!==h||i[2]!==o||i[3]!==s||i[4]!==g||i[5]!==p||i[6]!==b||i[7]!==c||i[8]!==u||i[9]!==l||i[10]!==f||i[11]!==r?(t=()=>{if(!r)return;let e=()=>{l({width:r.videoWidth,height:r.videoHeight}),s(r.duration),o(r.currentTime),c(r.playbackRate),u(r.readyState),h(r.readyState<3&&!r.paused),p(r.muted),f(r.volume),v(r.buffered.length>0?r.buffered:null),g(r.ended),b(r.paused)},t=["timeupdate","loadedmetadata","progress","play","pause","ratechange","volumechange","ended","loadeddata","resize","waiting","canplay","stalled"];return t.forEach(t=>r.addEventListener(t,e)),e(),()=>{console.log("Removing video event listeners"),t.forEach(t=>r.removeEventListener(t,e))}},i[0]=v,i[1]=h,i[2]=o,i[3]=s,i[4]=g,i[5]=p,i[6]=b,i[7]=c,i[8]=u,i[9]=l,i[10]=f,i[11]=r,i[12]=t):t=i[12],i[13]!==e||i[14]!==r?(n=[r,e],i[13]=e,i[14]=r,i[15]=n):n=i[15],(0,m.useEffect)(t,n)}(G.playbackInfo),function(){var e,t,n,i,r,l,s,o,c,u,h,p,f,v;let g,b,y,x,k,w,E,S,T=(0,a.c)(35),[,C]=(0,d.fp)(tl),j=(0,d.md)(N.k),_=j.playbackInfo,P=null==(e=j.playbackInfo)?void 0:e.streamType,F=null==(n=j.playbackInfo)||null==(t=n.media)?void 0:t.id,I=null==(i=j.playbackInfo)?void 0:i.streamType,D=(null==_||null==(r=_.episode)?void 0:r.progressNumber)||0,{data:L}=(0,e3._8)(F),{data:M,refetch:R}=(0,e2.L)(F);T[0]!==F||T[1]!==R?(g=()=>{F&&R()},T[0]=F,T[1]=R,T[2]=g):g=T[2],T[3]!==F||T[4]!==j.playbackInfo?(b=[j.playbackInfo,F],T[3]=F,T[4]=j.playbackInfo,T[5]=b):b=T[5],(0,ti.A)(g,b),null==L||L.episodes,null==M||M.episodes;e:{let e;if(!M){let e;T[6]===Symbol.for("react.memo_cache_sentinel")?(e=[],T[6]=e):e=T[6],y=e;break e}if("localfile"===P){let e;T[7]!==(null==L?void 0:L.episodes)?(e=null!=(s=null==L||null==(l=L.episodes)?void 0:l.filter(ts))?s:[],T[7]=null==L?void 0:L.episodes,T[8]=e):e=T[8],y=e;break e}T[9]!==(null==M?void 0:M.episodes)?(e=null!=(o=null==M?void 0:M.episodes)?o:[],T[9]=null==M?void 0:M.episodes,T[10]=e):e=T[10],y=e}let A=y;T[11]!==D||T[12]!==A?(x=null!=(u=null==(c=A.find)?void 0:c.call(A,e=>e.progressNumber===D))?u:null,T[11]=D,T[12]=A,T[13]=x):x=T[13];let O=x;T[14]!==D||T[15]!==A?(k=null!=(p=null==(h=A.find)?void 0:h.call(A,e=>e.progressNumber===D-1))?p:null,T[14]=D,T[15]=A,T[16]=k):k=T[16];let U=k;T[17]!==D||T[18]!==A?(w=null!=(v=null==(f=A.find)?void 0:f.call(A,e=>e.progressNumber===D+1))?v:null,T[17]=D,T[18]=A,T[19]=w):w=T[19];let z=w;T[20]!==L||T[21]!==O||T[22]!==A||T[23]!==I||T[24]!==z||T[25]!==_||T[26]!==U||T[27]!==C?(E=()=>{if(!_||!O||!A.length||!L)return void C(null);C({type:I,episodes:null!=A?A:[],currentEpisode:O,previousEpisode:U,nextEpisode:z,animeEntry:L})},T[20]=L,T[21]=O,T[22]=A,T[23]=I,T[24]=z,T[25]=_,T[26]=U,T[27]=C,T[28]=E):E=T[28],T[29]!==L||T[30]!==O||T[31]!==z||T[32]!==_||T[33]!==U?(S=[L,_,O,U,z],T[29]=L,T[30]=O,T[31]=z,T[32]=_,T[33]=U,T[34]=S):S=T[34],m.useEffect(E,S)}();let ex=(0,m.useRef)(!1),ek=(0,m.useRef)(null),[,ew]=(0,d.fp)(nn),[eE,eS]=(0,d.fp)(ni),[eT,eC]=(0,d.fp)(na),[e_,eF]=(0,d.fp)(nr),[eI,eD]=(0,d.fp)(nl),[eM,eA]=(0,d.fp)(eu),eO=(0,d.Xr)(ed),[ez,eV]=(0,d.fp)(I),eB=(0,d.Xr)(t0),[eX,eq]=(0,d.fp)(eZ),e$=(0,d.Xr)(nu),eY=(0,d.md)(L.gw),[eJ,e0]=(0,d.fp)(t7),[e4,e5]=(0,d.fp)(ne),[e6,e8]=(0,d.fp)(tJ),e7=(0,d.md)(tH);(0,d.md)(t0);let te=(0,d.md)(t8);(0,d.md)(tY);let tt=(0,d.md)(L.gI),tn=(0,d.md)(t1),tr=(0,d.Xr)(v),tu=(0,d.Xr)(nu),tm=(0,d.md)(t9),[th,tp]=(0,d.fp)(nc),[tv,tg]=(0,d.fp)(nd),[tb]=(0,d.fp)(L.O_),[tx]=(0,d.fp)(L.e4),[tk]=(0,d.fp)(L.kF),[tw]=(0,d.fp)(L.bM),[tE]=(0,d.fp)(L.cW),[tS,tM]=(0,d.fp)(L.Gn),{mutate:tA}=(0,s.sq)(),{mutate:tO}=(0,s.Bv)(),{mutate:tK}=(0,s.P6)();m.useEffect(()=>{let e=setInterval(()=>{var e,t,n,i,a,r,l,s,o,c;ef.current&&(null==W||null==(t=W.settings)||null==(e=t.discord)?void 0:e.enableRichPresence)&&(null==W||null==(i=W.settings)||null==(n=i.discord)?void 0:n.enableAnimeRichPresence)&&tO({progress:Math.floor(null!=(s=null==(a=ef.current)?void 0:a.currentTime)?s:0),duration:Math.floor(null!=(o=null==(r=ef.current)?void 0:r.duration)?o:0),paused:null!=(c=null==(l=ef.current)?void 0:l.paused)&&c})},6e3);return()=>clearInterval(e)},[null==W||null==(t=W.settings)?void 0:t.discord,ef.current]);let[tX,{width:t2,height:t3}]=(0,tV.A)();m.useEffect(()=>{ey({width:t2,height:t3})},[t2,t3]);let t5=(0,tL.jE)();function ns(){var e,t,n;(null==ef||null==(e=ef.current)?void 0:e.paused)?(null==ef||null==(t=ef.current)||t.play(),null==J||J(),tr({message:"PLAY",type:"icon"})):(null==ef||null==(n=ef.current)||n.pause(),null==Z||Z(),tr({message:"PAUSE",type:"icon"}))}m.useEffect(()=>{t5.invalidateQueries({queryKey:[l.S.CONTINUITY.GetContinuityWatchHistory.key]}),t5.invalidateQueries({queryKey:[l.S.CONTINUITY.GetContinuityWatchHistoryItem.key]}),G.playbackInfo&&G.playbackInfo.id===ek.current||tK()},[G.playbackInfo]),m.useEffect(()=>{G.active&&ef.current&&G.playbackInfo&&setTimeout(()=>{var e;null==(e=ef.current)||e.focus()},100)},[G.active]),(0,tI.w5)(()=>{if(!G.playbackInfo){var e,t,n,i,a;tB.info("Cleaning up"),ef.current&&(ef.current.pause(),ef.current.removeAttribute("src"),ef.current.load(),ef.current=null),eb(null),null==eE||null==(e=eE.destroy)||e.call(eE),eS(null),null==e_||null==(t=e_.cleanup)||t.call(e_),eF(null),eC(null),null==eI||null==(n=eI.destroy)||n.call(eI),eD(null),null==eM||null==(i=eM.destroy)||i.call(eM),eA(null),eO(null),null==ez||null==(a=ez.destroy)||a.call(ez),eV(null),eB(!1),n_(0),eX&&(eX.setVideo(null),eX.destroy()),eq(null),ek.current=null,ef.current=null}G.playbackInfo&&(!ek.current||G.playbackInfo.id!==ek.current)&&(tB.info("New stream loaded"),eg(ef.current))},[G.playbackInfo,ef.current]);let nm=null==G||null==(u=G.playbackInfo)||null==(c=u.streamUrl)||null==(n=c.replace)?void 0:n.call(c,"{{SERVER_URL}}",(0,r.M)()),[nh,nf]=(0,d.fp)(k),{playEpisode:nv}=to(),[ng,nb]=m.useState(!1),ny=(0,d.md)(ee);m.useEffect(()=>{if(ny)return void nb(!0);let e=setTimeout(()=>{nb(!1)},800);return()=>{clearTimeout(e)}},[ny]);let nx=m.useRef(0),nk=e=>{if(tB.info("Video clicked"),"click"===e.type&&(ng||ns(),setTimeout(()=>{e5(!1)},100)),"contextmenu"===e.type){let e=Date.now();nx.current&&e-nx.current<500&&(null==ez||ez.toggleFullscreen()),nx.current=e}};m.useEffect(()=>{ef.current&&void 0!==tw&&tw!==ef.current.volume&&(ef.current.volume=tw)},[tw,ef.current]),m.useEffect(()=>{ef.current&&void 0!==tE&&tE!==ef.current.muted&&(ef.current.muted=tE)},[tE,ef.current]),m.useEffect(()=>{ef.current&&void 0!==tS&&tS!==ef.current.playbackRate&&(ef.current.playbackRate=tS)},[tS,ef.current]),m.useEffect(()=>{eM&&ef.current&&G.playbackInfo&&(eM.setVideo(ef.current,G.playbackInfo),eE&&eM.setSubtitleManager(eE))},[eM,eE,ef.current,G.playbackInfo]),m.useEffect(()=>{ez&&ev.current&&ez.setContainer(ev.current)},[ez,ev.current]),m.useEffect(()=>{eX&&ef.current&&G.playbackInfo&&G.active?(eX.setVideo(ef.current),eX.setPlaybackInfo(G.playbackInfo),eX.activate()):eX&&!G.active&&(tB.info("Video inactive, deactivating media session"),eX.deactivate())},[eX,ef.current,G.playbackInfo,G.active,nv]),m.useEffect(()=>()=>{tB.info("VideoCore unmounting, cleaning up media session"),eX&&(eX.setVideo(null),eX.destroy())},[eX]);let nw=m.useRef(null),nE=m.useRef({x:0,y:0}),nS=(0,m.useMemo)(()=>{var e,t,n,i,a,r;if(!e7||e7<=1)return[];if(null==(n=G.playbackInfo)||null==(t=n.mkvMetadata)||null==(e=t.chapters)?void 0:e.length){let e=eh(G.playbackInfo.mkvMetadata.chapters,e7);return tB.info("Chapter cues from MKV",e),e}if((null==q||null==(i=q.op)?void 0:i.interval)&&e7>0){let e=eh(function(e,t,n){var i,a,r,l,s,o,c,d,u,m,h;if(!(null==e||null==(i=e.op)?void 0:i.interval)||t<=0)return[];let p=[];return((null==e||null==(a=e.op)?void 0:a.interval)&&p.push({uid:91,start:e.op.interval.startTime>5?e.op.interval.startTime:0,end:e.op.interval.endTime,text:"Opening"}),(null==e||null==(r=e.ed)?void 0:r.interval)&&p.push({uid:92,start:e.ed.interval.startTime,end:e.ed.interval.endTime,text:"Ending"}),0===p.length)?[]:((null==(s=e.op)||null==(l=s.interval)?void 0:l.startTime)>5&&p.push({uid:90,start:0,end:e.op.interval.startTime,text:"Prologue"}),p.push({uid:93,start:(null==(c=e.op)||null==(o=c.interval)?void 0:o.endTime)||0,end:(null==(u=e.ed)||null==(d=u.interval)?void 0:d.startTime)||t,text:"MOVIE"!==n?"Episode":"Movie"}),(null==(h=e.ed)||null==(m=h.interval)?void 0:m.endTime)&&e.ed.interval.endTime<t-5&&p.push({uid:94,start:e.ed.interval.endTime,end:t,text:t-e.ed.interval.endTime>30?"Ending":"Preview"}),p.sort((e,t)=>e.start-t.start),p.length>0&&(p[p.length-1].end=t),p=p.map((e,n)=>({...e,start:1e6*e.start,end:e.end?n===p.length-1?1e6*t:1e6*e.end:void 0})))}(q,e7,null==G||null==(r=G.playbackInfo)||null==(a=r.media)?void 0:a.format),e7);return tB.info("Chapter cues from AniSkip",e),e}return[]},[null==(f=G.playbackInfo)||null==(p=f.mkvMetadata)?void 0:p.chapters,null==q||null==(b=q.op)?void 0:b.interval,null==q||null==(y=q.ed)?void 0:y.interval,e7,null==G||null==(E=G.playbackInfo)||null==(x=E.media)?void 0:x.format]),nT=(0,m.useCallback)(async e=>{var t,n,i,a;e.preventDefault(),tB.info("Upload event",e);let r=[...null!=(i=null==(t=null!=(n=e.dataTransfer)?n:e.clipboardData)?void 0:t.items)?i:[]],l=r.filter(e=>"file"===e.kind).map(e=>e.getAsFile()).filter(e=>null!==e);if(l.length>0){for(let e of l)if(e&&(a=e.name,/\.srt$|\.ass$|\.ssa$|\.vtt$|\.txt$|\.ttml$|\.stl$/i.test(a))){let t=await e.text();ec({name:e.name,content:t})}}else{let e=r.filter(e=>"string"===e.kind&&"text/plain"===e.type);e.length>0&&e[0].getAsString(e=>{tB.info("Uploading subtitle content from clipboard");let t=function(e){let t=e.trim();return/^\[Script Info\]/im.test(t)||/^\[V4\+ Styles\]/im.test(t)||/^\[V4 Styles\]/im.test(t)?"ass":/^(?:\uFEFF)?WEBVTT\b/im.test(t)?"vtt":/^<\?xml[\s\S]*?<tt[:\s>]/im.test(t)||/^<tt[:\s>]/im.test(t)?"ttml":/^\{\d+\}/m.test(t)?"stl":/^\d+\s*\n\s*\d{2}:\d{2}:\d{2},\d{3}\s*-->\s*\d{2}:\d{2}:\d{2},\d{3}/m.test(t)||/\d{2}:\d{2}:\d{2},\d{3}\s*-->\s*\d{2}:\d{2}:\d{2},\d{3}/.test(t)?"srt":/\d{2}:\d{2}:\d{2}\.\d{3}\s*-->\s*\d{2}:\d{2}:\d{2}\.\d{3}/.test(t)?"vtt":/\d{2}:\d{2}:\d{2},\d{3}\s*-->\s*\d{2}:\d{2}:\d{2},\d{3}/.test(t)?"srt":"unknown"}(e);if(tB.info("Detected subtitle type",t),"unknown"===t){ta.oR.error("Unknown subtitle type"),tB.info("Unknown subtitle type, skipping");return}ec({name:"PLACEHOLDER.".concat(t),content:e})})}},[]);function nC(e){e.preventDefault()}(0,m.useEffect)(()=>{let e=ev.current;if(e&&G.active)return e.addEventListener("paste",nT),e.addEventListener("drop",nT),e.addEventListener("dragover",nC),e.addEventListener("dragenter",nC),()=>{e.removeEventListener("paste",nT),e.removeEventListener("drop",nT),e.removeEventListener("dragover",nC),e.removeEventListener("dragenter",nC)}},[nT,G.active]);let[nj,n_]=(0,d.fp)(no);return m.useEffect(()=>{if(eI&&nj&&("off"===nh||null!==eI.canvas?(tr({message:"Progress restored",duration:1500}),tu({type:"seekTo",payload:{time:nj}})):"off"!==nh&&(tr({message:"Restoring progress",duration:1500}),eI.registerOnCanvasCreatedOnce(()=>{tu({type:"seekTo",payload:{time:nj}})})),n_(0),tx)){var e;null==(e=ef.current)||e.play()}},[eI,nh,nj,tx]),(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(tR.Ui,{atoms:[e9.N7,e9.Io,t_.l],children:[(0,i.jsx)(w,{}),(0,i.jsx)(K,{}),G.active&&!eJ&&(0,i.jsx)(tz.jp,{}),(0,i.jsx)(tP.d5,{isNativePlayerComponent:"overlay",show:G.active&&eJ}),(0,i.jsxs)(eQ,{open:G.active,onOpenChange:e=>{e||(eJ?$():(e0(!0),null==ez||ez.exitFullscreen()))},borderToBorder:!0,miniPlayer:eJ,size:eJ?"md":"full",side:eJ?"right":"bottom",contentClass:(0,o.cn)("p-0 m-0",!eJ&&"h-full"),allowOutsideInteraction:!0,overlayClass:(0,o.cn)(eJ&&"hidden"),hideCloseButton:!0,closeClass:(0,o.cn)("z-[99]",eH.X&&!eJ&&"top-8",eJ&&"left-4"),"data-native-player-drawer":!0,onMiniPlayerClick:()=>{ns()},children:[(0,i.jsx)(tP.d5,{isNativePlayerComponent:"top-section",show:!eJ&&!((null==(S=G.playbackInfo)?void 0:S.streamUrl)&&!G.loadingState)}),(null==G?void 0:G.playbackError)&&(0,i.jsx)("div",{className:"h-full w-full bg-black/100 flex items-center justify-center z-[20] absolute p-4",children:(0,i.jsxs)("div",{className:"text-white text-center",children:[eJ?(0,i.jsx)("h1",{className:(0,o.cn)("text-2xl font-bold",eJ&&"text-lg"),children:"Playback Error"}):(0,i.jsx)(tF.D,{title:"Playback Error"}),(0,i.jsx)("p",{className:(0,o.cn)("text-base text-white/50 max-w-xl",eJ&&"text-sm max-w-lg mx-auto"),children:G.playbackError||"An error occurred while playing the stream. Please try again later."})]})}),(0,i.jsx)("div",{ref:e=>{ev.current=e,ew(e)},className:(0,o.cn)("relative w-full h-full bg-black overflow-clip flex items-center justify-center",!e4&&!eJ&&"cursor-none"),onPointerMove:e=>{let{x:t,y:n}=e.nativeEvent,i=t-nE.current.x,a=n-nE.current.y;15>Math.abs(i)&&15>Math.abs(a)||((null==nw?void 0:nw.current)&&clearTimeout(nw.current),e5(!0),nw.current=setTimeout(()=>{tm||e5(!1)},1e3),nE.current={x:t,y:n})},children:(null==(T=G.playbackInfo)?void 0:T.streamUrl)&&!G.loadingState?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(H,{videoRef:ef,active:G.active,chapterCues:null!=nS?nS:[],introStartTime:null==q||null==(_=q.op)||null==(C=_.interval)?void 0:C.startTime,introEndTime:null==q||null==(R=q.op)||null==(F=R.interval)?void 0:F.endTime,endingStartTime:null==q||null==(O=q.ed)||null==(A=O.interval)?void 0:A.startTime,endingEndTime:null==q||null==(z=q.ed)||null==(U=z.interval)?void 0:U.endTime}),(0,i.jsx)(g,{}),e6&&(0,i.jsx)("div",{className:"absolute inset-0 flex items-center justify-center z-[50] pointer-events-none",children:(0,i.jsx)("div",{className:"bg-black/20 backdrop-blur-sm rounded-full p-4",children:(0,i.jsx)(h.zhB,{className:"size-12 text-white animate-spin"})})}),e4&&(0,i.jsxs)(i.Fragment,{children:[!!th&&!eJ&&(0,i.jsx)("div",{className:"absolute left-5 bottom-28 z-[60] native-player-hide-on-fullscreen",children:(0,i.jsx)(M.$n,{size:"sm",intent:"gray-basic",onClick:e=>{e.stopPropagation(),e$({type:"seekTo",payload:{time:th||0}})},onPointerMove:e=>e.stopPropagation(),children:"Skip Opening"})}),!!tv&&!eJ&&(0,i.jsx)("div",{className:"absolute right-5 bottom-28 z-[60] native-player-hide-on-fullscreen",children:(0,i.jsx)(M.$n,{size:"sm",intent:"gray-basic",onClick:e=>{e.stopPropagation(),e$({type:"seekTo",payload:{time:tv||0}})},onPointerMove:e=>e.stopPropagation(),children:"Skip Ending"})})]}),(0,i.jsx)("div",{className:"relative w-full h-full flex items-center justify-center",onClick:nk,onContextMenu:nk,children:(0,i.jsx)("video",{"data-video-core-element":!0,crossOrigin:"anonymous",preload:"auto",src:nm,ref:e=>{ef.current=e,e&&tX(e),eb(e)},onLoadedMetadata:e=>{var t,n,i,a,r,l,s,o,c,d,u,m,h,p,f,v,g,b,y,x,k,w,E,S,T,C,_;if(null==ei||ei(),!ef.current)return;let N=ef.current;if(tB.info("Loaded metadata",N.duration),tB.info("Audio tracks",N.audioTracks),tB.info("Text tracks",N.textTracks),tp(null),tg(null),tB.info("Subtitles changed",null==(T=ef.current)?void 0:T.textTracks),ef.current){let e=!1;for(let t=0;t<ef.current.textTracks.length;t++){let n=ef.current.textTracks[t];"showing"===n.mode&&(null==eE||eE.selectTrack(Number(n.id)),e=!0)}e||null==eE||eE.setNoTrack()}if(tB.info("Audio changed",null==(C=ef.current)?void 0:C.audioTracks),null==(_=ef.current)?void 0:_.audioTracks)for(let e=0;e<ef.current.audioTracks.length;e++){let t=ef.current.audioTracks[e];if(t.enabled){null==eT||eT.selectTrack(Number(t.id));break}}if(e$({type:"seek",payload:{time:-1}}),ex.current=!1,G.playbackInfo&&(ek.current=G.playbackInfo.id,(null==(t=G.playbackInfo)?void 0:t.mkvMetadata)&&(eS(e=>(e&&e.destroy(),new tf({videoElement:N,playbackInfo:G.playbackInfo,jassubOffscreenRender:!0,settings:eY}))),eC(new P({videoElement:N,playbackInfo:G.playbackInfo,settings:eY,onError:e=>{tB.error("Audio manager error",e),null==es||es(e)}}))),eD(e=>(e&&e.destroy(),new j({videoElement:N,settings:eY,onFallback:e=>{tr({message:e,duration:2e3})},onOptionChanged:e=>{console.warn("here",e),nf(e)}}))),eA(e=>{e&&e.destroy();let t=new em(e=>{eO(e)});return t.setVideo(N,G.playbackInfo),t}),eV(e=>(e&&e.destroy(),new D(e=>{eB(e)}))),eq(e=>{e&&e.destroy();let t=new e1;return t.on("media-play-request",()=>{var e;(null==(e=ef.current)?void 0:e.paused)&&ef.current.play().catch(e=>{tB.error("Failed to play video from media session",e)})}),t.on("media-pause-request",()=>{ef.current&&!ef.current.paused&&ef.current.pause()}),t.on("media-seek-request",e=>{let{seekTime:t}=e.detail;e$({type:"seekTo",payload:{time:t}})}),t.setPlaybackInfo(G.playbackInfo),t.setVideo(N),t}),tB.info("Initializing preview manager"),eF(e=>(e&&e.cleanup(),new td(N,nm))),(null==W||null==(i=W.settings)||null==(n=i.discord)?void 0:n.enableRichPresence)&&(null==W||null==(r=W.settings)||null==(a=r.discord)?void 0:a.enableAnimeRichPresence)&&(null==(s=G.playbackInfo)||null==(l=s.media)?void 0:l.id)&&(null==(c=G.playbackInfo)||null==(o=c.episode)?void 0:o.progressNumber))){let e=G.playbackInfo.media,t=null!=(k=null==(d=ef.current)?void 0:d.currentTime)?k:0,n=null!=(w=null==(u=ef.current)?void 0:u.duration)?w:0;tB.info("Setting discord activity",{videoProgress:t,videoDuration:n}),tA({mediaId:null!=(E=null==e?void 0:e.id)?E:0,title:(null==e||null==(m=e.title)?void 0:m.userPreferred)||(null==e||null==(h=e.title)?void 0:h.romaji)||(null==e||null==(p=e.title)?void 0:p.english)||"Watching",image:(null==e||null==(f=e.coverImage)?void 0:f.large)||(null==e||null==(v=e.coverImage)?void 0:v.medium)||"",isMovie:(null==e?void 0:e.format)==="MOVIE",episodeNumber:null!=(S=null==(b=G.playbackInfo)||null==(g=b.episode)?void 0:g.progressNumber)?S:0,progress:Math.floor(t),duration:Math.floor(n),totalEpisodes:null==e?void 0:e.episodes,currentEpisodeCount:(null==e||null==(y=e.nextAiringEpisode)?void 0:y.episode)?(null==e||null==(x=e.nextAiringEpisode)?void 0:x.episode)-1:null==e?void 0:e.episodes,episodeTitle:G.playbackInfo.episode.episodeTitle||void 0})}},onTimeUpdate:e=>{if(null==et||et(),!ef.current)return;let t=ef.current,n=t.currentTime/t.duration;t.duration&&!ex.current&&n>=.8&&(ex.current=!0,null==Q||Q())},onEnded:e=>{tB.info("Video ended"),null==Y||Y(),tb&&nv("next")},onPlay:e=>{tB.info("Video resumed"),null==J||J()},onPause:e=>{tB.info("Video paused"),null==Z||Z()},onDoubleClick:e=>{},onLoadedData:e=>{tB.info("Loaded data"),null==en||en(),ef.current&&tx&&ef.current.play().catch()},onVolumeChange:e=>{let t=e.currentTarget;tB.info("Volume changed",t.volume),null==ea||ea()},onRateChange:e=>{let t=e.currentTarget;tB.info("Playback rate changed",t.playbackRate),null==eo||eo(),t.playbackRate!==tS&&tM(t.playbackRate)},onError:e=>{null==es||es("")},onWaiting:e=>{e8(!0)},onCanPlay:e=>{e8(!1)},onStalled:e=>{e8(!0)},autoPlay:tx,muted:tE,playsInline:!0,controls:!1,style:{border:"none",width:"100%",height:"100%",objectFit:"contain",objectPosition:"center",filter:eY.videoEnhancement.enabled&&tt?"contrast(".concat(eY.videoEnhancement.contrast,") saturate(").concat(eY.videoEnhancement.saturation,") brightness(").concat(eY.videoEnhancement.brightness,")"):"none",imageRendering:"crisp-edges"},children:null==(X=G.playbackInfo)||null==(B=X.mkvMetadata)||null==(V=B.subtitleTracks)?void 0:V.map(e=>(0,i.jsx)("track",{id:e.number.toString(),kind:"subtitles",srcLang:e.language||"eng",label:e.name},e.number))})}),(0,i.jsxs)(tT,{children:[(0,i.jsx)(tC,{state:G}),(0,i.jsx)("div",{className:(0,o.cn)("opacity-0","transition-opacity duration-200 ease-in-out",(e4||te)&&"opacity-100"),children:(0,i.jsx)(np,{part:"video",onTerminateStream:$})})]}),tn&&(0,i.jsx)("div",{className:"absolute top-0 left-0 w-full h-full z-[100] bg-black flex items-center justify-center",children:(0,i.jsx)(M.$n,{intent:"gray-outline",size:"xl",onClick:()=>{null==eM||eM.togglePip()},children:"Exit PiP"})}),(0,i.jsxs)(ej,{timeRange:(0,i.jsx)(ty,{chapterCues:null!=nS?nS:[]}),children:[(0,i.jsx)(eP,{}),(0,i.jsx)(tc,{}),(0,i.jsx)(eN,{}),(0,i.jsx)(eL,{}),(0,i.jsx)("div",{className:"flex flex-1"}),(0,i.jsx)(tP.d5,{isNativePlayerComponent:"control-bar",show:!eJ}),(0,i.jsx)(eK,{}),(0,i.jsx)(eR,{}),(0,i.jsx)(eU,{}),(0,i.jsx)(eW,{}),(0,i.jsx)(eG,{})]})]}):(0,i.jsxs)("div",{className:"w-full h-full absolute flex justify-center items-center flex-col space-y-4 bg-black rounded-md",children:[(0,i.jsx)(np,{part:"loading",onTerminateStream:$}),G.loadingState&&(0,i.jsx)(tD.kt,{title:G.loadingState||"Loading...",spinner:(0,i.jsx)(tU.kiM,{className:"size-20 text-white animate-spin"}),containerClass:"z-[1]"}),!eJ&&(0,i.jsx)("div",{className:"opacity-50 absolute inset-0 z-[0] overflow-hidden",children:(0,i.jsx)(tN.N,{duration:10,breathingRange:5})})]})})]})]})})}function np(e){let t,n,r=(0,a.c)(13),{part:l,onTerminateStream:s}=e,c=(0,d.md)(t0),[u,m]=(0,d.fp)(t7);if(c)return null;r[0]!==u||r[1]!==s||r[2]!==m?(t=()=>(0,i.jsxs)(i.Fragment,{children:[!u&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(M.K0,{icon:(0,i.jsx)(tO.eDi,{className:"text-2xl"}),intent:"gray-basic",className:"rounded-full absolute top-0 flex-none right-4 z-[999]",onClick:()=>{m(!0)}})}),u&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(M.K0,{type:"button",intent:"gray",size:"sm",className:(0,o.cn)("rounded-full text-2xl flex-none absolute z-[999] right-4 top-4 pointer-events-auto bg-black/30 hover:bg-black/40",u&&"text-xl"),icon:(0,i.jsx)(tA.uSl,{}),onClick:()=>{m(!1)}}),(0,i.jsx)(M.K0,{type:"button",intent:"alert-subtle",size:"sm",className:(0,o.cn)("rounded-full text-2xl flex-none absolute z-[999] left-4 top-4 pointer-events-auto",u&&"text-xl"),icon:(0,i.jsx)(tA.Gsv,{}),onClick:()=>{s()}})]})]}),r[0]=u,r[1]=s,r[2]=m,r[3]=t):t=r[3];let h=t;if("loading"===l){let e,t,n,a=u&&"top-0";return r[4]!==a?(e=(0,o.cn)("absolute top-8 w-full z-[100]",a),r[4]=a,r[5]=e):e=r[5],r[6]!==h?(t=(0,i.jsx)(h,{}),r[6]=h,r[7]=t):t=r[7],r[8]!==e||r[9]!==t?(n=(0,i.jsx)("div",{className:e,children:t}),r[8]=e,r[9]=t,r[10]=n):n=r[10],n}return r[11]!==h?(n=(0,i.jsx)(h,{}),r[11]=h,r[12]=n):n=r[12],n}},51532:(e,t,n)=>{n.d(t,{Eb:()=>a,Gn:()=>v,O_:()=>u,RR:()=>o,Rk:()=>l,ZM:()=>s,bM:()=>p,cW:()=>f,e4:()=>m,gI:()=>d,gw:()=>r,kF:()=>h,y2:()=>c});var i=n(21842);let a={preferredSubtitleLanguage:"en,eng",preferredAudioLanguage:"jpn,jp,jap",videoEnhancement:{enabled:!0,contrast:1.05,saturation:1.1,brightness:1.02}},r=(0,i.tG)("sea-video-core-settings",a,void 0,{getOnInit:!0}),l={seekForward:{key:"KeyD",value:30},seekBackward:{key:"KeyA",value:30},seekForwardFine:{key:"ArrowRight",value:2},seekBackwardFine:{key:"ArrowLeft",value:2},nextChapter:{key:"KeyE"},previousChapter:{key:"KeyQ"},volumeUp:{key:"ArrowUp",value:5},volumeDown:{key:"ArrowDown",value:5},mute:{key:"KeyM"},cycleSubtitles:{key:"KeyJ"},cycleAudio:{key:"KeyK"},nextEpisode:{key:"KeyN"},previousEpisode:{key:"KeyB"},fullscreen:{key:"KeyF"},pictureInPicture:{key:"KeyP"},increaseSpeed:{key:"BracketRight",value:.1},decreaseSpeed:{key:"BracketLeft",value:.1},takeScreenshot:{key:"KeyI"}},s=(0,i.tG)("sea-video-core-keybindings",l,void 0,{getOnInit:!0}),o=(0,i.tG)("sea-video-core-chapter-markers",!0,void 0,{getOnInit:!0}),c=(0,i.tG)("sea-video-core-highlight-op-ed-chapters",!0,void 0,{getOnInit:!0}),d=(0,i.tG)("sea-video-core-increase-saturation",!1,void 0,{getOnInit:!0}),u=(0,i.tG)("sea-video-core-auto-next",!0,void 0,{getOnInit:!0}),m=(0,i.tG)("sea-video-core-auto-play",!0,void 0,{getOnInit:!0}),h=(0,i.tG)("sea-video-core-auto-skip-op-ed",!1,void 0,{getOnInit:!0}),p=(0,i.tG)("sea-video-core-volume",1,void 0,{getOnInit:!0}),f=(0,i.tG)("sea-video-core-muted",!1,void 0,{getOnInit:!0}),v=(0,i.tG)("sea-video-core-playback-rate",1,void 0,{getOnInit:!0})},55226:(e,t,n)=>{function i(e){return(navigator.userAgent||"").includes(e)}function a(){return navigator.vendor.includes("Apple")&&!function(){return i("Tizen")}()}n.d(t,{Fr:()=>r,f8:()=>a});function r(){let e="";return navigator.userAgent&&(e=navigator.userAgent),!!/iPhone|iPad|iPod|Android/.test(e)||a()&&navigator.maxTouchPoints>1}},58036:(e,t,n)=>{n.d(t,{N:()=>s});var i=n(95155),a=n(19749),r=n(84218),l=n(12115);let s=e=>{let t,n,s,o,c,d,u,m,h,p=(0,a.c)(21),{startingGap:f,Breathing:v,gradientColors:g,gradientStops:b,animationSpeed:y,breathingRange:x,topOffset:k,containerClassName:w,duration:E}=e,S=void 0===f?125:f,T=void 0===v||v;p[0]!==g?(t=void 0===g?["transparent","#312887","#3D5AFE","#FF80AB","#FF6D00","#FFD600","#00E676"]:g,p[0]=g,p[1]=t):t=p[1];let C=t;p[2]!==b?(n=void 0===b?[35,50,60,70,80,90,100]:b,p[2]=b,p[3]=n):n=p[3];let j=n,_=void 0===y?.02:y,P=void 0===x?5:x,N=void 0===k?0:k,F=void 0===E?2:E;if(C.length!==j.length)throw Error("GradientColors and GradientStops must have the same length.\n     Received gradientColors length: ".concat(C.length,",\n     gradientStops length: ").concat(j.length));let I=(0,l.useRef)(null);p[4]!==T||p[5]!==_||p[6]!==P||p[7]!==C||p[8]!==j||p[9]!==S||p[10]!==N?(s=()=>{let e,t,n;t=S,n=1;let i=()=>{t>=S+P&&(n=-1),t<=S-P&&(n=1),T||(n=0),t+=n*_;let a=j.map((e,t)=>"".concat(C[t]," ").concat(e,"%")).join(", "),r="radial-gradient(".concat(t,"% ").concat(t+N,"% at 50% 20%, ").concat(a,")");I.current&&(I.current.style.background=r),e=requestAnimationFrame(i)};return e=requestAnimationFrame(i),()=>cancelAnimationFrame(e)},o=[S,T,C,j,_,P,N],p[4]=T,p[5]=_,p[6]=P,p[7]=C,p[8]=j,p[9]=S,p[10]=N,p[11]=s,p[12]=o):(s=p[11],o=p[12]),(0,l.useEffect)(s,o),p[13]===Symbol.for("react.memo_cache_sentinel")?(c={opacity:0,scale:1.5},p[13]=c):c=p[13],p[14]===Symbol.for("react.memo_cache_sentinel")?(d=[.25,.1,.25,1],p[14]=d):d=p[14],p[15]!==F?(u={opacity:.2,scale:1,transition:{duration:F,ease:d}},p[15]=F,p[16]=u):u=p[16];let D="absolute inset-0 z-[0] overflow-hidden ".concat(void 0===w?"":w);return p[17]===Symbol.for("react.memo_cache_sentinel")?(m=(0,i.jsx)("div",{ref:I,className:"absolute inset-0 transition-transform"}),p[17]=m):m=p[17],p[18]!==u||p[19]!==D?(h=(0,i.jsx)(r.P.div,{initial:c,animate:u,className:D,children:m},"animated-gradient-background"),p[18]=u,p[19]=D,p[20]=h):h=p[20],h}}}]);