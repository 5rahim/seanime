(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2076],{7013:(e,t,n)=>{"use strict";n.d(t,{JW:()=>d,M$:()=>m,Ok:()=>u});var a=n(19749),l=n(7675),i=n(74889),r=n(35349),s=n(46278),o=n(29724),c=n(69554);function d(){let e,t,n=(0,a.c)(4),c=(0,s.jE)(),d=(0,o.Xr)(r.Q);return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.SETTINGS.GettingStarted.key],n[0]=e):e=n[0],n[1]!==c||n[2]!==d?(t={endpoint:i.S.SETTINGS.GettingStarted.endpoint,method:i.S.SETTINGS.GettingStarted.methods[0],mutationKey:e,onSuccess:async()=>{await c.invalidateQueries({queryKey:[i.S.SETTINGS.GetSettings.key]}),await c.invalidateQueries({queryKey:[i.S.STATUS.GetStatus.key]}),d(!0)}},n[1]=c,n[2]=d,n[3]=t):t=n[3],(0,l.qk)(t)}function u(){let e,t,n=(0,a.c)(3),r=(0,s.jE)();return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.SETTINGS.SaveSettings.key],n[0]=e):e=n[0],n[1]!==r?(t={endpoint:i.S.SETTINGS.SaveSettings.endpoint,method:i.S.SETTINGS.SaveSettings.methods[0],mutationKey:e,onSuccess:async()=>{await r.invalidateQueries({queryKey:[i.S.SETTINGS.GetSettings.key]}),await r.invalidateQueries({queryKey:[i.S.STATUS.GetStatus.key]}),c.oR.success("Settings saved")}},n[1]=r,n[2]=t):t=n[2],(0,l.qk)(t)}function m(){let e,t,n=(0,a.c)(3),r=(0,s.jE)();return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.SETTINGS.SaveAutoDownloaderSettings.key],n[0]=e):e=n[0],n[1]!==r?(t={endpoint:i.S.SETTINGS.SaveAutoDownloaderSettings.endpoint,method:i.S.SETTINGS.SaveAutoDownloaderSettings.methods[0],mutationKey:e,onSuccess:async()=>{await r.invalidateQueries({queryKey:[i.S.SETTINGS.GetSettings.key]}),await r.invalidateQueries({queryKey:[i.S.STATUS.GetStatus.key]}),c.oR.success("Settings saved")}},n[1]=r,n[2]=t):t=n[2],(0,l.qk)(t)}},15044:(e,t,n)=>{"use strict";n.d(t,{Gd:()=>s,Gm:()=>c,H2:()=>o});var a=n(19749),l=n(7675),i=n(74889),r=n(46278);function s(){let e,t=(0,a.c)(1);return t[0]===Symbol.for("react.memo_cache_sentinel")?(e={endpoint:i.S.LIBRARY_EXPLORER.GetLibraryExplorerFileTree.endpoint,method:i.S.LIBRARY_EXPLORER.GetLibraryExplorerFileTree.methods[0],queryKey:[i.S.LIBRARY_EXPLORER.GetLibraryExplorerFileTree.key],enabled:!0},t[0]=e):e=t[0],(0,l.fl)(e)}function o(){let e,t,n=(0,a.c)(3),s=(0,r.jE)();return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.LIBRARY_EXPLORER.RefreshLibraryExplorerFileTree.key],n[0]=e):e=n[0],n[1]!==s?(t={endpoint:i.S.LIBRARY_EXPLORER.RefreshLibraryExplorerFileTree.endpoint,method:i.S.LIBRARY_EXPLORER.RefreshLibraryExplorerFileTree.methods[0],mutationKey:e,onSuccess:async()=>{s.invalidateQueries({queryKey:[i.S.LIBRARY_EXPLORER.GetLibraryExplorerFileTree.key]})}},n[1]=s,n[2]=t):t=n[2],(0,l.qk)(t)}function c(){let e,t,n=(0,a.c)(3),s=(0,r.jE)();return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.LOCALFILES.SuperUpdateLocalFiles.key],n[0]=e):e=n[0],n[1]!==s?(t={endpoint:i.S.LOCALFILES.SuperUpdateLocalFiles.endpoint,method:i.S.LOCALFILES.SuperUpdateLocalFiles.methods[0],mutationKey:e,onSuccess:async()=>{s.invalidateQueries({queryKey:[i.S.LIBRARY_EXPLORER.GetLibraryExplorerFileTree.key]})}},n[1]=s,n[2]=t):t=n[2],(0,l.qk)(t)}},16629:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>rX,dynamic:()=>r$});var a=n(95155),l=n(19749),i=n(29648),r=n(14490),s=n(45754),o=n(52963),c=n(2091),d=n(6773),u=n(23862),m=n(29724),h=n(12115);function p(){let e,t,n,p,f,x,v,g,y=(0,l.c)(14),[b]=(0,m.fp)(i.gw),[j,w]=(0,h.useState)(0),[N,k]=(0,h.useState)("Scanning...");return(y[0]!==b?(e=()=>{b||(w(0),k("Scanning..."))},t=[b],y[0]=b,y[1]=e,y[2]=t):(e=y[1],t=y[2]),h.useEffect(e,t),y[3]===Symbol.for("react.memo_cache_sentinel")?(n={type:u.c.SCAN_PROGRESS,onMessage:e=>{console.log("Scan progress",e),w(e)}},y[3]=n):n=y[3],(0,r.oA)(n),y[4]===Symbol.for("react.memo_cache_sentinel")?(p={type:u.c.SCAN_STATUS,onMessage:e=>{console.log("Scan status",e),k(e)}},y[4]=p):p=y[4],(0,r.oA)(p),b)?(y[5]!==j?(f=(0,a.jsx)("div",{className:"w-full bg-gray-950 fixed top-0 left-0 z-[100]","data-scan-progress-bar-container":!0,children:(0,a.jsx)(d.z,{size:"xs",value:j})}),y[5]=j,y[6]=f):f=y[6],y[7]===Symbol.for("react.memo_cache_sentinel")?(x=(0,a.jsx)(c.y$,{className:"size-6"}),y[7]=x):x=y[7],y[8]!==j||y[9]!==N?(v=(0,a.jsx)("div",{className:"z-50 fixed bottom-4 right-4","data-scan-progress-bar-card-container":!0,children:(0,a.jsx)(s.f,{children:(0,a.jsx)(o.Zp,{className:"w-fit max-w-[400px] relative","data-scan-progress-bar-card":!0,children:(0,a.jsx)(o.aR,{children:(0,a.jsxs)(o.BT,{className:"flex items-center gap-2 text-base text-[--foregorund]",children:[x," ",j,"% - ",N]})})})})}),y[8]=j,y[9]=N,y[10]=v):v=y[10],y[11]!==f||y[12]!==v?(g=(0,a.jsxs)(a.Fragment,{children:[f,v]}),y[11]=f,y[12]=v,y[13]=g):g=y[13],g):null}var f=n(91360),x=n(42500);let v=(0,x.eU)(!1);function g(){let e,t,n=(0,l.c)(4),[i]=(0,m.fp)(v);return n[0]!==i?(e=i&&(0,a.jsx)("div",{className:(0,f.cn)("error-explainer-ui","fixed z-[100] bottom-8 w-fit left-20 h-fit flex","transition-all duration-300 select-none"),children:(0,a.jsx)("div",{className:(0,f.cn)("p-4 bg-gray-900 border text-white rounded-xl","transition-colors duration-300")})}),n[0]=i,n[1]=e):e=n[1],n[2]!==e?(t=(0,a.jsx)(a.Fragment,{children:e}),n[2]=e,n[3]=t):t=n[3],t}(0,x.eU)(null);var y=n(42094),b=n(38900),j=n(14680),w=n(5249),N=n(84127),k=n(30033),S=n(14370),E=n(14180),C=n(13890),I=n(68847),_=n(86694),T=n.n(_),A=n(6066),D=n(70376),P=n(75780);let M=(0,x.eU)(!1);function L(){var e,t,n,i,r,s,o,d;let u,p,x,v,g,_,L,R,F,U,z,K,B,V,G,H,q,W=(0,l.c)(36),[Q,X]=h.useState(""),$=(0,S.d)(Q,500),Y=(0,h.useRef)(null),[Z,J]=h.useState("anime"),ee=(0,A.useRouter)(),[et,en]=(0,m.fp)(M);W[0]!==et?(u=()=>{et&&setTimeout(()=>{var e;console.log("open",et,Y.current),console.log("focusing"),null==(e=Y.current)||e.focus()},300)},p=[et],W[0]=et,W[1]=u,W[2]=p):(u=W[1],p=W[2]),(0,h.useEffect)(u,p),W[3]===Symbol.for("react.memo_cache_sentinel")?(x=["FINISHED","CANCELLED","NOT_YET_RELEASED","RELEASING"],v=["SEARCH_MATCH"],W[3]=x,W[4]=v):(x=W[3],v=W[4]),W[5]!==$?(g={search:$,page:1,perPage:10,status:x,sort:v},W[5]=$,W[6]=g):g=W[6];let{data:ea,isLoading:el,isFetching:ei}=(0,y.qN)(g,$.length>0&&"anime"===Z);W[7]===Symbol.for("react.memo_cache_sentinel")?(_=["FINISHED","CANCELLED","NOT_YET_RELEASED","RELEASING"],L=["SEARCH_MATCH"],W[7]=_,W[8]=L):(_=W[7],L=W[8]),W[9]!==$?(R={search:$,page:1,perPage:10,status:_,sort:L},W[9]=$,W[10]=R):R=W[10];let{data:er,isLoading:es,isFetching:eo}=(0,b.cE)(R,$.length>0&&"manga"===Z),ec="anime"===Z?el:es,ed="anime"===Z?ei:eo;return W[11]!==(null==ea||null==(e=ea.Page)?void 0:e.media)||W[12]!==(null==er||null==(t=er.Page)?void 0:t.media)||W[13]!==Z?(U="anime"===Z?null==ea||null==(i=ea.Page)||null==(n=i.media)?void 0:n.filter(Boolean):null==er||null==(s=er.Page)||null==(r=s.media)?void 0:r.filter(Boolean),W[11]=null==ea||null==(o=ea.Page)?void 0:o.media,W[12]=null==er||null==(d=er.Page)?void 0:d.media,W[13]=Z,W[14]=U):U=W[14],F=U,W[15]===Symbol.for("react.memo_cache_sentinel")?(z=()=>X(""),W[15]=z):z=W[15],W[16]===Symbol.for("react.memo_cache_sentinel")?(K=(0,a.jsx)(E.e.Child,{as:h.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 transition-opacity backdrop-blur-sm"})}),W[16]=K):K=W[16],W[17]!==en?(B=(0,a.jsx)("div",{className:"absolute right-2 -top-7 z-10",children:(0,a.jsx)(w.i,{href:"/search",className:"text-[--muted] hover:text-[--foreground] font-bold",onClick:()=>en(!1),children:"Advanced search →"})}),W[17]=en,W[18]=B):B=W[18],W[19]!==$||W[20]!==ed||W[21]!==ec||W[22]!==F||W[23]!==ee||W[24]!==en||W[25]!==Z?(V=(0,a.jsx)(C.G,{children:e=>{var t,n,l;let{activeOption:i}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"relative border bg-gray-950 shadow-2xl ring-1 ring-black ring-opacity-5 w-full rounded-xl",children:[(0,a.jsx)(P.CKj,{className:"pointer-events-none absolute top-4 left-4 h-6 w-6 text-[--muted]","aria-hidden":"true"}),(0,a.jsx)(C.G.Input,{ref:Y,className:"h-14 w-full border-0 bg-transparent pl-14 pr-4 text-white placeholder-[--muted] focus:ring-0 sm:text-md",placeholder:"Search...",onChange:e=>X(e.target.value)}),(0,a.jsx)("div",{className:"block fixed lg:absolute top-2 right-2 z-1",children:(0,a.jsx)(k.l,{fieldClass:"w-fit",value:Z,onValueChange:e=>J(e),options:[{value:"anime",label:"Anime"},{value:"manga",label:"Manga"}]})})]}),!!F&&F.length>0&&(0,a.jsxs)(C.G.Options,{as:"div",static:!0,hold:!0,className:"flex divide-[--border] bg-gray-950 shadow-2xl ring-1 ring-black ring-opacity-5 rounded-xl border",children:[(0,a.jsx)("div",{className:(0,f.cn)("max-h-96 min-w-0 flex-auto scroll-py-2 overflow-y-auto px-6 py-2 my-2",{"sm:h-96":i}),children:(0,a.jsx)("div",{className:"-mx-2 text-sm text-[--foreground]",children:F.map(e=>(0,a.jsx)(C.G.Option,{as:"div",value:e,onClick:()=>{"anime"===Z?ee.push("/entry?id=".concat(e.id)):ee.push("/manga/entry?id=".concat(e.id)),en(!1)},className:O,children:t=>{var n,l,i;let{active:r}=t;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"h-10 w-10 flex-none rounded-[--radius-md] object-cover object-center relative overflow-hidden",children:(null==(n=e.coverImage)?void 0:n.medium)&&(0,a.jsx)(j.r,{src:null==(l=e.coverImage)?void 0:l.medium,alt:"",fill:!0,quality:50,priority:!0,sizes:"10rem",className:"object-cover object-center"})}),(0,a.jsx)("span",{className:"ml-3 flex-auto truncate",children:null==(i=e.title)?void 0:i.userPreferred}),r&&(0,a.jsx)(D.XWt,{className:"ml-3 h-7 w-7 flex-none text-gray-400","aria-hidden":"true"})]})}},e.id))})}),i&&(0,a.jsxs)("div",{className:"hidden min-h-96 w-1/2 flex-none flex-col overflow-y-auto sm:flex p-4",children:[(0,a.jsxs)("div",{className:"flex-none p-6 text-center",children:[(0,a.jsx)("div",{className:"h-40 w-32 mx-auto flex-none rounded-[--radius-md] object-cover object-center relative overflow-hidden",children:(null==(t=i.coverImage)?void 0:t.large)&&(0,a.jsx)(j.r,{src:null==(n=i.coverImage)?void 0:n.large,alt:"",fill:!0,quality:100,priority:!0,sizes:"10rem",className:"object-cover object-center"})}),(0,a.jsx)("h4",{className:"mt-3 font-semibold text-[--foreground] line-clamp-3",children:null==(l=i.title)?void 0:l.userPreferred}),(0,a.jsxs)("p",{className:"text-sm leading-6 text-[--muted]",children:[i.format,i.season?" - ".concat(T()(i.season)," "):" - ",i.seasonYear?i.seasonYear:"-"]})]}),(0,a.jsx)(w.i,{href:"anime"===Z?"/entry?id=".concat(i.id):"/manga/entry?id=".concat(i.id),onClick:()=>en(!1),children:(0,a.jsx)(N.$n,{type:"button",className:"w-full",intent:"gray-subtle",children:"Open"})})]})]}),""!==$&&(!F||0===F.length)&&(ec||ed)&&(0,a.jsx)(c.kt,{}),""!==$&&!ec&&!ed&&(!F||0===F.length)&&(0,a.jsxs)("div",{className:"py-14 px-6 text-center text-sm sm:px-14",children:[(0,a.jsx)("div",{className:"h-[10rem] w-[10rem] mx-auto flex-none rounded-[--radius-md] object-cover object-center relative overflow-hidden",children:(0,a.jsx)(j.r,{src:"/luffy-01.png",alt:"",fill:!0,quality:100,priority:!0,sizes:"10rem",className:"object-contain object-top"})}),(0,a.jsx)("h5",{className:"mt-4 font-semibold text-[--foreground]",children:"Nothing found"}),(0,a.jsx)("p",{className:"mt-2 text-[--muted]",children:"We couldn't find anything with that name. Please try again."})]})]})}}),W[19]=$,W[20]=ed,W[21]=ec,W[22]=F,W[23]=ee,W[24]=en,W[25]=Z,W[26]=V):V=W[26],W[27]!==B||W[28]!==V?(G=(0,a.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto p-4 sm:p-6 md:p-20",children:(0,a.jsx)(E.e.Child,{as:h.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(I.l.Panel,{className:"mx-auto max-w-3xl transform space-y-4 transition-all",children:[B,V]})})}),W[27]=B,W[28]=V,W[29]=G):G=W[29],W[30]!==en||W[31]!==G?(H=(0,a.jsxs)(I.l,{as:"div",className:"relative z-50",onClose:en,children:[K,G]}),W[30]=en,W[31]=G,W[32]=H):H=W[32],W[33]!==et||W[34]!==H?(q=(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(E.e.Root,{show:et,as:h.Fragment,afterLeave:z,appear:!0,children:H})}),W[33]=et,W[34]=H,W[35]=q):q=W[35],q}function O(e){let{active:t}=e;return(0,f.cn)("flex select-none items-center rounded-[--radius-md] p-2 text-[--muted] cursor-pointer",t&&"bg-gray-800 text-white")}var R=n(76793),F=n(92952),U=n(15044),z=n(58092),K=n(9478),B=n(48555),V=n(41611),G=n(3692);function H(e){let t,n,i,r,s=(0,l.c)(11),{fileNodes:o}=e,[c]=(0,m.fp)(V.fR),[d]=(0,m.fp)(V.Ob),[,u]=(0,m.fp)(V.yl);s[0]!==o||s[1]!==d?(t=null==o?void 0:o.filter(e=>d.has(e.path)&&"file"===e.kind),s[0]=o,s[1]=d,s[2]=t):t=s[2];let h=t;s[3]!==u?(n=()=>{u(!0)},s[3]=u,s[4]=n):n=s[4];let p=n;return s[5]!==p||s[6]!==c||s[7]!==(null==h?void 0:h.length)?(i=c&&!!(null==h?void 0:h.length)&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(N.$n,{leftIcon:(0,a.jsx)(G.wwX,{className:"text-xl"}),size:"sm",intent:"white-link",onClick:p,children:"Super update"})}),s[5]=p,s[6]=c,s[7]=null==h?void 0:h.length,s[8]=i):i=s[8],s[9]!==i?(r=(0,a.jsx)(a.Fragment,{children:i}),s[9]=i,s[10]=r):r=s[10],r}var q=n(63352),W=n(14033),Q=n(75435),X=n(57073),$=n(53712),Y=n(77022),Z=n(78453),J=n(69554);let ee=(0,W.Jo)(e=>{let{z:t}=e;return t.object({searchText:t.string(),replaceText:t.string(),useRegex:t.boolean().default(!1),caseSensitive:t.boolean().default(!1),matchAllOccurrences:t.boolean().default(!1),enumerateItems:t.boolean().default(!1),editMetadata:t.boolean().default(!1)})});function et(e,t){return e=(e=e.replace(/\$\{\}/g,t.toString())).replace(/\$\{([^}]+)\}/g,(e,n)=>{let a={};for(let e of n.split(";")){let[t,n]=e.split("=");if(t&&n){let e=t.trim(),l=parseInt(n.trim());isNaN(l)||(a[e]=l)}}let l=a.padding||0,i=a.increment||1,r=(a.start||0)+t*i;return l>0?r.toString().padStart(l,"0"):r.toString()})}function en(e){return e?e.trim():""}function ea(e){let t=e.match(/^([a-zA-Z]*)(\d+)$/);if(t)return{prefix:t[1].toUpperCase(),number:parseInt(t[2],10)};let n=parseInt(e,10);return isNaN(n)?{prefix:"",number:0}:{prefix:"",number:n}}function el(e){let t=e.split(";").map(e=>e.trim()),n={episodeConditions:[],anidbConditions:[]};for(let e of t)if(e.startsWith("type="))n.types=e.substring(5).split("|").filter(e=>["main","special","nc"].includes(e));else if(e.startsWith("!type="))n.excludeTypes=e.substring(6).split("|").filter(e=>["main","special","nc"].includes(e));else if(e.startsWith("anidb>=")){let t=ea(e.substring(7));n.anidbConditions.push({operator:">=",value:t.number,prefix:t.prefix})}else if(e.startsWith("anidb<=")){let t=ea(e.substring(7));n.anidbConditions.push({operator:"<=",value:t.number,prefix:t.prefix})}else if(e.startsWith("anidb>")){let t=ea(e.substring(6));n.anidbConditions.push({operator:">",value:t.number,prefix:t.prefix})}else if(e.startsWith("anidb<")){let t=ea(e.substring(6));n.anidbConditions.push({operator:"<",value:t.number,prefix:t.prefix})}else if(e.startsWith("anidb!=")){let t=ea(e.substring(7));n.anidbConditions.push({operator:"!=",value:t.number,prefix:t.prefix})}else if(e.startsWith("!anidb=")){let t=ea(e.substring(7));n.anidbConditions.push({operator:"!=",value:t.number,prefix:t.prefix})}else if(e.startsWith("anidb=")){let t=ea(e.substring(6));n.anidbConditions.push({operator:"=",value:t.number,prefix:t.prefix})}else if(e.startsWith(">=")){let t=parseInt(e.substring(2));isNaN(t)||n.episodeConditions.push({operator:">=",value:t})}else if(e.startsWith("<=")){let t=parseInt(e.substring(2));isNaN(t)||n.episodeConditions.push({operator:"<=",value:t})}else if(e.startsWith(">")){let t=parseInt(e.substring(1));isNaN(t)||n.episodeConditions.push({operator:">",value:t})}else if(e.startsWith("<")){let t=parseInt(e.substring(1));isNaN(t)||n.episodeConditions.push({operator:"<",value:t})}else if(e.startsWith("!=")){let t=parseInt(e.substring(2));isNaN(t)||n.episodeConditions.push({operator:"!=",value:t})}else if(e.startsWith("!")){let t=parseInt(e.substring(1));isNaN(t)||n.episodeConditions.push({operator:"!=",value:t})}else if(e.startsWith("=")){let t=parseInt(e.substring(1));isNaN(t)||n.episodeConditions.push({operator:"=",value:t})}else if(/^\d+$/.test(e)){let t=parseInt(e);isNaN(t)||n.episodeConditions.push({operator:"=",value:t})}return n}function ei(e,t,n,a){for(let t of a.episodeConditions)switch(t.operator){case">=":if(e<t.value)return!1;break;case"<=":if(e>t.value)return!1;break;case">":if(e<=t.value)return!1;break;case"<":if(e>=t.value)return!1;break;case"=":if(e!==t.value)return!1;break;case"!=":if(e===t.value)return!1}for(let e of a.anidbConditions){let t=ea(n);if(void 0!==e.prefix&&e.prefix!==t.prefix)return!1;switch(e.operator){case">=":if(t.number<e.value)return!1;break;case"<=":if(t.number>e.value)return!1;break;case">":if(t.number<=e.value)return!1;break;case"<":if(t.number>=e.value)return!1;break;case"=":if(t.number!==e.value)return!1;break;case"!=":if(t.number===e.value)return!1}}return!(a.types&&!a.types.includes(t)||a.excludeTypes&&a.excludeTypes.includes(t))}function er(e,t){switch(t){case"lowercase":return e.toLowerCase();case"uppercase":return e.toUpperCase();case"titlecase":return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();case"capitalize":return e.replace(/\b\w/g,e=>e.toUpperCase());default:return e}}function es(e){let{fileNodes:t}=e,[n,l]=(0,m.fp)(V.yl),i=(0,m.md)(V.Ob),[r,s]=(0,h.useState)("none"),[o,c]=(0,h.useState)([]),[d,u]=(0,h.useState)({searchText:"",replaceText:"",useRegex:!0,caseSensitive:!1,matchAllOccurrences:!1,enumerateItems:!0,editMetadata:!1}),{mutate:p,isPending:x}=(0,U.Gm)(),v=(0,h.useMemo)(()=>(null==t?void 0:t.filter(e=>i.has(e.path)&&"file"===e.kind))||[],[t,i]),g=(0,h.useMemo)(()=>{let e={...d,textFormatting:r};return v.map((t,n)=>{var a;let l=t.name,i=function(e,t){if(!e||""===e.trim())return t;let n=e.lastIndexOf("."),a=e,l="";n>0&&n<e.length-1&&(a=e.substring(0,n),l=e.substring(n));let i=a.replace(/[<>:"/\\|?*]/g,"_").replace(/\.\./g,"_").trim();if(""===i||/^[.\s]*$/.test(i))return t;let r=250-l.length;if(i.length>r&&r>0){let e=i.substring(0,r).trim();return""===e||/^[.\s]*$/.test(e)?t:e+l}return i+l}(function(e,t,n){let a=e.lastIndexOf("."),l=e,i="";a>0&&a<e.length-1&&(l=e.substring(0,a),i=e.substring(a));let r=l;if(!t.searchText)return t.enumerateItems&&(r=et(r,n)),(r=er(r,t.textFormatting))+i;try{if(t.useRegex){let e=t.caseSensitive?"g":"gi",n=new RegExp(t.searchText,e);t.matchAllOccurrences,r=l.replace(n,t.replaceText)}else{let e=t.caseSensitive?t.searchText:t.searchText.toLowerCase(),n=t.caseSensitive?l:l.toLowerCase();if(t.matchAllOccurrences){let a=n.split(e);if(r=a.join(t.replaceText),!t.caseSensitive){let e="",n=0;for(let i=0;i<a.length;i++)i>0&&(e+=t.replaceText),a[i]&&(e+=l.substr(n,a[i].length),n+=a[i].length+(i<a.length-1?t.searchText.length:0));r=e}}else{let a=n.indexOf(e);-1!==a&&(r=l.substring(0,a)+t.replaceText+l.substring(a+t.searchText.length))}}return t.enumerateItems&&(r=et(r,n)),(r=er(r,t.textFormatting))+i}catch(t){return e}}(l,e,n),l),r=null==(a=t.localFile)?void 0:a.metadata,s=d.editMetadata?function(e,t,n){let a,l,i;if(!e||0===t.length)return e;for(let s of t)switch(s.type){case"episode":{let t=el(s.searchText);ei(e.episode,e.type,e.aniDBEpisode,t)&&(a=function(e,t,n){let a=e;if(t.startsWith("increment=")){let n=parseInt(t.substring(10));isNaN(n)||(a=e+n)}else if(t.startsWith("decrement=")){let n=parseInt(t.substring(10));isNaN(n)||(a=e-n)}else{let e=parseInt(t);isNaN(e)||(a=e)}var l=a;if("string"==typeof l){let e=parseInt(l);return isNaN(e)?0:Math.max(0,e)}return"number"==typeof l?isNaN(l)?0:Math.max(0,Math.floor(l)):0}(e.episode,s.replaceText,0));break}case"anidb":{let t=!0;if(s.anidbSearchText&&s.anidbSearchText.trim()){let n=el(s.anidbSearchText);t=ei(e.episode,e.type,e.aniDBEpisode,n)}if(t)try{if(s.useRegex){let t=s.caseSensitive?"g":"gi",a=new RegExp(s.searchText,t);if(a.test(e.aniDBEpisode)){let t=e.aniDBEpisode.replace(a,s.replaceText);t=et(t,n),l=en(t)}}else{let t=s.caseSensitive?s.searchText:s.searchText.toLowerCase();if((s.caseSensitive?e.aniDBEpisode:e.aniDBEpisode.toLowerCase()).includes(t)){let t=e.aniDBEpisode.replace(new RegExp(s.searchText.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),s.caseSensitive?"g":"gi"),s.replaceText);t=et(t,n),l=en(t)}}}catch(e){console.warn("Invalid regex in AniDB edit:",s.searchText,e)}break}case"type":{var r;let t=el(s.searchText);ei(e.episode,e.type,e.aniDBEpisode,t)&&(i=["main","special","nc"].includes(r=s.replaceText)?r:"nc")}}let s={...e};return void 0!==a&&(s.episode=a),void 0!==l&&(s.aniDBEpisode=l),void 0!==i&&(s.type=i),s}(r,o,n):r,c=d.editMetadata&&r&&s&&(r.episode!==s.episode||r.aniDBEpisode!==s.aniDBEpisode||r.type!==s.type);return{originalPath:t.path,originalName:l,newName:i,willChange:i!==l,originalMetadata:r,newMetadata:s,metadataWillChange:!!c}})},[v,d,r,o]),y=g.filter(e=>e.willChange||e.metadataWillChange),b=()=>{let e={id:Date.now().toString(),type:"episode",searchText:"",anidbSearchText:"",replaceText:""};c(t=>[...t,e])},j=(e,t)=>{c(n=>n.map(n=>n.id===e?{...n,...t}:n))},w=e=>{c(t=>t.filter(t=>t.id!==e))};return(0,a.jsx)(Y.Tr,{open:n,onOpenChange:l,children:(0,a.jsxs)(Y.Cz,{className:(0,f.cn)("bg-gray-950 h-[90%] lg:h-[85%] bg-opacity-95 firefox:bg-opacity-100 lg:mx-[2rem]"),children:[(0,a.jsx)("p",{className:"p-4 pb-0",children:(0,a.jsx)("span",{className:"text-sm text-[--muted]",children:"Update multiple file names and metadata at once."})}),(0,a.jsxs)("div",{className:"p-6 flex-1 overflow-hidden flex flex-col",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(W.lV,{schema:ee,onSubmit:e=>{let t=y.filter(e=>(!e.willChange||!!e.newName&&""!==e.newName.trim()&&e.newName!==e.originalName)&&(e.willChange||e.metadataWillChange));if(0===t.length)return void J.oR.error("No valid changes to apply. Please check your settings.");let n=t.map(e=>({path:e.originalPath,...e.willChange&&{newName:e.newName},...e.metadataWillChange&&{metadata:e.newMetadata}}));if(t.length<y.length){let e=y.length-t.length;J.oR.warning("Applying ".concat(t.length," changes, skipping ").concat(e," invalid changes"))}console.log("filesToUpdate",n),p({files:n},{onSuccess:()=>{let e=n.filter(e=>e.newName).length,t=n.filter(e=>e.metadata).length,a="Successfully updated ";e>0&&t>0?a+="".concat(e," filename(s) and ").concat(t," metadata"):e>0?a+="".concat(e," filename(s)"):t>0&&(a+="".concat(t," metadata")),J.oR.success(a),l(!1),u({searchText:"",replaceText:"",useRegex:!0,caseSensitive:!1,matchAllOccurrences:!1,enumerateItems:!0,editMetadata:!1}),s("none"),c([])},onError:e=>{J.oR.error("Failed to rename files: "+e.message)}})},onChange:e=>u(t=>({...t,...e})),defaultValues:d,id:"super-update-form",children:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4",children:[(0,a.jsx)(W.D0.Text,{name:"searchText",label:"Search for",placeholder:"Enter text to search for..."}),(0,a.jsx)(W.D0.Text,{name:"replaceText",label:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{children:"Replace with"}),(0,a.jsx)(Q.A,{className:"w-full max-w-2xl",trigger:(0,a.jsx)(Z.ExT,{className:"transition-opacity opacity-45 hover:opacity-90"}),children:(0,a.jsxs)("div",{className:"p-3 bg-gray-800 rounded-md",children:[(0,a.jsx)("p",{className:"text-sm text-gray-300 mb-2",children:"Enumeration patterns:"}),(0,a.jsxs)("div",{className:"text-xs text-gray-400 space-y-1 font-mono",children:[(0,a.jsxs)("div",{children:["$","{}"," - Simple counter (0, 1, 2...)"]}),(0,a.jsxs)("div",{children:["$","{start=5}"," - Start from 5 (5, 6, 7...)"]}),(0,a.jsxs)("div",{children:["$","{increment=2}"," - Increment by 2 (0, 2, 4...)"]}),(0,a.jsxs)("div",{children:["$","{padding=3}"," - Pad with zeros (000, 001, 002...)"]}),(0,a.jsxs)("div",{children:["$","{padding=3;start=10}"," - Combined (010, 011, 012...)"]}),(0,a.jsxs)("div",{children:["$","{padding=2;increment=5}"," - Pad + increment (00, 05, 10...)"]}),(0,a.jsxs)("div",{children:["$","{increment=2;start=1;padding=3}"," - All combined (001, 003, 005...)"]})]})]})})]}),placeholder:"Enter replacement text..."})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 mb-4",children:[(0,a.jsx)(W.D0.Checkbox,{name:"useRegex",label:"Use regex",fieldClass:"w-fit"}),(0,a.jsx)(W.D0.Checkbox,{name:"caseSensitive",label:"Case sensitive",fieldClass:"w-fit"}),(0,a.jsx)(W.D0.Checkbox,{name:"matchAllOccurrences",label:"Match all occurrences",fieldClass:"w-fit"}),(0,a.jsx)(W.D0.Checkbox,{name:"enumerateItems",label:"Enumerate items",fieldClass:"w-fit"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Text formatting"}),(0,a.jsx)("div",{className:"flex gap-2",children:[{value:"none",label:"None"},{value:"lowercase",label:"aa"},{value:"uppercase",label:"AA"},{value:"titlecase",label:"Aa"},{value:"capitalize",label:"Aa Aa"}].map(e=>(0,a.jsx)("button",{type:"button",className:(0,f.cn)("px-3 py-1 rounded border text-sm font-mono",r===e.value?"bg-brand-500 border-brand-500 text-white":"bg-gray-800 border-gray-600 text-gray-300 hover:bg-gray-700"),onClick:()=>s(e.value),children:e.label},e.value))})]}),(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(W.D0.Checkbox,{name:"editMetadata",label:"Edit file metadata",fieldClass:"w-fit"})}),e.watch("editMetadata")&&(0,a.jsxs)("div",{className:"mb-4 p-4 bg-gray-900 border rounded-md max-h-[230px] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-300"}),(0,a.jsx)(N.$n,{leftIcon:(0,a.jsx)(D.Ca6,{}),intent:"gray-outline",size:"sm",onClick:b,children:"Add Rule"})]}),0===o.length?(0,a.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:'No metadata edit rules. Click "Add Rule" to create one.'}):(0,a.jsx)("div",{className:"space-y-4",children:o.map((e,t)=>(0,a.jsx)(eo,{edit:e,index:t,onUpdate:t=>j(e.id,t),onRemove:()=>w(e.id)},e.id))})]})]})})}),(0,a.jsx)(X.w,{className:"mb-4"}),(0,a.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,a.jsxs)("div",{className:"mb-4 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex gap-6",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-300",children:["Original (",v.length,")"]}),(0,a.jsxs)("span",{className:"text-sm text-gray-300",children:["Renamed (",y.length,")"]})]}),(0,a.jsxs)(N.$n,{type:"submit",form:"super-update-form",disabled:0===y.length||x,loading:x,leftIcon:(0,a.jsx)(D.Y$T,{}),intent:"white",size:"sm",children:["Apply (",y.length,")"]})]}),(0,a.jsx)("div",{className:(0,f.cn)("overflow-y-auto flex-1 bg-gray-950 border rounded-md p-2 h-[calc(100%-55px)]"),children:0===g.length?(0,a.jsx)("div",{className:"text-center text-gray-500 py-8",children:"No files selected"}):(0,a.jsx)("div",{className:"space-y-2",children:g.map((e,t)=>(0,a.jsxs)("div",{className:(0,f.cn)("flex items-center gap-3 p-2 rounded",e.willChange||e.metadataWillChange?"bg-green-900/20":"bg-gray-800/20 hover:bg-gray-800/30"),children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"text-sm text-gray-300 truncate tracking-wide select-text",children:e.originalName}),e.willChange&&(0,a.jsx)("div",{className:"text-md text-green-200 truncate tracking-wide",children:e.newName}),e.metadataWillChange&&e.originalMetadata&&e.newMetadata&&(0,a.jsxs)("div",{className:"text-xs text-blue-300 mt-1 space-y-1",children:[e.originalMetadata.episode!==e.newMetadata.episode&&(0,a.jsxs)("div",{children:["Episode: ",e.originalMetadata.episode," → ",e.newMetadata.episode]}),e.originalMetadata.aniDBEpisode!==e.newMetadata.aniDBEpisode&&(0,a.jsxs)("div",{children:['AniDB: "',e.originalMetadata.aniDBEpisode,'" → "',e.newMetadata.aniDBEpisode,'"']}),e.originalMetadata.type!==e.newMetadata.type&&(0,a.jsxs)("div",{children:["Type: ",e.originalMetadata.type," → ",e.newMetadata.type]})]})]}),(e.willChange||e.metadataWillChange)&&(0,a.jsxs)("div",{className:"text-xs flex-shrink-0 flex flex-col gap-1",children:[e.willChange&&(0,a.jsx)("div",{className:(0,f.cn)(e.newName===e.originalName?"text-yellow-500":"text-green-500"),children:e.newName===e.originalName?"No Change":"Renamed"}),e.metadataWillChange&&(0,a.jsx)("div",{className:"text-blue-500",children:"Metadata"})]})]},e.originalPath))})})]})]})]})})}function eo(e){let t,n,i,r,s,o,c,d,u,m,h,p,f,x,v,g,y,b,j,w,S,E,C=(0,l.c)(59),{edit:I,index:_,onUpdate:T,onRemove:A}=e;C[0]!==I.type?(t=()=>{switch(I.type){case"episode":return"e.g.: >=1;<=12;!=5;type=main|special;!type=nc";case"anidb":return"Enter text or regex pattern";case"type":return"e.g.: >=1;<12;=5;type=main;!type=special";default:return""}},C[0]=I.type,C[1]=t):t=C[1];let P=t;C[2]!==I.type?(n=()=>{switch(I.type){case"episode":return"e.g.: increment=1, decrement=1, or direct value like 5";case"anidb":return"Replacement text (supports enumeration patterns)";case"type":return"Select new type";default:return""}},C[2]=I.type,C[3]=n):n=C[3];let M=n;C[4]!==I.type?(i=()=>{switch(I.type){case"episode":return"Operators: >=, <=, >, <, =, !=, ! | Types: type=main|special|nc, !type=special";case"anidb":return"Supports regex patterns and case sensitivity options";case"type":return"Same operators as episode: >=, <=, >, <, =, !=, ! | Types: type=main, !type=special";default:return""}},C[4]=I.type,C[5]=i):i=C[5];let L=i,O=_+1;C[6]!==O?(r=(0,a.jsxs)("span",{className:"text-xs font-mono text-gray-400",children:["#",O]}),C[6]=O,C[7]=r):r=C[7],C[8]===Symbol.for("react.memo_cache_sentinel")?(s=[{value:"episode",label:"Episode Number"},{value:"anidb",label:"AniDB Episode"},{value:"type",label:"File Type"}],C[8]=s):s=C[8],C[9]!==T?(o=e=>{T({type:e}),"anidb"===e&&(T({searchText:"^(.*)$"}),T({useRegex:!0}))},C[9]=T,C[10]=o):o=C[10],C[11]!==I.type||C[12]!==o?(c=(0,a.jsx)(k.l,{options:s,value:I.type,onValueChange:o,size:"sm"}),C[11]=I.type,C[12]=o,C[13]=c):c=C[13],C[14]===Symbol.for("react.memo_cache_sentinel")?(d=(0,a.jsx)("div",{className:"flex-1"}),C[14]=d):d=C[14],C[15]===Symbol.for("react.memo_cache_sentinel")?(u=(0,a.jsx)(D.id1,{}),C[15]=u):u=C[15],C[16]!==A?(m=(0,a.jsx)(N.K0,{icon:u,intent:"alert-subtle",size:"sm",onClick:A}),C[16]=A,C[17]=m):m=C[17],C[18]!==m||C[19]!==r||C[20]!==c?(h=(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[r,c,d,m]}),C[18]=m,C[19]=r,C[20]=c,C[21]=h):h=C[21],C[22]!==I.anidbSearchText||C[23]!==I.type||C[24]!==T?(p="anidb"===I.type&&(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Filter (Optional)"}),(0,a.jsx)($.k,{placeholder:function(){return"e.g.: anidb>=1;anidb=S1;anidb!=C2;type=special"}(),value:I.anidbSearchText||"",onValueChange:e=>T({anidbSearchText:e||""}),size:"sm"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:function(){return"AniDB operators: anidb>=, anidb<=, anidb=, anidb!=, !anidb= | Format: numbers (1,12) or prefixed (S1,C2,T1)"}()})]}),C[22]=I.anidbSearchText,C[23]=I.type,C[24]=T,C[25]=p):p=C[25];let R="anidb"===I.type?"Find (Text/Regex)":"Search";C[26]!==R?(f=(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:R}),C[26]=R,C[27]=f):f=C[27];let F="anidb"===I.type?"Enter text or regex pattern":P();C[28]!==T?(x=e=>T({searchText:e||""}),C[28]=T,C[29]=x):x=C[29],C[30]!==I.searchText||C[31]!==F||C[32]!==x?(v=(0,a.jsx)($.k,{placeholder:F,value:I.searchText,onValueChange:x,size:"sm"}),C[30]=I.searchText,C[31]=F,C[32]=x,C[33]=v):v=C[33],C[34]!==f||C[35]!==v?(g=(0,a.jsxs)("div",{className:"flex-1",children:[f,v]}),C[34]=f,C[35]=v,C[36]=g):g=C[36],C[37]===Symbol.for("react.memo_cache_sentinel")?(y=(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Replace"}),C[37]=y):y=C[37],C[38]!==I.replaceText||C[39]!==I.type||C[40]!==M||C[41]!==T?(b=(0,a.jsxs)("div",{className:"flex-1",children:[y,"type"===I.type?(0,a.jsx)(k.l,{options:[{value:"main",label:"Main"},{value:"special",label:"Special"},{value:"nc",label:"NC"}],value:I.replaceText,onValueChange:e=>T({replaceText:e||""}),placeholder:"Select type",size:"sm"}):(0,a.jsx)($.k,{placeholder:M(),value:I.replaceText,onValueChange:e=>T({replaceText:e||""}),size:"sm"})]}),C[38]=I.replaceText,C[39]=I.type,C[40]=M,C[41]=T,C[42]=b):b=C[42],C[43]!==p||C[44]!==g||C[45]!==b?(j=(0,a.jsx)("div",{className:"space-y-3 mb-3",children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row gap-3",children:[p,g,b]})}),C[43]=p,C[44]=g,C[45]=b,C[46]=j):j=C[46],C[47]!==I.caseSensitive||C[48]!==I.type||C[49]!==I.useRegex||C[50]!==T?(w="anidb"===I.type&&(0,a.jsxs)("div",{className:"flex gap-4 mb-2",children:[(0,a.jsx)(q.Sc,{label:"Use regex",value:I.useRegex||!1,onValueChange:e=>T({useRegex:!!e}),size:"sm",labelClass:"text-xs text-gray-300"}),(0,a.jsx)(q.Sc,{label:"Case sensitive",value:I.caseSensitive||!1,onValueChange:e=>T({caseSensitive:!!e}),size:"sm",labelClass:"text-xs text-gray-300"})]}),C[47]=I.caseSensitive,C[48]=I.type,C[49]=I.useRegex,C[50]=T,C[51]=w):w=C[51];let U=L();return C[52]!==U?(S=(0,a.jsx)("p",{className:"text-xs text-gray-500",children:U}),C[52]=U,C[53]=S):S=C[53],C[54]!==h||C[55]!==j||C[56]!==w||C[57]!==S?(E=(0,a.jsxs)("div",{className:"p-3 bg-gray-950 rounded-xl border",children:[h,j,w,S]}),C[54]=h,C[55]=j,C[56]=w,C[57]=S,C[58]=E):E=C[58],E}function ec(e){let t=[];if("file"===e.kind)t.push(e.path);else if("directory"===e.kind&&e.children)for(let n of e.children)t.push(...ec(n));return t}function ed(e){if(!e)return[];let t=[];if("file"===e.kind)t.push(e);else if("directory"===e.kind&&e.children)for(let n of e.children)t.push(...ed(n));return t}var eu=n(50558),em=n(47342),eh=n(76049),ep=n(97400),ef=n(12556),ex=n(62816),ev=n(43994),eg=n(41452),ey=n(40568),eb=n(64685),ej=n(68090),ew=n(28668),eN=n(94936),ek=n(47601),eS=n(61585),eE=n(32754);function eC(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i="directory"===e.kind,r=e.children&&e.children.length>0,s=n&&e.children?e.children.filter(e=>e.name.toLowerCase().includes(n)||e.children&&e.children.some(e=>e.name.toLowerCase().includes(n))):e.children;return(!n||e.name.toLowerCase().includes(n)||s&&s.length>0)&&(l.push({node:e,level:a,index:l.length}),i&&r&&t.has(e.path)&&(s||e.children||[]).forEach(e=>{eC(e,t,n,a+1,l)})),l}function eI(){var e;let{data:t,isLoading:n,refetch:l}=(0,U.Gd)(),i=(0,U.H2)(),[r,s]=(0,m.fp)(V._S),[o,d]=h.useState(""),[u,p]=h.useState(new Set),[x,v]=(0,m.fp)(V.qE),[g,y]=(0,m.fp)(V.fR),[b]=(0,m.fp)(V.m7),j=h.useRef(null),{mutate:w}=(0,K.bU)(),{mutate:k}=(0,z.E)(),[,S]=(0,m.fp)(F.r),[,E]=(0,m.fp)(V.m7),C=e=>{w({paths:e,action:"unmatch"})},I=e=>{w({paths:e,action:"lock"})},_=e=>{w({paths:e,action:"unlock"})},T=e=>{w({paths:e,action:"ignore"})},A=e=>{w({paths:e,action:"unignore"})},P=e=>{var t,n;E(null!=(n=null==e||null==(t=e.filter(e=>{var t;return e.localFile&&!(null==(t=e.localFile)?void 0:t.mediaId)}))?void 0:t.map(e=>e.localFile))?n:[]),h.startTransition(()=>{S(!0)})},M=e=>{k({path:e})},L=h.useCallback(e=>{p(t=>{let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},[]),O=h.useRef(u),R=h.useRef(null);h.useEffect(()=>(R.current&&(clearTimeout(R.current),R.current=null),R.current=setTimeout(()=>{if(0===u.size)return;let e=Array.from(O.current).filter(e=>!u.has(e));if(e.length>0){let t=[];e.forEach(e=>{Array.from(u).forEach(n=>{n.startsWith(e+"/")&&t.push(n)})}),t.length>0&&p(e=>{let n=new Set(e);return t.forEach(e=>n.delete(e)),n})}O.current=u},100),()=>{R.current&&(clearTimeout(R.current),R.current=null)}),[u]);let B=h.useCallback(e=>{s(e)},[]),G=h.useCallback(()=>{y(e=>!e)},[]),[q,W]=(0,m.fp)(V.Ob);h.useEffect(()=>{g||W(new Set)},[g]);let Q=h.useCallback((e,t)=>{W(n=>{let a=new Set(n);if("file"===e.kind)t?a.add(e.path):a.delete(e.path);else{let n=ec(e);t?n.forEach(e=>a.add(e)):n.forEach(e=>a.delete(e))}return a})},[]),{width:X}=(0,ej.A)(),Y=ed(null==t?void 0:t.root),Z=null==Y?void 0:Y.some(e=>!e.localFile),J=h.useMemo(()=>(null==t?void 0:t.root)?eC(t.root,u,o.toLowerCase()):[],[null==t?void 0:t.root,u,o]),[ee,et]=(0,m.fp)(V._J),en=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!ee)return null;if(e.path.toLowerCase()===ee.toLowerCase())return{node:e,parents:t};if(e.children)for(let n of e.children){let a=en(n,[...t,e.path]);if(a)return a}return null};h.useEffect(()=>{if(ee&&x&&(null==t?void 0:t.root)){let e=en(t.root);if(e){s(e.node);let n=new Set([...e.parents,ee]);p(e=>new Set([...e,...n])),setTimeout(()=>{let e=eC(t.root,n,o.toLowerCase()).findIndex(e=>e.node.path.toLowerCase()===ee.toLowerCase());if(e>=0){var a;null==(a=j.current)||a.scrollToIndex({index:e,align:"start"})}},500)}et(null)}},[ee,x,null==t?void 0:t.root,en,o]);let ea=null==Y?void 0:Y.some(e=>e.localFile&&!!e.localFile.mediaId&&!e.localFile.locked&&!e.localFile.ignored),el=null==Y?void 0:Y.filter(e=>!!e.localFile&&!e.localFile.mediaId&&!e.localFile.ignored);return n?(0,a.jsx)("div",{className:"p-4 lg:p-8 flex-1 overflow-y-auto flex items-center justify-center",children:(0,a.jsx)(c.kt,{})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"hidden lg:flex h-full",children:[(0,a.jsxs)("div",{className:"flex-1 flex flex-col border-r bg-gray-950",children:[(0,a.jsxs)("div",{className:"p-4 border-b space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-100 2xl:block hidden",children:"Library Explorer"}),ea&&(0,a.jsx)(eu.F,{intent:"info",className:"text-sm py-1 px-3",description:"Lock all correctly matched files"}),!!(null==el?void 0:el.length)&&(0,a.jsx)(eu.F,{intent:"warning",className:"text-sm py-1 px-3 cursor-pointer",description:"".concat(el.length," unmatched file").concat(1!=el.length?"s":""),onClick:()=>{var e;et(null==el||null==(e=el[0])?void 0:e.path)}})]}),(0,a.jsx)("div",{className:"flex flex-1"}),(0,a.jsx)(e_,{fileNodes:Y,handleMatchFiles:P,handleUnmatchFiles:C}),(0,a.jsx)(H,{fileNodes:Y}),(0,a.jsxs)(N.$n,{leftIcon:(0,a.jsx)(D.Y$T,{className:"text-xl"}),size:"sm",intent:g?"white":"gray-subtle",onClick:G,className:(0,f.cn)(g&&"animate-pulse"),children:["Select",g?"ing":""]}),(0,a.jsx)(N.K0,{icon:(0,a.jsx)(ev.Z05,{}),size:"sm",intent:"gray-subtle",onClick:()=>{i.mutate()},loading:i.isPending})]}),(0,a.jsx)($.k,{placeholder:"Search files and folders...",value:o,onChange:e=>d(e.target.value),leftIcon:(0,a.jsx)(D.iyI,{}),size:"sm"}),Z&&(0,a.jsx)(eu.F,{intent:"warning",description:"Some files have not been scanned yet. Please scan the library to be able to perform actions on them."})]}),(0,a.jsx)("div",{className:"flex-1 library-explorer-tree-container",children:(0,a.jsx)(ew.aY,{ref:j,data:J,itemContent:(e,n)=>(0,a.jsx)(eA,{item:n,isExpanded:u.has(n.node.path),onToggleExpand:L,onSelect:B,selectedPath:null==r?void 0:r.path,localFiles:null==t?void 0:t.localFiles,selectedPaths:q,onPathSelection:Q,windowWidth:X,onUnmatchFiles:C,onLockFiles:I,onUnlockFiles:_,onIgnoreFiles:T,onUnignoreFiles:A,onMatchFiles:P,onOpenInExplorer:M},n.node.path),style:{height:"100%"},components:{Footer:()=>(0,a.jsx)("div",{className:"p-2",children:(0,a.jsx)("p",{className:"text-xs text-gray-400 text-center py-2",children:"End"})})}})})]}),(0,a.jsx)("div",{className:"flex flex-col flex-none bg-gray-950/50 w-80",children:(0,a.jsx)(eD,{localFiles:null==t?void 0:t.localFiles})})]}),(0,a.jsx)(F.d,{unmatchedGroups:[{dir:ef.V.dirname((null==(e=b[0])?void 0:e.path)||""),localFiles:b}]}),(0,a.jsx)(es,{fileNodes:Y})]})}function e_(e){let t,n,i,r,s,o=(0,l.c)(17),{fileNodes:c,handleMatchFiles:d,handleUnmatchFiles:u}=e,[h]=(0,m.fp)(V.fR),[p]=(0,m.fp)(V.Ob);o[0]!==c||o[1]!==p?(n=null==(t=null==c?void 0:c.filter(e=>p.has(e.path)))?void 0:t.some(eT),o[0]=c,o[1]=p,o[2]=t,o[3]=n):(t=o[2],n=o[3]);let f=n;o[4]!==d||o[5]!==u||o[6]!==t||o[7]!==p||o[8]!==f?(i=function(){f?u(Array.from(p)):d(t)},o[4]=d,o[5]=u,o[6]=t,o[7]=p,o[8]=f,o[9]=i):i=o[9];let x=i;return o[10]!==x||o[11]!==h||o[12]!==t||o[13]!==f?(r=h&&!!(null==t?void 0:t.length)&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(N.$n,{leftIcon:(0,a.jsx)(eg.eXw,{className:"text-xl"}),size:"sm",intent:f?"warning-link":"success-link",onClick:x,children:[f?"Unmatch":"Match"," ",t.length," file",1!=t.length?"s":""]})}),o[10]=x,o[11]=h,o[12]=t,o[13]=f,o[14]=r):r=o[14],o[15]!==r?(s=(0,a.jsx)(a.Fragment,{children:r}),o[15]=r,o[16]=s):s=o[16],s}function eT(e){var t;return"file"===e.kind&&!!e.localFile&&!!(null==(t=e.localFile)?void 0:t.mediaId)}let eA=(0,h.memo)(e=>{var t,n,l,i,r,s,o,c,d,u,p,x,v,g,y,b,w,k,S,E,C;let{item:I,isExpanded:_,onToggleExpand:T,onSelect:A,selectedPath:M,localFiles:L,selectedPaths:O,onPathSelection:R,windowWidth:F,onUnmatchFiles:U,onLockFiles:z,onUnlockFiles:H,onIgnoreFiles:Q,onUnignoreFiles:X,onMatchFiles:$,onOpenInExplorer:Y}=e,{node:Z,level:ee}=I,et="directory"===Z.kind,en=M===Z.path,ea=Z.children&&Z.children.length>0,el=(0,m.md)(B.Qy),ei=(0,m.md)(V.fR),er=(0,m.Xr)(V.Ob),es=(0,m.Xr)(V.yl),[eo,eu]=h.useState(!1),{updateLocalFile:ef}=(0,K.sS)();h.useCallback(e=>{e.stopPropagation()},[]);let ej=h.useCallback(e=>{e.stopPropagation()},[]),ew=h.useCallback(e=>{R(Z,!0===e)},[Z]),eS=32*ee+8,eC=(null==(t=Z.mediaIds)?void 0:t.length)===1?null==el?void 0:el.find(e=>{var t;return e.id===(null==(t=Z.mediaIds)?void 0:t[0])}):void 0,eI=ed(Z),e_=null==eI?void 0:eI.filter(e=>{var t;return!!(null==(t=e.localFile)?void 0:t.mediaId)}),eT=null!=(S=null==eI?void 0:eI.length)?S:0,eA=null!=(E=null==e_?void 0:e_.length)?E:0,eD=null!=(C=null==eI?void 0:eI.every(e=>{var t;return!!(null==(t=e.localFile)?void 0:t.mediaId)}))&&C,eP=null==eI?void 0:eI.every(e=>{var t;return!!(null==(t=e.localFile)?void 0:t.ignored)}),eM=null==eI?void 0:eI.every(e=>!!e.localFile),eL=null==eI?void 0:eI.every(e=>{var t;return!!(null==(t=e.localFile)?void 0:t.locked)||!e.localFile}),[eO,eR]=h.useState(null!=eL&&eL);h.useEffect(()=>{eR(null!=eL&&eL)},[eL]);let eF=h.useMemo(()=>F-eS-620,[F,eS,null==eC||null==(n=eC.title)?void 0:n.userPreferred]),{isPending:eU}=(0,K.bU)(),ez=()=>{if(!eU){if(et)eO?H(ec(Z)):z(ec(Z));else{var e;(null==(e=Z.localFile)?void 0:e.locked)?H([Z.path]):z([Z.path])}eR(e=>!e)}},{setPreviewModalMediaId:eK}=(0,eE.D)(),eB=!!Z.localFile,[eV,eG]=h.useState(!1);return(0,a.jsxs)("div",{className:"px-2",children:[(0,a.jsx)(ek.i,{onOpenChange:eG,content:(0,a.jsxs)(ex.Q2,{children:[(0,a.jsx)(em.F7,{className:"text-[--muted] line-clamp-2 py-0 my-2 text-xs tracking-wide",children:Z.name}),(null==(l=Z.mediaIds)?void 0:l.length)===1&&(0,a.jsx)(em.kt,{onClick:function(){var e;eK(null!=(e=null==eC?void 0:eC.id)?e:0,"anime")},children:"Preview anime"}),(0,a.jsxs)(em.kt,{onClick:function(){et?(er(new Set(ec(Z))),h.startTransition(()=>{es(!0)})):(er(new Set([Z.path])),h.startTransition(()=>{es(!0)}))},children:[(0,a.jsx)(G.wwX,{})," Super update"]}),et&&!!eT&&(0,a.jsxs)(a.Fragment,{children:[eD&&(0,a.jsxs)(em.kt,{onClick:()=>{U(ec(Z))},className:(0,f.cn)("text-[--orange]",eU&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(eg.eXw,{className:"text-lg"})," Unmatch files"]}),!eD&&(0,a.jsxs)(em.kt,{onClick:()=>{$(ed(Z))},className:(0,f.cn)("text-[--green]",eU&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(eg.Raw,{className:"text-lg"})," Match files"]}),!eP&&(0,a.jsxs)(em.kt,{onClick:()=>{Q(ec(Z))},className:(0,f.cn)("",eU&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(ev.ofU,{className:"text-lg"})," Ignore files"]}),eP&&(0,a.jsxs)(em.kt,{onClick:()=>{X(ec(Z))},className:(0,f.cn)("text-purple-300",eU&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(ev.uKT,{className:"text-lg"})," Un-ignore files"]})]}),!et&&eB&&(0,a.jsxs)(a.Fragment,{children:[!!(null==(i=Z.localFile)?void 0:i.mediaId)&&(0,a.jsxs)(em.kt,{onClick:()=>eu(!0),className:(0,f.cn)("text-[--blue]",eU&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(ev.Pcz,{className:"text-lg"})," Edit metadata"]}),!!(null==(r=Z.localFile)?void 0:r.mediaId)&&(0,a.jsxs)(em.kt,{onClick:()=>{U([Z.path])},className:(0,f.cn)("text-[--orange]",eU&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(eg.eXw,{className:"text-lg"})," Unmatch file"]}),!(null==(s=Z.localFile)?void 0:s.mediaId)&&(0,a.jsxs)(em.kt,{onClick:()=>{$(ed(Z))},className:(0,f.cn)("text-[--green]",eU&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(eg.Raw,{className:"text-lg"})," Match file"]}),!(null==Z||null==(o=Z.localFile)?void 0:o.ignored)&&(0,a.jsxs)(em.kt,{onClick:()=>{Q([Z.path])},className:(0,f.cn)("",eU&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(ev.ofU,{className:"text-lg"})," Ignore file"]}),(null==Z||null==(c=Z.localFile)?void 0:c.ignored)&&(0,a.jsxs)(em.kt,{onClick:()=>{X([Z.path])},className:(0,f.cn)("text-purple-300",eU&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(ev.uKT,{className:"text-lg"})," Un-ignore file"]})]}),(0,a.jsx)(em.K5,{className:"!my-2"}),(0,a.jsxs)(em.kt,{onClick:()=>{Y(Z.path)},children:[(0,a.jsx)(D.gNt,{})," Open in explorer"]})]}),children:(0,a.jsx)(em.Rc,{children:(0,a.jsxs)("div",{className:(0,f.cn)("flex items-center px-2 h-10 rounded-md cursor-pointer select-none group/tree-node transition-colors",!en&&"hover:bg-gray-800/50",en&&"bg-brand-500/20 text-brand-100",eV&&"bg-gray-800/30"),style:{paddingLeft:eS},onClick:()=>{A(Z),et&&ea&&T(Z.path)},children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[et&&ea&&(0,a.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:_?(0,a.jsx)(D.nwe,{className:"size-4 text-gray-400"}):(0,a.jsx)(D.XWt,{className:"size-4 text-gray-400"})}),ei&&(et||eB)&&(0,a.jsx)("div",{className:"flex h-full items-center",children:(0,a.jsx)(q.Sc,{size:"md",fieldClass:"flex-shrink-0 flex items-center",value:function(e,t){if("file"===e.kind)return t.has(e.path);let n=ec(e);if(0===n.length)return!1;let a=n.filter(e=>t.has(e)).length;return 0!==a&&(a===n.length||"indeterminate")}(Z,O),onClick:ej,onValueChange:ew})}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(()=>{var e,t,n,l,i;return et?0===ee?(0,a.jsx)(P.nOB,{className:"size-5 text-brand-400"}):_?(0,a.jsx)(ey.b$g,{className:(0,f.cn)("size-5 text-brand-400/90",!(null==(l=Z.mediaIds)?void 0:l.length)&&"text-[--muted]")}):(0,a.jsx)(P.UDU,{className:(0,f.cn)("size-5 text-brand-400/80",!(null==(i=Z.mediaIds)?void 0:i.length)&&"text-[--muted]")}):Z.localFile?(0,a.jsx)(ev.bs1,{className:(0,f.cn)("size-4 text-[--muted]",(null==(e=Z.localFile.metadata)?void 0:e.type)==="main"&&"text-brand-400/70",(null==(t=Z.localFile.metadata)?void 0:t.type)==="special"&&"text-cyan-200/50",(null==(n=Z.localFile.metadata)?void 0:n.type)==="nc"&&"text-gray-200/30")}):(0,a.jsx)(ev.AHA,{className:"size-4 text-[--muted]"})})()}),et&&!!eC&&(0,a.jsx)("div",{className:"size-6 flex-none rounded-[--radius-md] object-cover object-center relative overflow-hidden ml-2",children:(0,a.jsx)(j.r,{src:(null==(d=eC.coverImage)?void 0:d.medium)||"",alt:(null==(u=eC.title)?void 0:u.userPreferred)||"",fill:!0,sizes:"1rem",className:"object-cover object-center"})}),et&&!eC&&!!(null==(p=Z.mediaIds)?void 0:p.length)&&(null==(x=Z.mediaIds)?void 0:x.length)>1&&(0,a.jsx)("div",{className:"h-6 px-2 flex-none rounded-[--radius-md] flex items-center justify-center bg-gray-800 ml-2 text-white text-xs font-semibold",children:null==(v=Z.mediaIds)?void 0:v.length}),(0,a.jsxs)("span",{className:"text-md tracking-wide text-gray-200 break-all group-hover/tree-node:text-gray-100 flex gap-1 items-center w-full overflow-hidden",style:{maxWidth:eF+"px"},children:[(0,a.jsx)("span",{className:(0,f.cn)("truncate min-w-0",!et&&!!Z.localFile&&!Z.localFile.mediaId&&"text-orange-200",!et&&!eB&&"text-red-200",!et&&(null==(g=Z.localFile)?void 0:g.ignored)&&"text-[--muted] italic"),children:"root"===Z.name?"Anime Libraries":Z.name}),!!eC&&(0,a.jsxs)("span",{className:(0,f.cn)("hidden tracking-normal 2xl:flex text-[--muted] text-sm flex-shrink whitespace-nowrap line-clamp-1 items-center gap-1"),style:{maxWidth:200},children:[(0,a.jsx)("span",{children:" - "}),(0,a.jsx)("span",{children:null==(y=eC.title)?void 0:y.userPreferred})]}),eP&&et&&(0,a.jsxs)("span",{className:(0,f.cn)("hidden 2xl:flex text-[--muted] text-sm flex-shrink whitespace-nowrap line-clamp-1 items-center gap-1"),style:{maxWidth:200},children:[(0,a.jsx)("span",{children:" "}),(0,a.jsx)("span",{children:"(Ignored)"})]})]})]}),et&&!!eT&&!eP&&(0,a.jsxs)("span",{className:(0,f.cn)("text-xs bg-green-500/20 text-[--green] px-2 py-0.5 rounded-full",eT!==eA&&"bg-orange-500/20 text-[--orange]",!eM&&"bg-red-500/20 text-[--red]"),children:[eA," / ",eT]}),!et&&eB&&!(null==(b=Z.localFile)?void 0:b.mediaId)&&!(null==(w=Z.localFile)?void 0:w.ignored)&&(0,a.jsx)("div",{className:"text-xs text-orange-200",children:"Not matched"}),!et&&!eB&&(0,a.jsx)("div",{className:"text-xs text-red-200",children:"Not scanned"}),(et&&(null==e_?void 0:e_.length)>0||eB&&!!Z.localFile.mediaId)&&(0,a.jsx)(ep.m_,{trigger:(0,a.jsx)(N.K0,{icon:eO?(0,a.jsx)(eb.zu7,{}):(0,a.jsx)(D.iXN,{}),intent:eO?"success-subtle":"warning-subtle",size:"xs",className:"hover:opacity-60 ml-2",loading:eU,onClick:e=>{e.stopPropagation(),ez()}}),children:eO?"Unlock all files":"Lock all files"})]})})}),Z.localFile&&(0,a.jsxs)(eh.a,{open:eo,onOpenChange:()=>eu(!1),title:"File metadata",titleClass:"text-center",contentClass:"max-w-xl",children:[(0,a.jsx)("p",{className:"w-full line-clamp-2 text-sm px-4 text-center py-2 flex-none",children:null==(k=Z.localFile)?void 0:k.name}),(0,a.jsxs)(W.lV,{schema:eN.Qx,onSubmit:e=>{if(Z.localFile){var t;ef(Z.localFile,{metadata:{...null==(t=Z.localFile)?void 0:t.metadata,type:e.type,episode:e.episode,aniDBEpisode:e.aniDBEpisode}},()=>{eu(!1),J.oR.success("Metadata saved")})}},onError:console.log,defaultValues:{...Z.localFile.metadata},children:[(0,a.jsx)(W.D0.Number,{label:"Episode number",name:"episode",help:"Relative episode number. If movie, episode number = 1",required:!0}),(0,a.jsx)(W.D0.Text,{label:"AniDB episode",name:"aniDBEpisode",help:"Specials typically contain the letter S"}),(0,a.jsx)(W.D0.Select,{label:"Type",name:"type",options:[{label:"Main",value:"main"},{label:"Special",value:"special"},{label:"NC/Other",value:"nc"}]}),(0,a.jsx)("div",{className:"w-full flex justify-end",children:(0,a.jsx)(W.D0.Submit,{role:"save",intent:"success",loading:eU,children:"Save"})})]})]})]})});function eD(e){var t,n,i,r,s,o,c,d,u,h,p,x,v,g,y,b,j,w,N,k,S,E,C,I,_,T,A,D,M,L,O,R,F,U,z,K;let G,H,q,W,Q,$,Y,Z,J,ee,et,en,ea,el,ei,er,es,eo,ec,ed=(0,l.c)(55),eu=(0,m.md)(V._S),em=(0,m.md)(B.Qy),eh=(null==eu?void 0:eu.kind)==="directory";ed[0]!==eh||ed[1]!==(null==eu?void 0:eu.name)?(G=eh?null:null==eu||null==(o=eu.name.split(".").pop())?void 0:o.toUpperCase(),ed[0]=eh,ed[1]=null==eu?void 0:eu.name,ed[2]=G):G=ed[2];let ep=G;ed[3]!==(null==eu||null==(t=eu.mediaIds)?void 0:t[0])||ed[4]!==(null==eu||null==(n=eu.mediaIds)?void 0:n.length)||ed[5]!==em?(H=(null==eu||null==(c=eu.mediaIds)?void 0:c.length)===1?null==em?void 0:em.find(e=>{var t;return e.id===(null==eu||null==(t=eu.mediaIds)?void 0:t[0])}):void 0,ed[3]=null==eu||null==(d=eu.mediaIds)?void 0:d[0],ed[4]=null==eu||null==(u=eu.mediaIds)?void 0:u.length,ed[5]=em,ed[6]=H):H=ed[6];let ef=H;ed[7]!==(null==eu?void 0:eu.children)?(q=null!=(x=null==eu||null==(p=eu.children)||null==(h=p.filter(eM))?void 0:h.length)?x:0,ed[7]=null==eu?void 0:eu.children,ed[8]=q):q=ed[8];let ex=q;ed[9]!==(null==eu?void 0:eu.children)?(W=null!=(y=null==eu||null==(g=eu.children)||null==(v=g.filter(eP))?void 0:v.length)?y:0,ed[9]=null==eu?void 0:eu.children,ed[10]=W):W=ed[10];let ev=W,ey=null==em?void 0:em.filter(e=>{var t;return null==eu||null==(t=eu.mediaIds)?void 0:t.includes(e.id)}),{setPreviewModalMediaId:eb}=(0,eE.D)();if(!eu){let e;return ed[11]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)("div",{className:"p-4 flex-1 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center text-gray-500",children:[(0,a.jsx)(P.UDU,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),(0,a.jsx)("p",{className:"text-sm",children:"Select a file or folder to view details"})]})}),ed[11]=e):e=ed[11],e}ed[12]!==eh||ed[13]!==(null==(r=eu.localFile)||null==(i=r.metadata)?void 0:i.type)||ed[14]!==(null==(s=eu.mediaIds)?void 0:s.length)?(Q=(0,a.jsx)("div",{className:"w-16 h-16 flex items-center justify-center mb-3",children:eh?(0,a.jsx)(P.UDU,{className:(0,f.cn)("w-12 h-12 text-brand-400",!(null==(b=eu.mediaIds)?void 0:b.length)&&"text-[--muted]")}):(0,a.jsx)(eg.tO7,{className:(0,f.cn)("w-12 h-12 text-[--muted]",(null==(w=eu.localFile)||null==(j=w.metadata)?void 0:j.type)==="main"&&"text-brand-400/80",(null==(k=eu.localFile)||null==(N=k.metadata)?void 0:N.type)==="special"&&"text-cyan-200/50",(null==(E=eu.localFile)||null==(S=E.metadata)?void 0:S.type)==="nc"&&"text-gray-200/30")})}),ed[12]=eh,ed[13]=null==(I=eu.localFile)||null==(C=I.metadata)?void 0:C.type,ed[14]=null==(_=eu.mediaIds)?void 0:_.length,ed[15]=Q):Q=ed[15],ed[16]!==eu.name?($=(0,a.jsx)("h3",{className:"font-semibold text-gray-100 break-all text-sm leading-tight",children:eu.name}),ed[16]=eu.name,ed[17]=$):$=ed[17],ed[18]!==ep?(Y=ep&&(0,a.jsxs)("span",{className:"text-xs text-gray-400 mt-1",children:[ep," File"]}),ed[18]=ep,ed[19]=Y):Y=ed[19],ed[20]!==Q||ed[21]!==$||ed[22]!==Y?(Z=(0,a.jsxs)("div",{className:"flex flex-col items-center text-center mb-6",children:[Q,$,Y]}),ed[20]=Q,ed[21]=$,ed[22]=Y,ed[23]=Z):Z=ed[23],ed[24]===Symbol.for("react.memo_cache_sentinel")?(J=(0,a.jsx)(X.w,{className:"mb-4"}),ed[24]=J):J=ed[24],ed[25]===Symbol.for("react.memo_cache_sentinel")?(ee=(0,a.jsx)("dt",{className:"text-gray-400 text-sm uppercase tracking-wide mb-1",children:"Type"}),ed[25]=ee):ee=ed[25];let ej=eh?"Folder":"File";ed[26]!==ej?(et=(0,a.jsxs)("div",{children:[ee,(0,a.jsx)("dd",{className:"text-gray-200",children:ej})]}),ed[26]=ej,ed[27]=et):et=ed[27],ed[28]===Symbol.for("react.memo_cache_sentinel")?(en=(0,a.jsx)("dt",{className:"text-gray-400 text-sm uppercase tracking-wide mb-1",children:"Path"}),ed[28]=en):en=ed[28],ed[29]!==eu.path?(ea=(0,a.jsxs)("div",{children:[en,(0,a.jsx)("dd",{className:"text-gray-200 text-xs font-mono bg-gray-900 p-2 rounded break-all",children:eu.path})]}),ed[29]=eu.path,ed[30]=ea):ea=ed[30],ed[31]!==eu.size?(el=eu.size&&(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-gray-400 text-sm uppercase tracking-wide mb-1",children:"Size"}),(0,a.jsx)("dd",{className:"text-gray-200",children:function(e){let t=["B","KB","MB","GB","TB"],n=e,a=0;for(;n>=1024&&a<t.length-1;)n/=1024,a++;return"".concat(n.toFixed(1)," ").concat(t[a])}(eu.size)})]}),ed[31]=eu.size,ed[32]=el):el=ed[32];let ew=eh&&eu.mediaIds&&eu.mediaIds.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-gray-400 text-sm uppercase tracking-wide mb-1",children:"Associated Media"}),(0,a.jsxs)("dd",{className:"text-gray-200",children:[eu.mediaIds.length," anime series"]}),eu.mediaIds.length>1&&eu.mediaIds.length<=5&&(null==ey?void 0:ey.map(e=>{var t;return(0,a.jsx)("dd",{onClick:()=>eb(e.id,"anime"),className:"text-gray-200 cursor-pointer underline line-clamp-2 hover:opacity-80",children:null==(t=e.title)?void 0:t.userPreferred},e.id)}))]});return ed[33]!==eu.localFile?(ei=eu.localFile&&(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsx)("dt",{className:"text-gray-400 text-sm uppercase tracking-wide",children:"Library File"}),(null==(T=eu.localFile)?void 0:T.mediaId)>0&&(0,a.jsx)("dd",{className:"text-[--green] text-sm",children:"✓ Matched"}),(null==(A=eu.localFile)?void 0:A.mediaId)===0&&(0,a.jsx)("dd",{className:"text-[--orange] text-sm",children:"Not matched"}),(0,a.jsxs)("dd",{className:"text-gray-200 text-sm",children:["Episode: ",(0,a.jsx)("span",{className:"font-semibold",children:null!=(z=null==(M=eu.localFile)||null==(D=M.metadata)?void 0:D.episode)?z:"N/A"})]}),(0,a.jsxs)("dd",{className:"text-gray-200 text-sm",children:["AniDB Episode: ",(0,a.jsx)("span",{className:"font-semibold",children:null!=(K=null==(O=eu.localFile)||null==(L=O.metadata)?void 0:L.aniDBEpisode)?K:"N/A"})]}),(0,a.jsxs)("dd",{className:"text-gray-200 text-sm",children:["Type: ",(0,a.jsx)("span",{className:"font-semibold",children:null==(U=eu.localFile)||null==(F=U.metadata)||null==(R=F.type)?void 0:R.toUpperCase()})]})]}),ed[33]=eu.localFile,ed[34]=ei):ei=ed[34],ed[35]!==ex||ed[36]!==ev||ed[37]!==eh||ed[38]!==eu.children?(er=eh&&eu.children&&(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-gray-400 text-sm uppercase tracking-wide mb-1",children:"Contents"}),(0,a.jsxs)("dd",{className:"text-gray-200",children:[ex," folder",1!=ex?"s":"",", "," ",ev," file",1!=ev?"s":""]})]}),ed[35]=ex,ed[36]=ev,ed[37]=eh,ed[38]=eu.children,ed[39]=er):er=ed[39],ed[40]!==ef||ed[41]!==eb?(es=!!ef&&(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(eS.V,{media:ef,type:"anime",onClick:()=>{eb(ef.id,"anime")}})}),ed[40]=ef,ed[41]=eb,ed[42]=es):es=ed[42],ed[43]!==et||ed[44]!==ea||ed[45]!==el||ed[46]!==ew||ed[47]!==ei||ed[48]!==er||ed[49]!==es?(eo=(0,a.jsxs)("div",{className:"space-y-3 text-sm",children:[et,ea,el,ew,ei,er,es]}),ed[43]=et,ed[44]=ea,ed[45]=el,ed[46]=ew,ed[47]=ei,ed[48]=er,ed[49]=es,ed[50]=eo):eo=ed[50],ed[51]!==J||ed[52]!==eo||ed[53]!==Z?(ec=(0,a.jsxs)("div",{className:"p-4 flex flex-col",children:[Z,J,eo]}),ed[51]=J,ed[52]=eo,ed[53]=Z,ed[54]=ec):ec=ed[54],ec}function eP(e){return"file"===e.kind}function eM(e){return"directory"===e.kind}var eL=n(91332),eO=n(78259);function eR(e){let t,n,i,r,s,o=(0,l.c)(8);(0,eL.Ky)();let[c,d]=(0,m.fp)(V.qE);return o[0]!==d?(t=e=>d(e),o[0]=d,o[1]=t):t=o[1],o[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,f.cn)("bg-gray-950 h-[90%] lg:h-[80%] bg-opacity-95 firefox:bg-opacity-100 lg:mx-[2rem] overflow-hidden"),o[2]=n):n=o[2],o[3]===Symbol.for("react.memo_cache_sentinel")?(i=(0,a.jsx)(eO.Ui,{atoms:[F.r],children:(0,a.jsx)(eI,{})}),o[3]=i):i=o[3],o[4]===Symbol.for("react.memo_cache_sentinel")?(r=(0,a.jsxs)(Y.Cz,{className:n,children:[i,(0,a.jsx)("div",{className:"block lg:hidden",children:(0,a.jsx)("p",{className:"text-center text-white text-lg font-semibold py-4",children:"Library explorer can only be rendered on larger screens."})})]}),o[4]=r):r=o[4],o[5]!==c||o[6]!==t?(s=(0,a.jsx)(Y.Tr,{open:c,onOpenChange:t,children:r}),o[5]=c,o[6]=t,o[7]=s):s=o[7],s}var eF=n(74889),eU=n(96826),ez=n(73832),eK=n(46278);function eB(e){var t,n,d,p,f,x,v,g;let y,b,j,w,k,S,E=(0,l.c)(29),C=(0,eK.jE)(),I=(0,eU.v1)(),[_,T]=(0,h.useState)(null),A=(0,ez.C)(!1),M=(0,ez.C)(!1),L=(0,ez.C)(!1),[O,R]=(0,h.useState)(0),F=(0,m.Xr)(i.ho);E[0]!==A||E[1]!==(null==I||null==(n=I.settings)||null==(t=n.library)?void 0:t.autoScan)?(y={type:u.c.LIBRARY_WATCHER_FILE_ADDED,onMessage:e=>{var t,n;console.log("Library watcher",e),(null==I||null==(n=I.settings)||null==(t=n.library)?void 0:t.autoScan)||(A.on(),T(e))}},E[0]=A,E[1]=null==I||null==(x=I.settings)||null==(f=x.library)?void 0:f.autoScan,E[2]=y):y=E[2],(0,r.oA)(y),E[3]!==M||E[4]!==(null==I||null==(p=I.settings)||null==(d=p.library)?void 0:d.autoScan)?(b={type:u.c.LIBRARY_WATCHER_FILE_REMOVED,onMessage:e=>{var t,n;console.log("Library watcher",e),(null==I||null==(n=I.settings)||null==(t=n.library)?void 0:t.autoScan)||(M.on(),T(e))}},E[3]=M,E[4]=null==I||null==(g=I.settings)||null==(v=g.library)?void 0:v.autoScan,E[5]=b):b=E[5],(0,r.oA)(b),E[6]!==A||E[7]!==M?(j={type:u.c.SCAN_PROGRESS,onMessage:e=>{T(null),A.off(),M.off(),R(e),100===e&&setTimeout(()=>{R(0)},2e3)}},E[6]=A,E[7]=M,E[8]=j):j=E[8],(0,r.oA)(j),E[9]!==L?(w={type:u.c.AUTO_SCAN_STARTED,onMessage:e=>{L.on()}},E[9]=L,E[10]=w):w=E[10],(0,r.oA)(w),E[11]!==L||E[12]!==C?(k={type:u.c.AUTO_SCAN_COMPLETED,onMessage:e=>{L.off(),J.oR.success("Library scanned"),C.invalidateQueries({queryKey:[eF.S.ANIME_COLLECTION.GetLibraryCollection.key]}),C.invalidateQueries({queryKey:[eF.S.ANIME_ENTRIES.GetMissingEpisodes.key]}),C.invalidateQueries({queryKey:[eF.S.AUTO_DOWNLOADER.GetAutoDownloaderItems.key]})}},E[11]=L,E[12]=C,E[13]=k):k=E[13],(0,r.oA)(k),E[14]!==A||E[15]!==M?(S=function(){T(null),A.off(),M.off()},E[14]=A,E[15]=M,E[16]=S):S=E[16];let U=S;if(L.active&&O>0){let e,t;return E[17]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(c.y$,{className:"size-6"}),E[17]=e):e=E[17],E[18]!==O?(t=(0,a.jsx)("div",{className:"z-50 fixed bottom-4 right-4",children:(0,a.jsx)(s.f,{children:(0,a.jsx)(o.Zp,{className:"w-fit max-w-[400px]",children:(0,a.jsx)(o.aR,{children:(0,a.jsxs)(o.BT,{className:"flex items-center gap-2 text-base",children:[e," ",O,"% Refreshing your library..."]})})})})}),E[18]=O,E[19]=t):t=E[19],t}if(_){let e,t,n,l,i;return E[20]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsxs)(o.aR,{children:[(0,a.jsxs)(o.ZB,{className:"text-lg flex items-center gap-2",children:[(0,a.jsx)(D.nlg,{className:"text-brand-400"}),"Library watcher"]}),(0,a.jsx)(o.BT,{className:"flex items-center gap-2 text-base",children:"A change has been detected in your library, refresh your entries."})]}),E[20]=e):e=E[20],E[21]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsx)(P.CKj,{}),E[21]=t):t=E[21],E[22]!==F?(n=(0,a.jsx)(o.wL,{children:(0,a.jsx)(N.$n,{intent:"primary-outline",leftIcon:t,size:"sm",onClick:()=>F(!0),className:"rounded-full",children:"Scan your library"})}),E[22]=F,E[23]=n):n=E[23],E[24]!==U?(l=(0,a.jsx)(N.Jn,{className:"absolute top-2 right-2",onClick:U}),E[24]=U,E[25]=l):l=E[25],E[26]!==n||E[27]!==l?(i=(0,a.jsx)("div",{className:"z-50 fixed bottom-4 right-4",children:(0,a.jsx)(s.f,{children:(0,a.jsxs)(o.Zp,{className:"w-full max-w-[400px] min-h-[150px] relative",children:[e,n,l]})})}),E[26]=n,E[27]=l,E[28]=i):i=E[28],i}return null}var eV=n(62322),eG=n(17946),eH=n(35349);let eq=(0,x.eU)(!1);function eW(){let e,t=(0,l.c)(3),[n,a]=(0,m.fp)(eq);return t[0]!==a||t[1]!==n?(e={syncIsActive:n,setSyncIsActive:a},t[0]=a,t[1]=n,t[2]=e):e=t[2],e}var eQ=n(10554),eX=n(28296),e$=n(39797),eY=n(93715),eZ=n(66380);let eJ=(0,x.eU)(!1),e0=(0,x.eU)(!1),e1=(0,x.eU)(!1);function e2(e){var t,n,l,i,s;let o=(0,eU.v1)(),[c,d]=(0,m.fp)(eJ),[p,f]=(0,m.fp)(e1),{data:x,isLoading:v,refetch:g}=(0,eQ.A2)(!!o&&!(null==o||null==(n=o.settings)||null==(t=n.library)?void 0:t.disableUpdateCheck));(0,r.oA)({type:u.c.CHECK_FOR_UPDATES,onMessage:()=>{g().then(()=>R())}});let[y,b]=h.useState(!0),[j,k]=h.useState(!1),[S,E]=h.useState(""),[C,I]=(0,m.fp)(e0),[_,T]=h.useState(!1),[A,M]=h.useState(!1),[L,O]=h.useState(0),R=h.useCallback(()=>{try{window.electron&&(b(!0),window.electron.checkForUpdates().then(e=>{k(e),b(!1)}).catch(e=>{(0,eY.v)("ELECTRON").error("Failed to check for updates",e),E(JSON.stringify(e)),b(!1)}))}catch(e){(0,eY.v)("ELECTRON").error("Failed to check for updates",e),f(!1)}},[]);async function F(){if(j&&!p)try{if(f(!0),window.electron){if(!A){J.oR.info("Downloading update..."),T(!0),await window.electron.checkForUpdates();return}try{J.oR.info("Shutting down server..."),await window.electron.killServer()}catch(e){(0,eY.v)("ELECTRON").error("Failed to kill server",e)}J.oR.info("Installing update..."),await window.electron.installUpdate(),I(!0),J.oR.info("Update installed. Restarting app...")}}catch(e){(0,eY.v)("ELECTRON").error("Failed to install update",e),J.oR.error("Failed to install update: ".concat(JSON.stringify(e))),f(!1),T(!1)}}return(h.useEffect(()=>{if(R(),window.electron){let e=window.electron.on("update-downloaded",()=>{J.oR.success("Update downloaded and ready to install"),T(!1),M(!0),O(100)}),t=window.electron.on("update-error",e=>{(0,eY.v)("ELECTRON").error("Update error",e),J.oR.error("Update error: ".concat(e)),f(!1),T(!1)}),n=window.electron.on("download-progress",e=>{O(Math.round(e.percent))}),a=window.electron.on("update-available",()=>{T(!0),M(!1),O(0),J.oR.info("Update found, downloading...")});return()=>{null==e||e(),null==t||t(),null==n||n(),null==a||a()}}},[]),h.useEffect(()=>{x&&x.release&&d(!0)},[x]),h.useEffect(()=>{A&&p&&!_&&F()},[A,p,_]),(null==o||null==(i=o.settings)||null==(l=i.library)?void 0:l.disableUpdateCheck)||v||y||!x||!x.release)?null:C?(0,a.jsx)("div",{className:"fixed top-0 left-0 w-full h-full bg-[--background] flex items-center z-[9999]",children:(0,a.jsxs)("div",{className:"container max-w-4xl py-10",children:[(0,a.jsx)("div",{className:"mb-4 flex justify-center w-full",children:(0,a.jsx)("img",{src:"/seanime-logo.png",alt:"logo",className:"w-14 h-auto"})}),(0,a.jsx)("p",{className:"text-center text-lg",children:"Update installed. The app will restart automatically."})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e$.m,{collapsed:e.collapsed,items:[{iconType:Z.$S7,name:"Update available",onClick:()=>d(!0)}],itemIconClass:"text-brand-300"}),(0,a.jsx)(eh.a,{open:c,onOpenChange:e=>!p&&d(e),contentClass:"max-w-3xl",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"text-center",children:"A new update is available!"}),(0,a.jsxs)("h4",{className:"font-bold flex gap-2 text-center items-center justify-center",children:[(0,a.jsx)("span",{className:"text-[--muted]",children:x.current_version})," ",(0,a.jsx)(P.dyV,{}),(0,a.jsx)("span",{className:"text-indigo-200",children:x.release.version})]}),!j&&(0,a.jsx)(eu.F,{intent:"warning",children:"This update is not yet available for desktop clients. Wait a few minutes or check the GitHub page for more information."}),(0,a.jsx)(eX.O,{updateData:x}),(0,a.jsxs)("div",{className:"flex gap-2 w-full !mt-4",children:[j&&(0,a.jsx)(N.$n,{leftIcon:(0,a.jsx)(eZ.$Wp,{className:"text-2xl"}),onClick:F,loading:p||_,disabled:v,children:_?"Downloading... ".concat(L,"%"):A?"Install now":"Download & Install"}),(0,a.jsx)("div",{className:"flex flex-1"}),(0,a.jsx)(w.i,{href:(null==x||null==(s=x.release)?void 0:s.html_url)||"",target:"_blank",children:(0,a.jsx)(N.$n,{intent:"white-subtle",rightIcon:(0,a.jsx)(D.zaF,{}),children:"See on GitHub"})})]})]})})]})}var e3=n(48683),e4=n(21335),e5=n(15388);let e6=(0,f.u)({root:(0,e4.F)(["UI-NavigationMenu__root","relative inline-block z-10 max-w-full"]),item:(0,e4.F)(["UI-NavigationMenu__item","relative group/navigationMenu_item inline-flex !text-[1.15rem] items-center h-full select-none rounded-[--radius] leading-none no-underline outline-none transition-colors","text-[--muted] hover:text-[--foreground]","data-[current=true]:text-white","font-[600] leading-none","focus-visible:ring-1 focus-visible:ring-inset focus-visible:ring-[--ring]"],{variants:{size:{sm:"px-3 h-8 text-sm",md:"px-2 sm",lg:"px-3 h-12 text-base"}},defaultVariants:{size:"md"}}),icon:(0,e4.F)(["UI-VerticalNav__icon","flex-shrink-0 mr-3","text-[--muted] group-hover/navigationMenu_item:text-[--foreground] data-[current=true]:text-[--brand] data-[current=true]:group-hover/navigationMenu_item:text-[--brand]"],{variants:{size:{sm:"size-4",md:"size-5",lg:"size-6"}},defaultVariants:{size:"md"}}),itemChevron:(0,e4.F)(["UI-VerticalNav__itemChevron","ml-2 w-4 h-4 transition-transform duration-200 group-hover/navigationMenu_item:rotate-180"]),desktopList:(0,e4.F)(["UI-VerticalNav__desktopList","inline-block space-x-1"],{variants:{switchToDrawerBelow:{sm:"hidden sm:flex",md:"hidden md:flex",lg:"hidden lg:flex",never:"flex"}},defaultVariants:{switchToDrawerBelow:"md"}}),mobileTrigger:(0,e4.F)(["UI-VerticalNav__mobileTrigger","items-center justify-center rounded-[--radius] p-2 text-[--muted] hover:bg-[--subtle] hover:text-[--foreground]","focus:outline-none focus:ring-2 focus:ring-inset focus:ring-[--ring]"],{variants:{switchToDrawerBelow:{sm:"inline-flex sm:hidden",md:"inline-flex md:hidden",lg:"inline-flex lg:hidden",never:"hidden"}},defaultVariants:{switchToDrawerBelow:"md"}}),menuContainer:(0,e4.F)(["UI-NavigationMenu__menuContainer","absolute left-0 top-0 p-1 data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out","data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52","data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52","data-[motion=to-start]:slide-out-to-left-52 w-full sm:min-w-full"]),viewport:(0,e4.F)(["UI-NavigationMenu__viewport","relative mt-1.5 duration-300 h-[var(--radix-navigation-menu-viewport-height)]","w-full min-w-96 rounded-[--radius] shadow-sm border bg-[--paper] text-[--foreground]","data-[state=open]:animate-in data-[state=open]:zoom-in-90 data-[state=open]:fade-in-25","data-[state=closed]:animate-out data-[state=closed]:zoom-out-100 data-[state=closed]:fade-out-0"])}),e8=h.forwardRef((e,t)=>{let n,i,r,s,o,c,d,u,m,p,x,v,g,y,b,j,N,k,S,E,C,I,_,T,A,D,P,M,L,O,R,F,U,z=(0,l.c)(69);if(z[0]!==e){let{children:t,iconClass:a,itemClass:l,desktopListClass:h,itemChevronClass:f,mobileTriggerClass:j,menuContainerClass:w,viewportClass:N,className:k,switchToDrawerBelow:S,mobileDrawerHeader:E,mobileDrawerContent:C,mobileDrawerProps:I,items:_,size:T,...A}=e;r=a,o=l,i=h,s=f,x=j,d=w,b=N,n=k,y=S,m=E,u=C,p=I,c=_,g=T,v=A,z[0]=e,z[1]=n,z[2]=i,z[3]=r,z[4]=s,z[5]=o,z[6]=c,z[7]=d,z[8]=u,z[9]=m,z[10]=p,z[11]=x,z[12]=v,z[13]=g,z[14]=y,z[15]=b}else n=z[1],i=z[2],r=z[3],s=z[4],o=z[5],c=z[6],d=z[7],u=z[8],m=z[9],p=z[10],x=z[11],v=z[12],g=z[13],y=z[14],b=z[15];let[K,B]=h.useState(!1);z[16]!==r||z[17]!==g?(j=e=>{let{item:t}=e;return t.iconType?(0,a.jsx)(t.iconType,{className:(0,f.cn)(e6.icon({size:g}),r),"aria-hidden":"true","data-current":t.isCurrent}):null},z[16]=r,z[17]=g,z[18]=j):j=z[18];let V=j;return z[19]!==n?(N=(0,f.cn)(e6.root(),n),z[19]=n,z[20]=N):N=z[20],z[21]!==x||z[22]!==y?(k=(0,f.cn)(e6.mobileTrigger({switchToDrawerBelow:y}),x),z[21]=x,z[22]=y,z[23]=k):k=z[23],z[24]===Symbol.for("react.memo_cache_sentinel")?(S=()=>B(e7),E=(0,a.jsx)("span",{className:"sr-only",children:"Open main menu"}),z[24]=S,z[25]=E):(S=z[24],E=z[25]),z[26]!==K?(C=K?(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"block h-6 w-6",children:[(0,a.jsx)("line",{x1:"18",x2:"6",y1:"6",y2:"18"}),(0,a.jsx)("line",{x1:"6",x2:"18",y1:"6",y2:"18"})]}):(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"block h-6 w-6",children:[(0,a.jsx)("line",{x1:"4",x2:"20",y1:"12",y2:"12"}),(0,a.jsx)("line",{x1:"4",x2:"20",y1:"6",y2:"6"}),(0,a.jsx)("line",{x1:"4",x2:"20",y1:"18",y2:"18"})]}),z[26]=K,z[27]=C):C=z[27],z[28]!==k||z[29]!==C?(I=(0,a.jsxs)("button",{className:k,onClick:S,children:[E,C]}),z[28]=k,z[29]=C,z[30]=I):I=z[30],z[31]===Symbol.for("react.memo_cache_sentinel")?(_=e=>B(e),z[31]=_):_=z[31],z[32]===Symbol.for("react.memo_cache_sentinel")?(T=()=>B(!1),z[32]=T):T=z[32],z[33]!==c?(A=(0,a.jsx)(e$.m,{items:c,className:"mt-2",onLinkItemClick:T}),z[33]=c,z[34]=A):A=z[34],z[35]!==u||z[36]!==m||z[37]!==p||z[38]!==K||z[39]!==A?(D=(0,a.jsxs)(e5._s,{open:K,onOpenChange:_,side:"left",...p,children:[m,A,u]}),z[35]=u,z[36]=m,z[37]=p,z[38]=K,z[39]=A,z[40]=D):D=z[40],z[41]!==i||z[42]!==y?(P=(0,f.cn)(e6.desktopList({switchToDrawerBelow:y}),i),z[41]=i,z[42]=y,z[43]=P):P=z[43],z[44]!==V||z[45]!==s||z[46]!==o||z[47]!==c||z[48]!==d||z[49]!==K||z[50]!==t||z[51]!==g?(M=c.map(e=>e.subContent?(0,a.jsxs)(e3.q7,{children:[(0,a.jsxs)(e3.l9,{className:(0,f.cn)(e6.item({size:g}),o),"data-current":e.isCurrent,children:[(0,a.jsx)(V,{item:e}),(0,a.jsx)("span",{className:"flex-none",children:e.name}),(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:(0,f.cn)(e6.itemChevron(),s),"data-open":"".concat(K),children:(0,a.jsx)("polyline",{points:"6 9 12 15 18 9"})})]}),(0,a.jsx)(e3.UC,{ref:t,className:(0,f.cn)(e6.menuContainer(),d),children:(0,a.jsx)("div",{className:"w-full",children:e.subContent&&e.subContent})})]},e.name):(0,a.jsx)(e3.q7,{children:(0,a.jsx)(e3.Ws,{asChild:!0,children:e.href?(0,a.jsxs)(w.i,{href:e.href,className:(0,f.cn)(e6.item({size:g}),o),"data-current":e.isCurrent,children:[(0,a.jsx)(V,{item:e}),(0,a.jsx)("span",{className:"flex-none",children:e.name}),e.addon]}):(0,a.jsxs)("button",{className:(0,f.cn)(e6.item({size:g}),o),"data-current":e.isCurrent,children:[(0,a.jsx)(V,{item:e}),(0,a.jsx)("span",{className:"flex-none",children:e.name}),e.addon]})})},e.name)),z[44]=V,z[45]=s,z[46]=o,z[47]=c,z[48]=d,z[49]=K,z[50]=t,z[51]=g,z[52]=M):M=z[52],z[53]!==P||z[54]!==M?(L=(0,a.jsx)(e3.B8,{className:P,children:M}),z[53]=P,z[54]=M,z[55]=L):L=z[55],z[56]===Symbol.for("react.memo_cache_sentinel")?(O=(0,f.cn)("perspective-[2000px] absolute left-0 top-full w-full flex justify-center"),z[56]=O):O=z[56],z[57]!==b?(R=(0,f.cn)(e6.viewport(),b),z[57]=b,z[58]=R):R=z[58],z[59]!==R?(F=(0,a.jsx)("div",{className:O,children:(0,a.jsx)(e3.LM,{className:R})}),z[59]=R,z[60]=F):F=z[60],z[61]!==t||z[62]!==v||z[63]!==N||z[64]!==D||z[65]!==L||z[66]!==F||z[67]!==I?(U=(0,a.jsxs)(e3.bL,{ref:t,className:N,...v,children:[I,D,L,F]}),z[61]=t,z[62]=v,z[63]=N,z[64]=D,z[65]=L,z[66]=F,z[67]=I,z[68]=U):U=z[68],U});function e7(e){return!e}e8.displayName="NavigationMenu";let e9=e=>{var t,n,i,r,s,o,c,d;let u,m,h,p,f,x,v=(0,l.c)(12),g=(0,eU.v1)(),y=(0,A.usePathname)();null==g||null==(n=g.settings)||null==(t=n.library)||t.enableManga;let b="/offline"===y;v[0]!==b?(m={href:"/offline",isCurrent:b,name:"Anime Library"},v[0]=b,v[1]=m):m=v[1],v[2]!==y||v[3]!==(null==g||null==(r=g.settings)||null==(i=r.library)?void 0:i.enableManga)?(h=(null==g||null==(o=g.settings)||null==(s=o.library)?void 0:s.enableManga)&&{href:"/offline/manga",icon:null,isCurrent:y.includes("/offline/manga"),name:"Manga"},v[2]=y,v[3]=null==g||null==(d=g.settings)||null==(c=d.library)?void 0:c.enableManga,v[4]=h):h=v[4],v[5]!==h?(p=[h].filter(Boolean),v[5]=h,v[6]=p):p=v[6];let j=p;return v[7]!==m||v[8]!==j?(f=[m,...j].filter(Boolean),v[7]=m,v[8]=j,v[9]=f):f=v[9],u=f,v[10]!==u?(x=(0,a.jsx)(e8,{className:"p-0 hidden lg:inline-block",itemClass:"text-xl",items:u}),v[10]=u,v[11]=x):x=v[11],x};function te(){let e,t,n=(0,l.c)(4),i=(0,A.usePathname)();return n[0]!==i?(e=!i.startsWith("/entry")&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{"data-layout-header-background":!0,className:(0,f.cn)("bg-[#000] opacity-50 bg-contain bg-center bg-repeat z-[-2] w-full h-[20rem] absolute bottom-0")}),(0,a.jsx)("div",{"data-layout-header-background-gradient":!0,className:"w-full absolute bottom-0 h-[8rem] bg-gradient-to-t from-[--background] to-transparent z-[-2]"})]}),n[0]=i,n[1]=e):e=n[1],n[2]!==e?(t=(0,a.jsx)(a.Fragment,{children:e}),n[2]=e,n[3]=t):t=n[3],t}var tt=n(52116);let tn=e=>{var t,n,i,r,s,o,c,d;let u,m,h,p,f,x,v,g,y,b,j,w,N=(0,l.c)(27),k=(0,eU.v1)(),S=(0,A.usePathname)();(0,tt.Wk)(),null==k||null==(n=k.settings)||null==(t=n.library)||t.enableManga;let E="/"===S;N[0]!==E?(m={href:"/",isCurrent:E,name:"Home"},N[0]=E,N[1]=m):m=N[1],N[2]!==S?(h=S.startsWith("/schedule"),N[2]=S,N[3]=h):h=N[3],N[4]!==h?(p={href:"/schedule",icon:null,isCurrent:h,name:"Schedule"},N[4]=h,N[5]=p):p=N[5],N[6]!==S||N[7]!==(null==k||null==(r=k.settings)||null==(i=r.library)?void 0:i.enableManga)?(f=(null==k||null==(o=k.settings)||null==(s=o.library)?void 0:s.enableManga)&&{href:"/manga",icon:null,isCurrent:S.startsWith("/manga"),name:"Manga"},N[6]=S,N[7]=null==k||null==(d=k.settings)||null==(c=d.library)?void 0:c.enableManga,N[8]=f):f=N[8],N[9]!==f?(x=[f].filter(Boolean),N[9]=f,N[10]=x):x=N[10];let C=x;return N[11]!==S?(v=S.startsWith("/lists"),N[11]=S,N[12]=v):v=N[12],N[13]!==v?(g={href:"/lists",icon:null,isCurrent:v,name:"My lists"},N[13]=v,N[14]=g):g=N[14],N[15]!==S?(y=S.startsWith("/discover")||S.startsWith("/search"),N[15]=S,N[16]=y):y=N[16],N[17]!==y?(b={href:"/discover",icon:null,isCurrent:y,name:"Discover"},N[17]=y,N[18]=b):b=N[18],N[19]!==b||N[20]!==m||N[21]!==p||N[22]!==C||N[23]!==g?(j=[m,p,...C,g,b].filter(Boolean),N[19]=b,N[20]=m,N[21]=p,N[22]=C,N[23]=g,N[24]=j):j=N[24],u=j,N[25]!==u?(w=(0,a.jsx)(e8,{className:"p-0 hidden lg:inline-block",items:u,desktopListClass:"space-x-0","data-top-menu":!0}),N[25]=u,N[26]=w):w=N[26],w};var ta=n(10109),tl=n(28002);let ti=(0,x.eU)(!1),tr=(0,x.eU)(!1);function ts(e){let t,n,i=(0,l.c)(6),{asSidebarButton:r}=e,[s]=(0,m.fp)(ti),[,o]=(0,m.fp)(tr);return i[0]!==r||i[1]!==s||i[2]!==o?(t=s&&(0,a.jsx)(a.Fragment,{children:r?(0,a.jsx)(N.K0,{"data-manual-progress-tracking-button":!0,intent:"primary-subtle",className:(0,f.cn)("animate-pulse"),icon:(0,a.jsx)(tl.OpB,{}),onClick:()=>o(!0)}):(0,a.jsx)(N.$n,{"data-manual-progress-tracking-button":!0,intent:"primary",className:(0,f.cn)("animate-pulse"),leftIcon:(0,a.jsx)(tl.OpB,{}),onClick:()=>o(!0),children:"Currently watching"})}),i[0]=r,i[1]=s,i[2]=o,i[3]=t):t=i[3],i[4]!==t?(n=(0,a.jsx)(a.Fragment,{children:t}),i[4]=t,i[5]=n):n=i[5],n}function to(){let e,t,n,i,s,o,c,d,p,f,x,v,g,y=(0,l.c)(38),[b,w]=(0,m.fp)(ti),k=h.useRef(null),[S,E]=h.useState(null),[C,I]=(0,m.fp)(tr);y[0]!==b||y[1]!==w?(e={type:u.c.PLAYBACK_MANAGER_MANUAL_TRACKING_PLAYBACK_STATE,onMessage:e=>{b||w(!0),E(e)}},y[0]=b,y[1]=w,y[2]=e):e=y[2],(0,r.oA)(e),y[3]!==I||y[4]!==S?(t=()=>{null===k.current&&I(!0),k.current=S},y[3]=I,y[4]=S,y[5]=t):t=y[5],y[6]!==S?(n=[S],y[6]=S,y[7]=n):n=y[7],h.useEffect(t,n),y[8]!==w||y[9]!==I?(i={type:u.c.PLAYBACK_MANAGER_MANUAL_TRACKING_STOPPED,onMessage:()=>{w(!1),I(!1),E(null)}},y[8]=w,y[9]=I,y[10]=i):i=y[10],(0,r.oA)(i);let{mutate:_,isPending:T}=(0,ta.gv)(),{isPending:A}=(0,ta.a8)();y[11]!==w||y[12]!==I?(s={onSuccess:()=>{I(!1),E(null),w(!1)}},y[11]=w,y[12]=I,y[13]=s):s=y[13];let{mutate:D,isPending:P}=(0,ta.mS)(s),M=C&&b;y[14]!==I?(o=e=>I(e),y[14]=I,y[15]=o):o=y[15],y[16]!==S?(c=S&&(0,a.jsxs)("div",{"data-manual-progress-tracking-modal-content":!0,className:"text-center relative overflow-hidden space-y-2",children:[(0,a.jsx)("p",{className:"text-[--muted]",children:"Playing externally"}),S.mediaCoverImage&&(0,a.jsx)("div",{className:"size-16 rounded-full relative mx-auto overflow-hidden mb-3",children:(0,a.jsx)(j.r,{src:S.mediaCoverImage,alt:"cover image",fill:!0,className:"object-cover object-center"})}),(0,a.jsx)("h3",{className:"text-lg font-medium line-clamp-1",children:null==S?void 0:S.mediaTitle}),(0,a.jsxs)("p",{className:"text-2xl font-bold",children:["Episode ",null==S?void 0:S.episodeNumber,(0,a.jsxs)("span",{className:"text-[--muted]",children:[" / ",(null==S?void 0:S.mediaTotalEpisodes)&&(null==S?void 0:S.mediaTotalEpisodes)>0?null==S?void 0:S.mediaTotalEpisodes:"-"]})]})]}),y[16]=S,y[17]=c):c=y[17];let L=T||A||P;y[18]!==_?(d=()=>_(),y[18]=_,y[19]=d):d=y[19],y[20]!==T||y[21]!==L||y[22]!==d?(p=(0,a.jsx)(N.$n,{intent:"primary-subtle",disabled:L,onClick:d,className:"w-full",loading:T,children:"Update progress now"}),y[20]=T,y[21]=L,y[22]=d,y[23]=p):p=y[23];let O=T||A||P;return y[24]!==D?(f=()=>D(),y[24]=D,y[25]=f):f=y[25],y[26]!==P||y[27]!==O||y[28]!==f?(x=(0,a.jsx)(N.$n,{intent:"alert-subtle",disabled:O,onClick:f,className:"w-full",loading:P,children:"Stop"}),y[26]=P,y[27]=O,y[28]=f,y[29]=x):x=y[29],y[30]!==p||y[31]!==x?(v=(0,a.jsxs)("div",{"data-manual-progress-tracking-modal-buttons":!0,className:"flex gap-2 w-full",children:[p,x]}),y[30]=p,y[31]=x,y[32]=v):v=y[32],y[33]!==v||y[34]!==M||y[35]!==o||y[36]!==c?(g=(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(eh.a,{"data-manual-progress-tracking-modal":!0,open:M,onOpenChange:o,titleClass:"text-center",contentClass:"!space-y-2 relative max-w-2xl",children:[c,v]})}),y[33]=v,y[34]=M,y[35]=o,y[36]=c,y[37]=g):g=y[37],g}var tc=n(73499),td=n(37614);function tu(e){let t,n,i,r,s,o,c,d,u,m=(0,l.c)(23),{autoplayState:h,onCancel:p,onPlayNow:f}=e,{isActive:x,countdown:v,nextEpisode:g}=h;m[0]!==p?(t=()=>{(0,eY.v)("AutoplayCountdownModal").info("User cancelled autoplay"),p()},m[0]=p,m[1]=t):t=m[1];let y=t;m[2]!==f?(n=()=>{(0,eY.v)("AutoplayCountdownModal").info("User requested immediate play"),null==f||f()},m[2]=f,m[3]=n):n=m[3];let b=n;return x?((()=>{if(g){var e,t,n;return g.displayTitle,g.episodeTitle,(null==(e=g.episodeMetadata)?void 0:e.image)||null==(n=g.baseAnime)||null==(t=n.coverImage)||t.large}})(),m[4]!==y?(i=e=>{e||y()},m[4]=y,m[5]=i):i=m[5],m[6]!==v?(r=(0,a.jsx)("div",{className:"rounded-[--radius-md] text-center",children:(0,a.jsx)("h3",{className:"text-5xl font-bold",children:v})}),m[6]=v,m[7]=r):r=m[7],m[8]!==y?(s=(0,a.jsx)(N.$n,{intent:"gray-basic",onClick:y,className:"flex-1",size:"sm",children:"Cancel"}),m[8]=y,m[9]=s):s=m[9],m[10]!==b||m[11]!==f?(o=f&&(0,a.jsx)(N.$n,{intent:"primary",onClick:b,className:"flex-1",size:"sm",leftIcon:(0,a.jsx)(D.XTW,{}),children:"Play Now"}),m[10]=b,m[11]=f,m[12]=o):o=m[12],m[13]!==s||m[14]!==o?(c=(0,a.jsxs)("div",{className:"flex gap-2 pt-2",children:[s,o]}),m[13]=s,m[14]=o,m[15]=c):c=m[15],m[16]!==r||m[17]!==c?(d=(0,a.jsxs)("div",{className:"text-center space-y-4",children:[r,c]}),m[16]=r,m[17]=c,m[18]=d):d=m[18],m[19]!==x||m[20]!==i||m[21]!==d?(u=(0,a.jsx)(eh.a,{open:x,onOpenChange:i,titleClass:"text-center",hideCloseButton:!0,title:"Playing next episode in",contentClass:"!space-y-4 relative max-w-xl border-transparent !rounded-3xl",closeClass:"!text-[--red]",children:d}),m[19]=x,m[20]=i,m[21]=d,m[22]=u):u=m[22],u):null}var tm=n(75733),th=n(35656),tp=n(4573),tf=n.n(tp);let tx=(0,x.eU)(!1),tv=(0,x.eU)(!1),tg=(0,x.eU)(!1),ty=(0,eY.v)("PLAYBACK MANAGER");function tb(e){let t,n,i=(0,l.c)(6),{asSidebarButton:r}=e,[,s]=(0,m.fp)(tx),o=(0,m.md)(tv),c=(0,m.md)(tg),d=o||c;return i[0]!==r||i[1]!==s||i[2]!==d?(t=d&&(0,a.jsx)(a.Fragment,{children:r?(0,a.jsx)(N.K0,{"data-progress-tracking-button":!0,intent:"primary-subtle",className:(0,f.cn)("animate-pulse"),icon:(0,a.jsx)(tl.OpB,{}),onClick:()=>s(!0)}):(0,a.jsx)(N.$n,{"data-progress-tracking-button":!0,intent:"primary",className:(0,f.cn)("animate-pulse"),leftIcon:(0,a.jsx)(tl.OpB,{}),onClick:()=>s(!0),children:"Currently watching"})}),i[0]=r,i[1]=s,i[2]=d,i[3]=t):t=i[3],i[4]!==t?(n=(0,a.jsx)(a.Fragment,{children:t}),i[4]=t,i[5]=n):n=i[5],n}function tj(){var e,t,n,i,s,o,c,p,x,v,g;let y,b,w,k,S,E,C,I,_,T,A,P,M,L,O,R,F,U,z,K,B,V,G,H,q,W,Q,X=(0,l.c)(101),$=(0,eU.v1)(),Y=(0,eK.jE)(),[Z,ee]=(0,m.fp)(tx),[et,en]=(0,m.fp)(tv),[ea,el]=(0,m.fp)(tg),ei=et||ea,[er,es]=h.useState(null),[eo,ec]=h.useState(null),{state:ed,startAutoplay:eu,cancelAutoplay:em}=(0,tc.bN)(),ep=(0,tc.A9)((null==er?void 0:er.mediaId)||0,(null==er?void 0:er.episodeNumber)||0),{currentPlaylist:ef}=(0,td.n)(),{mutate:ex,isPending:ev}=(0,ta.gv)(),ey=null==eo||null==(e=eo.current)?void 0:e.name;X[0]!==ey?(y=[ey],X[0]=ey,X[1]=y):y=X[1];let{mutate:eb,isSuccess:ej}=(0,ta.YI)(y),ew=null==eo||null==(t=eo.current)?void 0:t.name;X[2]!==ew?(b=[ew],X[2]=ew,X[3]=b):b=X[3];let{mutate:eN,isSuccess:ek}=(0,ta.QQ)(b),eS=null==er?void 0:er.filename;X[4]!==eS?(w=[eS],X[4]=eS,X[5]=w):w=X[5];let{mutate:eE,isSuccess:eC,isPending:eI}=(0,ta.R7)(w);X[6]!==el||X[7]!==en||X[8]!==ee?(k={type:u.c.PLAYBACK_MANAGER_PROGRESS_TRACKING_STARTED,onMessage:e=>{ty.info("Tracking started",e),en(!0),el(!1),ee(!0),es(e)}},X[6]=el,X[7]=en,X[8]=ee,X[9]=k):k=X[9],(0,r.oA)(k),X[10]!==el?(S={type:u.c.PLAYBACK_MANAGER_PROGRESS_VIDEO_COMPLETED,onMessage:e=>{ty.info("Video completed",e),el(!0),es(e)}},X[10]=el,X[11]=S):S=X[11],(0,r.oA)(S),X[12]!==ed||X[13]!==ef||X[14]!==ep||X[15]!==Y||X[16]!==el||X[17]!==en||X[18]!==eu||X[19]!==er?(E={type:u.c.PLAYBACK_MANAGER_PROGRESS_TRACKING_STOPPED,onMessage:e=>{ty.info("Tracking stopped",e,"Completion percentage:",null==er?void 0:er.completionPercentage),en(!1),(null==er?void 0:er.progressUpdated)&&(ty.info("Progress updated, setting isCompleted to false"),el(!1),es(null)),"Player closed"===e?(J.oR.info("Player closed"),.8>=((null==er?void 0:er.completionPercentage)||0)&&el(!1)):"Tracking stopped"===e?J.oR.info("Tracking stopped"):J.oR.error(e),Y.invalidateQueries({queryKey:[eF.S.CONTINUITY.GetContinuityWatchHistory.key]}).then(),!ef&&er&&er.completionPercentage&&er.completionPercentage>.7&&!ed.isActive&&eu(er,ep||void 0,"local")}},X[12]=ed,X[13]=ef,X[14]=ep,X[15]=Y,X[16]=el,X[17]=en,X[18]=eu,X[19]=er,X[20]=E):E=X[20],(0,r.oA)(E),X[21]!==et||X[22]!==en?(C={type:u.c.PLAYBACK_MANAGER_PROGRESS_PLAYBACK_STATE,onMessage:e=>{et||en(!0),es(e)}},X[21]=et,X[22]=en,X[23]=C):C=X[23],(0,r.oA)(C);let e_=(0,eK.jE)();X[24]!==e_?(I={type:u.c.PLAYBACK_MANAGER_PROGRESS_UPDATED,onMessage:e=>{e&&(e_.invalidateQueries({queryKey:[eF.S.ANIME_ENTRIES.GetAnimeEntry.key,String(e.mediaId)]}),e_.invalidateQueries({queryKey:[eF.S.ANIME_COLLECTION.GetLibraryCollection.key]}),e_.invalidateQueries({queryKey:[eF.S.ANILIST.GetAnimeCollection.key]}),es(e),J.oR.success("Progress updated"))}},X[24]=e_,X[25]=I):I=X[25],(0,r.oA)(I),X[26]===Symbol.for("react.memo_cache_sentinel")?(_={type:u.c.PLAYBACK_MANAGER_PLAYLIST_STATE,onMessage:e=>{ec(e)}},X[26]=_):_=X[26],(0,r.oA)(_),X[27]!==eb||X[28]!==ej?(T={title:"Play next episode",description:"Are you sure you want to play the next episode?",actionText:"Confirm",actionIntent:"success",onConfirm:()=>{ej||eb()}},X[27]=eb,X[28]=ej,X[29]=T):T=X[29];let eT=(0,tm.J)(T);X[30]!==em||X[31]!==ev||X[32]!==eE||X[33]!==eb||X[34]!==eo||X[35]!==(null==er?void 0:er.canPlayNext)||X[36]!==(null==er?void 0:er.completionPercentage)||X[37]!==ex?(A=()=>(tf().bind("u",()=>{!ev&&(null==er?void 0:er.completionPercentage)&&(null==er?void 0:er.completionPercentage)>.7&&ex()}),tf().bind("space",()=>{!ev&&(null==er?void 0:er.completionPercentage)&&(null==er?void 0:er.completionPercentage)>.7&&(em(),(null==er?void 0:er.canPlayNext)&&!eo&&eE(),(null==eo?void 0:eo.next)&&eb())}),tw),X[30]=em,X[31]=ev,X[32]=eE,X[33]=eb,X[34]=eo,X[35]=null==er?void 0:er.canPlayNext,X[36]=null==er?void 0:er.completionPercentage,X[37]=ex,X[38]=A):A=X[38];let eA=(null==er?void 0:er.completionPercentage)&&(null==er?void 0:er.completionPercentage)>.7,eD=null==er?void 0:er.canPlayNext,eP=!!(null==eo?void 0:eo.next);X[39]!==em||X[40]!==eA||X[41]!==eD||X[42]!==eP?(P=[eA,eD,eP,em],X[39]=em,X[40]=eA,X[41]=eD,X[42]=eP,X[43]=P):P=X[43],h.useEffect(A,P),X[44]!==eE||X[45]!==eC?(M={title:"Play next episode",description:"Are you sure you want to play the next episode?",actionText:"Confirm",actionIntent:"success",onConfirm:()=>{eC||eE()}},X[44]=eE,X[45]=eC,X[46]=M):M=X[46];let eM=(0,tm.J)(M);X[47]!==eN||X[48]!==ek?(L={title:"Play next",actionText:"Confirm",actionIntent:"alert",description:"Are you sure you want to stop the playlist? It will be deleted.",onConfirm:()=>{ek||eN()}},X[47]=eN,X[48]=ek,X[49]=L):L=X[49];let eL=(0,tm.J)(L);X[50]!==ex?(O=function(){ex()},X[50]=ex,X[51]=O):O=X[51];let eO=O,eR=Z&&ei;return X[52]!==ee?(R=e=>ee(e),X[52]=ee,X[53]=R):R=X[53],X[54]!==er?(F=!!(null==er?void 0:er.completionPercentage)&&(0,a.jsx)("div",{"data-progress-tracking-modal-progress-bar":!0,className:"absolute left-0 top-0 w-full",children:(0,a.jsx)(d.z,{className:"h-2 rounded-lg",value:100*er.completionPercentage})}),X[54]=er,X[55]=F):F=X[55],X[56]!==(null==$||null==(i=$.settings)||null==(n=i.library)?void 0:n.autoUpdateProgress)||X[57]!==er?(U=er&&(0,a.jsxs)("div",{"data-progress-tracking-main-content":!0,className:"text-center relative overflow-hidden py-2 space-y-2",children:[er.mediaCoverImage&&(0,a.jsx)("div",{className:"size-16 rounded-full relative mx-auto overflow-hidden mb-3",children:(0,a.jsx)(j.r,{src:er.mediaCoverImage,alt:"cover image",fill:!0,className:"object-cover object-center"})}),(0,a.jsxs)("div",{"data-progress-tracking-title":!0,children:[(0,a.jsx)("h3",{className:"text-lg font-medium line-clamp-1",children:null==er?void 0:er.mediaTitle}),(0,a.jsxs)("p",{className:"text-2xl font-bold",children:["Episode ",null==er?void 0:er.episodeNumber,(0,a.jsxs)("span",{className:"text-[--muted]",children:[" / ",(null==er?void 0:er.mediaTotalEpisodes)||"-"]})]})]}),(null==$||null==(o=$.settings)||null==(s=o.library)?void 0:s.autoUpdateProgress)&&!(null==er?void 0:er.progressUpdated)&&(0,a.jsx)("p",{"data-progress-tracking-auto-update-progress":!0,className:"text-[--muted] text-center text-sm",children:"Your progress will be automatically updated"}),(null==er?void 0:er.progressUpdated)&&(0,a.jsx)("p",{"data-progress-tracking-progress-updated":!0,className:"text-green-300 text-center",children:"Progress updated"})]}),X[56]=null==$||null==(p=$.settings)||null==(c=p.library)?void 0:c.autoUpdateProgress,X[57]=er,X[58]=U):U=X[58],X[59]!==eO||X[60]!==ev||X[61]!==er?(z=!!(null==er?void 0:er.completionPercentage)&&(null==er?void 0:er.completionPercentage)>.7&&!er.progressUpdated&&(0,a.jsx)("div",{"data-progress-tracking-update-progress-button":!0,className:"flex gap-2 justify-center items-center",children:(0,a.jsx)(N.$n,{intent:"primary-subtle",disabled:ev||(null==er?void 0:er.progressUpdated),onClick:eO,className:"w-full animate-pulse",loading:ev,children:"Update progress now"})}),X[59]=eO,X[60]=ev,X[61]=er,X[62]=z):z=X[62],X[63]!==em||X[64]!==eM||X[65]!==eo||X[66]!==(null==er?void 0:er.canPlayNext)||X[67]!==(null==er?void 0:er.completionPercentage)||X[68]!==eC||X[69]!==eI?(K=!!(null==er?void 0:er.completionPercentage)&&(null==er?void 0:er.completionPercentage)>.7&&(null==er?void 0:er.canPlayNext)&&!eo&&(0,a.jsx)("div",{"data-progress-tracking-play-next-episode-button":!0,className:"flex gap-2 justify-center items-center",children:(0,a.jsx)(N.$n,{intent:"gray-subtle",onClick:()=>{em(),eM.open()},className:"w-full",disabled:eC,loading:eI,leftIcon:(0,a.jsx)(D.XTW,{className:"text-2xl"}),children:"Play next episode"})}),X[63]=em,X[64]=eM,X[65]=eo,X[66]=null==er?void 0:er.canPlayNext,X[67]=null==er?void 0:er.completionPercentage,X[68]=eC,X[69]=eI,X[70]=K):K=X[70],X[71]!==em||X[72]!==eT||X[73]!==eL||X[74]!==eo||X[75]!==ej||X[76]!==ek?(B=!!(null==eo?void 0:eo.next)&&(0,a.jsx)("div",{"data-progress-tracking-playlist":!0,className:"border rounded-[--radius-md] p-4 text-center relative overflow-hidden",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-lg font-medium text-center text-[--muted] mb-2 uppercase tracking-wide",children:"Playlist"}),!!eo.remaining&&(0,a.jsxs)("p",{"data-progress-tracking-playlist-remaining":!0,className:"text-[--muted]",children:[eo.remaining," episode",eo.remaining>1?"s":""," after this one"]}),(0,a.jsxs)("p",{"data-progress-tracking-playlist-next":!0,className:"text-center truncate line-clamp-1",children:["Next: ",(0,a.jsx)("span",{className:"font-semibold",children:null==eo||null==(x=eo.next)?void 0:x.name})]})]}),(0,a.jsxs)("div",{"data-progress-tracking-playlist-next-episode-button":!0,className:(0,f.cn)("w-full rounded-[--radius-md] relative overflow-hidden",ej?"opacity-50 pointer-events-none":"cursor-pointer"),onClick:()=>{ej||(em(),eT.open())},children:[(null==(v=eo.next)?void 0:v.mediaImage)&&(0,a.jsx)(j.r,{"data-progress-tracking-playlist-next-episode-button-image":!0,src:(null==(g=eo.next)?void 0:g.mediaImage)||"",placeholder:(0,th.r)(700,475),sizes:"10rem",fill:!0,alt:"",className:"object-center object-cover z-[1]"}),(0,a.jsx)("div",{"data-progress-tracking-playlist-next-episode-button-container":!0,className:"inset-0 relative z-[2] bg-black border bg-opacity-70 hover:bg-opacity-80 transition flex flex-col gap-2 items-center justify-center p-4",children:(0,a.jsxs)("p",{"data-progress-tracking-playlist-next-episode-button-text":!0,className:"flex gap-2 items-center",children:[(0,a.jsx)(D.XTW,{className:"block text-2xl"})," Play next"]})})]}),(0,a.jsx)("div",{"data-progress-tracking-playlist-next-episode-button-stop-button-container":!0,className:"absolute -top-0.5 right-2",children:(0,a.jsx)(N.K0,{intent:"alert-subtle",onClick:()=>{ek||(em(),eL.open())},size:"sm",disabled:ej,loading:ek,icon:(0,a.jsx)(eg.uDv,{})})})]})}),X[71]=em,X[72]=eT,X[73]=eL,X[74]=eo,X[75]=ej,X[76]=ek,X[77]=B):B=X[77],X[78]!==eR||X[79]!==R||X[80]!==F||X[81]!==U||X[82]!==z||X[83]!==K||X[84]!==B?(V=(0,a.jsxs)(eh.a,{"data-progress-tracking-modal":!0,open:eR,onOpenChange:R,titleClass:"text-center",contentClass:"!space-y-0 relative max-w-2xl overflow-hidden",children:[F,U,z,K,B]}),X[78]=eR,X[79]=R,X[80]=F,X[81]=U,X[82]=z,X[83]=K,X[84]=B,X[85]=V):V=X[85],X[86]!==ed||X[87]!==em?(G=(0,a.jsx)(tu,{autoplayState:ed,onCancel:em}),X[86]=ed,X[87]=em,X[88]=G):G=X[88],X[89]!==eT?(H=(0,a.jsx)(tm.K,{...eT}),X[89]=eT,X[90]=H):H=X[90],X[91]!==eL?(q=(0,a.jsx)(tm.K,{...eL}),X[91]=eL,X[92]=q):q=X[92],X[93]!==eM?(W=(0,a.jsx)(tm.K,{...eM}),X[93]=eM,X[94]=W):W=X[94],X[95]!==V||X[96]!==G||X[97]!==H||X[98]!==q||X[99]!==W?(Q=(0,a.jsxs)(a.Fragment,{children:[V,G,H,q,W]}),X[95]=V,X[96]=G,X[97]=H,X[98]=q,X[99]=W,X[100]=Q):Q=X[100],Q}function tw(){tf().unbind("u"),tf().unbind("space")}var tN=n(17205),tk=n(39076),tS=n(78106),tE=n(63717),tC=n(22960),tI=n(80893);let t_=(0,x.eU)(!1);function tT(e){let t,n,i,r,s=(0,l.c)(9),[o,c]=(0,m.fp)(t_),{data:d}=(0,b.QJ)();return s[0]!==d?(t=(0,a.jsx)(tA,{mangaCollection:d}),s[0]=d,s[1]=t):t=s[1],s[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsx)(tO,{}),s[2]=n):n=s[2],s[3]!==t?(i=(0,a.jsxs)("div",{className:"py-4 space-y-8","data-chapter-downloads-modal-content":!0,children:[t,n]}),s[3]=t,s[4]=i):i=s[4],s[5]!==o||s[6]!==c||s[7]!==i?(r=(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(eh.a,{open:o,onOpenChange:c,contentClass:"max-w-5xl",title:"Downloaded chapters","data-chapter-downloads-modal":!0,children:i})}),s[5]=o,s[6]=c,s[7]=i,s[8]=r):r=s[8],r}function tA(e){let t,n,i,r,s,u,m,h,p=(0,l.c)(31),{mangaCollection:x}=e,{downloadQueue:v,downloadQueueLoading:g,downloadQueueError:y,startDownloadQueue:b,stopDownloadQueue:j,isStartingDownloadQueue:k,isStoppingDownloadQueue:S,resetErroredChapters:E,isResettingErroredChapters:C,clearDownloadQueue:I,isClearingDownloadQueue:_}=(0,tk.I2)(),T=k||S||C||_;return p[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsx)("h3",{children:"Queue"}),n=(0,a.jsx)("div",{className:"flex flex-1","data-chapter-download-queue-header-spacer":!0}),p[0]=t,p[1]=n):(t=p[0],n=p[1]),p[2]!==I||p[3]!==v||p[4]!==y||p[5]!==g||p[6]!==_||p[7]!==T||p[8]!==C||p[9]!==k||p[10]!==S||p[11]!==E||p[12]!==b||p[13]!==j?(i=!g&&!y&&(0,a.jsxs)("div",{className:"flex gap-2 items-center","data-chapter-download-queue-header-actions":!0,children:[!!(null==v?void 0:v.find(tL))&&(0,a.jsx)(N.$n,{intent:"warning-outline",size:"sm",disabled:T,onClick:()=>E(),loading:C,children:"Reset errored chapters"}),(null==v?void 0:v.find(tM))?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(N.$n,{intent:"alert-subtle",size:"sm",onClick:()=>j(),loading:S,children:"Stop"})}):(0,a.jsxs)(a.Fragment,{children:[!!(null==v?void 0:v.length)&&(0,a.jsx)(N.$n,{intent:"alert-subtle",size:"sm",disabled:T,onClick:()=>I(),leftIcon:(0,a.jsx)(eg.Tfw,{className:"text-xl"}),loading:_,children:"Clear all"}),!!(null==v?void 0:v.length)&&!!(null==v?void 0:v.find(tP))&&(0,a.jsx)(N.$n,{intent:"success",size:"sm",disabled:T,onClick:()=>b(),leftIcon:(0,a.jsx)(tI.EnF,{className:"text-xl"}),loading:k,children:"Start"})]})]}),p[2]=I,p[3]=v,p[4]=y,p[5]=g,p[6]=_,p[7]=T,p[8]=C,p[9]=k,p[10]=S,p[11]=E,p[12]=b,p[13]=j,p[14]=i):i=p[14],p[15]!==i?(r=(0,a.jsxs)("div",{className:"flex w-full items-center","data-chapter-download-queue-header":!0,children:[t,n,i]}),p[15]=i,p[16]=r):r=p[16],p[17]!==y||p[18]!==g?(s=g?(0,a.jsx)(c.kt,{}):y?(0,a.jsx)(tS.D,{title:"Oops!",children:(0,a.jsx)("p",{children:"Could not fetch the download queue"})}):null,p[17]=y,p[18]=g,p[19]=s):s=p[19],p[20]!==v||p[21]!==y||p[22]!==g||p[23]!==(null==x?void 0:x.lists)?(u=(null==v?void 0:v.length)?(0,a.jsx)(tC.F,{className:"h-[14rem]","data-chapter-download-queue-scroll-area":!0,children:(0,a.jsx)("div",{className:"space-y-2","data-chapter-download-queue-scroll-area-content":!0,children:v.map(e=>{var t,n,l,i;let r=null==x||null==(l=x.lists)||null==(n=l.flatMap(tD))||null==(t=n.find(t=>{var n;return(null==t||null==(n=t.media)?void 0:n.id)===e.mediaId}))?void 0:t.media;return(0,a.jsxs)(o.Zp,{className:(0,f.cn)("px-3 py-2 bg-gray-900 space-y-1.5","errored"===e.status&&"border-[--orange]"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[!!r&&(0,a.jsx)(w.i,{className:"font-semibold max-w-[180px] text-ellipsis truncate underline",href:"/manga/entry?id=".concat(r.id),children:null==(i=r.title)?void 0:i.userPreferred}),(0,a.jsxs)("p",{children:["Chapter ",e.chapterNumber," ",(0,a.jsxs)("span",{className:"text-[--muted] italic",children:["(id: ",e.chapterId,")"]})]}),"errored"===e.status&&(0,a.jsxs)("div",{className:"flex gap-1 items-center text-[--orange]",children:[(0,a.jsx)(tl.ZtR,{className:"text-2xl text-[--orange]"}),(0,a.jsx)("p",{children:"Errored"})]})]}),"downloading"===e.status&&(0,a.jsx)(d.z,{size:"sm",isIndeterminate:!0})]},e.mediaId+e.provider+e.chapterId)})})}):!g&&!y&&(0,a.jsx)("p",{className:"text-center text-[--muted] italic","data-chapter-download-queue-empty-state":!0,children:"Nothing in the queue"}),p[20]=v,p[21]=y,p[22]=g,p[23]=null==x?void 0:x.lists,p[24]=u):u=p[24],p[25]!==s||p[26]!==u?(m=(0,a.jsxs)(o.Zp,{className:"p-4 space-y-2","data-chapter-download-queue-card":!0,children:[s,u]}),p[25]=s,p[26]=u,p[27]=m):m=p[27],p[28]!==r||p[29]!==m?(h=(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"space-y-4","data-chapter-download-queue-container":!0,children:[r,m]})}),p[28]=r,p[29]=m,p[30]=h):h=p[30],h}function tD(e){return e.entries}function tP(e){return"not_started"===e.status}function tM(e){return"downloading"===e.status}function tL(e){return"errored"===e.status}function tO(e){let t,n,i,r,s=(0,l.c)(11),{data:o,isLoading:d,isError:u}=(0,tN.pK)();return s[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsxs)("div",{className:"flex w-full items-center","data-chapter-download-list-header":!0,children:[(0,a.jsx)("h3",{children:"Downloaded"}),(0,a.jsx)("div",{className:"flex flex-1","data-chapter-download-list-header-spacer":!0})]}),s[0]=t):t=s[0],s[1]!==u||s[2]!==d?(n=d?(0,a.jsx)(c.kt,{}):u?(0,a.jsx)(tS.D,{title:"Oops!",children:(0,a.jsx)("p",{children:"Could not fetch the download queue"})}):null,s[1]=u,s[2]=d,s[3]=n):n=s[3],s[4]!==o||s[5]!==u||s[6]!==d?(i=(null==o?void 0:o.length)?(0,a.jsxs)(a.Fragment,{children:[null==o?void 0:o.filter(t$).sort(tX).sort(tq).map(tG),(0,a.jsx)("div",{"data-chapter-download-list-media-grid":!0,className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-4 xl:grid-cols-4 2xl:grid-cols-4 gap-4",children:null==o?void 0:o.filter(tV).sort(tB).sort(tU).map(tR)})]}):!d&&!u&&(0,a.jsx)("p",{className:"text-center text-[--muted] italic","data-chapter-download-list-empty-state":!0,children:"No chapters downloaded"}),s[4]=o,s[5]=u,s[6]=d,s[7]=i):i=s[7],s[8]!==n||s[9]!==i?(r=(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"space-y-4","data-chapter-download-list-container":!0,children:[t,(0,a.jsxs)("div",{className:"py-4 space-y-2","data-chapter-download-list-content":!0,children:[n,i]})]})}),s[8]=n,s[9]=i,s[10]=r):r=s[10],r}function tR(e){var t;let n=Object.values(e.downloadData).flatMap(tF).length;return(0,a.jsx)("div",{className:"col-span-1",children:(0,a.jsx)(eS.V,{media:e.media,type:"manga",hideUnseenCountBadge:!0,hideAnilistEntryEditButton:!0,overlay:(0,a.jsxs)(tE.E,{className:"font-semibold text-white bg-gray-950 !bg-opacity-100 rounded-[--radius-md] text-base rounded-bl-none rounded-tr-none",intent:"gray",size:"lg",children:[n," chapter",1===n?"":"s"]})})},null==(t=e.media)?void 0:t.id)}function tF(e){return e}function tU(e,t){return Object.values(t.downloadData).flatMap(tK).length-Object.values(e.downloadData).flatMap(tz).length}function tz(e){return e}function tK(e){return e}function tB(e,t){return e.mediaId-t.mediaId}function tV(e){return!!e.media}function tG(e){return(0,a.jsxs)(o.Zp,{className:(0,f.cn)("px-3 py-2 bg-gray-900 space-y-1"),children:[(0,a.jsxs)(w.i,{className:"font-semibold underline",href:"/manga/entry?id=".concat(e.mediaId),children:["Media ",e.mediaId]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("p",{children:[Object.values(e.downloadData).flatMap(tH).length," chapters"]})," - ",(0,a.jsx)("em",{className:"text-[--muted]",children:"Not in your AniList collection"})]})]},e.mediaId)}function tH(e){return e}function tq(e,t){return Object.values(t.downloadData).flatMap(tQ).length-Object.values(e.downloadData).flatMap(tW).length}function tW(e){return e}function tQ(e){return e}function tX(e,t){return e.mediaId-t.mediaId}function t$(e){return!e.media}function tY(e){let t,n,i,r=(0,l.c)(5),s=(0,A.usePathname)(),o=(0,m.Xr)(t_);return s.startsWith("/manga")?(r[0]!==o?(t=()=>o(!0),r[0]=o,r[1]=t):t=r[1],r[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsx)(ev.anB,{}),r[2]=n):n=r[2],r[3]!==t?(i=(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(N.$n,{onClick:t,intent:"white-subtle",rounded:!0,size:"sm",leftIcon:n,children:"Downloads"})}),r[3]=t,r[4]=i):i=r[4],i):null}var tZ=n(244),tJ=n(94077),t0=n(4022),t1=n(69402),t2=n(52885),t3=n(60695),t4=n(74092),t5=n(21410),t6=n(5290),t8=n(31561);function t7(e){return{label:e.label,value:String(e.value)}}function t9(e){return{label:e.label,value:String(e.value)}}function ne(e,t){var n;return t.name&&(e[t.name]=null!=(n=t.value)?n:""),e}function nt(e,t){if(!t.name)return e;switch(t.type){case"input":case"select":case"radio":e[t.name]=t6.Yj().optional();break;case"number":e[t.name]=t6.ai().optional();break;case"checkbox":e[t.name]=t6.zM().optional();break;case"date":e[t.name]=t6.p6().optional()}return e}var nn=n(77885);let na=new Map([["flex",function(e){let t,n,i,r,s,o,c=(0,l.c)(16),{items:d,direction:u,gap:m,style:h,className:p}=e;c[0]!==d?(t=void 0===d?[]:d,c[0]=d,c[1]=t):t=c[1];let x=t,v=void 0===u?"row":u;c[2]!==p?(n=(0,f.cn)("flex",p),c[2]=p,c[3]=n):n=c[3],c[4]!==h?(i=h||{},c[4]=h,c[5]=i):i=c[5];let g="".concat(.25*(void 0===m?2:m),"rem");return c[6]!==v||c[7]!==i||c[8]!==g?(r={...i,gap:g,flexDirection:v},c[6]=v,c[7]=i,c[8]=g,c[9]=r):r=c[9],c[10]!==x?(s=x&&x.length>0&&(0,a.jsx)(nr,{data:x}),c[10]=x,c[11]=s):s=c[11],c[12]!==n||c[13]!==r||c[14]!==s?(o=(0,a.jsx)("div",{className:n,style:r,children:s}),c[12]=n,c[13]=r,c[14]=s,c[15]=o):o=c[15],o}],["text",function(e){let t,n,i=(0,l.c)(6),{text:r,style:s,className:o}=e;return i[0]!==o?(t=(0,f.cn)("w-full break-all",o),i[0]=o,i[1]=t):t=i[1],i[2]!==s||i[3]!==t||i[4]!==r?(n=(0,a.jsx)("p",{className:t,style:s,children:r}),i[2]=s,i[3]=t,i[4]=r,i[5]=n):n=i[5],n}],["div",function(e){let t,n,i,r,s,o=(0,l.c)(15),{items:c,style:d,onClick:u,className:m}=e;o[0]!==c?(t=void 0===c?[]:c,o[0]=c,o[1]=t):t=o[1];let h=t,{sendEventHandlerTriggeredEvent:p}=(0,t8._L)(),{trayIcon:x}=np();o[2]!==u||o[3]!==p||o[4]!==x?(n=function(){u&&p({handlerName:u,event:{}},x.extensionId)},o[2]=u,o[3]=p,o[4]=x,o[5]=n):n=o[5];let v=n;return o[6]!==m?(i=(0,f.cn)("relative",m),o[6]=m,o[7]=i):i=o[7],o[8]!==h?(r=h&&h.length>0&&(0,a.jsx)(nr,{data:h}),o[8]=h,o[9]=r):r=o[9],o[10]!==v||o[11]!==d||o[12]!==i||o[13]!==r?(s=(0,a.jsx)("div",{className:i,style:d,onClick:v,children:r}),o[10]=v,o[11]=d,o[12]=i,o[13]=r,o[14]=s):s=o[14],s}],["stack",function(e){let t,n,i,r,s,o,c=(0,l.c)(15),{items:d,style:u,gap:m,className:h}=e;c[0]!==d?(t=void 0===d?[]:d,c[0]=d,c[1]=t):t=c[1];let p=t;c[2]!==h?(n=(0,f.cn)("flex",h),c[2]=h,c[3]=n):n=c[3],c[4]!==u?(i=u||{},c[4]=u,c[5]=i):i=c[5];let x="".concat(.25*(void 0===m?2:m),"rem");return c[6]!==i||c[7]!==x?(r={...i,gap:x,flexDirection:"column"},c[6]=i,c[7]=x,c[8]=r):r=c[8],c[9]!==p?(s=p&&p.length>0&&(0,a.jsx)(nr,{data:p}),c[9]=p,c[10]=s):s=c[10],c[11]!==n||c[12]!==r||c[13]!==s?(o=(0,a.jsx)("div",{className:n,style:r,children:s}),c[11]=n,c[12]=r,c[13]=s,c[14]=o):o=c[14],o}],["input",function(e){var t,n,i;let r,s,o,c,d,u,m,p,f=(0,l.c)(44),{trayIcon:x}=np(),{sendEventHandlerTriggeredEvent:v}=(0,t8._L)(),{sendFieldRefSendValueEvent:g}=(0,t8.B8)(),[y,b]=h.useState(e.value||(null==(t=e.fieldRef)?void 0:t.current)),j=(0,S.d)(y,200),w=h.useRef(null),N=h.useRef(null),k=h.useRef(!0);f[0]!==j||f[1]!==e.fieldRef||f[2]!==e.onChange||f[3]!==v||f[4]!==g||f[5]!==x.extensionId?(r=()=>{if(k.current){k.current=!1;return}e.onChange&&v({handlerName:e.onChange,event:{value:j}},x.extensionId),e.fieldRef&&g({fieldRef:e.fieldRef.__ID,value:j},x.extensionId)},f[0]=j,f[1]=e.fieldRef,f[2]=e.onChange,f[3]=v,f[4]=g,f[5]=x.extensionId,f[6]=r):r=f[6],f[7]!==j?(s=[j],f[7]=j,f[8]=s):s=f[8],(0,h.useEffect)(r,s),f[9]!==(null==(n=e.fieldRef)?void 0:n.__ID)?(o=t=>{var n;t.fieldRef===(null==(n=e.fieldRef)?void 0:n.__ID)&&b(t.value)},f[9]=null==(i=e.fieldRef)?void 0:i.__ID,f[10]=o):o=f[10],(0,t8.Ql)(o,x.extensionId);let[E,C]=h.useState(null),I=(0,S.d)(E,400);f[11]!==e.onSelect||f[12]!==e.textarea?(c=function(t){if(e.onSelect){var n,a,l,i,r,s;let t=e.textarea?null==(n=N.current)?void 0:n.selectionStart:null==(a=w.current)?void 0:a.selectionStart,o=e.textarea?null==(l=N.current)?void 0:l.selectionEnd:null==(i=w.current)?void 0:i.selectionEnd,c=e.textarea?null==(r=N.current)?void 0:r.value.slice(null!=t?t:0,null!=o?o:0):null==(s=w.current)?void 0:s.value.slice(null!=t?t:0,null!=o?o:0);C({value:null!=c?c:"",cursorStart:null!=t?t:0,cursorEnd:null!=o?o:0})}},f[11]=e.onSelect,f[12]=e.textarea,f[13]=c):c=f[13];let _=c;f[14]!==I||f[15]!==e.onSelect||f[16]!==v||f[17]!==x.extensionId?(d=()=>{e.onSelect&&I&&v({handlerName:e.onSelect,event:{value:I.value,cursorStart:I.cursorStart,cursorEnd:I.cursorEnd}},x.extensionId)},f[14]=I,f[15]=e.onSelect,f[16]=v,f[17]=x.extensionId,f[18]=d):d=f[18];let T=null==I?void 0:I.value,A=null==I?void 0:I.cursorStart,D=null==I?void 0:I.cursorEnd;if(f[19]!==T||f[20]!==A||f[21]!==D?(u=[T,A,D],f[19]=T,f[20]=A,f[21]=D,f[22]=u):u=f[22],(0,h.useEffect)(d,u),e.textarea){let t,n;return f[23]===Symbol.for("react.memo_cache_sentinel")?(t=e=>b(e),f[23]=t):t=f[23],f[24]!==_||f[25]!==e.className||f[26]!==e.disabled||f[27]!==e.id||f[28]!==e.label||f[29]!==e.placeholder||f[30]!==e.style||f[31]!==y?(n=(0,a.jsx)(t4.T,{id:e.id,label:e.label,placeholder:e.placeholder,style:e.style,value:y,onValueChange:t,onSelect:_,disabled:e.disabled,fieldClass:e.className,ref:N}),f[24]=_,f[25]=e.className,f[26]=e.disabled,f[27]=e.id,f[28]=e.label,f[29]=e.placeholder,f[30]=e.style,f[31]=y,f[32]=n):n=f[32],n}f[33]===Symbol.for("react.memo_cache_sentinel")?(m=e=>b(e),f[33]=m):m=f[33];let P=e.size||"md";return f[34]!==_||f[35]!==e.className||f[36]!==e.disabled||f[37]!==e.id||f[38]!==e.label||f[39]!==e.placeholder||f[40]!==e.style||f[41]!==P||f[42]!==y?(p=(0,a.jsx)($.k,{id:e.id,label:e.label,placeholder:e.placeholder,style:e.style,value:y,onValueChange:m,onSelect:_,disabled:e.disabled,size:P,fieldClass:e.className,ref:w}),f[34]=_,f[35]=e.className,f[36]=e.disabled,f[37]=e.id,f[38]=e.label,f[39]=e.placeholder,f[40]=e.style,f[41]=P,f[42]=y,f[43]=p):p=f[43],p}],["button",function(e){let t,n,i=(0,l.c)(13),{sendEventHandlerTriggeredEvent:r}=(0,t8._L)(),{trayIcon:s}=np();i[0]!==e.onClick||i[1]!==r||i[2]!==s?(t=function(){e.onClick&&r({handlerName:e.onClick,event:{}},s.extensionId)},i[0]=e.onClick,i[1]=r,i[2]=s,i[3]=t):t=i[3];let o=t,c=e.intent||"white-subtle",d=e.size||"sm",u=e.label||"Button";return i[4]!==o||i[5]!==e.className||i[6]!==e.disabled||i[7]!==e.loading||i[8]!==e.style||i[9]!==c||i[10]!==d||i[11]!==u?(n=(0,a.jsx)(N.$n,{intent:c,style:e.style,onClick:o,disabled:e.disabled,loading:e.loading,size:d,className:e.className,children:u}),i[4]=o,i[5]=e.className,i[6]=e.disabled,i[7]=e.loading,i[8]=e.style,i[9]=c,i[10]=d,i[11]=u,i[12]=n):n=i[12],n}],["anchor",function(e){let t,n,i,r=(0,l.c)(15),{sendEventHandlerTriggeredEvent:s}=(0,t8._L)(),{trayIcon:o}=np();r[0]!==e.href||r[1]!==e.onClick||r[2]!==e.text||r[3]!==s||r[4]!==o?(t=function(t){e.onClick&&(t.preventDefault(),s({handlerName:e.onClick,event:{href:e.href,text:e.text}},o.extensionId))},r[0]=e.href,r[1]=e.onClick,r[2]=e.text,r[3]=s,r[4]=o,r[5]=t):t=r[5];let c=t,d=e.href,u=e.target||"_blank",m=e.style;r[6]!==e.className?(n=(0,f.cn)("underline cursor-pointer",e.className),r[6]=e.className,r[7]=n):n=r[7];let h=e.text||"Link";return r[8]!==c||r[9]!==e.href||r[10]!==e.style||r[11]!==u||r[12]!==n||r[13]!==h?(i=(0,a.jsx)("a",{href:d,target:u,rel:"noopener noreferrer",style:m,onClick:c,className:n,children:h}),r[8]=c,r[9]=e.href,r[10]=e.style,r[11]=u,r[12]=n,r[13]=h,r[14]=i):i=r[14],i}],["form",function(e){let t,n,i,s,o,d,u,m,p=(0,l.c)(24),{name:f,fields:x}=e;(0,r.Y0)();let[v,g]=h.useState(x);t6.Ik(v.reduce(nt,{})),p[0]!==v?(t=v.reduce(ne,{}),p[0]=v,p[1]=t):t=p[1],p[2]!==t?(n={defaultValues:t},p[2]=t,p[3]=n):n=p[3];let y=(0,t5.mN)(n),{trayIcon:b}=np(),{sendFormSubmittedEvent:j}=(0,t8.q_)();p[4]!==f||p[5]!==j||p[6]!==b.extensionId?(i=e=>{j({formName:f,data:e},b.extensionId)},p[4]=f,p[5]=j,p[6]=b.extensionId,p[7]=i):i=p[7];let w=i;return p[8]!==x||p[9]!==y||p[10]!==f?(s=e=>{e.formName===f&&(e.fieldToReset?y.resetField(e.fieldToReset):(y.reset(),g([]),setTimeout(()=>{g(x)},250)))},p[8]=x,p[9]=y,p[10]=f,p[11]=s):s=p[11],(0,t8.Fp)(s,b.extensionId),p[12]!==y||p[13]!==f?(o=e=>{if(e.formName===f)for(let[t,n]of Object.entries(e.data))y.setValue(t,n)},p[12]=y,p[13]=f,p[14]=o):o=p[14],(0,t8.iA)(o,b.extensionId),p[15]!==y||p[16]!==w?(d=y.handleSubmit(w),p[15]=y,p[16]=w,p[17]=d):d=p[17],p[18]!==v||p[19]!==y?(u=(null==v?void 0:v.length)?v.map(e=>{var t,n,l,i,r;if(!e.name&&"submit"!==e.type)return null;switch(e.type){case"input":return(0,a.jsx)($.k,{label:e.label,placeholder:e.placeholder,...y.register(e.name)},e.id);case"number":return(0,a.jsx)($.k,{type:"number",label:e.label,placeholder:e.placeholder,...y.register(e.name)},e.id);case"select":return(0,a.jsx)(t5.xI,{control:y.control,name:e.name,defaultValue:null!=(t=e.value)?t:"",render:t=>{var n,l;let{field:i}=t;return(0,a.jsx)(k.l,{label:e.label,name:e.name,options:null!=(l=null==(n=e.options)?void 0:n.map(t9))?l:[],placeholder:e.placeholder,value:i.value,onValueChange:e=>i.onChange(e)},e.id)}},e.id);case"checkbox":return(0,a.jsx)(t5.xI,{control:y.control,name:e.name,defaultValue:null!=(n=e.value)&&n,render:t=>{let{field:n}=t;return(0,a.jsx)(q.Sc,{label:e.label,value:n.value,onValueChange:e=>n.onChange(e)},e.id)}},e.id);case"switch":return(0,a.jsx)(t5.xI,{control:y.control,name:e.name,defaultValue:null!=(l=e.value)&&l,render:t=>{let{field:n}=t;return(0,a.jsx)(t3.d,{label:e.label,value:n.value,onValueChange:e=>n.onChange(e)},e.id)}},e.id);case"radio":return(0,a.jsx)(t5.xI,{control:y.control,name:e.name,defaultValue:null!=(i=e.value)?i:"",render:t=>{var n,l;let{field:i}=t;return(0,a.jsx)(t2.z,{label:e.label,name:e.name,options:null!=(l=null==(n=e.options)?void 0:n.map(t7))?l:[],value:i.value,onValueChange:e=>i.onChange(e)},e.id)}},e.id);case"date":return(0,a.jsx)(t5.xI,{control:y.control,name:e.name,defaultValue:null!=(r=e.value)?r:"",render:t=>{let{field:n}=t;return(0,a.jsx)(t1.lr,{name:e.name,label:e.label,value:n.value,onValueChange:e=>n.onChange(e)},e.id)}},e.id);case"submit":return(0,a.jsx)(N.$n,{type:"submit",children:e.label},e.id);default:return null}}):(0,a.jsx)(c.kt,{}),p[18]=v,p[19]=y,p[20]=u):u=p[20],p[21]!==d||p[22]!==u?(m=(0,a.jsx)("form",{onSubmit:d,className:"space-y-4",children:u}),p[21]=d,p[22]=u,p[23]=m):m=p[23],m}],["switch",function(e){var t,n,i;let r,s,o,c,d,u=(0,l.c)(21),{trayIcon:m}=np(),{sendEventHandlerTriggeredEvent:p}=(0,t8._L)(),{sendFieldRefSendValueEvent:f}=(0,t8.B8)(),[x,v]=h.useState(e.value||(null==(t=e.fieldRef)?void 0:t.current)),g=(0,S.d)(x,200),y=h.useRef(!0);u[0]!==e.fieldRef||u[1]!==e.onChange||u[2]!==p||u[3]!==f||u[4]!==m.extensionId||u[5]!==x?(r=()=>{if(y.current){y.current=!1;return}e.onChange&&p({handlerName:e.onChange,event:{value:x}},m.extensionId),e.fieldRef&&f({fieldRef:e.fieldRef.__ID,value:x},m.extensionId)},u[0]=e.fieldRef,u[1]=e.onChange,u[2]=p,u[3]=f,u[4]=m.extensionId,u[5]=x,u[6]=r):r=u[6],u[7]!==g?(s=[g],u[7]=g,u[8]=s):s=u[8],(0,h.useEffect)(r,s),u[9]!==(null==(n=e.fieldRef)?void 0:n.__ID)?(o=t=>{var n;t.fieldRef===(null==(n=e.fieldRef)?void 0:n.__ID)&&v(t.value)},u[9]=null==(i=e.fieldRef)?void 0:i.__ID,u[10]=o):o=u[10],(0,t8.Ql)(o,m.extensionId);let b=e.side||"right";u[11]===Symbol.for("react.memo_cache_sentinel")?(c=e=>v(e),u[11]=c):c=u[11];let j=e.size||"sm";return u[12]!==e.className||u[13]!==e.disabled||u[14]!==e.id||u[15]!==e.label||u[16]!==e.style||u[17]!==b||u[18]!==j||u[19]!==x?(d=(0,a.jsx)(t3.d,{side:b,id:e.id,label:e.label,style:e.style,value:x,onValueChange:c,disabled:e.disabled,size:j,fieldClass:e.className}),u[12]=e.className,u[13]=e.disabled,u[14]=e.id,u[15]=e.label,u[16]=e.style,u[17]=b,u[18]=j,u[19]=x,u[20]=d):d=u[20],d}],["radio-group",function(e){var t,n,i;let r,s,o,c,d,u=(0,l.c)(20),{trayIcon:m}=np(),{sendEventHandlerTriggeredEvent:p}=(0,t8._L)(),{sendFieldRefSendValueEvent:f}=(0,t8.B8)(),[x,v]=h.useState(e.value||(null==(t=e.fieldRef)?void 0:t.current)),g=(0,S.d)(x,200),y=h.useRef(!0);u[0]!==e.fieldRef||u[1]!==e.onChange||u[2]!==p||u[3]!==f||u[4]!==m.extensionId||u[5]!==x?(r=()=>{if(y.current){y.current=!1;return}e.onChange&&p({handlerName:e.onChange,event:{value:x}},m.extensionId),e.fieldRef&&f({fieldRef:e.fieldRef.__ID,value:x},m.extensionId)},u[0]=e.fieldRef,u[1]=e.onChange,u[2]=p,u[3]=f,u[4]=m.extensionId,u[5]=x,u[6]=r):r=u[6],u[7]!==g?(s=[g],u[7]=g,u[8]=s):s=u[8],(0,h.useEffect)(r,s),u[9]!==(null==(n=e.fieldRef)?void 0:n.__ID)?(o=t=>{var n;t.fieldRef===(null==(n=e.fieldRef)?void 0:n.__ID)&&v(t.value)},u[9]=null==(i=e.fieldRef)?void 0:i.__ID,u[10]=o):o=u[10],(0,t8.Ql)(o,m.extensionId),u[11]===Symbol.for("react.memo_cache_sentinel")?(c=e=>v(e),u[11]=c):c=u[11];let b=e.size||"md";return u[12]!==e.className||u[13]!==e.disabled||u[14]!==e.id||u[15]!==e.label||u[16]!==e.options||u[17]!==b||u[18]!==x?(d=(0,a.jsx)(t2.z,{id:e.id,label:e.label,options:e.options,value:x,onValueChange:c,disabled:e.disabled,size:b,fieldClass:e.className}),u[12]=e.className,u[13]=e.disabled,u[14]=e.id,u[15]=e.label,u[16]=e.options,u[17]=b,u[18]=x,u[19]=d):d=u[19],d}],["checkbox",function(e){var t,n,i;let r,s,o,c,d,u=(0,l.c)(20),{trayIcon:m}=np(),{sendEventHandlerTriggeredEvent:p}=(0,t8._L)(),{sendFieldRefSendValueEvent:f}=(0,t8.B8)(),[x,v]=h.useState(e.value||(null==(t=e.fieldRef)?void 0:t.current)),g=(0,S.d)(x,200),y=h.useRef(!0);u[0]!==e.fieldRef||u[1]!==e.onChange||u[2]!==p||u[3]!==f||u[4]!==m.extensionId||u[5]!==x?(r=()=>{if(y.current){y.current=!1;return}e.onChange&&p({handlerName:e.onChange,event:{value:x}},m.extensionId),e.fieldRef&&f({fieldRef:e.fieldRef.__ID,value:x},m.extensionId)},u[0]=e.fieldRef,u[1]=e.onChange,u[2]=p,u[3]=f,u[4]=m.extensionId,u[5]=x,u[6]=r):r=u[6],u[7]!==g?(s=[g],u[7]=g,u[8]=s):s=u[8],(0,h.useEffect)(r,s),u[9]!==(null==(n=e.fieldRef)?void 0:n.__ID)?(o=t=>{var n;t.fieldRef===(null==(n=e.fieldRef)?void 0:n.__ID)&&v(t.value)},u[9]=null==(i=e.fieldRef)?void 0:i.__ID,u[10]=o):o=u[10],(0,t8.Ql)(o,m.extensionId),u[11]===Symbol.for("react.memo_cache_sentinel")?(c=e=>"boolean"==typeof e&&v(e),u[11]=c):c=u[11];let b=e.size||"md";return u[12]!==e.className||u[13]!==e.disabled||u[14]!==e.id||u[15]!==e.label||u[16]!==e.style||u[17]!==b||u[18]!==x?(d=(0,a.jsx)(q.Sc,{id:e.id,label:e.label,style:e.style,value:x,onValueChange:c,disabled:e.disabled,size:b,fieldClass:e.className}),u[12]=e.className,u[13]=e.disabled,u[14]=e.id,u[15]=e.label,u[16]=e.style,u[17]=b,u[18]=x,u[19]=d):d=u[19],d}],["select",function(e){var t,n,i;let r,s,o,c,d,u=(0,l.c)(21),{trayIcon:m}=np(),{sendEventHandlerTriggeredEvent:p}=(0,t8._L)(),{sendFieldRefSendValueEvent:f}=(0,t8.B8)(),[x,v]=h.useState(e.value||(null==(t=e.fieldRef)?void 0:t.current)),g=(0,S.d)(x,200),y=h.useRef(!0);u[0]!==g||u[1]!==e.fieldRef||u[2]!==e.onChange||u[3]!==p||u[4]!==f||u[5]!==m.extensionId?(r=()=>{if(y.current){y.current=!1;return}e.onChange&&p({handlerName:e.onChange,event:{value:g}},m.extensionId),e.fieldRef&&f({fieldRef:e.fieldRef.__ID,value:g},m.extensionId)},u[0]=g,u[1]=e.fieldRef,u[2]=e.onChange,u[3]=p,u[4]=f,u[5]=m.extensionId,u[6]=r):r=u[6],u[7]!==g?(s=[g],u[7]=g,u[8]=s):s=u[8],(0,h.useEffect)(r,s),u[9]!==(null==(n=e.fieldRef)?void 0:n.__ID)?(o=t=>{var n;t.fieldRef===(null==(n=e.fieldRef)?void 0:n.__ID)&&v(t.value)},u[9]=null==(i=e.fieldRef)?void 0:i.__ID,u[10]=o):o=u[10],(0,t8.Ql)(o,m.extensionId),u[11]===Symbol.for("react.memo_cache_sentinel")?(c=e=>v(e),u[11]=c):c=u[11];let b=e.size||"md";return u[12]!==e.className||u[13]!==e.disabled||u[14]!==e.id||u[15]!==e.label||u[16]!==e.options||u[17]!==e.style||u[18]!==b||u[19]!==x?(d=(0,a.jsx)(k.l,{id:e.id,label:e.label,style:e.style,options:e.options,value:x,onValueChange:c,disabled:e.disabled,size:b,fieldClass:e.className}),u[12]=e.className,u[13]=e.disabled,u[14]=e.id,u[15]=e.label,u[16]=e.options,u[17]=e.style,u[18]=b,u[19]=x,u[20]=d):d=u[20],d}]]);function nl(e){let t,n=(0,l.c)(2),{type:i}=e;return n[0]!==i?(t=(0,a.jsxs)("div",{className:"p-4 text-muted-foreground",children:['Component type "',i,'" not found']}),n[0]=i,n[1]=t):t=n[1],t}function ni(e){let t,n,i=(0,l.c)(3),{error:r}=e;return i[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsx)("p",{children:"Something went wrong:"}),i[0]=t):t=i[0],i[1]!==r.message?(n=(0,a.jsxs)("div",{className:"p-4 text-destructive",role:"alert",children:[t,(0,a.jsx)("pre",{className:"mt-2 text-sm",children:r.message})]}),i[1]=r.message,i[2]=n):n=i[2],n}function nr(e){let t,n,i=(0,l.c)(17),{data:r,fallback:s}=e,o=void 0===s?nl:s,c=function(){let e=(0,h.useContext)(ns);if(!e)throw Error("usePluginRegistry must be used within a PluginProvider");return e}();if(Array.isArray(r)){let e,t;if(i[0]!==o||i[1]!==r){let t;i[3]!==o?(t=e=>(0,a.jsx)(nr,{data:e,fallback:o},e.key||e.id),i[3]=o,i[4]=t):t=i[4],e=r.map(t),i[0]=o,i[1]=r,i[2]=e}else e=i[2];return i[5]!==e?(t=(0,a.jsx)(a.Fragment,{children:e}),i[5]=e,i[6]=t):t=i[6],t}i[7]!==r.type||i[8]!==c?(t=c.get(r.type),i[7]=r.type,i[8]=c,i[9]=t):t=i[9];let d=t;if(!d){let e;return i[10]!==o||i[11]!==r.type?(e=(0,a.jsx)(o,{type:r.type}),i[10]=o,i[11]=r.type,i[12]=e):e=i[12],e}return i[13]!==d||i[14]!==r.id||i[15]!==r.props?(n=(0,a.jsx)(nn.tH,{FallbackComponent:ni,children:(0,a.jsx)(d,{...r.props},r.id)}),i[13]=d,i[14]=r.id,i[15]=r.props,i[16]=n):n=i[16],n}let ns=(0,h.createContext)(null);function no(e){let t,n=(0,l.c)(3),{children:i,registry:r}=e;return n[0]!==i||n[1]!==r?(t=(0,a.jsx)(ns.Provider,{value:r,children:i}),n[0]=i,n[1]=r,n[2]=t):t=n[2],t}function nc(e,t){var n;let a=((null==(n=e.ownerDocument)?void 0:n.defaultView)||window).getComputedStyle(e);return a.getPropertyValue(t)||a[t]}function nd(e){return e?nc(e,"fontSize")||nd(e.parentElement):nc(window.document.documentElement,"fontSize")}var nu=n(21096);let nm=h.createContext({place:"sidebar",width:null,isPinned:!1,trayIcon:{extensionId:"",extensionName:"",iconUrl:"",withContent:!1,isDrawer:!1,tooltipText:"",badgeNumber:0,badgeIntent:"info",width:"30rem",minHeight:"auto"}});function nh(e){let t,n=(0,l.c)(3);return n[0]!==e.children||n[1]!==e.props?(t=(0,a.jsx)(nm.Provider,{value:e.props,children:e.children}),n[0]=e.children,n[1]=e.props,n[2]=t):t=n[2],t}function np(){let e=h.useContext(nm);if(!e)throw Error("usePluginTray must be used within a PluginTrayProvider");return e}function nf(e){let[t,n]=h.useState(!1),[l,i]=h.useState(0),[r,s]=h.useState("info"),{sendTrayOpenedEvent:o}=(0,t8.ob)(),{sendTrayClosedEvent:c}=(0,t8.z0)(),{sendTrayClickedEvent:d}=(0,t8._n)();(0,m.md)(ny);let[u,p]=(0,m.fp)(nb),[x,v]=(0,m.fp)(nj),g=h.useRef(!0);h.useEffect(()=>{if(g.current){g.current=!1;return}t?o({},e.trayIcon.extensionId):c({},e.trayIcon.extensionId)},[t]);let y=h.useRef(!1);function b(){d({},e.trayIcon.extensionId)}h.useEffect(()=>{if((null==u?void 0:u.extensionId)===e.trayIcon.extensionId&&(v(e.trayIcon.extensionId),!y.current)){let e=setTimeout(()=>{n(!0),y.current=!0},100);return()=>clearTimeout(e)}},[u]),h.useEffect(()=>{(null==u?void 0:u.extensionId)===e.trayIcon.extensionId&&!t&&y.current&&(p(null),y.current=!1)},[t]),(0,t8.Y8)(e=>{i(e.badgeNumber),s(e.badgeIntent)},e.trayIcon.extensionId),(0,t8.yi)(e=>{n(!0)},e.trayIcon.extensionId),(0,t8.of)(e=>{n(!1)},e.trayIcon.extensionId);let w=e.trayIcon.extensionName,k=()=>(0,a.jsxs)("div",{"data-plugin-tray-icon":!0,className:"w-8 h-8 rounded-full flex items-center justify-center hover:bg-gray-800 cursor-pointer transition-all relative select-none",onClick:b,children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center overflow-hidden relative","data-plugin-tray-icon-inner-container":!0,children:e.trayIcon.iconUrl?(0,a.jsx)(j.r,{src:e.trayIcon.iconUrl,alt:"logo",fill:!0,className:"p-1 w-full h-full object-contain","data-plugin-tray-icon-image":!0}):(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center","data-plugin-tray-icon-image-fallback":!0,children:(0,a.jsx)(ev.Low,{className:"text-2xl"})})}),!!l&&(0,a.jsx)(tE.E,{intent:"".concat(r,"-solid"),size:"sm",className:"absolute -top-2 -right-2 z-10 select-none pointer-events-none","data-plugin-tray-icon-badge":!0,children:l})]}),S=function e(t,n){var a,l;if(t.trim().startsWith("calc(")){let a=t.replace(/^calc\(\s*/,"").replace(/\s*\)$/,"").replace(/(-?[\d.]+[a-z%]+)/g,t=>isNaN(Number(t))?e(t,n).toString():t);try{let e=a.replace(/\s+/g," ").replace(/\s*([+\-*/()])\s*/g,"$1");return Function("'use strict'; return (".concat(e,")"))()}catch(e){return console.error("Error evaluating calc() expression:",e),0}}let i=null!=(l=null==n||null==(a=n.ownerDocument)?void 0:a.defaultView)?l:window,r=i.document.documentElement||i.document.body,[s,o]=function(e){var t,n;let a=e||"0";if(a.trim().startsWith("calc(")){return n=0,[0,"calc"]}let l=Number.parseFloat(a),i=a.match(/[\d-.]+(\w+)$/);return[l,(null!=(t=null==i?void 0:i[1])?t:"").toLowerCase()]}(t);switch(o){case"rem":return s*e(nd(window.document.documentElement));case"em":return s*e(nd(n),null==n?void 0:n.parentElement);case"in":return 96*s;case"q":return 96*s/25.4/4;case"mm":return 96*s/25.4;case"cm":return 96*s*10/25.4;case"pt":return 96*s/72;case"pc":return 96*s/6;case"vh":return(s*i.innerHeight||r.clientWidth)/100;case"vw":return(s*i.innerWidth||r.clientHeight)/100;case"vmin":return s*Math.min(i.innerWidth||r.clientWidth,i.innerHeight||r.clientHeight)/100;case"vmax":return s*Math.max(i.innerWidth||r.clientWidth,i.innerHeight||r.clientHeight)/100;default:return s}}(e.trayIcon.width||"30rem"),E=e.width&&e.width<1024?S>=e.width?"calc(100vw - 30px)":S:e.trayIcon.width||"30rem";if(!e.trayIcon.withContent)return(0,a.jsx)("div",{className:"cursor-pointer",children:w?(0,a.jsx)(ep.m_,{side:"right",trigger:(0,a.jsx)("div",{"data-plugin-tray-icon-tooltip-trigger":!0,children:(0,a.jsx)(k,{})}),"data-plugin-tray-icon-tooltip":!0,children:w}):(0,a.jsx)(k,{})});h.useEffect(()=>{t&&(v(e.trayIcon.extensionId),setTimeout(()=>{document.body.style.pointerEvents="auto"},500))},[e.trayIcon.isDrawer,t]),h.useLayoutEffect(()=>{x!==e.trayIcon.extensionId&&n(!1)},[x]);let{isMobile:C}=(0,eL.al)();return e.trayIcon.isDrawer?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{"data-plugin-tray-icon-trigger":e.trayIcon.extensionId,onClick:()=>{v(e.trayIcon.extensionId),n(!0)},className:"cursor-pointer","data-plugin-tray-icon-trigger-drawer":!0,children:w?(0,a.jsx)(ep.m_,{side:"sidebar"===e.place?"right":"bottom",trigger:(0,a.jsx)("div",{"data-plugin-tray-icon-tooltip-trigger":!0,children:(0,a.jsx)(k,{})}),"data-plugin-tray-icon-tooltip":!0,children:w}):(0,a.jsx)(k,{})}),(0,a.jsx)(Y.Tr,{open:t&&x===e.trayIcon.extensionId,onOpenChange:n,modal:!1,children:(0,a.jsxs)(Y.Cz,{className:(0,f.cn)("bg-gray-950 p-0 rounded-t-xl mx-auto rounded-b-none border-b-0 !min-h-[120px]"),onOpenAutoFocus:e=>e.preventDefault(),style:{width:C?"100vw":E,minHeight:e.trayIcon.minHeight||"auto"},"data-plugin-tray-popover-content":e.trayIcon.extensionId,children:[(0,a.jsx)("div",{className:"absolute inset-0 top-[-2.5rem]",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm border font-medium text-gray-300 px-1.5 py-0.5 rounded-lg bg-black/60","data-plugin-tray-vaul-title":!0,children:e.trayIcon.extensionName}),(0,a.jsx)(N.K0,{icon:(0,a.jsx)(D.Gsv,{}),"data-plugin-tray-vaul-close-button":!0,intent:"gray-glass",size:"sm",className:"rounded-full",onClick:()=>n(!1)})]})}),(0,a.jsx)(nh,{props:e,children:(0,a.jsx)(nx,{open:t,setOpen:n,...e})})]})})]}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(nu.bL,{open:t,onOpenChange:n,modal:!1,children:[(0,a.jsx)(nu.l9,{asChild:!0,children:(0,a.jsx)("div",{"data-plugin-tray-icon-trigger":e.trayIcon.extensionId,children:w?(0,a.jsx)(ep.m_,{side:"sidebar"===e.place?"right":"bottom",trigger:(0,a.jsx)("div",{"data-plugin-tray-icon-tooltip-trigger":!0,children:(0,a.jsx)(k,{})}),"data-plugin-tray-icon-tooltip":!0,children:w}):(0,a.jsx)(k,{})})}),(0,a.jsx)(nu.ZL,{children:(0,a.jsx)(nu.UC,{sideOffset:10,side:"sidebar"===e.place?"right":"bottom",className:(0,f.cn)(Q.x.root(),"bg-gray-950 p-0 shadow-xl rounded-xl mb-4"),onOpenAutoFocus:e=>e.preventDefault(),style:{width:E,minHeight:e.trayIcon.minHeight||"auto",marginLeft:e.width&&e.width<1024?"10px":void 0},"data-plugin-tray-popover-content":e.trayIcon.extensionId,children:(0,a.jsx)(nh,{props:e,children:(0,a.jsx)(nx,{open:t,setOpen:n,...e})})})})]})})}function nx(e){let t,n,i,r,s,o=(0,l.c)(10),{trayIcon:d,open:u}=e,{sendRenderTrayEvent:m}=(0,t8.$w)();o[0]!==u||o[1]!==m||o[2]!==d.extensionId?(t=()=>{u&&m({},d.extensionId)},o[0]=u,o[1]=m,o[2]=d.extensionId,o[3]=t):t=o[3],o[4]!==u?(n=[u],o[4]=u,o[5]=n):n=o[5],h.useEffect(t,n);let[p,x]=h.useState(null);return o[6]===Symbol.for("react.memo_cache_sentinel")?(i=e=>{x(e)},o[6]=i):i=o[6],(0,t8.lg)(i,d.extensionId),o[7]===Symbol.for("react.memo_cache_sentinel")?(r=(0,f.cn)("max-h-[35rem] overflow-y-auto p-3"),o[7]=r):r=o[7],o[8]!==p?(s=(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:r,children:(0,a.jsx)(no,{registry:na,children:p&&p.components?(0,a.jsx)(nr,{data:p.components}):(0,a.jsx)(c.kt,{})})})}),o[8]=p,o[9]=s):s=o[9],s}var nv=n(50943);let ng=(0,x.eU)([]),ny=(0,x.eU)(!1),nb=(0,x.eU)(null),nj=(0,x.eU)(null),nw=e=>{let t,n,i,r,s,o,c,d,u,p,x,v,g,y,b=(0,l.c)(52),{place:w,developmentModeExtensions:k,isReloadingExtension:S,reloadExternalExtension:E,trayIcons:C,settings:I,width:_}=e,{mutate:T,isPending:A}=(0,eG.D3)();b[0]!==(null==I?void 0:I.pinnedTrayPluginIds)?(t=(null==I?void 0:I.pinnedTrayPluginIds)||[],b[0]=null==I?void 0:I.pinnedTrayPluginIds,b[1]=t):t=b[1];let D=t;b[2]!==D?(n=e=>D.includes(e),b[2]=D,b[3]=n):n=b[3];let P=n,[M,L]=(0,m.fp)(nb),[O,R]=(0,m.fp)(nj),[F,U]=h.useState(!1);b[4]!==P||b[5]!==(null==M?void 0:M.extensionId)?(i=e=>P(e.extensionId)||e.extensionId===(null==M?void 0:M.extensionId),b[4]=P,b[5]=null==M?void 0:M.extensionId,b[6]=i):i=b[6];let z=C.filter(i);b[7]!==P||b[8]!==R||b[9]!==L||b[10]!==C?(r=e=>{e.extensionId&&(P(e.extensionId)||(L(C.find(t=>t.extensionId===e.extensionId)||null),R(e.extensionId)))},b[7]=P,b[8]=R,b[9]=L,b[10]=C,b[11]=r):r=b[11],(0,t8.yi)(r,""),b[12]!==P||b[13]!==O||b[14]!==R||b[15]!==L||b[16]!==(null==M?void 0:M.extensionId)?(s=e=>{e.extensionId&&(P(e.extensionId)||(null==M?void 0:M.extensionId)!==e.extensionId||L(null),O===e.extensionId&&R(null))},b[12]=P,b[13]=O,b[14]=R,b[15]=L,b[16]=null==M?void 0:M.extensionId,b[17]=s):s=b[17],(0,t8.of)(s,"");let K="top"===w&&"flex-row w-auto my-0 justify-start px-2 py-2 border-none",B=z.length>0&&"border-[--border]";b[18]!==K||b[19]!==B?(o=(0,f.cn)("w-10 mx-auto p-1 my-2","flex flex-col gap-1 items-center border border-transparent justify-center rounded-full transition-all duration-300 select-none",K,B),b[18]=K,b[19]=B,b[20]=o):o=b[20];let V="top"===w?"bottom":"right";b[21]===Symbol.for("react.memo_cache_sentinel")?(c=(0,a.jsx)("div",{children:(0,a.jsx)(ep.m_,{side:"right",trigger:(0,a.jsx)(N.K0,{intent:"gray-basic",size:"sm",icon:(0,a.jsx)(ev.ZKr,{className:"size-5 text-[--muted]"}),className:"rounded-full hover:rotate-360 transition-all duration-300"}),children:"Tray Plugins"})}),b[21]=c):c=b[21],b[22]!==P||b[23]!==A||b[24]!==D||b[25]!==T||b[26]!==L||b[27]!==C?(d=null==C?void 0:C.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2 justify-between bg-[--subtle] rounded-md px-2 py-1 max-w-full",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer max-w-full",onClick:()=>{L(e),U(!1)},children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center overflow-hidden relative flex-none",children:e.iconUrl?(0,a.jsx)(j.r,{src:e.iconUrl,alt:"logo",fill:!0,className:"p-1 w-full h-full object-contain","data-plugin-tray-icon-image":!0}):(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-none","data-plugin-tray-icon-image-fallback":!0,children:(0,a.jsx)(ev.Low,{className:"text-2xl"})})}),(0,a.jsx)("p",{className:"text-sm font-medium line-clamp-1 tracking-wide",children:e.extensionName})]}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:(0,a.jsx)(ep.m_,{trigger:(0,a.jsx)("div",{children:P(e.extensionId)?(0,a.jsx)(N.K0,{intent:"primary-basic",size:"sm",icon:(0,a.jsx)(tI.lur,{className:"size-5"}),className:"rounded-full",onClick:()=>{T({pinnedTrayPluginIds:D.filter(t=>t!==e.extensionId)})},disabled:A}):(0,a.jsx)(N.K0,{intent:"gray-basic",size:"sm",icon:(0,a.jsx)(tI.xi4,{className:"size-5 text-[--muted]"}),className:"rounded-full",onClick:()=>{T({pinnedTrayPluginIds:[...D,e.extensionId]})},disabled:A})}),children:P(e.extensionId)?"Unpin":"Pin"})})]},e.extensionId)),b[22]=P,b[23]=A,b[24]=D,b[25]=T,b[26]=L,b[27]=C,b[28]=d):d=b[28],b[29]!==C.length?(u=!C.length&&(0,a.jsx)("p",{className:"text-sm text-[--muted] py-1 text-center w-full",children:"No tray plugins"}),b[29]=C.length,b[30]=u):u=b[30],b[31]!==d||b[32]!==u?(p=(0,a.jsxs)("div",{className:"space-y-1 max-h-[310px] overflow-y-auto","data-plugin-sidebar-debug-popover-content":!0,children:[d,u]}),b[31]=d,b[32]=u,b[33]=p):p=b[33],b[34]!==V||b[35]!==p||b[36]!==F?(x=(0,a.jsx)(Q.A,{open:F,onOpenChange:U,side:V,trigger:c,className:"p-2 w-[300px]","data-plugin-sidebar-debug-popover":!0,modal:!1,children:p}),b[34]=V,b[35]=p,b[36]=F,b[37]=x):x=b[37],b[38]!==k||b[39]!==S||b[40]!==w||b[41]!==E?(v=!!k.length&&(0,a.jsx)(Q.A,{side:"top"===w?"bottom":"right",trigger:(0,a.jsx)("div",{children:(0,a.jsx)(N.K0,{intent:"warning-basic",size:"sm",icon:(0,a.jsx)(ev.XGn,{className:"size-4"}),className:"rounded-full"})}),className:"p-2","data-plugin-sidebar-debug-popover":!0,modal:!1,children:(0,a.jsxs)("div",{className:"space-y-1","data-plugin-sidebar-debug-popover-content":!0,children:[(0,a.jsxs)("div",{className:"text-sm space-y-1",children:[(0,a.jsx)("p",{className:"font-bold",children:"Debug"}),(0,a.jsx)("p",{className:"text-xs text-[--muted]",children:"These extensions are loaded in development mode."})]}),null==k?void 0:k.sort(nS).map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2 justify-between bg-[--subtle] rounded-md px-2 py-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:e.id}),(0,a.jsx)("div",{children:(0,a.jsx)(N.K0,{intent:"warning-basic",size:"sm",icon:(0,a.jsx)(ev.JbZ,{className:"size-5"}),className:"rounded-full",onClick:()=>E({id:e.id}),loading:S})})]},e.id))]})}),b[38]=k,b[39]=S,b[40]=w,b[41]=E,b[42]=v):v=b[42],b[43]!==P||b[44]!==w||b[45]!==_?(g=(e,t)=>(0,a.jsx)(nf,{trayIcon:e,isPinned:P(e.extensionId),place:w,width:_},e.extensionId),b[43]=P,b[44]=w,b[45]=_,b[46]=g):g=b[46];let G=z.map(g);return b[47]!==x||b[48]!==v||b[49]!==G||b[50]!==o?(y=(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{"data-plugin-sidebar-tray":!0,className:o,children:[x,v,G]})}),b[47]=x,b[48]=v,b[49]=G,b[50]=o,b[51]=y):y=b[51],y};function nN(e){let t,n,i,s,o,c,d,p,f,x,v,g,y,b=(0,l.c)(47),{place:j}=e,{width:w}=(0,nv.lW)(),[k,S]=(0,m.fp)(ng),[E,C]=(0,m.fp)(ny),I=(0,A.usePathname)(),{data:_}=(0,eG.s8)(),[T,D]=h.useState(!1),[P,M]=h.useState(null),L=h.useContext(t0.P),O=h.useRef(!0);b[0]!==E||b[1]!==C?(t=()=>{if(O.current){O.current=!1;return}E||C(!0)},b[0]=E,b[1]=C,b[2]=t):t=b[2],b[3]!==E||b[4]!==I?(n=[I,E],b[3]=E,b[4]=I,b[5]=n):n=b[5],h.useEffect(t,n);let{sendListTrayIconsEvent:R}=(0,t8.$M)();b[6]!==R?(i=()=>{R({},"")},b[6]=R,b[7]=i):i=b[7],b[8]===Symbol.for("react.memo_cache_sentinel")?(s=[],b[8]=s):s=b[8],h.useEffect(i,s),b[9]!==S?(o=(e,t)=>{S(n=>[...n.filter(e=>e.extensionId!==t),{...e}].sort(nk))},b[9]=S,b[10]=o):o=b[10],(0,t8.l9)(o,""),b[11]!==j||b[12]!==w?(c=e=>{w&&w<1024&&"top"===j&&(M(e.extensionId||""),window.scrollTo({top:0,behavior:"smooth"}),D(!0))},b[11]=j,b[12]=w,b[13]=c):c=b[13],(0,t8.yi)(c,""),b[14]!==j||b[15]!==w?(d=e=>{w&&w<1024&&"top"===j&&(M(null),setTimeout(()=>{D(!1)},300))},b[14]=j,b[15]=w,b[16]=d):d=b[16],(0,t8.of)(d,""),b[17]!==T||b[18]!==P||b[19]!==L?(p=()=>{if(T&&P&&L){let e=setTimeout(()=>{let e=new MessageEvent("message",{data:JSON.stringify({type:"plugin",payload:{type:"tray:open",extensionId:P,payload:{extensionId:P}}})});L.dispatchEvent(e)},100);return()=>clearTimeout(e)}},f=[T,P,L],b[17]=T,b[18]=P,b[19]=L,b[20]=p,b[21]=f):(p=b[20],f=b[21]),h.useEffect(p,f);let{data:F,refetch:U}=(0,eG.EZ)(),{mutate:z,isPending:K}=(0,eG.dh)();b[22]!==U||b[23]!==S?(x={type:u.c.PLUGIN_UNLOADED,onMessage:e=>{S(t=>t.filter(t=>t.extensionId!==e)),setTimeout(()=>{U()},1e3)}},b[22]=U,b[23]=S,b[24]=x):x=b[24],(0,r.oA)(x);let B=w&&w<1024;return k?(b[25]!==F||b[26]!==B||b[27]!==K||b[28]!==j||b[29]!==_||b[30]!==z||b[31]!==k||b[32]!==w?(v=!B&&"sidebar"===j&&(0,a.jsx)(nw,{place:j,developmentModeExtensions:F||[],isReloadingExtension:K,reloadExternalExtension:z,trayIcons:k,settings:_,width:w}),b[25]=F,b[26]=B,b[27]=K,b[28]=j,b[29]=_,b[30]=z,b[31]=k,b[32]=w,b[33]=v):v=b[33],b[34]!==F||b[35]!==B||b[36]!==K||b[37]!==T||b[38]!==j||b[39]!==_||b[40]!==z||b[41]!==k||b[42]!==w?(g=B&&"top"===j&&(0,a.jsx)("div",{className:"",children:(0,a.jsx)(Q.A,{open:T,onOpenChange:D,side:"bottom",trigger:(0,a.jsx)("div",{children:(0,a.jsx)(N.K0,{intent:"gray-basic",size:"sm",icon:(0,a.jsx)(ev.sVt,{className:"size-5 text-[--muted]"})})}),className:"rounded-full p-0 overflow-y-auto bg-[--background] mx-4",style:{width:w?w-50:"100%"},children:(0,a.jsx)(nw,{place:j,developmentModeExtensions:F||[],isReloadingExtension:K,reloadExternalExtension:z,trayIcons:k,settings:_,width:w})})}),b[34]=F,b[35]=B,b[36]=K,b[37]=T,b[38]=j,b[39]=_,b[40]=z,b[41]=k,b[42]=w,b[43]=g):g=b[43],b[44]!==v||b[45]!==g?(y=(0,a.jsxs)(a.Fragment,{children:[v,g]}),b[44]=v,b[45]=g,b[46]=y):y=b[46],y):null}function nk(e,t){return e.extensionId.localeCompare(t.extensionId,void 0,{numeric:!0})}function nS(e,t){return e.id.localeCompare(t.id,void 0,{numeric:!0})}function nE(e){let t,n,i,r,s,o,c,d,u,m,h,p=(0,l.c)(18),x=(0,eU.v1)(),v=null==x?void 0:x.isOffline,g=((0,eL.Ky)().hideTopNavbar||tJ.X)&&"lg:hidden";return p[0]!==g?(t=(0,f.cn)("w-full h-[5rem] relative overflow-hidden flex items-center",g),p[0]=g,p[1]=t):t=p[1],p[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsx)(tZ.Mz,{}),p[2]=n):n=p[2],p[3]!==v?(i=v?(0,a.jsx)(e9,{}):(0,a.jsx)(tn,{}),p[3]=v,p[4]=i):i=p[4],p[5]===Symbol.for("react.memo_cache_sentinel")?(r=(0,a.jsx)(tb,{}),s=(0,a.jsx)(ts,{}),o=(0,a.jsx)("div",{"data-top-navbar-content-separator":!0,className:"flex flex-1"}),c=(0,a.jsx)(nN,{place:"top"}),p[5]=r,p[6]=s,p[7]=o,p[8]=c):(r=p[5],s=p[6],o=p[7],c=p[8]),p[9]!==v?(d=!v&&(0,a.jsx)(tY,{}),p[9]=v,p[10]=d):d=p[10],p[11]!==i||p[12]!==d?(u=(0,a.jsx)("div",{"data-top-navbar-content-container":!0,className:"relative z-10 px-4 w-full flex flex-row md:items-center overflow-x-auto",children:(0,a.jsxs)("div",{"data-top-navbar-content":!0,className:"flex items-center w-full gap-3",children:[n,i,r,s,o,c,d]})}),p[11]=i,p[12]=d,p[13]=u):u=p[13],p[14]===Symbol.for("react.memo_cache_sentinel")?(m=(0,a.jsx)(te,{}),p[14]=m):m=p[14],p[15]!==t||p[16]!==u?(h=(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{"data-top-navbar":!0,className:t,children:[u,m]})}),p[15]=t,p[16]=u,p[17]=h):h=p[17],h}function nC(e){let t,n,i,r,s,o=(0,l.c)(13),{isCollapsed:c,handleExpandSidebar:d,handleUnexpandedSidebar:u}=e,h=(0,eU.v1)(),p=(0,eL.Ky)(),f=(0,A.usePathname)(),x=(0,m.Xr)(t_);o[0]!==f?(t=f.startsWith("/manga"),o[0]=f,o[1]=t):t=o[1];let v=t;return p.hideTopNavbar,o[2]!==d||o[3]!==u||o[4]!==c||o[5]!==v||o[6]!==x||o[7]!==(null==h?void 0:h.isOffline)?(n=!(null==h?void 0:h.isOffline)&&(0,a.jsx)(e$.m,{"data-sidebar-navbar-vertical-menu":!0,className:"px-4",collapsed:c,itemClass:"relative",onMouseEnter:d,onMouseLeave:u,isSidebar:!0,items:[...v?[{iconType:ev.anB,name:"Manga Downloads",onClick:()=>{x(!0)}}]:[]]}),o[2]=d,o[3]=u,o[4]=c,o[5]=v,o[6]=x,o[7]=null==h?void 0:h.isOffline,o[8]=n):n=o[8],o[9]===Symbol.for("react.memo_cache_sentinel")?(i=(0,a.jsx)("div",{"data-sidebar-navbar-playback-manager-progress-tracking-button":!0,className:"flex justify-center",children:(0,a.jsx)(tb,{asSidebarButton:!0})}),o[9]=i):i=o[9],o[10]===Symbol.for("react.memo_cache_sentinel")?(r=(0,a.jsx)("div",{"data-sidebar-navbar-manual-progress-tracking-button":!0,className:"flex justify-center",children:(0,a.jsx)(ts,{asSidebarButton:!0})}),o[10]=r):r=o[10],o[11]!==n?(s=(0,a.jsxs)("div",{"data-sidebar-navbar":!0,className:"flex flex-col gap-1",children:[n,i,r]}),o[11]=n,o[12]=s):s=o[12],s}var nI=n(81845),n_=n(61816),nT=n(22148);let nA=(0,x.eU)(!1),nD=(0,x.eU)(!1);function nP(e){var t,n,i,s,o;let c,d,p,f,x,v,g,y,b,j,k,S,E,C,I,_,T,A,M,L,O,R,F,U,z,K=(0,l.c)(62),B=(0,eU.v1)(),[V,G]=(0,m.fp)(nA),[,H]=(0,m.fp)(nD),{data:q,isLoading:W,refetch:Q}=(0,eQ.A2)(!!B&&!(null==B||null==(n=B.settings)||null==(t=n.library)?void 0:t.disableUpdateCheck));K[0]!==Q?(c={type:u.c.CHECK_FOR_UPDATES,onMessage:()=>{Q()}},K[0]=Q,K[1]=c):c=K[1],(0,r.oA)(c);let{mutate:X,isPending:$}=(0,eQ.zf)();h.useState(""),K[2]!==G||K[3]!==q?(d=()=>{if(q&&q.release){localStorage.setItem("latest-available-update",JSON.stringify(q.release.version));let e=localStorage.getItem("notified-available-update");e&&e===JSON.stringify(q.release.version)||G(!0)}},K[2]=G,K[3]=q,K[4]=d):d=K[4],K[5]!==q?(p=[q],K[5]=q,K[6]=p):p=K[6],h.useEffect(d,p),K[7]!==G||K[8]!==q?(f=()=>{q&&q.release&&(localStorage.setItem("notified-available-update",JSON.stringify(q.release.version)),G(!1))},K[7]=G,K[8]=q,K[9]=f):f=K[9];let Y=f;K[10]!==X?(x=function(){X({fallback_destination:""})},K[10]=X,K[11]=x):x=K[11];let J=x;if((null==B||null==(s=B.settings)||null==(i=s.library)?void 0:i.disableUpdateCheck)||W||!q||!q.release)return null;K[12]!==G?(v=[{iconType:Z.$S7,name:"Update available",onClick:()=>G(!0)}],K[12]=G,K[13]=v):v=K[13],K[14]!==e.collapsed||K[15]!==v?(g=(0,a.jsx)(e$.m,{collapsed:e.collapsed,items:v,itemIconClass:"text-brand-300"}),K[14]=e.collapsed,K[15]=v,K[16]=g):g=K[16],K[17]!==Y?(y=()=>Y(),K[17]=Y,K[18]=y):y=K[18],K[19]!==q.release?(b=(0,a.jsx)(nM,{release:q.release}),K[19]=q.release,K[20]=b):b=K[20],K[21]===Symbol.for("react.memo_cache_sentinel")?(j=(0,a.jsx)("h3",{className:"text-center",children:"A new update is available!"}),K[21]=j):j=K[21],K[22]!==q.current_version?(k=(0,a.jsx)("span",{className:"text-[--muted]",children:q.current_version}),K[22]=q.current_version,K[23]=k):k=K[23],K[24]===Symbol.for("react.memo_cache_sentinel")?(S=(0,a.jsx)(P.dyV,{}),K[24]=S):S=K[24],K[25]!==q.release.version?(E=(0,a.jsx)("span",{className:"text-indigo-200",children:q.release.version}),K[25]=q.release.version,K[26]=E):E=K[26],K[27]!==k||K[28]!==E?(C=(0,a.jsxs)("h4",{className:"font-bold flex gap-2 text-center items-center justify-center",children:[k," ",S,E]}),K[27]=k,K[28]=E,K[29]=C):C=K[29],K[30]!==(null==B?void 0:B.isDesktopSidecar)?(I=(null==B?void 0:B.isDesktopSidecar)&&(0,a.jsx)(eu.F,{intent:"info",description:"Update Seanime from the desktop application."}),K[30]=null==B?void 0:B.isDesktopSidecar,K[31]=I):I=K[31],K[32]!==q?(_=(0,a.jsx)(eX.O,{updateData:q}),K[32]=q,K[33]=_):_=K[33],K[34]!==J||K[35]!==$||K[36]!==(null==B?void 0:B.isDesktopSidecar)?(T=!(null==B?void 0:B.isDesktopSidecar)&&(0,a.jsx)(eh.a,{trigger:(0,a.jsx)(N.$n,{leftIcon:(0,a.jsx)(eZ.$Wp,{className:"text-2xl"}),children:"Update now"}),contentClass:"max-w-xl",title:(0,a.jsx)("span",{children:"Update Seanime"}),children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{children:"Seanime will perform an update by downloading and replacing existing files. Refer to the documentation for more information."}),(0,a.jsx)(N.$n,{className:"w-full",onClick:J,disabled:$,children:"Download and Install"})]})}),K[34]=J,K[35]=$,K[36]=null==B?void 0:B.isDesktopSidecar,K[37]=T):T=K[37],K[38]===Symbol.for("react.memo_cache_sentinel")?(A=(0,a.jsx)("div",{className:"flex flex-1"}),K[38]=A):A=K[38];let ee=(null==q||null==(o=q.release)?void 0:o.html_url)||"";return K[39]===Symbol.for("react.memo_cache_sentinel")?(M=(0,a.jsx)(N.$n,{intent:"white-subtle",rightIcon:(0,a.jsx)(D.zaF,{}),children:"See on GitHub"}),K[39]=M):M=K[39],K[40]!==ee?(L=(0,a.jsx)(w.i,{href:ee,target:"_blank",children:M}),K[40]=ee,K[41]=L):L=K[41],K[42]!==(null==B?void 0:B.isDesktopSidecar)||K[43]!==H?(O=!(null==B?void 0:B.isDesktopSidecar)&&(0,a.jsx)(N.$n,{intent:"white",leftIcon:(0,a.jsx)(D.Ah9,{}),onClick:()=>H(!0),children:"Download"}),K[42]=null==B?void 0:B.isDesktopSidecar,K[43]=H,K[44]=O):O=K[44],K[45]!==T||K[46]!==L||K[47]!==O?(R=(0,a.jsxs)("div",{className:"flex gap-2 w-full items-center !mt-4",children:[T,A,L,O]}),K[45]=T,K[46]=L,K[47]=O,K[48]=R):R=K[48],K[49]!==C||K[50]!==I||K[51]!==_||K[52]!==R?(F=(0,a.jsxs)("div",{className:"space-y-2",children:[j,C,I,_,R]}),K[49]=C,K[50]=I,K[51]=_,K[52]=R,K[53]=F):F=K[53],K[54]!==F||K[55]!==y||K[56]!==b||K[57]!==V?(U=(0,a.jsxs)(eh.a,{open:V,onOpenChange:y,contentClass:"max-w-3xl",children:[b,F]}),K[54]=F,K[55]=y,K[56]=b,K[57]=V,K[58]=U):U=K[58],K[59]!==U||K[60]!==g?(z=(0,a.jsxs)(a.Fragment,{children:[g,U]}),K[59]=U,K[60]=g,K[61]=z):z=K[61],z}function nM(e){let t,n,i,r,s,o,c,d,u,p,x,v=(0,l.c)(28),[g,y]=(0,m.fp)(nD),[b,j]=h.useState(""),[w,k]=h.useState(""),{release:S}=e,{mutate:E,isPending:C}=(0,n_.F)();v[0]!==w||v[1]!==b||v[2]!==E||v[3]!==y?(t=function(){if(!w||!b)return J.oR.error("Missing options");E({destination:b,download_url:w},{onSuccess:()=>{y(!1)}})},v[0]=w,v[1]=b,v[2]=E,v[3]=y,v[4]=t):t=v[4];let I=t;if(!S)return null;if(v[5]!==y?(n=()=>y(!1),v[5]=y,v[6]=n):n=v[6],v[7]===Symbol.for("react.memo_cache_sentinel")?(i=(0,f.cn)("border-transparent absolute top-2 right-2 bg-transparent dark:bg-transparent dark:data-[state=unchecked]:bg-transparent","data-[state=unchecked]:bg-transparent data-[state=unchecked]:hover:bg-transparent dark:data-[state=unchecked]:hover:bg-transparent","focus-visible:ring-0 focus-visible:ring-offset-0 focus-visible:ring-offset-transparent"),v[7]=i):i=v[7],v[8]===Symbol.for("react.memo_cache_sentinel")?(r=(0,f.cn)("items-start cursor-pointer transition border-transparent rounded-[--radius] py-1.5 px-2 w-full","bg-gray-50 hover:bg-[--subtle] dark:bg-gray-900","data-[state=checked]:bg-white dark:data-[state=checked]:bg-gray-950","focus:ring-2 ring-transparent dark:ring-transparent outline-none ring-offset-1 ring-offset-[--background] focus-within:ring-2 transition","border border-transparent data-[state=checked]:border-[--brand] data-[state=checked]:ring-offset-0"),v[8]=r):r=v[8],v[9]===Symbol.for("react.memo_cache_sentinel")?(s=e=>e?k(e):{},v[9]=s):s=v[9],v[10]!==S.assets){var _;o=(null==(_=S.assets)?void 0:_.filter(nO).map(nL))||[],v[10]=S.assets,v[11]=o}else o=v[11];v[12]!==w||v[13]!==o?(c=(0,a.jsx)("div",{children:(0,a.jsx)(t2.z,{itemClass:i,itemIndicatorClass:"hidden",itemLabelClass:"font-normal tracking-wide line-clamp-1 truncate flex flex-col items-center data-[state=checked]:text-[--brand] cursor-pointer",itemContainerClass:r,value:w,onValueChange:s,options:o})}),v[12]=w,v[13]=o,v[14]=c):c=v[14];let T="/seanime-".concat(S.version);return v[15]!==b||v[16]!==T?(d=(0,a.jsx)(nT.j,{label:"Select destination",onSelect:j,value:b,rightAddon:T}),v[15]=b,v[16]=T,v[17]=d):d=v[17],v[18]===Symbol.for("react.memo_cache_sentinel")?(u=(0,a.jsx)(D.Ah9,{}),v[18]=u):u=v[18],v[19]!==I||v[20]!==C?(p=(0,a.jsx)("div",{className:"flex gap-2 justify-end mt-2",children:(0,a.jsx)(N.$n,{intent:"white",leftIcon:u,onClick:I,loading:C,children:"Download"})}),v[19]=I,v[20]=C,v[21]=p):p=v[21],v[22]!==g||v[23]!==n||v[24]!==p||v[25]!==c||v[26]!==d?(x=(0,a.jsxs)(eh.a,{open:g,onOpenChange:n,title:"Download new release",contentClass:"space-y-4 max-w-2xl overflow-hidden",children:[c,d,p]}),v[22]=g,v[23]=n,v[24]=p,v[25]=c,v[26]=d,v[27]=x):x=v[27],x}function nL(e){return{label:e.name,value:e.browser_download_url}}function nO(e){return!e.name.endsWith(".txt")}let nR=(0,x.eU)([]),nF=(0,x.eU)(e=>e(nR).length);var nU=n(6759),nz=n(40291);let nK=(0,f.u)({root:(0,e4.F)(["UI-Avatar__root","relative flex shrink-0 overflow-hidden rounded-full"],{variants:{size:{xs:"h-6 w-6",sm:"h-8 w-8",md:"h-10 w-10",lg:"h-14 w-14",xl:"h-20 w-20"}},defaultVariants:{size:"md"}}),image:(0,e4.F)(["UI-Avatar__image","aspect-square h-full w-full"]),fallback:(0,e4.F)(["UI-Avatar__fallback","flex h-full w-full items-center justify-center rounded-full bg-[--muted] text-white dark:text-gray-800 font-semibold"]),fallbackIcon:(0,e4.F)(["UI-Avatar__fallback-icon","fill-transparent"])}),nB=h.forwardRef((e,t)=>{let n,i,r,s,o,c,d,u,m,h,p,x,v,g,y,b,j=(0,l.c)(34);if(j[0]!==e){let{className:t,children:a,imageRef:l,fallbackRef:h,asChild:p,imageClass:f,fallbackClass:x,fallback:v,fallbackIconClass:g,size:y,...b}=e;n=t,d=l,o=h,c=f,r=x,i=v,s=g,m=y,u=b,j[0]=e,j[1]=n,j[2]=i,j[3]=r,j[4]=s,j[5]=o,j[6]=c,j[7]=d,j[8]=u,j[9]=m}else n=j[1],i=j[2],r=j[3],s=j[4],o=j[5],c=j[6],d=j[7],u=j[8],m=j[9];return j[10]!==n||j[11]!==m?(h=(0,f.cn)(nK.root({size:m}),n),j[10]=n,j[11]=m,j[12]=h):h=j[12],j[13]!==c?(p=(0,f.cn)(nK.image(),c),j[13]=c,j[14]=p):p=j[14],j[15]!==d||j[16]!==u||j[17]!==p?(x=(0,a.jsx)(nz._V,{ref:d,className:p,...u}),j[15]=d,j[16]=u,j[17]=p,j[18]=x):x=j[18],j[19]!==r?(v=(0,f.cn)(nK.fallback(),r),j[19]=r,j[20]=v):v=j[20],j[21]!==i||j[22]!==s?(g=!i&&(0,a.jsxs)("svg",{viewBox:"0 0 128 128",className:(0,f.cn)(nK.fallbackIcon(),s),role:"img","aria-label":"avatar",children:[(0,a.jsx)("path",{fill:"currentColor",d:"M103,102.1388 C93.094,111.92 79.3504,118 64.1638,118 C48.8056,118 34.9294,111.768 25,101.7892 L25,95.2 C25,86.8096 31.981,80 40.6,80 L87.4,80 C96.019,80 103,86.8096 103,95.2 L103,102.1388 Z"}),(0,a.jsx)("path",{fill:"currentColor",d:"M63.9961647,24 C51.2938136,24 41,34.2938136 41,46.9961647 C41,59.7061864 51.2938136,70 63.9961647,70 C76.6985159,70 87,59.7061864 87,46.9961647 C87,34.2938136 76.6985159,24 63.9961647,24"})]}),j[21]=i,j[22]=s,j[23]=g):g=j[23],j[24]!==i||j[25]!==o||j[26]!==v||j[27]!==g?(y=(0,a.jsxs)(nz.H4,{ref:o,className:v,children:[g,i]}),j[24]=i,j[25]=o,j[26]=v,j[27]=g,j[28]=y):y=j[28],j[29]!==t||j[30]!==h||j[31]!==x||j[32]!==y?(b=(0,a.jsxs)(nz.bL,{ref:t,className:h,children:[x,y]}),j[29]=t,j[30]=h,j[31]=x,j[32]=y,j[33]=b):b=j[33],b});nB.displayName="Avatar";var nV=n(17934),nG=n(84118);let nH=(0,f.u)({root:(0,e4.F)(["UI-HoverCard__root","z-50 w-64 rounded-xl text-sm border bg-[--paper] p-4 shadow-sm outline-none","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0","data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-100 data-[state=open]:zoom-in-95","data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2","data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2"])}),nq=h.forwardRef((e,t)=>{let n,i,r,s,o,c,d,u,m,h,p=(0,l.c)(22);p[0]!==e?({className:n,align:r,sideOffset:s,openDelay:o,closeDelay:c,...i}=e,p[0]=e,p[1]=n,p[2]=i,p[3]=r,p[4]=s,p[5]=o,p[6]=c):(n=p[1],i=p[2],r=p[3],s=p[4],o=p[5],c=p[6]);let x=void 0===r?"center":r,v=void 0===s?8:s,g=void 0===o?1e3:o,y=void 0===c?0:c;return p[7]!==e.trigger?(d=(0,a.jsx)(nG.l9,{asChild:!0,children:e.trigger}),p[7]=e.trigger,p[8]=d):d=p[8],p[9]!==n?(u=(0,f.cn)(nH.root(),n),p[9]=n,p[10]=u):u=p[10],p[11]!==x||p[12]!==t||p[13]!==i||p[14]!==v||p[15]!==u?(m=(0,a.jsx)(nG.UC,{ref:t,align:x,sideOffset:v,className:u,...i}),p[11]=x,p[12]=t,p[13]=i,p[14]=v,p[15]=u,p[16]=m):m=p[16],p[17]!==y||p[18]!==g||p[19]!==d||p[20]!==m?(h=(0,a.jsxs)(nG.bL,{openDelay:g,closeDelay:y,children:[d,m]}),p[17]=y,p[18]=g,p[19]=d,p[20]=m,p[21]=h):h=p[21],h});nq.displayName="HoverCard";var nW=n(43756),nQ=n(21068),nX=n(24151),n$=n(73329),nY=n.n(n$),nZ=n(65160),nJ=n(38628),n0=n(67187),n1=n(81281);function n2(){var e,t,n,l,i,s,o,c,d,p,x,v,g,b,j,w,k,S,E,C,I,_,T,L,O,R,F;let U=(0,tZ.kb)(),z=(0,eL.Ky)(),[K,B]=h.useState(!1),[V,G]=h.useState(!1),H=z.expandSidebarOnHover?!U.isBelowBreakpoint&&!K:!U.isBelowBreakpoint,q=(0,A.useRouter)(),Q=(0,A.usePathname)(),X=(0,eU.v1)(),$=(0,eU.LX)(),Y=(0,eU.iZ)(),{setSeaCommandOpen:Z}=(0,nI.W)(),J=(0,tt.Wk)(),ee=(0,m.md)(nF),{mutate:et,data:en,isPending:ea}=(0,eV.W)();h.useEffect(()=>{ea||$(en)},[ea,en]);let el=(0,m.Xr)(M),[ei,er]=(0,m.fp)(eH.Q),[es,eo]=(0,m.fp)(n1.gg),ec=(0,n1.zh)(),ed=()=>{!U.isBelowBreakpoint&&z.expandSidebarOnHover&&B(!0)},eu=()=>{K&&z.expandSidebarOnHover&&B(!1)},em=(0,tm.J)({title:"Sign out",description:"Are you sure you want to sign out?",onConfirm:()=>{et()}}),[ep,ef]=h.useState({downloading:0,paused:0,seeding:0});(0,r.oA)({type:u.c.ACTIVE_TORRENT_COUNT_UPDATED,onMessage:e=>{ef(e)}});let{syncIsActive:ex}=eW(),{data:eb}=(0,eG.Og)(),[ej,ew]=h.useState(!1),{mutate:eN,isPending:ek}=(0,y.Z_)(),eS=[{id:"home",iconType:nJ.M14,name:"Home",href:"/",isCurrent:"/"===Q},{id:"schedule",iconType:ev.IdP,name:"Schedule",href:"/schedule",isCurrent:"/schedule"===Q,addon:J>0?(0,a.jsx)(tE.E,{className:"absolute right-0 top-0",size:"sm",intent:"alert-solid",children:J}):void 0},...(null==X||null==(t=X.settings)||null==(e=t.library)?void 0:e.enableManga)?[{id:"manga",iconType:ev.Z5q,name:"Manga",href:"/manga",isCurrent:Q.startsWith("/manga")}]:[],{id:"lists",iconType:ey.t6L,name:"My lists",href:"/lists",isCurrent:"/lists"===Q},{id:"discover",iconType:ev.Gd$,name:"Discover",href:"/discover",isCurrent:"/discover"===Q},...(null==X||null==(l=X.settings)||null==(n=l.library)?void 0:n.torrentProvider)!==nX.xF.NONE&&(null==X||null==(s=X.settings)||null==(i=s.torrent)?void 0:i.defaultTorrentClient)!==nX.XH.NONE?[{id:"torrent-list",iconType:(null==X||null==(c=X.settings)||null==(o=c.torrent)?void 0:o.defaultTorrentClient)===nX.XH.QBITTORRENT?n0.fy_:n0.nfy,name:0!==ep.seeding&&(null==X||null==(p=X.settings)||null==(d=p.torrent)?void 0:d.showActiveTorrentCount)?"Torrent list (".concat(ep.seeding," seeding)"):"Torrent list",href:"/torrent-list",isCurrent:"/torrent-list"===Q,addon:ep.downloading+ep.paused>0&&(null==X||null==(v=X.settings)||null==(x=v.torrent)?void 0:x.showActiveTorrentCount)?(0,a.jsx)(tE.E,{className:"absolute right-0 top-0 bg-green-500",size:"sm",intent:"alert-solid",children:ep.downloading+ep.paused}):void 0}]:[],...(null==X||null==(g=X.debridSettings)?void 0:g.enabled)&&(null==X||null==(b=X.debridSettings)?void 0:b.provider)?[{id:"debrid",iconType:nZ.hgf,name:"Debrid",href:"/debrid",isCurrent:"/debrid"===Q}]:[],...(null==X||null==(w=X.settings)||null==(j=w.library)?void 0:j.libraryPath)?[{id:"scan-summaries",iconType:tI.rlW,name:"Scan summaries",href:"/scan-summaries",isCurrent:"/scan-summaries"===Q}]:[],...(null==X||null==(S=X.settings)||null==(k=S.library)?void 0:k.torrentProvider)!==nX.xF.NONE&&(null==X||null==(C=X.settings)||null==(E=C.library)?void 0:E.libraryPath)?[{id:"auto-downloader",iconType:ev.sOl,name:"Auto Downloader",href:"/auto-downloader",isCurrent:"/auto-downloader"===Q,addon:ee>0?(0,a.jsx)(tE.E,{className:"absolute right-0 top-0",size:"sm",intent:"alert-solid",children:ee}):void 0}]:[],{id:"search",iconType:P.CKj,name:"Search",onClick:()=>{U.setOpen(!1),el(!0)}}],eE=h.useMemo(()=>eS.filter(e=>{var t;return!(null==(t=z.unpinnedMenuItems)?void 0:t.includes(e.id))}),[eS,z.unpinnedMenuItems]),eC=h.useMemo(()=>{var e;return(null==(e=z.unpinnedMenuItems)?void 0:e.length)===0||0===eS.length?[]:[{iconType:D.XWt,name:"More",subContent:(0,a.jsx)(e$.m,{items:eS.filter(e=>{var t;return null==(t=z.unpinnedMenuItems)?void 0:t.includes(e.id)})})}]},[eS,z.unpinnedMenuItems,z.hideTopNavbar]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(tZ.GK,{className:(0,f.cn)("group/main-sidebar h-full flex flex-col justify-between transition-gpu w-full transition-[width] duration-300",!U.isBelowBreakpoint&&K&&"w-[260px]",!U.isBelowBreakpoint&&!z.disableSidebarTransparency&&"bg-transparent",!U.isBelowBreakpoint&&!z.disableSidebarTransparency&&z.expandSidebarOnHover&&"hover:bg-[--background]"),onMouseEnter:ed,onMouseLeave:eu,children:[!U.isBelowBreakpoint&&z.expandSidebarOnHover&&z.disableSidebarTransparency&&(0,a.jsx)("div",{className:(0,f.cn)("fixed h-full translate-x-0 w-[50px] bg-gradient bg-gradient-to-r via-[--background] from-[--background] to-transparent","group-hover/main-sidebar:translate-x-[250px] transition opacity-0 duration-300 group-hover/main-sidebar:opacity-100")}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:(0,f.cn)("mb-4 p-4 pb-0 flex justify-center w-full",tJ.X&&"mt-2"),children:(0,a.jsx)("img",{src:"/seanime-logo.png",alt:"logo",className:"w-15 h-10 transition-all duration-300"})}),(0,a.jsx)(e$.m,{className:"px-4",collapsed:H,itemClass:"relative",itemChevronClass:"hidden",itemIconClass:"transition-transform group-data-[state=open]/verticalMenu_parentItem:rotate-90",items:[...eE,...eC,{iconType:ev.JbZ,name:"Refresh AniList",onClick:()=>{ek||eN()}}],subContentClass:(0,f.cn)((z.hideTopNavbar||tJ.X)&&"border-transparent !border-b-0"),onLinkItemClick:()=>U.setOpen(!1),isSidebar:!0}),(0,a.jsx)(nC,{isCollapsed:H,handleExpandSidebar:()=>{},handleUnexpandedSidebar:()=>{}}),tJ.X&&(0,a.jsx)("div",{className:"w-full flex justify-center px-4",children:(0,a.jsx)(nq,{side:"right",sideOffset:-8,className:"bg-transparent border-none",trigger:(0,a.jsx)(N.K0,{intent:"gray-basic",className:"!text-[--muted] hover:!text-[--foreground]",icon:(0,a.jsx)(tl._R2,{}),onClick:()=>{q.back()}}),children:(0,a.jsx)(N.K0,{icon:(0,a.jsx)(tl.HNO,{}),intent:"gray-subtle",className:"opacity-50 hover:opacity-100",onClick:()=>{q.forward()}})})}),(0,a.jsx)(nN,{place:"sidebar"})]}),(0,a.jsxs)("div",{className:"flex w-full gap-2 flex-col px-4",children:[tJ.X?tJ.qe?(0,a.jsx)(nU.gS,{collapsed:H}):tJ.nH?(0,a.jsx)(e2,{collapsed:H}):null:(0,a.jsx)(nP,{collapsed:H}),(0,a.jsx)("div",{children:(0,a.jsx)(e$.m,{collapsed:H,itemClass:"relative",onMouseEnter:()=>{},onMouseLeave:()=>{},onLinkItemClick:()=>U.setOpen(!1),isSidebar:!0,items:[...(null==X||null==(_=X.settings)||null==(I=_.nakama)?void 0:I.enabled)?[{iconType:eg.u67,iconClass:"size-6",name:"Nakama",isCurrent:es,onClick:()=>eo(!0),addon:(0,a.jsxs)(a.Fragment,{children:[(null==ec?void 0:ec.isHost)&&!!(null==ec||null==(T=ec.connectedPeers)?void 0:T.length)&&(0,a.jsx)(tE.E,{className:"absolute right-0 top-0",size:"sm",intent:"info",children:null==ec||null==(L=ec.connectedPeers)?void 0:L.length}),(null==ec?void 0:ec.isConnectedToHost)&&(0,a.jsx)("div",{className:"absolute right-2 top-2 animate-pulse size-2 bg-green-500 rounded-full"})]})}]:[],{iconType:D.DT2,name:"Extensions",href:"/extensions",isCurrent:Q.includes("/extensions"),addon:(null==eb?void 0:eb.length)?(0,a.jsx)(tE.E,{className:"absolute right-0 top-0 bg-red-500 animate-pulse",size:"sm",intent:"alert-solid",children:(null==eb?void 0:eb.length)||1}):void 0},{iconType:nJ.fps,name:"Offline",href:"/sync",isCurrent:Q.includes("/sync"),addon:ex?(0,a.jsx)(tE.E,{className:"absolute right-0 top-0 bg-blue-500",size:"sm",intent:"alert-solid",children:"1"}):void 0},{iconType:ev.xPd,name:"Settings",href:"/settings",isCurrent:"/settings"===Q},...U.isBelowBreakpoint?[{iconType:(null==Y?void 0:Y.isSimulated)?P.dUr:D.AMx,name:(null==Y?void 0:Y.isSimulated)?"Sign in":"Sign out",onClick:(null==Y?void 0:Y.isSimulated)?()=>er(!0):em.open}]:[]]})}),!Y&&(0,a.jsx)("div",{children:(0,a.jsx)(e$.m,{collapsed:H,itemClass:"relative",onMouseEnter:ed,onMouseLeave:eu,onLinkItemClick:()=>U.setOpen(!1),isSidebar:!0,items:[{iconType:P.dUr,name:"Login",onClick:()=>(0,nW.A)(nQ.$M)}]})}),!!Y&&(0,a.jsx)("div",{className:"flex w-full gap-2 flex-col",children:(0,a.jsx)(nV.rI,{trigger:(0,a.jsxs)("div",{className:(0,f.cn)("w-full flex p-2.5 pt-1 items-center space-x-2",{hidden:U.isBelowBreakpoint}),children:[(0,a.jsx)(nB,{size:"sm",className:"cursor-pointer",src:(null==Y||null==(R=Y.viewer)||null==(O=R.avatar)?void 0:O.medium)||void 0}),K&&(0,a.jsx)("p",{className:"truncate",children:null==Y||null==(F=Y.viewer)?void 0:F.name})]}),open:V,onOpenChange:G,children:Y.isSimulated?(0,a.jsxs)(nV._2,{onClick:()=>er(!0),children:[(0,a.jsx)(D.DLy,{})," Log in with AniList"]}):(0,a.jsxs)(nV._2,{onClick:em.open,children:[(0,a.jsx)(D.AMx,{})," Sign out"]})})})]})]}),(0,a.jsx)(eh.a,{title:"Log in with AniList",description:"Using an AniList account is recommended.",open:ei&&(null==Y?void 0:Y.isSimulated),onOpenChange:e=>er(e),overlayClass:"bg-opacity-95 bg-gray-950",contentClass:"border",children:(0,a.jsxs)("div",{className:"mt-5 text-center space-y-4",children:[(0,a.jsx)(nY(),{href:nQ.tL,target:"_blank",children:(0,a.jsx)(N.$n,{leftIcon:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",width:"24",height:"24",viewBox:"0 0 24 24",role:"img",children:(0,a.jsx)("path",{d:"M6.361 2.943 0 21.056h4.942l1.077-3.133H11.4l1.052 3.133H22.9c.71 0 1.1-.392 1.1-1.101V17.53c0-.71-.39-1.101-1.1-1.101h-6.483V4.045c0-.71-.392-1.102-1.101-1.102h-2.422c-.71 0-1.101.392-1.101 1.102v1.064l-.758-2.166zm2.324 5.948 1.688 5.018H7.144z"})}),intent:"white",size:"md",children:"Get AniList token"})}),(0,a.jsxs)(W.lV,{schema:(0,W.Jo)(e=>{let{z:t}=e;return t.object({token:t.string().min(1,"Token is required")})}),onSubmit:e=>{ew(!0),q.push("/auth/callback#access_token="+e.token.trim()),er(!1),ew(!1)},children:[(0,a.jsx)(W.D0.Textarea,{name:"token",label:"Enter the token",fieldClass:"px-4"}),(0,a.jsx)(W.D0.Submit,{showLoadingOverlayOnSuccess:!0,loading:ej,children:"Continue"})]})]})}),(0,a.jsx)(tm.K,{...em})]})}var n3=n(68205),n4=n(56222),n5=n(18292),n6=n(62024);function n8(e){var t,n,i,r;let s,o,c,d,u,m,p,f,x,v,g,y,b,j,w,k=(0,l.c)(47),{libraryCollection:S,playlist:E,trigger:C}=e,[I,_]=h.useState(!1),[T,A]=h.useState(null!=(t=null==E?void 0:E.name)?t:"");k[0]===Symbol.for("react.memo_cache_sentinel")?(s=[],k[0]=s):s=k[0];let[D,P]=h.useState(s),M=!!E,{mutate:L,isPending:O}=(0,n4._X)(),{mutate:R,isPending:F}=(0,n4.F6)(),{mutate:U,isPending:z}=(0,n4.pZ)();k[1]===Symbol.for("react.memo_cache_sentinel")?(o=function(){A(""),P([])},k[1]=o):o=k[1];let K=o;k[2]!==M||k[3]!==E?(c=()=>{M&&E&&E.episodes&&(A(E.name),P(E.episodes))},k[2]=M,k[3]=E,k[4]=c):c=k[4],k[5]!==I||k[6]!==E?(d=[E,I],k[5]=I,k[6]=E,k[7]=d):d=k[7],h.useEffect(c,d),k[8]!==L||k[9]!==D||k[10]!==M||k[11]!==T||k[12]!==E||k[13]!==U?(u=function(){if(0===T.length)return void J.oR.error("Please enter a name for the playlist");M&&E?U({dbId:E.dbId,name:T,episodes:D}):(_(!1),L({name:T,episodes:D},{onSuccess:()=>{K()}}))},k[8]=L,k[9]=D,k[10]=M,k[11]=T,k[12]=E,k[13]=U,k[14]=u):u=k[14];let B=u,V=M?"Edit playlist":"Create a playlist";k[15]===Symbol.for("react.memo_cache_sentinel")?(m=e=>_(e),k[15]=m):m=k[15],k[16]===Symbol.for("react.memo_cache_sentinel")?(p=e=>A(e.target.value),k[16]=p):p=k[16],k[17]!==T?(f=(0,a.jsx)($.k,{label:"Name",value:T,onChange:p}),k[17]=T,k[18]=f):f=k[18],k[19]!==D||k[20]!==S?(x=(0,a.jsx)(n6.er,{episodes:D,setEpisodes:P,libraryCollection:S}),k[19]=D,k[20]=S,k[21]=x):x=k[21],k[22]!==D||k[23]!==(null==S?void 0:S.lists)?(v=null==S||null==(r=S.lists)||null==(i=r.flatMap(n7))||null==(n=i.filter(Boolean))?void 0:n.map(e=>(0,a.jsx)(n6.Zf,{entry:e,episodes:D,setEpisodes:P},e.mediaId)),k[22]=D,k[23]=null==S?void 0:S.lists,k[24]=v):v=k[24];let G=0===D.length,H=O||F||z,q=M?"Update":"Create";return k[25]!==B||k[26]!==G||k[27]!==H||k[28]!==q?(g=(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)(N.$n,{disabled:G,onClick:B,loading:H,className:"w-full",children:q})}),k[25]=B,k[26]=G,k[27]=H,k[28]=q,k[29]=g):g=k[29],k[30]!==v||k[31]!==g||k[32]!==f||k[33]!==x?(y=(0,a.jsxs)("div",{className:"space-y-4",children:[f,x,v,g]}),k[30]=v,k[31]=g,k[32]=f,k[33]=x,k[34]=y):y=k[34],k[35]!==R||k[36]!==M||k[37]!==E?(b=M&&(0,a.jsx)(W.mw,{actionText:"Delete playlist",onDelete:()=>{M&&E&&R({dbId:E.dbId},{onSuccess:()=>{_(!1)}})}}),k[35]=R,k[36]=M,k[37]=E,k[38]=b):b=k[38],k[39]!==y||k[40]!==b?(j=(0,a.jsxs)("div",{className:"space-y-4",children:[y,b]}),k[39]=y,k[40]=b,k[41]=j):j=k[41],k[42]!==I||k[43]!==j||k[44]!==V||k[45]!==C?(w=(0,a.jsx)(eh.a,{title:V,trigger:C,open:I,onOpenChange:m,onInteractOutside:n9,contentClass:"max-w-4xl",children:j}),k[42]=I,k[43]=j,k[44]=V,k[45]=C,k[46]=w):w=k[46],w}function n7(e){return e.entries}function n9(e){return e.preventDefault()}var ae=n(29694),at=n(74907),an=n(6708),aa=n(19022);function al(){var e,t,n,i,r,s,o,c,d;let u,m,p,x,v,g,y,b,j,w,k,S,E=(0,l.c)(45);(0,eU.v1)();let{isModalOpen:C,setModalOpen:I,setSelectedMedia:_,selectedMedia:T}=(0,ae.e)(),{data:A}=(0,n3.lD)();e:{if(!(null==A?void 0:A.lists)){u=void 0;break e}if(null==A?void 0:A.stream){let a,l,c,d;if(E[0]!==A.lists||E[1]!==A.stream.anime||E[2]!==A.stream.listData){let l,r=null==(e=A.lists)?void 0:e.find(as);for(let e of(a=[...null!=(t=null==r?void 0:r.entries)?t:[]],E[4]!==A.stream.anime?(l=null!=(n=A.stream.anime)?n:[],E[4]=A.stream.anime,E[5]=l):l=E[5],l))a.some(t=>t.mediaId===e.id)||a.push({media:e,mediaId:e.id,listData:null==(i=A.stream.listData)?void 0:i[e.id],libraryData:void 0});E[0]=A.lists,E[1]=A.stream.anime,E[2]=A.stream.listData,E[3]=a}else a=E[3];E[6]!==a?(l={type:"CURRENT",status:"CURRENT",entries:a},E[6]=a,E[7]=l):l=E[7];let m=l;E[8]!==A.lists||E[9]!==m?(c=[m,...null!=(o=null==(r=null!=(s=A.lists)?s:[])?void 0:r.filter(ar))?o:[]].filter(Boolean),E[8]=A.lists,E[9]=m,E[10]=c):c=E[10],E[11]!==A||E[12]!==c?(d={...A,lists:c},E[11]=A,E[12]=c,E[13]=d):d=E[13],u=d}else u=A}let D=u;E[14]!==(null==D?void 0:D.lists)?(m=null!=(d=null==D||null==(c=D.lists)?void 0:c.flatMap(ai))?d:[],E[14]=null==D?void 0:D.lists,E[15]=m):m=E[15];let P=m;E[16]!==P||E[17]!==T||E[18]!==I||E[19]!==_?(p=()=>{T&&!P.find(e=>(null==e?void 0:e.mediaId)===T)&&(J.oR.warning("This anime is not in your library or currently watching collection."),_(null),h.startTransition(()=>{I(!1)}))},E[16]=P,E[17]=T,E[18]=I,E[19]=_,E[20]=p):p=E[20],E[21]!==P||E[22]!==T?(x=[T,P],E[21]=P,E[22]=T,E[23]=x):x=E[23],h.useEffect(p,x),E[24]!==I||E[25]!==_?(v=e=>{I(e),e||_(null)},E[24]=I,E[25]=_,E[26]=v):v=E[26],E[27]===Symbol.for("react.memo_cache_sentinel")?(g=(0,a.jsx)("div",{children:(0,a.jsxs)("h4",{className:"flex items-center",children:["Playlists ",(0,a.jsx)(at.U,{})]})}),E[27]=g):g=E[27];let M=T&&"animate-pulse";E[28]!==M?(y=(0,f.cn)("rounded-full",M),E[28]=M,E[29]=y):y=E[29];let L=T?"Add to new Playlist":"Create a Playlist";return E[30]!==y||E[31]!==L?(b=(0,a.jsx)(N.$n,{intent:"white",className:y,children:L}),E[30]=y,E[31]=L,E[32]=b):b=E[32],E[33]!==D||E[34]!==b?(j=(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[g,(0,a.jsx)("div",{className:"flex gap-2 items-center md:pr-8",children:(0,a.jsx)(n8,{libraryCollection:D,trigger:b})})]}),E[33]=D,E[34]=b,E[35]=j):j=E[35],E[36]!==D?(w=(0,a.jsx)("div",{className:"",children:(0,a.jsx)(ao,{libraryCollection:D})}),E[36]=D,E[37]=w):w=E[37],E[38]!==j||E[39]!==w?(k=(0,a.jsxs)("div",{className:"space-y-6",children:[j,w]}),E[38]=j,E[39]=w,E[40]=k):k=E[40],E[41]!==C||E[42]!==k||E[43]!==v?(S=(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(e5._s,{open:C,onOpenChange:v,size:"lg",side:"bottom",contentClass:"",children:k})}),E[41]=C,E[42]=k,E[43]=v,E[44]=S):S=E[44],S}function ai(e){return e.entries}function ar(e){return"CURRENT"!==e.type}function as(e){return"CURRENT"===e.type}function ao(e){let t,n,i,r,s=(0,l.c)(17),{libraryCollection:o}=e,{data:d,isLoading:u}=(0,n4.PY)(),{selectedMedia:m,setModalOpen:h}=(0,ae.e)(),{startPlaylist:p}=(0,td.n)();if(u){let e;return s[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(c.kt,{}),s[0]=e):e=s[0],e}if(!(null==d?void 0:d.length)){let e;return s[1]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsxs)("div",{className:"text-center text-[--muted] space-y-1 py-6",children:[(0,a.jsx)(eg.wHW,{className:"mx-auto text-5xl text-[--muted]"}),(0,a.jsx)("div",{children:"No playlists"})]}),s[1]=e):e=s[1],e}if(s[2]===Symbol.for("react.memo_cache_sentinel")?(t={align:"start"},n=(0,a.jsx)(an.h1,{}),s[2]=t,s[3]=n):(t=s[2],n=s[3]),s[4]!==o||s[5]!==d||s[6]!==m||s[7]!==h||s[8]!==p){let e;s[10]!==o||s[11]!==m||s[12]!==h||s[13]!==p?(e=e=>{var t,n,l,i,r;let s=null==(l=e.episodes)||null==(n=l[0])||null==(t=n.episode)?void 0:t.baseAnime;return(0,a.jsx)(an.A7,{className:(0,f.cn)("md:basis-1/3 lg:basis-1/4 2xl:basis-1/6 min-[2000px]:basis-1/6","aspect-[7/6] p-2"),children:(0,a.jsxs)("div",{className:"group/playlist-item flex gap-3 h-full justify-between items-center bg-gray-950 rounded-md transition relative overflow-hidden",children:[((null==s||null==(i=s.coverImage)?void 0:i.large)||(null==s?void 0:s.bannerImage))&&(0,a.jsx)(j.r,{src:(null==s||null==(r=s.coverImage)?void 0:r.extraLarge)||(null==s?void 0:s.bannerImage)||"",placeholder:(0,th.r)(700,475),sizes:"10rem",fill:!0,alt:"",className:"object-center object-cover z-[1]"}),(0,a.jsx)("div",{className:"absolute inset-0 z-[2] bg-gray-900 opacity-50 hover:opacity-70 transition-opacity flex items-center justify-center"}),(0,a.jsx)("div",{className:"absolute inset-0 z-[6] flex items-center justify-center",children:!m&&(0,a.jsx)("div",{onClick:()=>{p(e),h(!1)},children:(0,a.jsx)(aa.Yay,{className:"block text-5xl cursor-pointer opacity-95 hover:opacity-70 hover:scale-[1.1] transition-all"})})}),(0,a.jsx)("div",{className:"absolute top-2 right-2 z-[6] flex items-center justify-center",children:(0,a.jsx)(n8,{libraryCollection:o,trigger:(0,a.jsx)(N.$n,{className:(0,f.cn)("w-full flex-none rounded-full",m&&"animate-pulse"),leftIcon:m?(0,a.jsx)(ev._rf,{}):(0,a.jsx)(D.VZ_,{}),intent:m?"white":"white-subtle",size:"sm",children:m?"Add to Playlist":"Edit"}),playlist:e})}),(0,a.jsx)("div",{className:"absolute w-full bottom-0 h-fit z-[6]",children:(0,a.jsxs)("div",{className:"space-y-0 pb-3 items-center",children:[(0,a.jsx)("p",{className:"text-md font-bold text-white max-w-lg truncate text-center",children:e.name}),e.episodes&&(0,a.jsxs)("p",{className:"text-sm text-[--muted] font-normal line-clamp-1 text-center",children:[e.episodes.length," episode",e.episodes.length>1?"s":""]})]})}),(0,a.jsx)(n5.H,{})]})},e.dbId)},s[10]=o,s[11]=m,s[12]=h,s[13]=p,s[14]=e):e=s[14],i=d.map(e),s[4]=o,s[5]=d,s[6]=m,s[7]=h,s[8]=p,s[9]=i}else i=s[9];return s[15]!==i?(r=(0,a.jsxs)(an.FN,{className:"w-full max-w-full",gap:"none",opts:t,children:[n,(0,a.jsx)(an.Wk,{children:i})]}),s[15]=i,s[16]=r):r=s[16],r}var ac=n(45499),ad=n(70274);function au(e){let{extensionId:t,info:n}=e;(0,A.useRouter)();let l=(0,A.usePathname)(),[i,r]=h.useState(!1),[s,o]=h.useState(""),[c,d]=h.useState(""),[u,m]=h.useState([]),[p,f]=h.useState(n.placeholder),{sendRenderCommandPaletteEvent:x}=(0,t8.Zf)(),{sendCommandPaletteInputEvent:v}=(0,t8.FS)(),{sendCommandPaletteOpenedEvent:g}=(0,t8.aY)(),{sendCommandPaletteClosedEvent:y}=(0,t8.vM)(),{sendCommandPaletteItemSelectedEvent:b}=(0,t8.fP)();h.useEffect(()=>{if(n.keyboardShortcut)return tf().bind(n.keyboardShortcut,()=>{o(""),h.startTransition(()=>{r(!0)})}),()=>{tf().unbind(n.keyboardShortcut)}},[n.keyboardShortcut]),(0,ad.w5)(()=>{i||(o(""),y({},t)),i&&(g({},t),x({},t))},[i,t]),(0,t8.Ce)(e=>{v({value:s},t)},t),(0,t8.NM)(e=>{o(e.value)},t),(0,t8.kF)(e=>{r(!0)},t),(0,t8.mU)(e=>{r(!1)},t),(0,t8.$n)(e=>{m(e.items),f(e.placeholder)},t);let j=h.useRef(null);function w(){let e=j.current;if(!e)return()=>{};let t=setTimeout(()=>{e.scrollTop=0;let t=e.querySelector("[cmdk-item]");if(t){let e=t.getAttribute("data-value");e&&d(e)}},100);return()=>clearTimeout(t)}h.useEffect(()=>{let e=w();return()=>e()},[s,l]);let N=h.useMemo(()=>{let e={};return u.filter(e=>"includes"===e.filterType?e.value.toLowerCase().includes(s.toLowerCase()):"startsWith"!==e.filterType||e.value.toLowerCase().startsWith(s.toLowerCase())).forEach(t=>{let n=t.heading||"";e[n]||(e[n]=[]),e[n].push(t)}),w(),e},[u,s]);return(0,a.jsxs)(ac.Gj,{open:i,onOpenChange:r,commandProps:{value:c,onValueChange:d},overlayClass:"bg-black/30",contentClass:"max-w-2xl",commandClass:"h-[300px]",children:[(0,a.jsx)(ac.G7,{placeholder:p||"",value:s,onValueChange:o}),(0,a.jsx)(ac.oI,{className:"mb-2",ref:j,children:(0,a.jsx)(no,{registry:na,children:Object.entries(N).map(e=>{let[n,l]=e;return(0,a.jsx)(ac.L$,{heading:n,children:l.map(e=>(0,a.jsx)(ac.h_,{value:e.value,onSelect:()=>{b({itemId:e.id},t)},className:"block",children:e.label?e.label:(0,a.jsx)(nr,{data:e.components})},e.id))},n)})})})]})}let am=(0,x.eU)([]);function ah(){let e,t,n,i,s,o,c=(0,l.c)(11),[d,p]=(0,m.fp)(am),{sendListCommandPalettesEvent:f}=(0,t8.mL)();return(c[0]!==f?(e=()=>{f({},"")},c[0]=f,c[1]=e):e=c[1],c[2]===Symbol.for("react.memo_cache_sentinel")?(t=[],c[2]=t):t=c[2],h.useEffect(e,t),c[3]!==p?(n=(e,t)=>{"q"!==e.keyboardShortcut&&"meta+j"!==e.keyboardShortcut&&p(n=>[...n.filter(e=>e.extensionId!==t),{extensionId:t,...e}].sort(af))},c[3]=p,c[4]=n):n=c[4],(0,t8.KQ)(n,""),c[5]!==p?(i={type:u.c.PLUGIN_UNLOADED,onMessage:e=>{p(t=>t.filter(t=>t.extensionId!==e))}},c[5]=p,c[6]=i):i=c[6],(0,r.oA)(i),d)?(c[7]!==d?(s=d.map(ap),c[7]=d,c[8]=s):s=c[8],c[9]!==s?(o=(0,a.jsx)(a.Fragment,{children:s}),c[9]=s,c[10]=o):o=c[10],o):null}function ap(e,t){return(0,a.jsx)(au,{extensionId:e.extensionId,info:e},t)}function af(e,t){return e.extensionId.localeCompare(t.extensionId,void 0,{numeric:!0})}let ax=0;function av(e){let t=(ax++).toString(36);return"".concat("pe","-").concat(e.substring(0,4),"-").concat(t)}function ag(e,t){let n=document.getElementById(e.elementId);n&&n.removeEventListener(e.eventType,e.callback)}function ay(e){e.disconnect()}function ab(e,t,n,a){if(!(e instanceof HTMLElement))return;let l={};if(e.dataset.original)try{l=JSON.parse(e.dataset.original)}catch(e){l={}}l[t]||(l[t]={}),void 0===l[t][n]&&(l[t][n]=a,e.dataset.original=JSON.stringify(l))}function aj(e){return e.target}function aw(e){return e.isIntersecting}function aN(e){}function ak(e){}function aS(e){let t,n,a,i,s,o,c,d,m,p,f,x,v,g,y,b=(0,l.c)(39),{extensionId:j,onUnloaded:w}=e,{handleDOMQuery:N,handleDOMQueryOne:k,handleDOMObserve:S,handleDOMObserveInView:E,handleDOMStopObserve:C,handleDOMCreate:I,handleDOMManipulate:_,cleanup:T}=function(e){let t,n,a,i,s,o,c,d,u,m,p,f,x,v,g,y,b,j,w,N,k,S,E=(0,l.c)(58),{sendPluginMessage:C}=(0,r.Y0)();E[0]===Symbol.for("react.memo_cache_sentinel")?(t=new Map,E[0]=t):t=E[0];let I=(0,h.useRef)(t);E[1]===Symbol.for("react.memo_cache_sentinel")?(n=new Map,E[1]=n):n=E[1];let _=(0,h.useRef)(n);E[2]===Symbol.for("react.memo_cache_sentinel")?(a=new Map,E[2]=a):a=E[2];let T=(0,h.useRef)(a);E[3]===Symbol.for("react.memo_cache_sentinel")?(i=new Map,E[3]=i):i=E[3];let A=(0,h.useRef)(i),D=(0,h.useRef)(null),P=(0,h.useRef)(!1),M=(0,h.useRef)(!1);E[4]===Symbol.for("react.memo_cache_sentinel")?(s=new Set,E[4]=s):s=E[4];let L=(0,h.useRef)(s);E[5]===Symbol.for("react.memo_cache_sentinel")?(o=new Map,E[5]=o):o=E[5];let O=(0,h.useRef)(o);E[6]!==e?(c=t=>{if(I.current.has(t))return I.current.get(t);if(t.id)return I.current.set(t,t.id),t.id;let n=av(e);return t.id=n,I.current.set(t,n),n},E[6]=e,E[7]=c):c=E[7];let R=c;E[8]!==e||E[9]!==C?(d=(t,n)=>{P.current||C(t,n,e)},E[8]=e,E[9]=C,E[10]=d):d=E[10];let F=d;E[11]!==F?(u=()=>{P.current||M.current||(M.current=!0,F(t8.sn.DOMReady,{}))},E[11]=F,E[12]=u):u=E[12];let U=u;E[13]!==R?(m=(e,t)=>{let n={};for(let t=0;t<e.attributes.length;t++){let a=e.attributes[t];n[a.name]=a.value}if(n.id=R(e),e instanceof HTMLElement)for(let t in e.dataset)Object.prototype.hasOwnProperty.call(e.dataset,t)&&(n["data-".concat(t)]=e.dataset[t]||"");return(null==t?void 0:t.identifyChildren)&&e.querySelectorAll("*").forEach(e=>{e.id||R(e)}),{id:n.id,tagName:e.tagName.toLowerCase(),attributes:n,innerHTML:(null==t?void 0:t.withInnerHTML)?e.innerHTML:void 0,outerHTML:(null==t?void 0:t.withOuterHTML)?e.outerHTML:void 0,children:[]}},E[13]=R,E[14]=m):m=E[14];let z=m;E[15]!==z||E[16]!==R||E[17]!==F?(p=()=>{"undefined"!=typeof MutationObserver&&(D.current=new MutationObserver(e=>{if(P.current)return;let t=new Set;e.forEach(e=>{if("childList"===e.type&&e.addedNodes.forEach(e=>{e instanceof Element&&(t.add(e),e.querySelectorAll("*").forEach(e=>t.add(e)))}),"attributes"===e.type||"characterData"===e.type){let n=e.target instanceof Element?e.target:e.target.parentElement;n&&t.add(n)}}),_.current.forEach((e,n)=>{let a=[],l=T.current.get(n)||new Set;if(t.forEach(t=>{t.matches(e.selector)&&(R(t),a.push(t))}),document.querySelectorAll(e.selector).forEach(e=>{let t=R(e);l.has(t)||a.includes(e)||a.push(e)}),a.length>0){let t=a.map(t=>z(t,{withInnerHTML:e.withInnerHTML,withOuterHTML:e.withOuterHTML,identifyChildren:e.identifyChildren}));t.forEach(e=>l.add(e.id)),T.current.set(n,l),e.callback(a),F(t8.sn.DOMObserveResult,{observerId:n,elements:t})}})}),D.current.observe(document.body,{childList:!0,subtree:!0,attributes:!0,characterData:!0}))},E[15]=z,E[16]=R,E[17]=F,E[18]=p):p=E[18];let K=p;E[19]!==z||E[20]!==F?(f=e=>{let{selector:t,requestId:n,withInnerHTML:a,identifyChildren:l,withOuterHTML:i}=e;if(P.current)return;let r=Array.from(document.querySelectorAll(t)).map(e=>z(e,{withInnerHTML:a,identifyChildren:l,withOuterHTML:i}));F(t8.sn.DOMQueryResult,{requestId:n,elements:r})},E[19]=z,E[20]=F,E[21]=f):f=E[21];let B=f;E[22]!==z||E[23]!==F?(x=e=>{let{selector:t,requestId:n,withInnerHTML:a,identifyChildren:l,withOuterHTML:i}=e;if(P.current)return;let r=document.querySelector(t),s=r?z(r,{withInnerHTML:a,identifyChildren:l,withOuterHTML:i}):null;F(t8.sn.DOMQueryOneResult,{requestId:n,element:s})},E[22]=z,E[23]=F,E[24]=x):x=E[24];let V=x;E[25]!==z||E[26]!==R||E[27]!==F?(v=e=>{let{selector:t,observerId:n,withInnerHTML:a,identifyChildren:l,withOuterHTML:i}=e;if(P.current)return;T.current.set(n,new Set),_.current.set(n,{selector:t,withInnerHTML:a,withOuterHTML:i,identifyChildren:l,callback:ak});let r=document.querySelectorAll(t);if(r.length>0){var s;let e=Array.from(r).map(e=>(R(e),e)),t=e.map(e=>z(e,{withInnerHTML:a,identifyChildren:l,withOuterHTML:i})),o=T.current.get(n);t.forEach(e=>o.add(e.id)),null==(s=_.current.get(n))||s.callback(e),F(t8.sn.DOMObserveResult,{observerId:n,elements:t})}},E[25]=z,E[26]=R,E[27]=F,E[28]=v):v=E[28];let G=v;E[29]!==z||E[30]!==R||E[31]!==F?(g=e=>{let{selector:t,observerId:n,withInnerHTML:a,identifyChildren:l,withOuterHTML:i,margin:r}=e;if(P.current)return;if(O.current.has(n)){var s;null==(s=O.current.get(n))||s.disconnect(),O.current.delete(n)}T.current.set(n,new Set),_.current.set(n,{selector:t,withInnerHTML:a,withOuterHTML:i,identifyChildren:l,callback:aN});let o=document.querySelectorAll(t),c=new IntersectionObserver(e=>{let t=e.filter(aw).map(aj);if(t.length>0){var r;let e=t.map(e=>z(e,{withInnerHTML:a,withOuterHTML:i,identifyChildren:l})),s=T.current.get(n)||new Set;e.forEach(e=>s.add(e.id)),T.current.set(n,s),null==(r=_.current.get(n))||r.callback(t),F(t8.sn.DOMObserveResult,{observerId:n,elements:e})}},{root:null,rootMargin:r,threshold:.1});O.current.set(n,c),o.length>0&&o.forEach(e=>{R(e),c.observe(e)})},E[29]=z,E[30]=R,E[31]=F,E[32]=g):g=E[32];let H=g;E[33]===Symbol.for("react.memo_cache_sentinel")?(y=e=>{let{observerId:t}=e;_.current.delete(t),T.current.delete(t)},E[33]=y):y=E[33];let q=y;E[34]!==z||E[35]!==e||E[36]!==F?(b=t=>{let{tagName:n,requestId:a}=t;if(P.current)return;let l=document.createElement(n),i=av(e);l.id=i,I.current.set(l,i),L.current.add(i);let r=document.getElementById("plugin-dom-container");r||((r=document.createElement("div")).id="plugin-dom-container",r.style.display="none",document.body.appendChild(r)),r.appendChild(l),F(t8.sn.DOMCreateResult,{requestId:a,element:z(l)})},E[34]=z,E[35]=e,E[36]=F,E[37]=b):b=E[37];let W=b;E[38]!==z||E[39]!==F?(j=e=>{if(P.current)return;let{elementId:t,action:n,params:a,requestId:l}=e,i=document.getElementById(t);if(!i)return void F(t8.sn.DOMElementUpdated,{elementId:t,action:n,result:void 0,requestId:l});let r=null;switch(n){case"setAttribute":if(i instanceof HTMLElement&&a.name){let e=i.getAttribute(a.name);ab(i,"attribute",a.name,e)}i.setAttribute(a.name,a.value),r=!0;break;case"removeAttribute":if(i instanceof HTMLElement&&a.name){let e=i.getAttribute(a.name);ab(i,"attribute",a.name,e)}i.removeAttribute(a.name);break;case"setInnerHTML":i.innerHTML=a.html;break;case"setOuterHTML":i.outerHTML=a.html;case"appendChild":{let e=document.getElementById(a.childId);e&&i.appendChild(e);break}case"removeChild":{let e=document.getElementById(a.childId);e&&i.contains(e)&&i.removeChild(e);break}case"getText":r=i.textContent;break;case"setText":i instanceof HTMLElement&&ab(i,"text","textContent",i.textContent),i.textContent=a.text;break;case"getAttribute":r=i.getAttribute(a.name);break;case"getAttributes":r={};for(let e=0;e<i.attributes.length;e++){let t=i.attributes[e];r[t.name]=t.value}break;case"hasAttribute":r=i.hasAttribute(a.name);break;case"getProperty":r=i[a.name];break;case"setProperty":i instanceof HTMLElement&&a.name&&ab(i,"property",a.name,i[a.name]),i[a.name]=a.value;break;case"addClass":i.classList.add(...a.classNames);break;case"removeClass":i.classList.remove(...a.classNames);break;case"hasClass":r=i.classList.contains(a.className);break;case"setStyle":i instanceof HTMLElement&&a.property&&ab(i,"style",a.property,i.style.getPropertyValue(a.property)),i.style.setProperty(a.property,a.value);break;case"setCssText":i instanceof HTMLElement&&a.cssText&&ab(i,"style","cssText",i.style.cssText),i.style.cssText=a.cssText;break;case"getStyle":if(a.property)r=i.style.getPropertyValue(a.property);else{r={};for(let e=0;e<i.style.length;e++){let t=i.style[e];r[t]=i.style.getPropertyValue(t)}}break;case"getComputedStyle":r=window.getComputedStyle(i).getPropertyValue(a.property);break;case"append":{let e=document.getElementById(a.childId);e&&i.appendChild(e);break}case"before":{let e=document.getElementById(a.siblingId);e&&i.parentNode&&i.parentNode.insertBefore(e,i);break}case"after":{let e=document.getElementById(a.siblingId);e&&i.parentNode&&i.parentNode.insertBefore(e,i.nextSibling);break}case"remove":i.remove();break;case"getParent":r=i.parentElement?z(i.parentElement,{withInnerHTML:a.withInnerHTML,withOuterHTML:a.withOuterHTML,identifyChildren:a.identifyChildren}):null;break;case"getChildren":r=Array.from(i.children).map(e=>z(e,{withInnerHTML:a.withInnerHTML,withOuterHTML:a.withOuterHTML,identifyChildren:a.identifyChildren}));break;case"query":{let e=Array.from(i.querySelectorAll(a.selector)).map(e=>z(e,{withInnerHTML:a.withInnerHTML,identifyChildren:a.identifyChildren,withOuterHTML:a.withOuterHTML}));F(t8.sn.DOMQueryResult,{requestId:a.requestId,elements:e});return}case"queryOne":{let e=i.querySelector(a.selector);i.querySelectorAll(a.selector);let t=e?z(e,{withInnerHTML:a.withInnerHTML,identifyChildren:a.identifyChildren,withOuterHTML:a.withOuterHTML}):null;F(t8.sn.DOMQueryOneResult,{requestId:a.requestId,element:t});return}case"addEventListener":{let e=a.listenerId,n=a.event;A.current.set(e,{elementId:t,eventType:n,callback:e=>{let a=function(e){let t={type:e.type,bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed,timeStamp:e.timeStamp};return e instanceof MouseEvent&&(t.clientX=e.clientX,t.clientY=e.clientY,t.screenX=e.screenX,t.screenY=e.screenY,t.altKey=e.altKey,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.metaKey=e.metaKey,t.button=e.button,t.buttons=e.buttons),e instanceof KeyboardEvent&&(t.key=e.key,t.code=e.code,t.location=e.location,t.repeat=e.repeat,t.altKey=e.altKey,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.metaKey=e.metaKey),t}(e);F(t8.sn.DOMEventTriggered,{elementId:t,eventType:n,event:a})}}),i.addEventListener(n,A.current.get(e).callback);break}case"removeEventListener":{let e=a.listenerId,t=a.event,n=A.current.get(e);n&&(i.removeEventListener(t,n.callback),A.current.delete(e));break}case"getDataAttribute":i instanceof HTMLElement&&(r=i.dataset[a.key]);break;case"getDataAttributes":r=i instanceof HTMLElement?{...i.dataset}:{};break;case"setDataAttribute":i instanceof HTMLElement&&(a.key&&ab(i,"dataset",a.key,i.dataset[a.key]),i.dataset[a.key]=a.value);break;case"removeDataAttribute":i instanceof HTMLElement&&(a.key&&ab(i,"dataset",a.key,i.dataset[a.key]),delete i.dataset[a.key]);break;case"hasDataAttribute":r=i instanceof HTMLElement&&a.key in i.dataset;break;case"hasStyle":r=""!==i.style.getPropertyValue(a.property);break;case"removeStyle":i instanceof HTMLElement&&a.property&&ab(i,"style",a.property,i.style.getPropertyValue(a.property)),i.style.removeProperty(a.property);break;default:console.warn("Unknown DOM action: ".concat(n))}F(t8.sn.DOMElementUpdated,{elementId:t,action:n,result:r,requestId:l})},E[38]=z,E[39]=F,E[40]=j):j=E[40];let Q=j;E[41]!==e?(w=()=>{(0,eY.v)("DOMManager").info("Cleaning up DOMManager for extension",e),P.current=!0,M.current=!1,D.current&&(D.current.disconnect(),D.current=null),O.current.forEach(ay),O.current.clear(),A.current.forEach(ag),L.current.forEach(e=>{let t=document.getElementById(e);t&&(Array.from(A.current.values()).filter(t=>t.elementId===e).forEach(e=>{t.removeEventListener(e.eventType,e.callback)}),t.remove())}),_.current.clear(),A.current.clear(),T.current.clear(),L.current.clear(),I.current.clear();let t=document.getElementById("plugin-dom-container");t&&(!t.hasChildNodes()||0===t.children.length)&&t.remove()},E[41]=e,E[42]=w):w=E[42];let X=w;return E[43]!==X||E[44]!==e||E[45]!==K||E[46]!==U?(N=()=>((0,eY.v)("DOMManager").info("DOMManager hook initialized for extension",e),"complete"===document.readyState?U():window.addEventListener("load",U),K(),()=>{X(),M.current||window.removeEventListener("load",U)}),E[43]=X,E[44]=e,E[45]=K,E[46]=U,E[47]=N):N=E[47],E[48]!==e?(k=[e],E[48]=e,E[49]=k):k=E[49],(0,h.useEffect)(N,k),E[50]!==X||E[51]!==W||E[52]!==Q||E[53]!==G||E[54]!==H||E[55]!==B||E[56]!==V?(S={handleDOMQuery:B,handleDOMQueryOne:V,handleDOMObserve:G,handleDOMObserveInView:H,handleDOMStopObserve:q,handleDOMCreate:W,handleDOMManipulate:Q,cleanup:X},E[50]=X,E[51]=W,E[52]=Q,E[53]=G,E[54]=H,E[55]=B,E[56]=V,E[57]=S):S=E[57],S}(j);return b[0]!==T||b[1]!==j||b[2]!==w?(t={type:u.c.PLUGIN_UNLOADED,onMessage:e=>{e===j&&(T(),w())}},b[0]=T,b[1]=j,b[2]=w,b[3]=t):t=b[3],(0,r.oA)(t),b[4]!==N?(n=e=>{N(e)},b[4]=N,b[5]=n):n=b[5],b[6]!==j||b[7]!==n?(a={extensionId:j,type:t8.UH.DOMQuery,onMessage:n},b[6]=j,b[7]=n,b[8]=a):a=b[8],(0,r.hn)(a),b[9]!==k?(i=e=>{k(e)},b[9]=k,b[10]=i):i=b[10],b[11]!==j||b[12]!==i?(s={extensionId:j,type:t8.UH.DOMQueryOne,onMessage:i},b[11]=j,b[12]=i,b[13]=s):s=b[13],(0,r.hn)(s),b[14]!==S?(o=e=>{S(e)},b[14]=S,b[15]=o):o=b[15],b[16]!==j||b[17]!==o?(c={extensionId:j,type:t8.UH.DOMObserve,onMessage:o},b[16]=j,b[17]=o,b[18]=c):c=b[18],(0,r.hn)(c),b[19]!==E?(d=e=>{E(e)},b[19]=E,b[20]=d):d=b[20],b[21]!==j||b[22]!==d?(m={extensionId:j,type:t8.UH.DOMObserveInView,onMessage:d},b[21]=j,b[22]=d,b[23]=m):m=b[23],(0,r.hn)(m),b[24]!==C?(p=e=>{C(e)},b[24]=C,b[25]=p):p=b[25],b[26]!==j||b[27]!==p?(f={extensionId:j,type:t8.UH.DOMStopObserve,onMessage:p},b[26]=j,b[27]=p,b[28]=f):f=b[28],(0,r.hn)(f),b[29]!==I?(x=e=>{I(e)},b[29]=I,b[30]=x):x=b[30],b[31]!==j||b[32]!==x?(v={extensionId:j,type:t8.UH.DOMCreate,onMessage:x},b[31]=j,b[32]=x,b[33]=v):v=b[33],(0,r.hn)(v),b[34]!==_?(g=e=>{_(e)},b[34]=_,b[35]=g):g=b[35],b[36]!==j||b[37]!==g?(y={extensionId:j,type:t8.UH.DOMManipulate,onMessage:g},b[36]=j,b[37]=g,b[38]=y):y=b[38],(0,r.hn)(y),null}function aE(){let e,t,n,i,s,o,c,d,m,p,f=(0,l.c)(21),x=(0,A.useRouter)(),v=(0,A.usePathname)(),g=(0,A.useSearchParams)(),{sendScreenChangedEvent:y}=(0,t8.d8)(),{data:b}=(0,eG.nj)();f[0]===Symbol.for("react.memo_cache_sentinel")?(e=[],f[0]=e):e=f[0];let[j,w]=(0,h.useState)(e);return f[1]===Symbol.for("react.memo_cache_sentinel")?(t={type:u.c.PLUGIN_LOADED,onMessage:e=>{(0,h.startTransition)(()=>{w(t=>t.filter(t=>t!==e))})}},f[1]=t):t=f[1],(0,r.oA)(t),f[2]!==v||f[3]!==y?(n=()=>{y({pathname:v,query:window.location.search})},f[2]=v,f[3]=y,f[4]=n):n=f[4],f[5]!==v||f[6]!==g?(i=[v,g],f[5]=v,f[6]=g,f[7]=i):i=f[7],(0,h.useEffect)(n,i),f[8]!==v||f[9]!==y?(s=(e,t)=>{y({pathname:v,query:window.location.search},t)},f[8]=v,f[9]=y,f[10]=s):s=f[10],(0,t8.Zp)(s,""),f[11]!==x?(o=e=>{["/entry","/lists","/search","/manga","/settings","/auto-downloader","/debrid","/torrent-list","/schedule","/extensions","/sync","/discover","/scan-summaries"].some(t=>e.path.startsWith(t))&&x.push(e.path)},f[11]=x,f[12]=o):o=f[12],(0,t8.KD)(o,""),f[13]!==x?(c=e=>{x.refresh()},f[13]=x,f[14]=c):c=f[14],(0,t8.zO)(c,""),f[15]!==b||f[16]!==j?(d=null==b?void 0:b.filter(e=>"plugin"===e.type&&!j.includes(e.id)).map(e=>(0,a.jsx)(aS,{extensionId:e.id,onUnloaded:()=>w(t=>[...t,e.id])},e.id)),f[15]=b,f[16]=j,f[17]=d):d=f[17],f[18]===Symbol.for("react.memo_cache_sentinel")?(m=(0,a.jsx)(ah,{}),f[18]=m):m=f[18],f[19]!==d?(p=(0,a.jsxs)(a.Fragment,{children:[d,m]}),f[19]=d,f[20]=p):p=f[20],p}var aC=n(45886),aI=n(3196),a_=n(84218);let aT=(0,x.eU)(null),aA=(0,x.eU)(null),aD=(0,x.eU)(null,(e,t,n)=>{var a,l;let i=Date.now().toString(),r=e(aA),s=e(iq);t(aT,{id:i,message:n.message,timestamp:Date.now(),type:null!=(a=n.type)?a:"message"}),r&&clearTimeout(r);let o=setTimeout(()=>{t(aT,null),t(aA,null)},null!=(l=n.duration)?l:"icon"===n.type?200:s?1e3:500);t(aA,o)});function aP(){let e,t,n=(0,l.c)(18),[i]=(0,m.fp)(aT),r=(0,m.md)(iW);if(!i)return null;if("icon"===i.type){let e,t,l,s,o,c,d;return n[0]===Symbol.for("react.memo_cache_sentinel")?(e={opacity:.2,scale:1},t={opacity:.5,scale:1.6},l={opacity:1,scale:1},s={duration:.06,ease:"easeOut"},n[0]=e,n[1]=t,n[2]=l,n[3]=s):(e=n[0],t=n[1],l=n[2],s=n[3]),n[4]!==r||n[5]!==i.message?(o="PLAY"===i.message&&(0,a.jsx)(tl.IrE,{className:(0,f.cn)("size-24 text-white",r&&"size-10"),style:{textShadow:"0 1px 10px rgba(0, 0, 0, 0.8)"}}),n[4]=r,n[5]=i.message,n[6]=o):o=n[6],n[7]!==r||n[8]!==i.message?(c="PAUSE"===i.message&&(0,a.jsx)(tl.olp,{className:(0,f.cn)("size-24 text-white",r&&"size-10"),style:{textShadow:"0 1px 10px rgba(0, 0, 0, 0.8)"}}),n[7]=r,n[8]=i.message,n[9]=c):c=n[9],n[10]!==o||n[11]!==c?(d=(0,a.jsxs)(a_.P.div,{initial:e,animate:t,exit:l,transition:s,className:"absolute w-full h-full pointer-events-none flex z-[50] items-center justify-center",children:[o,c]}),n[10]=o,n[11]=c,n[12]=d):d=n[12],d}let s=r&&"text-sm";return n[13]!==s?(e=(0,f.cn)("text-white px-2 py-1 !text-xl font-semibold rounded-lg bg-black/50 backdrop-blur-sm tracking-wide",s),n[13]=s,n[14]=e):e=n[14],n[15]!==i.message||n[16]!==e?(t=(0,a.jsx)("div",{className:"absolute top-16 left-1/2 transform -translate-x-1/2 z-50 pointer-events-none",children:(0,a.jsx)("div",{className:e,children:i.message})}),n[15]=i.message,n[16]=e,n[17]=t):t=n[17],t}var aM=n(21842);let aL=(0,eY.v)("VIDEO CORE ANIME 4K"),aO=(0,aM.tG)("sea-video-core-anime4k","off",void 0,{getOnInit:!0}),aR=()=>{let e,t,n,a,i,r,s=(0,l.c)(19),o=(0,m.md)(iA),c=(0,m.md)(iK),d=(0,m.md)(iW),u=(0,m.md)(iz),p=(0,m.md)(i$),f=(0,m.md)(iq),x=(0,m.md)(i1),[v]=(0,m.fp)(aO);return s[0]!==x||s[1]!==o?(e=()=>{x&&x.updateCanvasSize(o)},t=[x,o],s[0]=x,s[1]=o,s[2]=e,s[3]=t):(e=s[2],t=s[3]),h.useEffect(e,t),s[4]!==d||s[5]!==u||s[6]!==x||s[7]!==c||s[8]!==v||s[9]!==p?(n=()=>{p&&x&&(aL.info("Setting Anime4K option",v),x.setOption(v,{isMiniPlayer:d,isPip:u,seeking:c}))},a=[p,x,v,d,u,c],s[4]=d,s[5]=u,s[6]=x,s[7]=c,s[8]=v,s[9]=p,s[10]=n,s[11]=a):(n=s[10],a=s[11]),h.useEffect(n,a),s[12]!==x||s[13]!==p?(i=()=>{p&&x&&x.reposition()},s[12]=x,s[13]=p,s[14]=i):i=s[14],s[15]!==x||s[16]!==f||s[17]!==p?(r=[f,x,p],s[15]=x,s[16]=f,s[17]=p,s[18]=r):r=s[18],h.useEffect(i,r),null},aF=[{value:"off",label:"Off",description:"Disabled",performance:"light"},{value:"mode-a",label:"Mode A",description:"Removes compression artifacts then upscales",performance:"light"},{value:"mode-b",label:"Mode B",description:"Gentle artifact removal then upscales",performance:"light"},{value:"mode-c",label:"Mode C",description:"Upscales with denoising then upscales again",performance:"light"},{value:"mode-aa",label:"Mode A+A",description:"Enhanced restoration for better quality",performance:"medium"},{value:"mode-bb",label:"Mode B+B",description:"Double soft restoration",performance:"medium"},{value:"mode-ca",label:"Mode C+A",description:"Denoising + restoration hybrid",performance:"medium"},{value:"cnn-2x-medium",label:"CNN 2x M",description:"Balanced speed and quality",performance:"medium"},{value:"cnn-2x-very-large",label:"CNN 2x VL",description:"High quality neural network",performance:"heavy"},{value:"denoise-cnn-2x-very-large",label:"Denoise CNN 2x VL",description:"Removes noise while upscaling",performance:"heavy"},{value:"cnn-2x-ultra-large",label:"CNN 2x UL",description:"Maximum CNN quality",performance:"heavy"},{value:"gan-3x-large",label:"GAN 3x L",description:"Generative adversarial network for perceptual quality",performance:"heavy"},{value:"gan-4x-ultra-large",label:"GAN 4x UL",description:"Maximum upscaling with GAN technology",performance:"heavy"}],aU=e=>aF.find(t=>t.value===e);var az=n(23909);let aK=(0,eY.v)("VIDEO CORE ANIME 4K MANAGER");class aB{updateCanvasSize(e){this._boxSize=e,this.canvas&&(this.canvas.width=e.width,this.canvas.height=e.height,this.canvas.style.top=this.videoElement.getBoundingClientRect().top+"px",aK.info("Updating canvas size",{width:e.width,height:e.height,top:this.videoElement.getBoundingClientRect().top}))}reposition(){this.canvas&&(this.canvas.style.top=this.videoElement.getBoundingClientRect().top+"px")}registerOnCanvasCreated(e){this._onCanvasCreatedCallbacks.add(e)}registerOnCanvasCreatedOnce(e){this._onCanvasCreatedCallbacksOnce.add(e)}async setOption(e,t){let n=this._currentOption;if(this._currentOption=e,"off"===e)return void this.destroy();if(t){if(t.isMiniPlayer||t.isPip){aK.info("Destroying canvas due to PIP/mini player mode"),this.destroy();return}if(t.seeking)return void this._hideCanvas()}if(0!==this._boxSize.width&&0!==this._boxSize.height){if(this.canvas&&this._isCanvasHidden()){aK.info("Showing previously hidden canvas"),this._showCanvas();return}if(n!==e||!this.canvas){aK.info("Change detected, reinitializing canvas"),this.destroy();try{await this._initialize()}catch(e){aK.error("Failed to initialize Anime4K",e),this._handleError(e instanceof Error?e.message:"Unknown error")}}}}destroy(){var e;this._initialized=!1,this._initializationTimeout&&(clearTimeout(this._initializationTimeout),this._initializationTimeout=null),this.canvas&&(this.canvas.remove(),this.canvas=null),this._renderLoopId&&(cancelAnimationFrame(this._renderLoopId),this._renderLoopId=null),(null==(e=this._webgpuResources)?void 0:e.device)&&(this._webgpuResources.device.destroy(),this._webgpuResources=null),this._abortController&&(this._abortController.abort(),this._abortController=null),this._frameDropState.frameDropCount=0,this._frameDropState.lastFrameTime=0}async _initialize(){if(!this._initialized&&"off"!==this._currentOption){aK.info("Initializing Anime4K",this._currentOption),this._abortController=new AbortController,this._frameDropState={...this._frameDropState,frameDropCount:0,initTime:performance.now(),lastFrameTime:0};try{if(!await this.getGPUInfo())throw Error("WebGPU not supported");if(this._abortController.signal.aborted||(this._createCanvas(),this._abortController.signal.aborted))return;await this._startRendering(),this._initialized=!0,aK.info("Anime4K initialized")}catch(t){var e;if(!(null==(e=this._abortController)?void 0:e.signal.aborted))throw aK.error("Initialization failed",t),t}}}_createCanvas(){var e,t;null!=(e=this._abortController)&&e.signal.aborted||(this.canvas=document.createElement("canvas"),this.canvas.width=this._boxSize.width,this.canvas.height=this._boxSize.height,this.canvas.style.objectFit="cover",this.canvas.style.position="absolute",this.canvas.style.top=this.videoElement.getBoundingClientRect().top+"px",this.canvas.style.left="0",this.canvas.style.right="0",this.canvas.style.pointerEvents="none",this.canvas.style.zIndex="2",this.canvas.style.display="block",this.canvas.className="vc-anime4k-canvas",aK.info("Creating canvas",{width:this.canvas.width,height:this.canvas.height,top:this.canvas.style.top}),null==(t=this.videoElement.parentElement)||t.appendChild(this.canvas))}async _startRendering(){if(!this.canvas||!this.videoElement||"off"===this._currentOption)return void console.warn("stopped started");let e={width:this.videoElement.videoWidth,height:this.videoElement.videoHeight},t={width:this.canvas.width,height:this.canvas.height};aK.info("Rendering started"),await (0,az.render)({video:this.videoElement,canvas:this.canvas,pipelineBuilder:(n,a)=>(this._webgpuResources={device:n},this.createPipeline({device:n,inputTexture:a,nativeDimensions:e,targetDimensions:t}))}),setTimeout(()=>{if(this.canvas){for(let e of this._onCanvasCreatedCallbacks)e(this.canvas);for(let e of this._onCanvasCreatedCallbacksOnce)e(this.canvas);this._onCanvasCreatedCallbacksOnce.clear()}},100),this._frameDropState.enabled&&this._isOptionSelected(this._currentOption)&&this._startFrameDropDetection()}createPipeline(e){switch(this._currentOption){case"mode-a":default:return[new az.ModeA(e)];case"mode-b":return[new az.ModeB(e)];case"mode-c":return[new az.ModeC(e)];case"mode-aa":return[new az.ModeAA(e)];case"mode-bb":return[new az.ModeBB(e)];case"mode-ca":return[new az.ModeCA(e)];case"cnn-2x-medium":return[new az.CNNx2M(e)];case"cnn-2x-very-large":return[new az.CNNx2VL(e)];case"denoise-cnn-2x-very-large":return[new az.DenoiseCNNx2VL(e)];case"cnn-2x-ultra-large":return[new az.CNNx2UL(e)];case"gan-3x-large":return[new az.GANx3L(e)];case"gan-4x-ultra-large":return[new az.GANx4UUL(e)]}}_startFrameDropDetection(){let e=()=>{this._isOptionSelected(this._currentOption)&&null!==this._renderLoopId&&(this._detectFrameDrops(),this._renderLoopId=requestAnimationFrame(e))};this._renderLoopId=requestAnimationFrame(e)}_detectFrameDrops(){if(!this._isOptionSelected(this._currentOption))return;let e=performance.now();if(e-this._frameDropState.initTime<this._frameDropState.performanceGracePeriod){this._frameDropState.lastFrameTime=e;return}if(this._frameDropState.lastFrameTime>0)if(e-this._frameDropState.lastFrameTime>1.5*this._frameDropState.targetFrameTime){if(this._frameDropState.frameDropCount++,this._frameDropState.frameDropCount>=this._frameDropState.frameDropThreshold){aK.warning("Detected ".concat(this._frameDropState.frameDropCount," consecutive frame drops. Falling back to 'off' mode.")),this._handlePerformanceFallback();return}}else this._frameDropState.frameDropCount=0;this._frameDropState.lastFrameTime=e}_handlePerformanceFallback(){var e,t;null==(e=this._onFallback)||e.call(this,"Performance degraded. Turning off Anime4K."),this.setOption("off"),null==(t=this._onOptionChanged)||t.call(this,"off")}_handleError(e){var t,n;null==(t=this._onFallback)||t.call(this,"Anime4K: ".concat(e)),this.setOption("off"),null==(n=this._onOptionChanged)||n.call(this,"off")}async getGPUInfo(){if(!navigator.gpu)return null;try{let e=await navigator.gpu.requestAdapter();if(!e)return null;let t=await e.requestDevice();if(!t)return null;let n=e.info||{};return{gpu:n.vendor||n.architecture||"Unknown GPU",vendor:n.vendor||"Unknown",device:t}}catch(e){return null}}_isOptionSelected(e){return"off"!==e}_hideCanvas(){this.canvas&&(this.canvas.style.display="none")}_showCanvas(){this.canvas&&(this.canvas.style.display="block")}_isCanvasHidden(){return!!this.canvas&&"none"===this.canvas.style.display}constructor({videoElement:e,settings:t,onFallback:n,onOptionChanged:a}){this.canvas=null,this._currentOption="off",this._webgpuResources=null,this._renderLoopId=null,this._abortController=null,this._frameDropState={enabled:!0,frameDropThreshold:5,frameDropCount:0,lastFrameTime:0,targetFrameTime:62.5,performanceGracePeriod:1e3,initTime:0},this._boxSize={width:0,height:0},this._initializationTimeout=null,this._initialized=!1,this._onCanvasCreatedCallbacks=new Set,this._onCanvasCreatedCallbacksOnce=new Set,this.videoElement=e,this.settings=t,this._onFallback=n,this._onOptionChanged=a,aK.info("Anime4K manager initialized")}}let aV=(0,eY.v)("AUDIO");class aG{_selectDefaultTrack(){var e,t,n;let a=null==(n=this.playbackInfo.mkvMetadata)||null==(t=n.audioTracks)||null==(e=t.filter)?void 0:e.call(t,e=>(e.language||"eng")===this.settings.preferredAudioLanguage);if(null==a?void 0:a.length){let e=a.findIndex(e=>e.forced);this.selectTrack(a[e>=0?e:0].number)}}selectTrackByLabel(e){var t,n,a;let l=null==(a=this.playbackInfo.mkvMetadata)||null==(n=a.audioTracks)||null==(t=n.find)?void 0:t.call(n,t=>t.name===e);l?this.selectTrack(l.number):aV.error("Audio track not found",e)}selectTrack(e){if(!this.videoElement.audioTracks)return;let t=!1;for(let n=0;n<this.videoElement.audioTracks.length;n++){let a=this.videoElement.audioTracks[n].id===e.toString();this.videoElement.audioTracks[n].enabled!==a&&(this.videoElement.audioTracks[n].enabled=a,t=!0)}t&&this.videoElement.audioTracks.dispatchEvent&&this.videoElement.audioTracks.dispatchEvent(new Event("change"))}getSelectedTrack(){if(!this.videoElement.audioTracks)return null;for(let e=0;e<this.videoElement.audioTracks.length;e++)if(this.videoElement.audioTracks[e].enabled)return Number(this.videoElement.audioTracks[e].id);return null}constructor({videoElement:e,settings:t,playbackInfo:n,onError:a}){if(this.videoElement=e,this.settings=t,this.playbackInfo=n,this.onError=a,this.videoElement.audioTracks){if(this.videoElement.audioTracks.length<=0)return void this.onError("The video element does not support the media's audio codec. Please try another media.");aV.info("Audio tracks",this.videoElement.audioTracks)}this._selectDefaultTrack()}}var aH=n(46383);let aq=(0,eY.v)("VIDEO CORE FULLSCREEN"),aW=(0,x.eU)(null);class aQ{setContainer(e){this.containerElement=e}isFullscreen(){return!!this.isElectron()&&!!this.isElectronNativeFullscreen||!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}async toggleFullscreen(){this.isFullscreen()?await this.exitFullscreen():await this.enterFullscreen()}async exitFullscreen(){try{if(this.isElectron()&&this.shouldUseElectronFullscreen())return void await this.exitElectronFullscreen();document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.mozCancelFullScreen?await document.mozCancelFullScreen():document.msExitFullscreen&&await document.msExitFullscreen(),aq.info("Exited fullscreen")}catch(e){aq.error("Failed to exit fullscreen",e)}}async enterFullscreen(){if(!this.containerElement)return void aq.warning("Container element not set");try{if(this.isElectron()&&this.shouldUseElectronFullscreen())return void await this.enterElectronFullscreen();this.containerElement.requestFullscreen?await this.containerElement.requestFullscreen():this.containerElement.webkitRequestFullscreen?await this.containerElement.webkitRequestFullscreen():this.containerElement.mozRequestFullScreen?await this.containerElement.mozRequestFullScreen():this.containerElement.msRequestFullscreen&&await this.containerElement.msRequestFullscreen(),aq.info("Entered fullscreen")}catch(e){aq.error("Failed to enter fullscreen",e)}}destroy(){this.controller.abort(),this.containerElement=null}isElectron(){var e;return!!(null==(e=window)?void 0:e.electron)}shouldUseElectronFullscreen(){return this.isElectron()}async enterElectronFullscreen(){var e,t,n;if(!(null==(n=window)||null==(t=n.electron)||null==(e=t.window)?void 0:e.setFullscreen))return void aq.warning("Electron fullscreen API not available");try{await window.electron.window.setFullscreen(!0),this.isElectronNativeFullscreen=!0,aq.info("Entered Electron native fullscreen")}catch(e){aq.error("Failed to enter Electron fullscreen",e)}}async exitElectronFullscreen(){var e,t,n,a;if(!(null==(t=window.electron)||null==(e=t.window)?void 0:e.setFullscreen))return void aq.warning("Electron fullscreen API not available");try{await (null==(a=window.electron)||null==(n=a.window)?void 0:n.setFullscreen(!1)),this.isElectronNativeFullscreen=!1,aq.info("Exited Electron native fullscreen")}catch(e){aq.error("Failed to exit Electron fullscreen",e)}}attachElectronListeners(){var e,t;if(!this.isElectron())return;let n=null==(t=window.electron)||null==(e=t.on)?void 0:e.call(t,"window:fullscreen",e=>{this.isElectronNativeFullscreen=e,aq.info("Electron fullscreen state changed:",e),this.onFullscreenChange(e)});if(n){let e=this.controller.abort.bind(this.controller);this.controller.abort=()=>{n(),e()}}}attachDocumentListeners(){document.addEventListener("fullscreenchange",this.handleFullscreenChange,{signal:this.controller.signal}),document.addEventListener("webkitfullscreenchange",this.handleFullscreenChange,{signal:this.controller.signal}),document.addEventListener("mozfullscreenchange",this.handleFullscreenChange,{signal:this.controller.signal}),document.addEventListener("msfullscreenchange",this.handleFullscreenChange,{signal:this.controller.signal})}constructor(e){this.containerElement=null,this.controller=new AbortController,this.isElectronNativeFullscreen=!1,this.handleFullscreenChange=()=>{let e=this.isFullscreen();aq.info("Fullscreen state changed:",e),this.onFullscreenChange(e)},this.onFullscreenChange=e,this.attachDocumentListeners(),this.attachElectronListeners()}}let aX=(0,aM.tG)("sea-video-core-settings",{preferredSubtitleLanguage:"eng",preferredAudioLanguage:"jpn",videoEnhancement:{enabled:!0,contrast:1.05,saturation:1.1,brightness:1.02}},void 0,{getOnInit:!0}),a$={seekForward:{key:"KeyD",value:30},seekBackward:{key:"KeyA",value:30},seekForwardFine:{key:"ArrowRight",value:2},seekBackwardFine:{key:"ArrowLeft",value:2},nextChapter:{key:"KeyE"},previousChapter:{key:"KeyQ"},volumeUp:{key:"ArrowUp",value:5},volumeDown:{key:"ArrowDown",value:5},mute:{key:"KeyM"},cycleSubtitles:{key:"KeyJ"},cycleAudio:{key:"KeyK"},nextEpisode:{key:"KeyN"},previousEpisode:{key:"KeyB"},fullscreen:{key:"KeyF"},pictureInPicture:{key:"KeyP"},increaseSpeed:{key:"BracketRight",value:.1},decreaseSpeed:{key:"BracketLeft",value:.1},takeScreenshot:{key:"KeyI"}},aY=(0,aM.tG)("sea-video-core-keybindings",a$,void 0,{getOnInit:!0}),aZ=(0,aM.tG)("sea-video-core-chapter-markers",!0,void 0,{getOnInit:!0}),aJ=(0,aM.tG)("sea-video-core-highlight-op-ed-chapters",!0,void 0,{getOnInit:!0}),a0=(0,aM.tG)("sea-video-core-increase-saturation",!1,void 0,{getOnInit:!0}),a1=(0,aM.tG)("sea-video-core-auto-next",!0,void 0,{getOnInit:!0}),a2=(0,aM.tG)("sea-video-core-auto-play",!0,void 0,{getOnInit:!0}),a3=(0,aM.tG)("sea-video-core-auto-skip-op-ed",!1,void 0,{getOnInit:!0}),a4=(0,aM.tG)("sea-video-core-volume",1,void 0,{getOnInit:!0}),a5=(0,aM.tG)("sea-video-core-muted",!1,void 0,{getOnInit:!0}),a6=(0,aM.tG)("sea-video-core-playback-rate",1,void 0,{getOnInit:!0});var a8=n(76136);let a7=(0,x.eU)(!1),a9=h.memo(e=>{let t,n=(0,l.c)(4),{actionKey:i,value:r,onValueChange:s}=e,o=i.includes("Speed")?.25:1;return n[0]!==s||n[1]!==o||n[2]!==r?(t=(0,a.jsx)(a8.Q,{value:r,onValueChange:s,size:"sm",fieldClass:"w-16",hideControls:!0,min:0,step:o,onKeyDown:ln,onInput:la}),n[0]=s,n[1]=o,n[2]=r,n[3]=t):t=n[3],t});function le(){let e,t,n,i,r,s,o,c,d,u,p,x,v,g,y,b=(0,l.c)(36),[j,w]=(0,m.fp)(a7),[k,S]=(0,m.fp)(aY),[E,C]=(0,h.useState)(k),[I,_]=(0,h.useState)(null);b[0]!==k||b[1]!==j?(e=()=>{j&&C(k)},t=[j,k],b[0]=k,b[1]=j,b[2]=e,b[3]=t):(e=b[2],t=b[3]),(0,h.useEffect)(e,t),b[4]===Symbol.for("react.memo_cache_sentinel")?(n=e=>{_(e);let t=n=>{n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation(),C(t=>({...t,[e]:{...t[e],key:n.code}})),_(null),document.removeEventListener("keydown",t,!0)};document.addEventListener("keydown",t,!0)},b[4]=n):n=b[4];let T=n;b[5]!==E||b[6]!==S||b[7]!==w?(i=()=>{S(E),w(!1)},b[5]=E,b[6]=S,b[7]=w,b[8]=i):i=b[8];let A=i;b[9]===Symbol.for("react.memo_cache_sentinel")?(r=()=>{C(a$)},b[9]=r):r=b[9];let D=r;b[10]!==E||b[11]!==I?(s=e=>{var t,n;let{action:l,actionKey:i,hasValue:r,valueLabel:s}=e;return(0,a.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-border/50 last:border-b-0",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:l}),void 0!==r&&r&&(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:[void 0===s?"":s,":"]}),(0,a.jsx)(a9,{actionKey:i,value:"value"in E[i]?E[i].value:0,onValueChange:e=>C(t=>({...t,[i]:{...t[i],value:e||0}}))})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(N.$n,{intent:I===i?"white-subtle":"gray-outline",size:"sm",onClick:()=>T(i),className:(0,f.cn)("h-8 px-3 text-lg font-mono",I===i&&"!text-xs text-white"),children:I===i?"Press key...":function(e){return({KeyA:"A",KeyB:"B",KeyC:"C",KeyD:"D",KeyE:"E",KeyF:"F",KeyG:"G",KeyH:"H",KeyI:"I",KeyJ:"J",KeyK:"K",KeyL:"L",KeyM:"M",KeyN:"N",KeyO:"O",KeyP:"P",KeyQ:"Q",KeyR:"R",KeyS:"S",KeyT:"T",KeyU:"U",KeyV:"V",KeyW:"W",KeyX:"X",KeyY:"Y",KeyZ:"Z",ArrowUp:"↑",ArrowDown:"↓",ArrowLeft:"←",ArrowRight:"→",BracketLeft:"[",BracketRight:"]",Space:"⎵"})[e]||e}(null!=(n=null==E||null==(t=E[i])?void 0:t.key)?n:"")})})]})},b[10]=E,b[11]=I,b[12]=s):s=b[12];let P=s;return b[13]!==P?(o=(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"space-y-0",children:[(0,a.jsx)(P,{action:"Seek Forward",description:"Seek forward",actionKey:"seekForward",hasValue:!0,valueLabel:"Seconds"}),(0,a.jsx)(P,{action:"Seek Backward",description:"Seek backward",actionKey:"seekBackward",hasValue:!0,valueLabel:"Seconds"}),(0,a.jsx)(P,{action:"Seek Forward (Fine)",description:"Seek forward (fine)",actionKey:"seekForwardFine",hasValue:!0,valueLabel:"Seconds"}),(0,a.jsx)(P,{action:"Seek Backward (Fine)",description:"Seek backward (fine)",actionKey:"seekBackwardFine",hasValue:!0,valueLabel:"Seconds"}),(0,a.jsx)(P,{action:"Increase Speed",description:"Increase playback speed",actionKey:"increaseSpeed",hasValue:!0,valueLabel:"increment"}),(0,a.jsx)(P,{action:"Decrease Speed",description:"Decrease playback speed",actionKey:"decreaseSpeed",hasValue:!0,valueLabel:"increment"})]})}),b[13]=P,b[14]=o):o=b[14],b[15]!==P?(c=(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"space-y-0",children:[(0,a.jsx)(P,{action:"Next Chapter",description:"Skip to next chapter",actionKey:"nextChapter"}),(0,a.jsx)(P,{action:"Previous Chapter",description:"Skip to previous chapter",actionKey:"previousChapter"}),(0,a.jsx)(P,{action:"Next Episode",description:"Play next episode",actionKey:"nextEpisode"}),(0,a.jsx)(P,{action:"Previous Episode",description:"Play previous episode",actionKey:"previousEpisode"}),(0,a.jsx)(P,{action:"Cycle Subtitles",description:"Cycle through subtitle tracks",actionKey:"cycleSubtitles"}),(0,a.jsx)(P,{action:"Fullscreen",description:"Toggle fullscreen",actionKey:"fullscreen"}),(0,a.jsx)(P,{action:"Picture in Picture",description:"Toggle picture in picture",actionKey:"pictureInPicture"}),(0,a.jsx)(P,{action:"Take Screenshot",description:"Take screenshot",actionKey:"takeScreenshot"})]})}),b[15]=P,b[16]=c):c=b[16],b[17]!==P?(d=(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"space-y-0",children:[(0,a.jsx)(P,{action:"Volume Up",description:"Increase volume",actionKey:"volumeUp",hasValue:!0,valueLabel:"Percent"}),(0,a.jsx)(P,{action:"Volume Down",description:"Decrease volume",actionKey:"volumeDown",hasValue:!0,valueLabel:"Percent"}),(0,a.jsx)(P,{action:"Mute",description:"Toggle mute",actionKey:"mute"}),(0,a.jsx)(P,{action:"Cycle Audio",description:"Cycle through audio tracks",actionKey:"cycleAudio"})]})}),b[17]=P,b[18]=d):d=b[18],b[19]!==o||b[20]!==c||b[21]!==d?(u=(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-8",children:[o,c,d]}),b[19]=o,b[20]=c,b[21]=d,b[22]=u):u=b[22],b[23]===Symbol.for("react.memo_cache_sentinel")?(p=(0,a.jsx)(N.$n,{intent:"gray-outline",onClick:D,children:"Reset to Defaults"}),b[23]=p):p=b[23],b[24]!==w?(x=(0,a.jsx)(N.$n,{intent:"gray-outline",onClick:()=>w(!1),children:"Cancel"}),b[24]=w,b[25]=x):x=b[25],b[26]!==A?(v=(0,a.jsx)(N.$n,{intent:"primary",onClick:A,children:"Save Changes"}),b[26]=A,b[27]=v):v=b[27],b[28]!==x||b[29]!==v?(g=(0,a.jsxs)("div",{className:"flex items-center justify-between pt-6 mt-6 border-t border-border",children:[p,(0,a.jsxs)("div",{className:"flex gap-2",children:[x,v]})]}),b[28]=x,b[29]=v,b[30]=g):g=b[30],b[31]!==j||b[32]!==w||b[33]!==g||b[34]!==u?(y=(0,a.jsxs)(eh.a,{title:"Keyboard Shortcuts",description:"Customize the keyboard shortcuts for the player",open:j,onOpenChange:w,contentClass:"max-w-5xl focus:outline-none focus-visible:outline-none outline-none bg-black/80 backdrop-blur-sm z-[101]",children:[u,g]}),b[31]=j,b[32]=w,b[33]=g,b[34]=u,b[35]=y):y=b[35],y}function lt(e){let{active:t,videoRef:n,chapterCues:a,introEndTime:i,introStartTime:r,endingEndTime:s,endingStartTime:o}=e,[c]=(0,m.fp)(aY),d=(0,m.md)(a7),u=(0,m.md)(iU),p=(0,m.md)(iz),f=(0,m.md)(iF),x=(0,m.Xr)(a4),v=(0,m.md)(iR),g=(0,m.Xr)(a5),{flashAction:y}=function(){let e,t=(0,l.c)(2),[,n]=(0,m.fp)(aD);return t[0]!==n?(e={flashAction:n},t[0]=n,t[1]=e):e=t[1],e}(),b=(0,m.Xr)(i6),j=(0,m.md)(iZ),w=(0,m.md)(iJ),N=(0,m.md)(aW),k=(0,h.useRef)(0);function S(e){var t,a,l;let i=null==(t=n.current)?void 0:t.paused;i||null==(a=n.current)||a.pause(),b({type:"seek",payload:{time:e,flashTime:!0}}),i||null==(l=n.current)||l.play()}function E(e){var t,a,l;let i=null==(t=n.current)?void 0:t.paused;i||null==(a=n.current)||a.pause(),b({type:"seekTo",payload:{time:e,flashTime:!0}}),i||null==(l=n.current)||l.play()}let{takeScreenshot:C}=function(){let e=(0,m.md)(i$),t=(0,m.md)(iZ),n=(0,m.Xr)(aD),a=(0,m.md)(i1),l=(0,m.md)(aO),i=h.useRef(null);async function r(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],await navigator.clipboard.write([new ClipboardItem({[e.type]:e})]),n({message:"Screenshot saved to clipboard",type:"message"})}async function s(e){let n=null==t?void 0:t.libassRenderer;if(!n)return;let a=e.getContext("2d");if(a)return new Promise(t=>{n.resize(e.width,e.height),i.current=setTimeout(()=>{a.drawImage(n._canvas,0,0,e.width,e.height),n.resize(0,0,0,0),t()},300)})}async function o(e){return new Promise(async t=>{if(e instanceof HTMLCanvasElement)e.toBlob(t,"image/png");else{let n=document.createElement("canvas"),a=n.getContext("2d");if(!a)return t(null);n.width=e.videoWidth,n.height=e.videoHeight,a.drawImage(e,0,0),await s(n),n.toBlob(e=>{n.remove(),t(e)})}})}async function c(e){return new Promise(t=>{let n=new Image;n.onload=async()=>{let e=document.createElement("canvas"),a=e.getContext("2d");if(!a)return t(null);e.width=n.width,e.height=n.height,a.drawImage(n,0,0),await s(e),e.toBlob(a=>{e.remove(),URL.revokeObjectURL(n.src),t(a)})},n.src=URL.createObjectURL(e)})}return{takeScreenshot:async function(){if(i.current&&clearTimeout(i.current),!e)return;let s=e.paused;e.pause(),n({message:"Taking screenshot..."});try{let n=null,i=!1;if("off"!==l&&(null==a?void 0:a.canvas)){let e=await o(a.canvas);e&&(n=(null==t?void 0:t.libassRenderer)?await c(e):e,i=!0)}n||(n=await o(e)),n&&await r(n,i)}catch(e){console.error("Screenshot failed:",e),n({message:"Screenshot failed"})}finally{s||e.play()}}}}(),I=(0,h.useCallback)(async a=>{if(d||a.target instanceof HTMLInputElement||a.target instanceof HTMLTextAreaElement||!n.current||!t)return;let l=n.current;if("Space"===a.code||"Enter"===a.code){a.preventDefault(),l.paused?(await l.play(),y({message:"PLAY",type:"icon"})):(l.pause(),y({message:"PAUSE",type:"icon"}));return}if("Home"===a.code){a.preventDefault(),E(0),y({message:"Beginning"});return}if("End"===a.code){a.preventDefault(),E(l.duration),y({message:"End"});return}if("Escape"===a.code&&u){a.preventDefault(),document.exitFullscreen();return}if(a.code.startsWith("Digit")&&6===a.code.length){a.preventDefault();let e=parseInt(a.code.slice(-1));E(Math.max(0,Math.min(l.duration,l.duration*(10*e)/100)));return}if("Comma"===a.code){a.preventDefault(),S(-1/24),y({message:"Previous Frame"});return}if("Period"===a.code){a.preventDefault(),S(1/24),y({message:"Next Frame"});return}let i=()=>{let e=Date.now();return!(e-k.current<100)&&(k.current=e,!0)};if(a.code===c.seekForward.key){if(a.preventDefault(),!i())return;if(e.introEndTime&&e.introStartTime&&l.currentTime<e.introEndTime&&l.currentTime>=e.introStartTime){E(e.introEndTime),y({message:"Skipped Opening"});return}if(e.endingEndTime&&e.endingStartTime&&l.currentTime<e.endingEndTime&&l.currentTime>=e.endingStartTime){E(e.endingEndTime),y({message:"Skipped Ending"});return}S(c.seekForward.value),l.dispatchEvent(new Event("seeked"))}else if(a.code===c.seekBackward.key){if(a.preventDefault(),!i())return;S(-c.seekBackward.value),l.dispatchEvent(new Event("seeked"))}else if(a.code===c.seekForwardFine.key)a.preventDefault(),l.dispatchEvent(new Event("seeking")),S(c.seekForwardFine.value),l.dispatchEvent(new Event("seeked"));else if(a.code===c.seekBackwardFine.key)a.preventDefault(),l.dispatchEvent(new Event("seeking")),S(-c.seekBackwardFine.value),l.dispatchEvent(new Event("seeked"));else if(a.code===c.nextChapter.key)a.preventDefault(),_();else if(a.code===c.previousChapter.key)a.preventDefault(),T();else if(a.code===c.volumeUp.key)a.preventDefault(),x(Math.min(1,f+c.volumeUp.value/100));else if(a.code===c.volumeDown.key)a.preventDefault(),x(Math.max(0,f-c.volumeDown.value/100));else if(a.code===c.mute.key)a.preventDefault(),g(!v);else if(a.code===c.cycleSubtitles.key)a.preventDefault(),A();else if(a.code===c.cycleAudio.key)a.preventDefault(),D();else if(a.code===c.nextEpisode.key)a.preventDefault(),M();else if(a.code===c.previousEpisode.key)a.preventDefault(),L();else if(a.code===c.fullscreen.key)a.preventDefault(),O();else if(a.code===c.pictureInPicture.key)a.preventDefault(),R();else if(a.code===c.increaseSpeed.key){a.preventDefault();let e=Math.min(8,l.playbackRate+c.increaseSpeed.value);l.playbackRate=e,y({message:"Speed: ".concat(e.toFixed(2),"x")})}else if(a.code===c.decreaseSpeed.key){a.preventDefault();let e=Math.max(.2,l.playbackRate-c.decreaseSpeed.value);l.playbackRate=e,y({message:"Speed: ".concat(e.toFixed(2),"x")})}else a.code===c.takeScreenshot.key&&(a.preventDefault(),C())},[c,f,v,S,t,u,p,y,i,r,d]),_=(0,h.useCallback)(()=>{if(!n.current||!a)return;let e=n.current.currentTime,t=[...a].sort((e,t)=>e.startTime-t.startTime),l=t.find(t=>t.startTime>e+1);if(l){E(l.startTime);let e=l.text;y({message:e?"Chapter: ".concat(e):"Chapter ".concat(t.indexOf(l)+1)})}else{let e=t[t.length-1];e&&e.endTime&&(E(e.endTime),y({message:"End of chapters"}))}},[a,E,y]),T=(0,h.useCallback)(()=>{if(!n.current||!a)return;let e=n.current.currentTime,t=[...a].sort((e,t)=>e.startTime-t.startTime),l=t.findIndex((n,a)=>{let l=t[a+1];return n.startTime<=e&&(!l||e<l.startTime)});if(l>0){let e=t[l-1];E(e.startTime);let n=e.text;y({message:n?"Chapter: ".concat(n):"Chapter ".concat(l)})}else if(0===l){E(0);let e=t[0].text;y({message:e?"Chapter: ".concat(e):"Chapter 1"})}else E(0),y({message:"Beginning"})},[a,E,y]),A=(0,h.useCallback)(()=>{if(!n.current)return;let e=Array.from(n.current.textTracks).filter(e=>"subtitles"===e.kind);if(0===e.length)return void y({message:"No subtitle tracks"});let t=-1;for(let n=0;n<e.length;n++)if("showing"===e[n].mode){t=n;break}let a=t+1;for(let t=0;t<e.length;t++)e[t].mode="disabled";if(a<e.length){e[a].mode="showing",null==j||j.selectTrack(Number(e[a].id));let t=e[a].label||"Track ".concat(a+1);y({message:"Subtitles: ".concat(t)})}else null==j||j.setNoTrack(),y({message:"Subtitles: Off"})},[j]),D=(0,h.useCallback)(()=>{if(!n.current)return;let e=n.current.audioTracks;if(!e||e.length<=1)return void y({message:"No additional audio tracks"});let t=-1;for(let n=0;n<e.length;n++)if(e[n].enabled){t=n;break}let a=(t+1)%e.length;for(let t=0;t<e.length;t++)e[t].enabled=!1;e[a].enabled=!0,null==w||w.selectTrack(a);let l=e[a].label||e[a].language||"Track ".concat(a+1);y({message:"Audio: ".concat(l)})},[]),P=(0,eY.v)("VideoCoreKeybindings"),M=(0,h.useCallback)(()=>{P.info("Next episode shortcut pressed - not implemented yet")},[]),L=(0,h.useCallback)(()=>{P.info("Previous episode shortcut pressed - not implemented yet")},[]),O=(0,h.useCallback)(()=>{null==N||N.toggleFullscreen(),h.startTransition(()=>{setTimeout(()=>{var e;null==(e=n.current)||e.focus()},100)})},[N]),R=(0,h.useCallback)(()=>{h.startTransition(()=>{setTimeout(()=>{var e;null==(e=n.current)||e.focus()},100)})},[p]);return(0,h.useEffect)(()=>{if(t)return document.addEventListener("keydown",I),()=>{document.removeEventListener("keydown",I)}},[I,t]),(0,h.useEffect)(()=>{if(!t)return;let e=()=>{setTimeout(()=>{document.fullscreenElement&&n.current&&n.current.focus()},100)};return document.addEventListener("fullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e)}},[t]),null}function ln(e){return e.stopPropagation()}function la(e){return e.stopPropagation()}let ll=(0,x.eU)(null),li=(0,x.eU)(null);function lr(e){let t,n,i,r,s,o,c=(0,l.c)(18),{trigger:d,children:u,name:p}=e,[f,x]=(0,m.fp)(ll),[,v]=(0,m.fp)(li),g=(0,m.md)(iU),y=(0,m.md)(iY),b=(0,h.useRef)(null);c[0]!==f||c[1]!==v?(t=()=>(f||(b.current=setTimeout(()=>{v(null)},300)),()=>{b.current&&clearTimeout(b.current)}),c[0]=f,c[1]=v,c[2]=t):t=c[2],c[3]!==f?(n=[f],c[3]=f,c[4]=n):n=c[4],h.useEffect(t,n);let j=f===p;c[5]!==p||c[6]!==x?(i=e=>{x(e?p:null)},c[5]=p,c[6]=x,c[7]=i):i=c[7],c[8]!==d?(r=(0,a.jsx)("div",{children:d}),c[8]=d,c[9]=r):r=c[9];let w=g&&y||void 0;return c[10]!==u?(s=(0,a.jsx)("div",{className:"h-auto",children:u}),c[10]=u,c[11]=s):s=c[11],c[12]!==j||c[13]!==i||c[14]!==r||c[15]!==w||c[16]!==s?(o=(0,a.jsx)(Q.A,{open:j,onOpenChange:i,trigger:r,sideOffset:4,align:"center",modal:!1,className:"bg-black/85 rounded-xl p-3 backdrop-blur-sm w-[20rem] z-[100]",portalContainer:w,children:s}),c[12]=j,c[13]=i,c[14]=r,c[15]=w,c[16]=s,c[17]=o):o=c[17],o}function ls(e){let t,n,i,r=(0,l.c)(6);return r[0]!==e?({children:t,...n}=e,r[0]=e,r[1]=t,r[2]=n):(t=r[1],n=r[2]),r[3]!==t||r[4]!==n?(i=(0,a.jsx)("div",{className:"text-white/70 font-bold text-sm pb-3 text-center border-b mb-3",...n,children:t}),r[3]=t,r[4]=n,r[5]=i):i=r[5],i}function lo(e){let t,n,i=(0,l.c)(5),{children:r}=e,[s]=(0,m.fp)(li);return i[0]!==r||i[1]!==s?(t=!s&&(0,a.jsx)(a_.P.div,{className:"h-auto",initial:{opacity:0,scale:1,x:-10},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:1,x:-10},transition:{duration:.15},children:r},"section-body"),i[0]=r,i[1]=s,i[2]=t):t=i[2],i[3]!==t?(n=(0,a.jsx)("div",{className:"vc-menu-section-body",children:t}),i[3]=t,i[4]=n):n=i[4],n}function lc(e){let t,n=(0,l.c)(2),{children:i}=e;return n[0]!==i?(t=(0,a.jsx)("div",{className:"max-h-[18rem] overflow-y-auto",children:i}),n[0]=i,n[1]=t):t=n[1],t}function ld(e){let t,n,i=(0,l.c)(5),{children:r}=e,[s]=(0,m.fp)(li);return i[0]!==r||i[1]!==s?(t=s&&(0,a.jsx)(a_.P.div,{className:"h-auto",initial:{opacity:0,scale:1,x:10},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:1,x:10},transition:{duration:.15},children:r},"section-body"),i[0]=r,i[1]=s,i[2]=t):t=i[2],i[3]!==t?(n=(0,a.jsx)("div",{className:"vc-menu-submenu-body",children:t}),i[3]=t,i[4]=n):n=i[4],n}function lu(e){let t,n,i,r,s=(0,l.c)(18),{children:o,title:c,icon:d,onClick:u,value:h}=e,[p,f]=(0,m.fp)(li);s[0]!==u||s[1]!==f||s[2]!==c?(t=function(){if(u)return void u();f(c)},s[0]=u,s[1]=f,s[2]=c,s[3]=t):t=s[3];let x=t;return s[4]!==d||s[5]!==x||s[6]!==p||s[7]!==c||s[8]!==h?(n=!p&&(0,a.jsxs)("button",{role:"button",className:"w-full p-2 h-10 flex items-center justify-between rounded-lg group/vc-menu-option hover:bg-white/10 active:bg-white/20 transition-colors",onClick:x,children:[(0,a.jsx)("span",{className:"w-8 flex justify-start items-center h-full",children:(0,a.jsx)(d,{className:"text-xl"})}),(0,a.jsx)("span",{className:"w-full flex flex-1 text-sm font-medium",children:c}),h&&(0,a.jsx)("span",{className:"text-sm font-medium tracking-wide text-[--muted] mr-2",children:h}),(0,a.jsx)(ev.xCi,{className:"text-lg"})]}),s[4]=d,s[5]=x,s[6]=p,s[7]=c,s[8]=h,s[9]=n):n=s[9],s[10]!==o||s[11]!==p||s[12]!==f||s[13]!==c?(i=p===c&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{role:"button",className:"w-full pb-2 h-10 mb-2 flex items-center justify-between rounded-lg transition-colors border-b",onClick:()=>f(null),children:[(0,a.jsx)("span",{className:"w-8 flex justify-start items-center h-full",children:(0,a.jsx)(ev.i84,{className:"text-lg"})}),(0,a.jsx)("span",{className:"w-full flex flex-1 text-sm font-medium",children:c})]}),(0,a.jsx)(lc,{children:o})]},c),s[10]=o,s[11]=p,s[12]=f,s[13]=c,s[14]=i):i=s[14],s[15]!==n||s[16]!==i?(r=(0,a.jsxs)(a.Fragment,{children:[n,i]}),s[15]=n,s[16]=i,s[17]=r):r=s[17],r}function lm(e){let t,n,i=(0,l.c)(13),{options:r,value:s,onValueChange:o,isFullscreen:c,containerElement:d}=e;if(i[0]!==d||i[1]!==c||i[2]!==o||i[3]!==r||i[4]!==s){let e;i[6]!==d||i[7]!==c||i[8]!==o||i[9]!==s?(e=e=>(0,a.jsxs)("div",{role:"button",className:"w-full p-2 flex items-center justify-between rounded-lg group/vc-menu-option hover:bg-white/10 active:bg-white/20 transition-colors",onClick:()=>{o(e.value)},children:[(0,a.jsx)("span",{className:"w-8 flex justify-start items-center h-full flex-none",children:s===e.value&&(0,a.jsx)(ev.sk9,{className:"text-lg"})}),(0,a.jsx)("span",{className:"w-full flex flex-1 text-sm font-medium line-clamp-2",children:e.label}),(e.moreInfo||e.description)&&(0,a.jsxs)("div",{className:"w-fit flex-none ml-2 flex gap-2 items-center",children:[e.moreInfo&&(0,a.jsx)("span",{className:"text-xs font-medium tracking-wide text-[--muted]",children:e.moreInfo}),e.description&&(0,a.jsx)(ep.m_,{trigger:(0,a.jsx)(Z.app,{className:"text-sm"}),portalContainer:c&&d||void 0,children:e.description})]})]},e.value),i[6]=d,i[7]=c,i[8]=o,i[9]=s,i[10]=e):e=i[10],t=r.map(e),i[0]=d,i[1]=c,i[2]=o,i[3]=r,i[4]=s,i[5]=t}else t=i[5];return i[11]!==t?(n=(0,a.jsx)("div",{className:"block",children:t}),i[11]=t,i[12]=n):n=i[12],n}let lh=(0,eY.v)("VIDEO CORE PIP"),lp=(0,x.eU)(null),lf=(0,x.eU)(null);class lx{setVideo(e,t){this.video=e,this.video&&(this.video.addEventListener("play",this.handleMainVideoPlay,{signal:this.controller.signal}),this.video.addEventListener("pause",this.handleMainVideoPause,{signal:this.controller.signal})),this.playbackInfo=t}setSubtitleManager(e){this.subtitleManager=e}togglePip(e){let t=null!==document.pictureInPictureElement;(void 0!==e?e:!t)?this.enterPip():this.exitPip()}exitPip(){document.pictureInPictureElement&&document.exitPictureInPicture().catch(e=>{lh.error("Failed to exit PiP",e)})}async enterPip(){if(document.pictureInPictureElement||!this.video)return void lh.warning("PiP already in use or video not set");try{var e,t;if((null==(t=this.subtitleManager)||null==(e=t.getSelectedTrack)?void 0:e.call(t))===null){lh.info("Entering PiP without subtitles"),await this.video.requestPictureInPicture();return}lh.info("Entering PiP with subtitle burning"),await this.enterPipWithSubtitles()}catch(e){lh.error("Failed to enter PiP",e)}}destroy(){var e;this.exitPip(),null==(e=this.canvasController)||e.abort(),this.controller.abort(),this.video=null,this.subtitleManager=null}newPipVideo(){let e=document.createElement("video");return e.muted=!0,e.addEventListener("enterpictureinpicture",this.handleEnterPip,{signal:this.controller.signal}),e.addEventListener("leavepictureinpicture",this.handleLeavePip,{signal:this.controller.signal}),e}async enterPipWithSubtitles(){var e,t,n,a;if(!this.video||!this.subtitleManager)return;let l=document.createElement("canvas"),i=l.getContext("2d");if(!i)return void lh.error("Failed to get canvas context");let r=this.newPipVideo();r.srcObject=l.captureStream(),r.muted=!0,this.pipProxy=r,l.width=this.video.videoWidth,l.height=this.video.videoHeight,(null==(e=this.subtitleManager)?void 0:e.libassRenderer)&&this.subtitleManager.libassRenderer.resize(this.video.videoWidth,this.video.videoHeight),this.canvasController=new AbortController,r.addEventListener("play",()=>{this.video&&this.video.paused&&(this.isSyncingFromPip=!0,this.video.play().catch(e=>{lh.error("Failed to play main video from PiP overlay",e)}).finally(()=>{this.isSyncingFromPip=!1}))},{signal:this.canvasController.signal}),r.addEventListener("pause",()=>{this.video&&!this.video.paused&&(this.isSyncingFromPip=!0,this.video.pause(),this.isSyncingFromPip=!1)},{signal:this.canvasController.signal});let s={current:0};i.drawImage(this.video,0,0);let o=null==(n=this.subtitleManager)||null==(t=n.libassRenderer)?void 0:t._canvas;o&&l.width&&l.height&&i.drawImage(o,0,0,l.width,l.height),await new Promise((e,t)=>{let n=setTimeout(()=>{t(Error("Timeout waiting for PiP video metadata"))},5e3);r.addEventListener("loadedmetadata",()=>{clearTimeout(n),e()},{once:!0}),r.addEventListener("error",()=>{clearTimeout(n),t(Error("Error loading PiP video metadata"))},{once:!0})}),this.canvasController.signal.addEventListener("abort",()=>{var e;(null==(e=this.subtitleManager)?void 0:e.libassRenderer)&&this.subtitleManager.libassRenderer.resize(),s.current&&this.video&&this.video.cancelVideoFrameCallback(s.current),l.remove(),r.remove(),this.pipProxy=null}),this.controller.signal.addEventListener("abort",()=>{var e;null==(e=this.canvasController)||e.abort()}),r.addEventListener("leavepictureinpicture",()=>{var e;null==(e=this.canvasController)||e.abort()},{signal:this.canvasController.signal});try{this.renderToCanvas(r,i,s)(performance.now());try{await r.play(),this.video.paused&&r.pause()}catch(e){if(e instanceof DOMException&&"AbortError"===e.name);else throw e}let e=await r.requestPictureInPicture();e.addEventListener("resize",()=>{var t,n;let{width:a,height:l}=e;!(isNaN(a)||isNaN(l))&&isFinite(a)&&isFinite(l)&&(null==(n=this.subtitleManager)||null==(t=n.libassRenderer)||t.resize(a,l))},{signal:this.canvasController.signal}),lh.info("Successfully entered PiP")}catch(e){throw lh.error("Failed to enter PiP",e),null==(a=this.canvasController)||a.abort(),e}}constructor(e){this.video=null,this.subtitleManager=null,this.controller=new AbortController,this.canvasController=null,this.pipProxy=null,this.isSyncingFromMain=!1,this.isSyncingFromPip=!1,this.playbackInfo=null,this.handleEnterPip=()=>{let e=document.pictureInPictureElement;lh.info("Entered PiP",e),this.onPipElementChange(e)},this.handleLeavePip=()=>{lh.info("Left PiP"),this.onPipElementChange(null),this.video&&this.video.focus(),this.pipProxy=null},this.renderToCanvas=(e,t,n)=>(a,l)=>{var i,r;if(!this.video||!t)return;void 0!==a&&(this.video.paused&&!e.paused?this.isSyncingFromPip||e.pause():this.video.paused||!e.paused||this.isSyncingFromPip||e.play().catch(()=>{})),t.drawImage(this.video,0,0);let s=null==(r=this.subtitleManager)||null==(i=r.libassRenderer)?void 0:i._canvas;s&&t.canvas.width&&t.canvas.height&&t.drawImage(s,0,0,t.canvas.width,t.canvas.height),n.current=this.video.requestVideoFrameCallback(this.renderToCanvas(e,t,n))},this.handleMainVideoPlay=()=>{!this.isSyncingFromPip&&this.pipProxy&&this.pipProxy.paused&&(this.isSyncingFromMain=!0,this.pipProxy.play().catch(()=>{}),this.isSyncingFromMain=!1)},this.handleMainVideoPause=()=>{this.isSyncingFromPip||this.pipProxy&&!this.pipProxy.paused&&(this.isSyncingFromMain=!0,this.pipProxy.pause(),this.isSyncingFromMain=!1)},this.onPipElementChange=e,document.addEventListener("enterpictureinpicture",this.handleEnterPip,{signal:this.controller.signal}),document.addEventListener("leavepictureinpicture",this.handleLeavePip,{signal:this.controller.signal}),window.addEventListener("visibilitychange",()=>{"visible"!==document.visibilityState&&this.video&&!this.video.paused&&this.togglePip(!0)},{signal:this.controller.signal})}}let lv=(e,t)=>e&&0!==e.length&&0!==t?e.map((n,a)=>{var l;return{startTime:n.start/1e6,endTime:n.end?n.end/1e6:(null==(l=e[a+1])?void 0:l.start)?e[a+1].start/1e6:t,text:n.text||""}}):[];function lg(e){return!!e&&(/opening$|^opening\s|^op$/mi.test(e)?"Opening":/ending$|^ending\s|^ed$|^credits/mi.test(e)?"Ending":/^intro$|recap/mi.test(e)?"Intro":!!/^outro$/mi.test(e)&&"Outro")}let ly=e=>{let t=e<0?"-":"",n=Math.abs(e),a=Math.floor(n/3600),l=Math.floor(n%3600/60),i=Math.floor(n%60);return a>0?"".concat(t).concat(a,":").concat(l.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0")):"".concat(t).concat(l,":").concat(i.toString().padStart(2,"0"))},lb=e=>{if(!e)return;console.log("HEVC main ->",e.canPlayType('video/mp4;codecs="hev1.1.6.L120.90"')||"❌"),console.log("HEVC main 10 ->",e.canPlayType('video/mp4;codecs="hev1.2.4.L120.90"')||"❌"),console.log("HEVC main still-picture ->",e.canPlayType('video/mp4;codecs="hev1.3.E.L120.90"')||"❌"),console.log("HEVC range extensions ->",e.canPlayType('video/mp4;codecs="hev1.4.10.L120.90"')||"❌"),console.log("Dolby AC3 ->",e.canPlayType('audio/mp4; codecs="ac-3"')||"❌"),console.log("Dolby EC3 ->",e.canPlayType('audio/mp4; codecs="ec-3"')||"❌");let t=document.createElement("canvas"),n=t.getContext("webgl2")||t.getContext("webgl");if(n){let e=n.getExtension("WEBGL_debug_renderer_info");e&&(console.log("GPU Vendor ->",n.getParameter(e.UNMASKED_VENDOR_WEBGL)),console.log("GPU Renderer ->",n.getParameter(e.UNMASKED_RENDERER_WEBGL)))}console.log("Hardware concurrency ->",navigator.hardwareConcurrency),console.log("User agent ->",navigator.userAgent),navigator.gpu?navigator.gpu.requestAdapter().then(e=>{e?(console.log("WebGPU adapter ->",e),console.log("WebGPU adapter features ->",e.features)):console.log("⚠️ No WebGPU adapter found.")}):console.log("❌ WebGPU not supported.")};var lj=n(43826),lw=n(73594),lN=n(46753);let lk=(0,x.eU)(!1);function lS(e){let t,n,i,r,s,o,c,d,u,p,x,v,g,y,b,j,w,N,k,S=(0,l.c)(53),{children:E,timeRange:C}=e,I=(0,m.md)(iq),_=(0,m.md)(iW),T=(0,m.md)(iQ),[A,D]=(0,m.fp)(lk),P=(0,m.md)(iY),M=(0,m.md)(iK),L=_?28:48,[O,R]=h.useState("outside"),F=!I&&"approaching"===O||I&&"outside"===O||I&&"approaching"===O,U=T||A?0:F?-L:"hover"===O?0:-300,z=_?!I:"hover"!==O&&!T,K=!F&&!T&&!A;S[0]!==P||S[1]!==_?(t=function(e){if(!P)return void R("outside");let t=P.getBoundingClientRect(),n=e instanceof PointerEvent?e.clientY-t.top:0,a=_?100:150;n>=t.height-a&&n<t.height-a+50?R("approaching"):n<t.height-a?R("outside"):R("hover")},S[0]=P,S[1]=_,S[2]=t):t=S[2];let B=t;S[3]===Symbol.for("react.memo_cache_sentinel")?(n=function(e){R("outside")},S[3]=n):n=S[3];let V=n;S[4]!==P||S[5]!==B?(i=()=>{if(P)return P.addEventListener("pointermove",B),P.addEventListener("pointerleave",V),P.addEventListener("pointercancel",V),()=>{P.removeEventListener("pointermove",B),P.removeEventListener("pointerup",V),P.removeEventListener("pointercancel",V)}},S[4]=P,S[5]=B,S[6]=i):i=S[6],S[7]!==P||S[8]!==A||S[9]!==_||S[10]!==I||S[11]!==M?(r=[P,I,_,M,A],S[7]=P,S[8]=A,S[9]=_,S[10]=I,S[11]=M,S[12]=r):r=S[12],h.useEffect(i,r);let G=_?"from-black/80 via-black/40":"from-black/40",H=_&&"h-20",q=!z&&"opacity-100";S[13]!==G||S[14]!==H||S[15]!==q?(s=(0,f.cn)("vc-control-bar-bottom-gradient pointer-events-none","absolute bottom-0 left-0 right-0 w-full z-[5] h-28 transition-opacity duration-300 opacity-0","bg-gradient-to-t to-transparent",G,H,q),S[13]=G,S[14]=H,S[15]=q,S[16]=s):s=S[16],S[17]!==s?(o=(0,a.jsx)("div",{className:s}),S[17]=s,S[18]=o):o=S[18],S[19]!==z||S[20]!==_||S[21]!==I||S[22]!==F?(c=!_&&(0,a.jsx)("div",{className:(0,f.cn)("vc-control-bar-bottom-gradient-time-range-only pointer-events-none","absolute bottom-0 left-0 right-0 w-full z-[5] h-14 transition-opacity duration-400 opacity-0","bg-gradient-to-t to-transparent",_?"from-black/60":"from-black/40",_&&"h-10",F&&I&&z&&"opacity-100")}),S[19]=z,S[20]=_,S[21]=I,S[22]=F,S[23]=c):c=S[23];let W=!K&&"opacity-100";S[24]!==W?(d=(0,f.cn)("vc-control-bar-section","absolute left-0 bottom-0 right-0 flex flex-col text-white","transition-all duration-300 opacity-0","z-[100] h-28",W,i_&&"bg-purple-500/20"),S[24]=W,S[25]=d):d=S[25];let Q="".concat(U,"px");S[26]!==Q?(u={bottom:Q},S[26]=Q,S[27]=u):u=S[27],S[28]!==D?(p=()=>{D(!0)},x=()=>{D(!1)},v=()=>{D(!1)},S[28]=D,S[29]=p,S[30]=x,S[31]=v):(p=S[29],x=S[30],v=S[31]),S[32]===Symbol.for("react.memo_cache_sentinel")?(g=(0,f.cn)("vc-control-bar","absolute bottom-0 w-full px-4",i_&&"bg-purple-800/40"),S[32]=g):g=S[32],S[33]===Symbol.for("react.memo_cache_sentinel")?(y=(0,f.cn)("vc-control-bar-main-section","transform-gpu duration-100 flex items-center pb-2"),S[33]=y):y=S[33];let X="".concat(L,"px");S[34]!==X?(b={height:X},S[34]=X,S[35]=b):b=S[35];let $=b;return S[36]!==E||S[37]!==$?(j=(0,a.jsx)("div",{className:y,style:$,children:E}),S[36]=E,S[37]=$,S[38]=j):j=S[38],S[39]!==j||S[40]!==C?(w=(0,a.jsxs)("div",{className:g,children:[C,j]}),S[39]=j,S[40]=C,S[41]=w):w=S[41],S[42]!==d||S[43]!==u||S[44]!==p||S[45]!==x||S[46]!==v||S[47]!==w?(N=(0,a.jsx)("div",{"data-vc-control-bar-section":!0,className:d,style:u,onPointerEnter:p,onPointerLeave:x,onPointerCancel:v,children:w}),S[42]=d,S[43]=u,S[44]=p,S[45]=x,S[46]=v,S[47]=w,S[48]=N):N=S[48],S[49]!==N||S[50]!==o||S[51]!==c?(k=(0,a.jsxs)(a.Fragment,{children:[o,c,N]}),S[49]=N,S[50]=o,S[51]=c,S[52]=k):k=S[52],k}function lE(e){let t,n,i,r,s,o=(0,l.c)(17),{icons:c,state:d,className:u,iconClass:h,onClick:p}=e,x=(0,m.md)(iW);o[0]===Symbol.for("react.memo_cache_sentinel")?(t={},o[0]=t):t=o[0];let v=x&&"text-2xl";if(o[1]!==u||o[2]!==v?(n=(0,f.cn)("vc-control-button flex items-center justify-center px-2 transition-opacity hover:opacity-80 relative h-full","text-3xl",v,u),o[1]=u,o[2]=v,o[3]=n):n=o[3],o[4]!==h||o[5]!==c||o[6]!==d){let e;o[8]!==h||o[9]!==d?(e=e=>{let[t,n]=e;return d!==t?null:(0,a.jsx)(a_.P.span,{className:"block",initial:{opacity:0,y:10,position:"relative"},animate:{opacity:1,y:0,position:"relative"},exit:{opacity:0,y:10,position:"absolute"},transition:{duration:.15},children:(0,a.jsx)(n,{className:(0,f.cn)("vc-control-button-icon",h)})},t)},o[8]=h,o[9]=d,o[10]=e):e=o[10],i=c.map(e),o[4]=h,o[5]=c,o[6]=d,o[7]=i}else i=o[7];return o[11]!==i?(r=(0,a.jsx)(lj.N,{children:i}),o[11]=i,o[12]=r):r=o[12],o[13]!==p||o[14]!==n||o[15]!==r?(s=(0,a.jsx)("button",{role:"button",style:t,className:n,onClick:p,children:r}),o[13]=p,o[14]=n,o[15]=r,o[16]=s):s=o[16],s}function lC(){let e,t,n,i=(0,l.c)(6),r=(0,m.md)(iq),s=(0,m.Xr)(i6);i[0]===Symbol.for("react.memo_cache_sentinel")?(e=[["playing",ey.d5L],["paused",ey.djq]],i[0]=e):e=i[0];let o=r?"paused":"playing";return i[1]!==s?(t=()=>{s({type:"togglePlay"})},i[1]=s,i[2]=t):t=i[2],i[3]!==o||i[4]!==t?(n=(0,a.jsx)(lE,{icons:e,state:o,onClick:t}),i[3]=o,i[4]=t,i[5]=n):n=i[5],n}function lI(){let e,t,n,i,r,s,o,c,d,u,p,x,v,g,y,b,j,w,N=(0,l.c)(37),k=(0,m.md)(iF),S=(0,m.md)(iR),E=(0,m.Xr)(a4),C=(0,m.Xr)(a5),I=(0,m.md)(iW),[_,T]=h.useState(!1);N[0]===Symbol.for("react.memo_cache_sentinel")?(e=function(e){return Math.pow(e,2)},N[0]=e):e=N[0];let A=e;N[1]===Symbol.for("react.memo_cache_sentinel")?(t=function(e){e.stopPropagation(),e.currentTarget.setPointerCapture(e.pointerId),T(!0)},N[1]=t):t=N[1];let D=t;N[2]!==C||N[3]!==E?(n=function(e){let t=e.currentTarget.getBoundingClientRect(),n=A(Math.max(0,Math.min(1,(e.clientX-t.left)/e.currentTarget.clientWidth)));E(n),C(0===n)},N[2]=C,N[3]=E,N[4]=n):n=N[4];let P=n;N[5]!==P||N[6]!==_?(i=function(e){_&&(e.stopPropagation(),e.currentTarget.setPointerCapture(e.pointerId),T(!1),P(e))},N[5]=P,N[6]=_,N[7]=i):i=N[7];let M=i;N[8]!==P||N[9]!==_?(r=function(e){_&&(e.stopPropagation(),P(e))},N[8]=P,N[9]=_,N[10]=r):r=N[10];let L=r;N[11]===Symbol.for("react.memo_cache_sentinel")?(s=(0,f.cn)("vc-control-volume group/vc-control-volume","flex items-center justify-center h-full gap-2"),N[11]=s):s=N[11],N[12]===Symbol.for("react.memo_cache_sentinel")?(o=[["low",ev.m8L],["mid",ev.l$p],["high",ev.exc],["muted",ev.fLJ]],N[12]=o):o=N[12];let O=S?"muted":k>=.5?"high":k>.1?"mid":"low",R=I?"text-[1.3rem]":"text-2xl";N[13]!==C||N[14]!==E||N[15]!==k?(c=()=>{C(e=>(e&&0===k&&E(.1),!e))},N[13]=C,N[14]=E,N[15]=k,N[16]=c):c=N[16],N[17]!==O||N[18]!==R||N[19]!==c?(d=(0,a.jsx)(lE,{icons:o,state:O,className:R,onClick:c}),N[17]=O,N[18]=R,N[19]=c,N[20]=d):d=N[20],N[21]===Symbol.for("react.memo_cache_sentinel")?(u=(0,f.cn)("vc-control-volume-slider-container relative w-0 flex group-hover/vc-control-volume:w-[6rem] h-6","transition-[width] duration-300"),p=(0,f.cn)("vc-control-volume-slider","flex h-full w-full relative items-center","rounded-full","cursor-pointer","transition-all duration-300"),N[21]=u,N[22]=p):(u=N[21],p=N[22]),N[23]===Symbol.for("react.memo_cache_sentinel")?(x=(0,f.cn)("vc-control-volume-slider-progress h-1.5","absolute bg-white","rounded-full"),N[23]=x):x=N[23];let F="".concat(100*Math.pow(k,.5),"%");return N[24]!==F?(v=(0,a.jsx)("div",{className:x,style:{width:F}}),N[24]=F,N[25]=v):v=N[25],N[26]===Symbol.for("react.memo_cache_sentinel")?(g=(0,a.jsx)("div",{className:(0,f.cn)("vc-control-volume-slider-progress h-1.5 w-full","absolute bg-white/20","rounded-full")}),N[26]=g):g=N[26],N[27]!==L||N[28]!==M||N[29]!==v?(y=(0,a.jsxs)("div",{className:p,onPointerDown:D,onPointerMove:L,onPointerUp:M,onPointerCancel:M,children:[v,g]}),N[27]=L,N[28]=M,N[29]=v,N[30]=y):y=N[30],N[31]===Symbol.for("react.memo_cache_sentinel")?(b=(0,a.jsx)("div",{className:"w-4"}),N[31]=b):b=N[31],N[32]!==y?(j=(0,a.jsxs)("div",{className:u,children:[y,b]}),N[32]=y,N[33]=j):j=N[33],N[34]!==d||N[35]!==j?(w=(0,a.jsxs)("div",{className:s,children:[d,j]}),N[34]=d,N[35]=j,N[36]=w):w=N[36],w}function l_(e){let t,n,i=(0,l.c)(3),{onClick:r}=e;return(0,m.md)(iW)?null:(i[0]===Symbol.for("react.memo_cache_sentinel")?(t=[["default",ev.xCi]],i[0]=t):t=i[0],i[1]!==r?(n=(0,a.jsx)(lE,{icons:t,state:"default",onClick:r}),i[1]=r,i[2]=n):n=i[2],n)}function lT(e){let t,n,i=(0,l.c)(3),{onClick:r}=e;return(0,m.md)(iW)?null:(i[0]===Symbol.for("react.memo_cache_sentinel")?(t=[["default",ev.i84]],i[0]=t):t=i[0],i[1]!==r?(n=(0,a.jsx)(lE,{icons:t,state:"default",onClick:r}),i[1]=r,i[2]=n):n=i[2],n)}let lA=(0,aM.tG)("sea-video-core-timestamp-type","elapsed",void 0,{getOnInit:!0});function lD(){let e,t,n,i,r=(0,l.c)(11),s=(0,m.md)(iD),o=(0,m.md)(iP),[c,d]=(0,m.fp)(lA);r[0]!==d?(e=function(){d(lP)},r[0]=d,r[1]=e):e=r[1];let u=e;if(s<=1||isNaN(s))return null;let h="remaining"===c?"-":"",p=Math.max(0,Math.min(s,"elapsed"===c?o:s-o));return r[2]!==p?(t=ly(p),r[2]=p,r[3]=t):t=r[3],r[4]!==s?(n=ly(s),r[4]=s,r[5]=n):n=r[5],r[6]!==u||r[7]!==h||r[8]!==t||r[9]!==n?(i=(0,a.jsxs)("p",{className:"font-medium text-sm opacity-100 hover:opacity-80 cursor-pointer",onClick:u,children:[h,t," / ",n]}),r[6]=u,r[7]=h,r[8]=t,r[9]=n,r[10]=i):i=r[10],i}function lP(e){return"elapsed"===e?"remaining":"elapsed"}function lM(){var e,t;let n,i,r,s,o,c,d,u,p,f,x=(0,l.c)(24),v=(0,m.Xr)(i6),g=(0,m.md)(iW),y=(0,m.md)(aH.k),b=(0,m.md)(iJ),j=(0,m.md)(i$),[w,N]=h.useState(null),k=null==(t=y.playbackInfo)||null==(e=t.mkvMetadata)?void 0:e.audioTracks;x[0]!==b?(n=function(){var e,t;N(null!=(t=null==b||null==(e=b.getSelectedTrack)?void 0:e.call(b))?t:null)},x[0]=b,x[1]=n):n=x[1];let S=n;if(x[2]!==b||x[3]!==S||x[4]!==j?(i=()=>{var e,t;if(j&&b)return null==j||null==(t=j.audioTracks)||null==(e=t.addEventListener)||e.call(t,"change",S),()=>{var e,t;null==j||null==(t=j.audioTracks)||null==(e=t.removeEventListener)||e.call(t,"change",S)}},x[2]=b,x[3]=S,x[4]=j,x[5]=i):i=x[5],x[6]!==b||x[7]!==j?(r=[j,b],x[6]=b,x[7]=j,x[8]=r):r=x[8],h.useEffect(i,r),x[9]!==S?(s=()=>{S()},x[9]=S,x[10]=s):s=x[10],x[11]!==b?(o=[b],x[11]=b,x[12]=o):o=x[12],h.useEffect(s,o),g||!(null==k?void 0:k.length)||1===k.length)return null;x[13]===Symbol.for("react.memo_cache_sentinel")?(c=(0,a.jsx)(lE,{icons:[["default",ev.XhC]],state:"default",className:"text-2xl",onClick:lO}),d=(0,a.jsx)(ls,{children:"Audio"}),x[13]=c,x[14]=d):(c=x[13],d=x[14]),x[15]!==k?(u=k.map(lL),x[15]=k,x[16]=u):u=x[16],x[17]!==v||x[18]!==b?(p=e=>{null==b||b.selectTrack(e),v({type:"seek",payload:{time:-1}})},x[17]=v,x[18]=b,x[19]=p):p=x[19];let E=w||0;return x[20]!==u||x[21]!==p||x[22]!==E?(f=(0,a.jsxs)(lr,{name:"audio",trigger:c,children:[d,(0,a.jsx)(lc,{children:(0,a.jsx)(lm,{options:u,onValueChange:p,value:E})})]}),x[20]=u,x[21]=p,x[22]=E,x[23]=f):f=x[23],f}function lL(e){var t;return{label:"".concat(e.name),value:e.number,moreInfo:null==(t=e.language)?void 0:t.toUpperCase()}}function lO(){}function lR(){var e,t;let n,i,r,s,o,c,d,u,p,f,x=(0,l.c)(23);(0,m.Xr)(i6);let v=(0,m.md)(iW),g=(0,m.md)(aH.k),y=(0,m.md)(iZ),b=(0,m.md)(i$),[j,w]=h.useState(null),N=null==(t=g.playbackInfo)||null==(e=t.mkvMetadata)?void 0:e.subtitleTracks;x[0]!==y?(n=function(){var e,t;w(null!=(t=null==y||null==(e=y.getSelectedTrack)?void 0:e.call(y))?t:null)},x[0]=y,x[1]=n):n=x[1];let k=n;if(x[2]!==k||x[3]!==y||x[4]!==b?(i=()=>{var e,t;if(b&&y)return null==b||null==(t=b.textTracks)||null==(e=t.addEventListener)||e.call(t,"change",k),()=>{var e,t;null==b||null==(t=b.textTracks)||null==(e=t.removeEventListener)||e.call(t,"change",k)}},x[2]=k,x[3]=y,x[4]=b,x[5]=i):i=x[5],x[6]!==y||x[7]!==b?(r=[b,y],x[6]=y,x[7]=b,x[8]=r):r=x[8],h.useEffect(i,r),x[9]!==k?(s=()=>{k()},x[9]=k,x[10]=s):s=x[10],x[11]!==y?(o=[y],x[11]=y,x[12]=o):o=x[12],h.useEffect(s,o),v||!(null==N?void 0:N.length))return null;x[13]===Symbol.for("react.memo_cache_sentinel")?(c=(0,a.jsx)(lE,{icons:[["default",ev.Fqr]],state:"default",onClick:lU}),d=(0,a.jsx)(ls,{children:"Subtitles"}),x[13]=c,x[14]=d):(c=x[13],d=x[14]),x[15]!==N?(u=N.map(lF),x[15]=N,x[16]=u):u=x[16],x[17]!==y?(p=e=>{null==y||y.selectTrack(e)},x[17]=y,x[18]=p):p=x[18];let S=j||0;return x[19]!==u||x[20]!==p||x[21]!==S?(f=(0,a.jsxs)(lr,{name:"subtitle",trigger:c,children:[d,(0,a.jsx)(lc,{children:(0,a.jsx)(lm,{options:u,onValueChange:p,value:S})})]}),x[19]=u,x[20]=p,x[21]=S,x[22]=f):f=x[22],f}function lF(e){return{label:"".concat(e.name),value:e.number,moreInfo:e.language?"".concat(e.language.toUpperCase()).concat(e.codecID?"/"+function(e){switch(e){case"S_TEXT/ASS":case"S_TEXT/SSA":return"SSA";case"S_TEXT/UTF8":return"TEXT";case"S_HDMV/PGS":return"PGS"}return"unknown"}(e.codecID):""):void 0}}function lU(){}function lz(){let e,t,n,i,r,s,o,c,d,u,p,f,x,v,g,y,b,j,w,N,k,S,E,C,I,_,T,A,D,P,M,L,O,R,F,U=(0,l.c)(85);(0,m.Xr)(i6);let z=(0,m.md)(iW),K=(0,m.md)(iM),B=(0,m.Xr)(a6),[V,G]=(0,m.fp)(aO);U[0]!==V?(e=aU(V),U[0]=V,U[1]=e):e=U[1];let H=e,[,q]=(0,m.fp)(a7),[W,Q]=(0,m.fp)(aZ),[X,$]=(0,m.fp)(aJ),[Y,Z]=(0,m.fp)(a0),[J,ee]=(0,m.fp)(a1),[et,en]=(0,m.fp)(a2),[ea,el]=(0,m.fp)(a3),[,ei]=(0,m.fp)(ll),[,er]=(0,m.fp)(li);if(z)return null;U[2]!==K||U[3]!==ei||U[4]!==er?(t=1!==K&&(0,a.jsx)("p",{className:"text-sm text-[--muted] cursor-pointer",onClick:()=>{ei("settings"),h.startTransition(()=>{er("Playback Speed")})},children:"".concat(K.toFixed(2),"x")}),U[2]=K,U[3]=ei,U[4]=er,U[5]=t):t=U[5],U[6]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsx)(lE,{icons:[["default",ev.ucQ]],state:"default",onClick:lB}),U[6]=n):n=U[6],U[7]===Symbol.for("react.memo_cache_sentinel")?(i=(0,a.jsx)(ls,{children:"Settings"}),U[7]=i):i=U[7];let es="".concat(K.toFixed(2),"x");U[8]!==es?(r=(0,a.jsx)(lu,{title:"Playback Speed",icon:eg.BJM,value:es}),U[8]=es,U[9]=r):r=U[9];let eo=et?"On":"Off";U[10]!==eo?(s=(0,a.jsx)(lu,{title:"Auto Play",icon:nJ.Rcw,value:eo}),U[10]=eo,U[11]=s):s=U[11];let ec=J?"On":"Off";U[12]!==ec?(o=(0,a.jsx)(lu,{title:"Auto Next",icon:lw.JgS,value:ec}),U[12]=ec,U[13]=o):o=U[13];let ed=ea?"On":"Off";U[14]!==ed?(c=(0,a.jsx)(lu,{title:"Skip OP/ED",icon:tI.ySo,value:ed}),U[14]=ed,U[15]=c):c=U[15];let eu=(null==H?void 0:H.label)||"Off";U[16]!==eu?(d=(0,a.jsx)(lu,{title:"Anime4K",icon:ev.rPP,value:eu}),U[16]=eu,U[17]=d):d=U[17],U[18]===Symbol.for("react.memo_cache_sentinel")?(u=(0,a.jsx)(lu,{title:"Appearance",icon:ev.WdH}),U[18]=u):u=U[18],U[19]!==q?(p=(0,a.jsx)(lu,{title:"Keybinds",icon:ev.xjf,onClick:()=>q(!0)}),U[19]=q,U[20]=p):p=U[20],U[21]!==c||U[22]!==d||U[23]!==p||U[24]!==r||U[25]!==s||U[26]!==o?(f=(0,a.jsxs)(lo,{children:[i,r,s,o,c,d,u,p]}),U[21]=c,U[22]=d,U[23]=p,U[24]=r,U[25]=s,U[26]=o,U[27]=f):f=U[27],U[28]===Symbol.for("react.memo_cache_sentinel")?(x=[{label:"0.5x",value:.5},{label:"0.9x",value:.9},{label:"1x",value:1},{label:"1.1x",value:1.1},{label:"1.5x",value:1.5},{label:"2x",value:2}],U[28]=x):x=U[28],U[29]!==B?(v=e=>{B(e)},U[29]=B,U[30]=v):v=U[30],U[31]!==K||U[32]!==v?(g=(0,a.jsx)(lu,{title:"Playback Speed",icon:eg.BJM,children:(0,a.jsx)(lm,{options:x,onValueChange:v,value:K})}),U[31]=K,U[32]=v,U[33]=g):g=U[33],U[34]===Symbol.for("react.memo_cache_sentinel")?(y=[{label:"On",value:1},{label:"Off",value:0}],U[34]=y):y=U[34],U[35]!==en?(b=e=>{en(!!e)},U[35]=en,U[36]=b):b=U[36];let em=+!!et;U[37]!==b||U[38]!==em?(j=(0,a.jsx)(lu,{title:"Auto Play",icon:nJ.Rcw,children:(0,a.jsx)(lm,{options:y,onValueChange:b,value:em})}),U[37]=b,U[38]=em,U[39]=j):j=U[39],U[40]===Symbol.for("react.memo_cache_sentinel")?(w=[{label:"On",value:1},{label:"Off",value:0}],U[40]=w):w=U[40],U[41]!==ee?(N=e=>{ee(!!e)},U[41]=ee,U[42]=N):N=U[42];let eh=+!!J;U[43]!==N||U[44]!==eh?(k=(0,a.jsx)(lu,{title:"Auto Next",icon:lw.JgS,children:(0,a.jsx)(lm,{options:w,onValueChange:N,value:eh})}),U[43]=N,U[44]=eh,U[45]=k):k=U[45],U[46]===Symbol.for("react.memo_cache_sentinel")?(S=[{label:"On",value:1},{label:"Off",value:0}],U[46]=S):S=U[46],U[47]!==el?(E=e=>{el(!!e)},U[47]=el,U[48]=E):E=U[48];let ep=+!!ea;return U[49]!==E||U[50]!==ep?(C=(0,a.jsx)(lu,{title:"Skip OP/ED",icon:tI.ySo,children:(0,a.jsx)(lm,{options:S,onValueChange:E,value:ep})}),U[49]=E,U[50]=ep,U[51]=C):C=U[51],U[52]===Symbol.for("react.memo_cache_sentinel")?(I=(0,a.jsx)("p",{className:"text-[--muted] text-sm mb-2",children:"Real-time upscaling. Do not enable if you have a low-end GPU or none."}),U[52]=I):I=U[52],U[53]===Symbol.for("react.memo_cache_sentinel")?(_=aF.map(lK),U[53]=_):_=U[53],U[54]!==G?(T=e=>{G(e)},U[54]=G,U[55]=T):T=U[55],U[56]!==V||U[57]!==T?(A=(0,a.jsxs)(lu,{title:"Anime4K",icon:ev.rPP,children:[I,(0,a.jsx)(lm,{options:_,onValueChange:T,value:V})]}),U[56]=V,U[57]=T,U[58]=A):A=U[58],U[59]!==Q||U[60]!==W?(D=(0,a.jsx)(t3.d,{label:"Show Chapter Markers",side:"right",fieldClass:"hover:bg-transparent px-0 ml-0 w-full",size:"sm",value:W,onValueChange:Q}),U[59]=Q,U[60]=W,U[61]=D):D=U[61],U[62]!==X||U[63]!==$?(P=(0,a.jsx)(t3.d,{label:"Highlight OP/ED Chapters",side:"right",fieldClass:"hover:bg-transparent px-0 ml-0 w-full",size:"sm",value:X,onValueChange:$}),U[62]=X,U[63]=$,U[64]=P):P=U[64],U[65]!==Y||U[66]!==Z?(M=(0,a.jsx)(t3.d,{label:"Increase saturation",side:"right",fieldClass:"hover:bg-transparent px-0 ml-0 w-full",size:"sm",value:Y,onValueChange:Z}),U[65]=Y,U[66]=Z,U[67]=M):M=U[67],U[68]!==D||U[69]!==P||U[70]!==M?(L=(0,a.jsxs)(lu,{title:"Appearance",icon:ev.WdH,children:[D,P,M]}),U[68]=D,U[69]=P,U[70]=M,U[71]=L):L=U[71],U[72]!==g||U[73]!==j||U[74]!==k||U[75]!==C||U[76]!==A||U[77]!==L?(O=(0,a.jsxs)(ld,{children:[g,j,k,C,A,L]}),U[72]=g,U[73]=j,U[74]=k,U[75]=C,U[76]=A,U[77]=L,U[78]=O):O=U[78],U[79]!==f||U[80]!==O?(R=(0,a.jsxs)(lr,{name:"settings",trigger:n,children:[f,O]}),U[79]=f,U[80]=O,U[81]=R):R=U[81],U[82]!==t||U[83]!==R?(F=(0,a.jsxs)(a.Fragment,{children:[t,R]}),U[82]=t,U[83]=R,U[84]=F):F=U[84],F}function lK(e){return{label:"".concat(e.label),value:e.value,moreInfo:"heavy"===e.performance?"Heavy":void 0,description:e.description}}function lB(){}function lV(){let e,t,n,i=(0,l.c)(6),r=(0,m.md)(lf),s=(0,m.md)(iz);if((0,m.md)(iW))return null;i[0]===Symbol.for("react.memo_cache_sentinel")?(e=[["default",tI.c6i],["pip",tI.LWH]],i[0]=e):e=i[0];let o=s?"pip":"default";return i[1]!==r?(t=()=>{null==r||r.togglePip()},i[1]=r,i[2]=t):t=i[2],i[3]!==o||i[4]!==t?(n=(0,a.jsx)(lE,{icons:e,state:o,onClick:t}),i[3]=o,i[4]=t,i[5]=n):n=i[5],n}function lG(){let e,t,n,i=(0,l.c)(6),r=(0,m.md)(aW),s=(0,m.md)(iU);i[0]===Symbol.for("react.memo_cache_sentinel")?(e=[["default",lN.kc3],["fullscreen",lN.iRv]],i[0]=e):e=i[0];let o=s?"fullscreen":"default";return i[1]!==r?(t=()=>{null==r||r.toggleFullscreen()},i[1]=r,i[2]=t):t=i[2],i[3]!==o||i[4]!==t?(n=(0,a.jsx)(lE,{icons:e,state:o,onClick:t}),i[3]=o,i[4]=t,i[5]=n):n=i[5],n}var lH=n(58181),lq=n(83475);let lW=(0,f.u)({overlay:(0,e4.F)(["UI-Drawer__overlay"]),content:(0,e4.F)(["UI-Drawer__content","fixed z-50 w-full","transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-500 data-[state=open]:duration-500","focus:outline-none focus-visible:outline-none outline-none",tJ.X&&"select-none"],{variants:{side:{player:"w-full inset-x-0 top-0 data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",top:"w-full lg:w-[calc(100%_-_20px)] inset-x-0 top-0 border data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"w-full lg:w-[calc(100%_-_20px)] inset-x-0 bottom-0 border data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full lg:h-[calc(100%_-_20px)] border data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left",right:"inset-y-0 right-0 h-full lg:h-[calc(100%_-_20px)] border data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right"},size:{sm:null,md:null,lg:null,xl:null,full:null}},defaultVariants:{side:"right",size:"md"},compoundVariants:[{size:"sm",side:"left",className:"sm:max-w-sm"},{size:"sm",side:"right",className:"sm:max-w-sm"},{size:"md",side:"left",className:"sm:max-w-md"},{size:"md",side:"right",className:"sm:max-w-md"},{size:"lg",side:"left",className:"sm:max-w-2xl"},{size:"lg",side:"right",className:"sm:max-w-2xl"},{size:"xl",side:"left",className:"sm:max-w-5xl"},{size:"xl",side:"right",className:"sm:max-w-5xl"},{size:"full",side:"top",className:"h-dvh"},{size:"full",side:"bottom",className:"h-dvh"}]}),close:(0,e4.F)(["UI-Drawer__close","absolute right-4 top-4"]),header:(0,e4.F)(["UI-Drawer__header","flex flex-col space-y-1.5 text-center sm:text-left"]),footer:(0,e4.F)(["UI-Drawer__footer","flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2"]),title:(0,e4.F)(["UI-Drawer__title","text-xl font-semibold leading-none tracking-tight"]),description:(0,e4.F)(["UI-Drawer__description","text-sm text-[--muted]"])});function lQ(e){let{allowOutsideInteraction:t=!1,trigger:n,title:l,footer:i,description:r,children:s,closeButton:o,overlayClass:c,contentClass:d,closeClass:u,headerClass:m,footerClass:p,titleClass:x,descriptionClass:v,hideCloseButton:g,side:y="right",size:b,open:j,onOpenAutoFocus:w,onCloseAutoFocus:k,onEscapeKeyDown:S,onPointerDownCapture:E,onInteractOutside:C,portalContainer:I,miniPlayer:_,onMiniPlayerClick:T,...A}=e;h.useEffect(()=>{j&&"full"===b?document.body.setAttribute("data-scroll-locked","1"):"full"===b&&document.body.removeAttribute("data-scroll-locked")},[j,b]);let D=h.useRef(_);h.useEffect(()=>{setTimeout(()=>{D.current=_},500)},[_]);let P=h.useRef(null),M=h.useRef(null),L=h.useCallback(()=>{let e=window.innerWidth>=1024?400:300;return{x:window.innerWidth-e-G,y:window.innerHeight-9/16*e-G}},[]),[O,R]=h.useState({x:0,y:0}),[F,U]=h.useState(!1),[z,K]=h.useState(!1),B=h.useRef({x:0,y:0}),V=h.useRef({x:0,y:0}),G=20,H=h.useCallback(()=>{if(!P.current)return null;let e=P.current.offsetWidth||0,t=P.current.offsetHeight||0;return{leftBoundary:80+G,rightBoundary:window.innerWidth-e-G,topBoundary:G,bottomBoundary:window.innerHeight-t-G,width:e,height:t}},[]);return h.useLayoutEffect(()=>{_&&(R(L()),K(!1))},[_,L]),h.useEffect(()=>{var e;if(!_||!P.current)return;let t=e=>{U(!0),B.current={x:e.clientX,y:e.clientY},V.current={x:O.x,y:O.y}},n=e=>{if(!F||!P.current)return;let t=e.clientX-B.current.x,n=e.clientY-B.current.y,a=V.current.x+t,l=V.current.y+n,i=H();if(i){if(a>=window.innerWidth-.5*i.width){z||K(!0),R({x:window.innerWidth-.15*i.width,y:l});return}z&&K(!1),R({x:Math.max(i.leftBoundary,Math.min(a,1.25*i.rightBoundary)),y:Math.max(i.topBoundary,Math.min(l,i.bottomBoundary))})}},a=e=>{if(U(!1),z){let e=H();if(!e)return;O.x<window.innerWidth-.5*e.width?(K(!1),R({x:e.rightBoundary,y:O.y})):R({x:window.innerWidth-.1*e.width,y:O.y});return}if(10>Math.abs(O.x-V.current.x)&&10>Math.abs(O.y-V.current.y)&&e.target===M.current){null==T||T();return}let t=H();if(!t)return;let n=[{x:t.leftBoundary,y:t.topBoundary},{x:t.rightBoundary,y:t.topBoundary},{x:t.leftBoundary,y:t.bottomBoundary},{x:t.rightBoundary,y:t.bottomBoundary}],a=n[0],l=Number.MAX_VALUE;n.forEach(e=>{let t=Math.sqrt(Math.pow(O.x-e.x,2)+Math.pow(O.y-e.y,2));t<l&&(l=t,a=e)}),R({x:a.x,y:a.y})};return null==(e=M.current)||e.addEventListener("mousedown",t),window.addEventListener("mousemove",n),window.addEventListener("mouseup",a),()=>{var e;null==(e=M.current)||e.removeEventListener("mousedown",t),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",a)}},[_,F,O,H,z]),h.useEffect(()=>{if(!_)return;let e=()=>{let e=H();e&&R(t=>{let n=t.x,a=t.y;return z?n=window.innerWidth-.1*e.width:(n=Math.max(e.leftBoundary,Math.min(t.x,e.rightBoundary)),a=Math.max(e.topBoundary,Math.min(t.y,e.bottomBoundary))),{x:n,y:a}})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[_,H,z]),h.useEffect(()=>{if(!P.current||!_)return;let e=0===O.x&&0===O.y?L():O;return P.current.style.position="fixed",P.current.style.left="".concat(e.x,"px"),P.current.style.top="".concat(e.y,"px"),P.current.style.zIndex=z?"40":"50",P.current.style.opacity=z?"0.7":"1",P.current.style.transform=z?"scale(0.95)":"scale(1)",D.current&&(F?P.current.style.transition="opacity 0.2s ease-out, transform 0.2s ease-out":P.current.style.transition="left 0.3s cubic-bezier(0.4, 0, 0.2, 1), top 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.2s ease-out, transform 0.2s ease-out"),()=>{P.current&&(P.current.style.position="",P.current.style.left="",P.current.style.top="",P.current.style.transform="",P.current.style.cursor="",P.current.style.transition="",P.current.style.zIndex="",P.current.style.opacity="")}},[_,O,F,z,L]),(0,a.jsxs)(lH.bL,{modal:!t,open:j,...A,children:[n&&(0,a.jsx)(lH.l9,{asChild:!0,children:n}),(0,a.jsx)(lH.ZL,{container:I,children:(0,a.jsxs)(lH.UC,{className:(0,f.cn)(lW.content({size:b,side:"player"}),d,"w-full h-full transition-all duration-300 overflow-hidden fixed",_&&"aspect-video w-[300px] lg:w-[400px] h-auto rounded-lg shadow-xl",z&&"ring-2 ring-brand-300"),ref:P,onOpenAutoFocus:e=>e.preventDefault(),onCloseAutoFocus:k,onEscapeKeyDown:S,onPointerDownCapture:E,onInteractOutside:e=>e.preventDefault(),tabIndex:-1,children:[l||r?(0,a.jsxs)("div",{className:(0,f.cn)(lW.header(),m),children:[(0,a.jsx)(lH.hE,{className:(0,f.cn)(lW.title(),tJ.X&&"relative",x),children:l}),r&&(0,a.jsx)(lH.VY,{className:(0,f.cn)(lW.description(),v),children:r})]}):(0,a.jsx)(lq.s6,{children:(0,a.jsx)(lH.hE,{children:"Drawer"})}),_&&(0,a.jsx)("div",{ref:M,className:"vc-drawer-draggable-area absolute inset-0 z-[6]"}),s,i&&(0,a.jsx)("div",{className:(0,f.cn)(lW.footer(),p),children:i}),!g&&(0,a.jsx)(lH.bm,{className:(0,f.cn)(lW.close(),u),asChild:!0,children:o||(0,a.jsx)(N.Jn,{})})]})})]})}lQ.displayName="NativePlayerDrawer",(0,eY.v)("VIDEO CORE MEDIA SESSION");let lX=(0,x.eU)(null),l$=["play","pause","seekforward","seekbackward","seekto"];class lY{setVideo(e){this.video=e,this.video&&this.isActive&&(this.setupVideoListeners(),this.updatePlaybackState())}setPlaybackInfo(e){this.playbackInfo=e,this.isActive&&this.updateMetadata()}activate(){this.checkSupport()&&!this.isActive&&(this.isActive=!0,this.setupActionHandlers(),this.updateMetadata(),this.video&&(this.setupVideoListeners(),this.updatePlaybackState()))}deactivate(){this.isActive&&(this.isActive=!1,"mediaSession"in navigator&&(navigator.mediaSession.playbackState="none"),this.onDisconnect(),this.controller.abort(),this.controller=new AbortController)}on(e,t){this.eventTarget.addEventListener(e,t)}off(e,t){this.eventTarget.removeEventListener(e,t)}destroy(){this.deactivate(),this.video=null,this.playbackInfo=null}checkSupport(){return"mediaSession"in navigator}dispatch(e,t){this.eventTarget.dispatchEvent(new CustomEvent(e,{detail:t}))}onDisconnect(){if("mediaSession"in navigator){for(let e of(console.warn("Media session disconnected"),l$))navigator.mediaSession.setActionHandler(e,null);navigator.mediaSession.metadata=new MediaMetadata({title:"",artist:"",artwork:[]}),"setPositionState"in navigator.mediaSession&&navigator.mediaSession.setPositionState()}}updateMetadata(){if(!this.isActive||!("mediaSession"in navigator))return;let e=this.createMetadata();navigator.mediaSession.metadata=e}updatePlaybackState(){if(!this.isActive||!("mediaSession"in navigator)||!this.video)return;let e=this.video.paused?"paused":"playing";navigator.mediaSession.playbackState=e}createMetadata(){var e,t,n,a,l,i;if(!this.playbackInfo)return null;let r=this.playbackInfo.episode,s=null==r?void 0:r.baseAnime,o=(null==r?void 0:r.displayTitle)||"Seanime",c=(null==s||null==(e=s.title)?void 0:e.userPreferred)||(null==s||null==(t=s.title)?void 0:t.romaji)||(null==s||null==(n=s.title)?void 0:n.english)||"Video Player",d=[],u=(null==r||null==(a=r.episodeMetadata)?void 0:a.image)||(null==s||null==(l=s.coverImage)?void 0:l.large)||(null==s||null==(i=s.coverImage)?void 0:i.medium);return u&&d.push({src:u,sizes:"512x512",type:"image/webp"}),new MediaMetadata({title:o,artist:c,artwork:d})}setupActionHandlers(){if(!("mediaSession"in navigator))return;let e=this.handleAction.bind(this);for(let t of l$)navigator.mediaSession.setActionHandler(t,e)}handleAction(e){switch(e.action){case"play":this.dispatch("media-play-request");break;case"pause":this.dispatch("media-pause-request");break;case"seekto":case"seekforward":case"seekbackward":let t;if(void 0!==e.seekTime)t=e.seekTime;else{var n;t=((null==(n=this.video)?void 0:n.currentTime)||0)+(e.seekOffset||("seekforward"===e.action?10:-10))}this.dispatch("media-seek-request",{seekTime:t})}}setupVideoListeners(){if(!this.video)return;let e={signal:this.controller.signal};this.video.addEventListener("play",this.updatePlaybackState.bind(this),e),this.video.addEventListener("pause",this.updatePlaybackState.bind(this),e),this.video.addEventListener("timeupdate",this.handleTimeUpdate.bind(this),e),this.video.addEventListener("loadedmetadata",this.updatePlaybackState.bind(this),e)}handleTimeUpdate(){this.isActive&&"mediaSession"in navigator&&this.video&&"setPositionState"in navigator.mediaSession&&navigator.mediaSession.setPositionState({duration:this.video.duration||0,playbackRate:this.video.playbackRate||1,position:this.video.currentTime||0})}constructor(){if(this.video=null,this.playbackInfo=null,this.isActive=!1,this.controller=new AbortController,this.eventTarget=new EventTarget,!this.checkSupport())return}}var lZ=n(22264),lJ=n(2159),l0=n(51441),l1=n(40845),l2=n(52029),l3=n(47363),l4=n(82449),l5=n(75385),l6=n(93319),l8=n(85530);let l7=(0,eY.v)("VIDEO CORE PLAYLIST"),l9=(0,x.eU)(null);function ie(e){return"main"===e.type}function it(){var e,t;let n,a,i,r=(0,l.c)(31),s=(0,m.md)(l9),o=null==(t=(0,m.md)(aH.k))||null==(e=t.playbackInfo)?void 0:e.streamType,c=null==s?void 0:s.animeEntry,d=(0,m.Xr)(l3.N7),u=(0,m.Xr)(l3.Io),{handleStreamSelection:p,handleAutoSelectStream:f}=(0,l4.w)(),{handleStreamSelection:x,handleAutoSelectStream:v}=(0,l0.u)(),{playMediaFile:g}=(0,l6.g)(),[y]=(0,m.fp)(l5.bj),[b]=(0,m.fp)(l1.RP),[j]=(0,m.fp)(l5.q6),[w]=(0,m.fp)(l1.mF),{setTorrentSearchStreamEpisode:N}=(0,l2.U)(),{autoPlayTorrent:k}=(0,tc.K1)(),{nextPlaylistEpisode:S,prevPlaylistEpisode:E,currentPlaylist:C,playEpisode:I}=(0,td.n)();r[0]!==k||r[1]!==w||r[2]!==b||r[3]!==v||r[4]!==x||r[5]!==f||r[6]!==p||r[7]!==s||r[8]!==d||r[9]!==u||r[10]!==N||r[11]!==o||r[12]!==j||r[13]!==y?(n=function(e){var t,n;if((null==s?void 0:s.animeEntry)&&e.aniDBEpisode){if(l7.info("Stream requested for ",e.episodeNumber),"torrent"===o||"debrid"===o){if(l7.info("Auto selecting torrent for ",e.episodeNumber),"torrent"===o&&y)return void f({mediaId:s.animeEntry.mediaId,episodeNumber:e.episodeNumber,aniDBEpisode:e.aniDBEpisode});if("debrid"===o&&b)return void v({mediaId:s.animeEntry.mediaId,episodeNumber:e.episodeNumber,aniDBEpisode:e.aniDBEpisode})}if(null==k||null==(t=k.torrent)?void 0:t.isBatch){let t;if(l7.info("Previous torrent selected for auto play",k),null==k?void 0:k.batchFiles){let e=null==(n=k.batchFiles.files)?void 0:n.find(e=>e.index===k.batchFiles.current+1);e&&(t=e.index)}"torrent"===o?p({mediaId:s.animeEntry.mediaId,episodeNumber:e.episodeNumber,aniDBEpisode:e.aniDBEpisode,torrent:k.torrent,chosenFileIndex:t,batchEpisodeFiles:(null==k?void 0:k.batchFiles)&&void 0!==t?{...k.batchFiles,current:t,currentEpisodeNumber:e.episodeNumber,currentAniDBEpisode:e.aniDBEpisode}:void 0}):"debrid"===o&&x({mediaId:s.animeEntry.mediaId,episodeNumber:e.episodeNumber,aniDBEpisode:e.aniDBEpisode,torrent:k.torrent,chosenFileId:void 0!==t?String(t):"",batchEpisodeFiles:(null==k?void 0:k.batchFiles)&&void 0!==t?{...k.batchFiles,current:t,currentEpisodeNumber:e.episodeNumber,currentAniDBEpisode:e.aniDBEpisode}:void 0})}else u(e.episodeNumber),N(e),l7.info("Torrent search for ",e.episodeNumber),h.startTransition(()=>{"torrent"===o?d(j?"torrentstream-select":"torrentstream-select-file"):"debrid"===o&&d(w?"debridstream-select":"debridstream-select-file")})}},r[0]=k,r[1]=w,r[2]=b,r[3]=v,r[4]=x,r[5]=f,r[6]=p,r[7]=s,r[8]=d,r[9]=u,r[10]=N,r[11]=o,r[12]=j,r[13]=y,r[14]=n):n=r[14];let _=n;r[15]!==c||r[16]!==C||r[17]!==S||r[18]!==E||r[19]!==I||r[20]!==g||r[21]!==s||r[22]!==_||r[23]!==o?(a=e=>{var t,n,a,l;if(!s)return void J.oR.error("Unexpected error: No playlist state");if(!c)return void J.oR.error("Unexpected error: No entry");if(l7.info("Requesting episode",e),C){switch(l7.info("Playing global playlist episode",e),e){case"previous":E&&I("previous",!0);break;case"next":S&&I("next",!0)}return}let i=null;switch(e){case"previous":(null==s?void 0:s.previousEpisode)&&(i=s.previousEpisode);break;case"next":(null==s?void 0:s.nextEpisode)&&(i=s.nextEpisode);break;default:i=null!=(n=null==s||null==(t=s.episodes)?void 0:t.find(t=>t.aniDBEpisode===e))?n:null}if(!i)return void l7.info("Episode not found for",e);switch(l7.info("Playing episode",i),o){case"localfile":if(!(null==i||null==(a=i.localFile)?void 0:a.path))return void J.oR.error("Local file not found");g({path:null==i||null==(l=i.localFile)?void 0:l.path,episode:i,mediaId:null==c?void 0:c.mediaId});break;case"torrent":case"debrid":_(i)}},r[15]=c,r[16]=C,r[17]=S,r[18]=E,r[19]=I,r[20]=g,r[21]=s,r[22]=_,r[23]=o,r[24]=a):a=r[24];let T=a,A=null==s?void 0:s.animeEntry,D=!!(null==s?void 0:s.previousEpisode),P=!!(null==s?void 0:s.nextEpisode);return r[25]!==T||r[26]!==s||r[27]!==A||r[28]!==D||r[29]!==P?(i={playlistState:s,animeEntry:A,hasPreviousEpisode:D,hasNextEpisode:P,playEpisode:T},r[25]=T,r[26]=s,r[27]=A,r[28]=D,r[29]=P,r[30]=i):i=r[30],i}function ia(){let e,t,n,i,r=(0,l.c)(21),{animeEntry:s,hasNextEpisode:o,hasPreviousEpisode:c,playEpisode:d}=it(),{nextPlaylistEpisode:u,prevPlaylistEpisode:m,currentPlaylist:h,playEpisode:p}=(0,td.n)();if(h){let e,t,n;return r[0]!==p||r[1]!==m?(e=!!m&&(0,a.jsx)(lT,{onClick:()=>{p("previous",!0)}}),r[0]=p,r[1]=m,r[2]=e):e=r[2],r[3]!==u||r[4]!==p?(t=!!u&&(0,a.jsx)(l_,{onClick:()=>{p("next",!0)}}),r[3]=u,r[4]=p,r[5]=t):t=r[5],r[6]!==e||r[7]!==t?(n=(0,a.jsxs)(a.Fragment,{children:[e,t]}),r[6]=e,r[7]=t,r[8]=n):n=r[8],n}return r[9]!==c||r[10]!==d?(e=c&&(0,a.jsx)(lT,{onClick:()=>{d("previous")}}),r[9]=c,r[10]=d,r[11]=e):e=r[11],r[12]!==o||r[13]!==d?(t=o&&(0,a.jsx)(l_,{onClick:()=>{d("next")}}),r[12]=o,r[13]=d,r[14]=t):t=r[14],r[15]!==s?(n=s&&(0,a.jsx)(l3.qM,{entry:s}),r[15]=s,r[16]=n):n=r[16],r[17]!==e||r[18]!==t||r[19]!==n?(i=(0,a.jsxs)(a.Fragment,{children:[e,t,n]}),r[17]=e,r[18]=t,r[19]=n,r[20]=i):i=r[20],i}class il{_bindToVideoPlayer(){this.detachFromCurrentPlayer(),this.videoSyncController=new AbortController,this.videoElement.addEventListener("timeupdate",()=>{let e=this.calculateSegmentIndex(this.videoElement.currentTime);e===this.lastCapturedSegment||this.previewCache.has(e)||this.throttledCaptureFrame(e)},{signal:this.videoSyncController.signal})}changeMediaSource(e){e!==this.currentMediaSource&&e&&(this.clearPreviewCache(),this.resetOperationQueue(),this.loadMediaSource(e),this.lastCapturedSegment=-1,this.captureThrottleTimeout&&(clearTimeout(this.captureThrottleTimeout),this.captureThrottleTimeout=null))}cleanup(){this.detachFromCurrentPlayer(),this.resetOperationQueue(),this.clearPreviewCache(),this.captureThrottleTimeout&&(clearTimeout(this.captureThrottleTimeout),this.captureThrottleTimeout=null),this._dummyVideoElement.pause(),this._dummyVideoElement.removeAttribute("src"),this._dummyVideoElement.load(),this._dummyVideoElement.remove(),this.currentMediaSource=void 0,this.lastCapturedSegment=-1,this.highestCachedIndex=-1}async retrievePreviewForSegment(e){let t=this.previewCache.get(e);if(t)return t;let n=this.inFlightPromises.get(e);return n||await this.schedulePreviewGeneration(e)}getLastestCachedIndex(){return this.highestCachedIndex}calculateTimeFromIndex(e){return 4*e}throttledCaptureFrame(e){this.captureThrottleTimeout&&clearTimeout(this.captureThrottleTimeout),this.captureThrottleTimeout=window.setTimeout(()=>{if(!this.previewCache.has(e)&&!this.inFlightPromises.has(e)){let t=this.captureFrameFromCurrentVideo(e);this.inFlightPromises.set(e,t),t.finally(()=>this.inFlightPromises.delete(e)),this.lastCapturedSegment=e}this.captureThrottleTimeout=null},500)}initializeDummyVideoElement(){this._dummyVideoElement.crossOrigin="anonymous",this._dummyVideoElement.playbackRate=0,this._dummyVideoElement.muted=!0,this._dummyVideoElement.preload="none"}loadMediaSource(e){this._dummyVideoElement.src=this.currentMediaSource=e,this._dummyVideoElement.load()}detachFromCurrentPlayer(){this.videoSyncController.abort(),this.captureThrottleTimeout&&(clearTimeout(this.captureThrottleTimeout),this.captureThrottleTimeout=null)}calculateSegmentIndex(e){return Math.floor(e/4)}async captureFrameFromCurrentVideo(e){if(this.videoElement.readyState<2)return;let t=this.videoElement.videoWidth,n=this.videoElement.videoHeight;if(!t||!n)return;this.configureRenderingSurface(t,n),this._drawingContext.drawImage(this.videoElement,0,0,this._offscreenCanvas.width,this._offscreenCanvas.height);let a=await this._offscreenCanvas.convertToBlob({type:"image/webp",quality:.8}),l=URL.createObjectURL(a);return this.previewCache.set(e,l),e>this.highestCachedIndex&&(this.highestCachedIndex=e),l}addJob(e){let{promise:t,resolve:n}=Promise.withResolvers();return{segmentIndex:e,execute:()=>{this._dummyVideoElement.requestVideoFrameCallback(async(t,a)=>{n(await this.captureFrameAtSegment(this._dummyVideoElement,e,a.width,a.height)),this.processNextJob()}),this._dummyVideoElement.currentTime=4*e},promise:t}}processNextJob(){this.jobs.current=void 0,this.jobs.pending&&(this.jobs.current=this.jobs.pending,this.jobs.pending=void 0,this.jobs.current.execute())}schedulePreviewGeneration(e){return this.jobs.current?this.jobs.current.segmentIndex===e?this.jobs.current.promise:(this.jobs.pending&&this.jobs.pending.segmentIndex===e||(this.jobs.pending=this.addJob(e)),this.jobs.pending.promise):(this.jobs.current=this.addJob(e),this.jobs.current.execute(),this.jobs.current.promise)}async captureFrameAtSegment(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.videoWidth,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.videoHeight,l=this.previewCache.get(t);if(l)return l;if(!n||!a)return;this.configureRenderingSurface(n,a),this._drawingContext.drawImage(e,0,0,this._offscreenCanvas.width,this._offscreenCanvas.height);let i=await this._offscreenCanvas.convertToBlob({type:"image/webp",quality:.8}),r=URL.createObjectURL(i);return this.previewCache.set(t,r),t>this.highestCachedIndex&&(this.highestCachedIndex=t),r}configureRenderingSurface(e,t){this._offscreenCanvas.width=200,this._offscreenCanvas.height=t/e*200}clearPreviewCache(){this.previewCache.forEach(e=>URL.revokeObjectURL(e)),this.previewCache.clear(),this.inFlightPromises.clear()}resetOperationQueue(){this.jobs.current=void 0,this.jobs.pending=void 0}constructor(e,t){this.previewCache=new Map,this.inFlightPromises=new Map,this.jobs={current:void 0,pending:void 0},this.videoSyncController=new AbortController,this.lastCapturedSegment=-1,this.captureThrottleTimeout=null,this.highestCachedIndex=-1,this._dummyVideoElement=document.createElement("video"),this._offscreenCanvas=new OffscreenCanvas(0,0),this._drawingContext=this._offscreenCanvas.getContext("2d"),this.initializeDummyVideoElement(),t&&this.loadMediaSource(t+"&thumbnail=true"),this.videoElement=e,this._bindToVideoPlayer()}}var ii=n(90711),ir=n(55226),is=n(9242);let io=(0,eY.v)("SUBTITLE");class ic{selectTrackByLabel(e){var t,n,a;let l=null==(a=this.playbackInfo.mkvMetadata)||null==(n=a.subtitleTracks)||null==(t=n.find)?void 0:t.call(n,t=>t.name===e);l?this.selectTrack(l.number):(io.error("Track not found",e),this.setNoTrack())}setNoTrack(){var e,t,n;this.currentTrackNumber=-1,null==(e=this.libassRenderer)||e.setTrack(this.defaultSubtitleHeader),null==(n=this.libassRenderer)||null==(t=n.resize)||t.call(n)}selectTrack(e){var t,n,a,l,i,r,s,o,c;if(io.info("Track selection requested",e),this._init(),this.currentTrackNumber===e)return void io.info("Track already selected",e);if(-1===e){io.info("No track selected",e),this.setNoTrack();return}let d=null==(n=this._getTracks())||null==(t=n.find)?void 0:t.call(n,t=>t.info.number===e);if(io.info("Selecting track",e,d),this.videoElement.textTracks){for(let e of(io.info("Updating video element's textTracks",this.videoElement.textTracks),this.videoElement.textTracks))d&&e.id===d.info.number.toString()?e.mode="showing":e.mode="disabled";this.videoElement.textTracks.dispatchEvent(new Event("change"))}if(!d){io.info("Track not found",e),this.setNoTrack();return}let u=(null==(l=d.info.codecPrivate)||null==(a=l.slice)?void 0:a.call(l,0,-1))||this.defaultSubtitleHeader;this.currentTrackNumber=d.info.number,null==(i=this.libassRenderer)||i.setTrack(u);let m=null==(r=this.tracks[d.info.number])?void 0:r.events;if(m){for(let{assEvent:e}of(io.info("Found",m.size,"events for track",d.info.number),m.values()))null==(c=this.libassRenderer)||c.createEvent(e);null==(o=this.libassRenderer)||null==(s=o.resize)||s.call(o)}}onSubtitleEvent(e){let{isNew:t,assEvent:n}=this._recordSubtitleEvent(e);n&&this.libassRenderer&&t&&e.trackNumber===this.currentTrackNumber&&this.libassRenderer.createEvent(n)}onTrackAdded(e){var t,n;io.info("Subtitle track added",e),J.oR.info("Subtitle track added: ".concat(e.name)),this._addTrack(e),this._storeTrackStyles();let a=document.createElement("track");a.id=e.number.toString(),a.kind="subtitles",a.label=e.name||"",a.srclang=e.language||"eng",this.videoElement.appendChild(a),this._selectDefaultTrack(),this._init(),null==(n=this.libassRenderer)||null==(t=n.resize)||t.call(n)}destroy(){var e;for(let t in io.info("Destroying subtitle manager"),null==(e=this.libassRenderer)||e.destroy(),this.libassRenderer=null,this.tracks)this.tracks[t].events.clear();this.tracks={},this.currentTrackNumber=-1}_selectDefaultTrack(){var e,t,n,a,l;if(-1!==this.currentTrackNumber)return;let i=this._getTracks();if(!(null==i?void 0:i.length))return void this.setNoTrack();if(1===i.length)return void this.selectTrack(i[0].info.number);let r=null==i||null==(e=i.filter)?void 0:e.call(i,e=>e.info.language===this.settings.preferredSubtitleLanguage);if(null==r?void 0:r.length){let e=r.findIndex(e=>e.info.forced);this.selectTrack(r[e>=0?e:0].info.number);return}let s=null==i||null==(t=i.filter)?void 0:t.call(i,e=>"eng"===(e.info.language||"eng")||"en"===e.info.language);if(null==s?void 0:s.length){let e=s.findIndex(e=>e.info.forced||e.info.default);this.selectTrack(s[e>=0?e:0].info.number);return}this.selectTrack(null!=(l=null==i||null==(a=i[0])||null==(n=a.info)?void 0:n.number)?l:-1)}_addTrack(e){return this.tracks[e.number]={info:e,events:new Map,styles:{}},this.tracks[e.number]}_getTracks(){return Object.values(this.tracks).sort((e,t)=>e.info.number-t.info.number)}getSelectedTrack(){if(!this.videoElement.textTracks)return null;for(let e=0;e<this.videoElement.textTracks.length;e++)if("showing"===this.videoElement.textTracks[e].mode)return Number(this.videoElement.textTracks[e].id);return null}_storeTrackStyles(){var e,t,n,a;if(null==(t=this.playbackInfo)||null==(e=t.mkvMetadata)?void 0:e.subtitleTracks)for(let e of this.playbackInfo.mkvMetadata.subtitleTracks){let t=((null==(a=e.codecPrivate)||null==(n=a.slice)?void 0:n.call(a,0,-1))||this.defaultSubtitleHeader).replaceAll("\r\n","\n").split("\n").filter(e=>e.startsWith("Style:")),l=1,i={};for(let n of(this.tracks[e.number].styles=i,t)){let e=n.split("Style:")[1];(e=(e.split(",")[0]||"").trim())&&!i[e]&&(i[e]=l++)}this.tracks[e.number].styles=i}}__eventMapKey(e){var t,n,a,l,i,r,s,o;return"".concat(e.trackNumber,"-").concat(e.startTime,"-").concat(e.duration,"-").concat(null==(t=e.extraData)?void 0:t.style,"-").concat(null==(n=e.extraData)?void 0:n.name,"-").concat(null==(a=e.extraData)?void 0:a.marginL,"-").concat(null==(l=e.extraData)?void 0:l.marginR,"-").concat(null==(i=e.extraData)?void 0:i.marginV,"-").concat(null==(r=e.extraData)?void 0:r.effect,"-").concat(null==(s=e.extraData)?void 0:s.readOrder,"-").concat(null==(o=e.extraData)?void 0:o.layer)}_init(){var e,t,n;if(this.libassRenderer)return;io.info("Initializing libass renderer");let a=new URL("/jassub/jassub-worker.wasm",window.location.origin).toString(),l=new URL("/jassub/jassub-worker.js",window.location.origin).toString(),i=new URL("/jassub/jassub-worker-modern.wasm",window.location.origin).toString(),r=(0,ii.yU)("/jassub/jassub-worker.wasm.js"),s="/jassub/Roboto-Medium.ttf";for(let o of(this.libassRenderer=new is.default({video:this.videoElement,subContent:this.defaultSubtitleHeader,wasmUrl:a,workerUrl:l,legacyWasmUrl:r,modernWasmUrl:i,offscreenRender:!(0,ir.f8)()&&this.jassubOffscreenRender,prescaleFactor:.8,onDemandRender:!1,fonts:this.fonts,fallbackFont:"roboto medium",availableFonts:{"roboto medium":s},libassGlyphLimit:60500}),this.fonts=(null==(n=this.playbackInfo.mkvMetadata)||null==(t=n.attachments)||null==(e=t.filter(e=>"font"===e.type))?void 0:e.map(e=>"".concat((0,aC.M)(),"/api/v1/directstream/att/").concat(e.filename)))||[],this.fonts=[s,...this.fonts],this.fonts))this.libassRenderer.addFont(o)}_createAssEvent(e,t){var n,a,l,i,r,s,o,c,d,u,m,h,p,f;return{Start:e.startTime,Duration:e.duration,Style:String((null==(n=e.extraData)?void 0:n.style)?null==(i=this.tracks[e.trackNumber])||null==(l=i.styles)?void 0:l[null!=(h=null==(a=e.extraData)?void 0:a.style)?h:"Default"]:1),Name:null!=(p=null==(r=e.extraData)?void 0:r.name)?p:"",MarginL:(null==(s=e.extraData)?void 0:s.marginL)?Number(e.extraData.marginL):0,MarginR:(null==(o=e.extraData)?void 0:o.marginR)?Number(e.extraData.marginR):0,MarginV:(null==(c=e.extraData)?void 0:c.marginV)?Number(e.extraData.marginV):0,Effect:null!=(f=null==(d=e.extraData)?void 0:d.effect)?f:"",Text:e.text,ReadOrder:(null==(u=e.extraData)?void 0:u.readOrder)?Number(e.extraData.readOrder):1,Layer:(null==(m=e.extraData)?void 0:m.layer)?Number(e.extraData.layer):0,_index:t}}_recordSubtitleEvent(e){var t,n;let a=null==(t=this.tracks[e.trackNumber])?void 0:t.events;if(!a)return{isNew:!1,assEvent:null};let l=this.__eventMapKey(e);if(a.has(l))return{isNew:!1,assEvent:null==(n=a.get(l))?void 0:n.assEvent};let i=this._createAssEvent(e,a.size);return a.set(l,{event:e,assEvent:i}),{isNew:!0,assEvent:i}}constructor({videoElement:e,jassubOffscreenRender:t,playbackInfo:n,settings:a}){var l,i;if(this.libassRenderer=null,this.defaultSubtitleHeader="[Script Info]\nTitle: English (US)\nScriptType: v4.00+\nWrapStyle: 0\nPlayResX: 640\nPlayResY: 360\nScaledBorderAndShadow: yes\n\n[V4+ Styles]\nFormat: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding\nStyle: Default, Roboto Medium,24,&H00FFFFFF,&H000000FF,&H00000000,&H00000000,0,0,0,0,100,100,0,0,1,1.3,0,2,20,20,23,0\n[Events]\n\n",this.tracks={},this.currentTrackNumber=-1,this.fonts=[],this.videoElement=e,this.jassubOffscreenRender=t,this.playbackInfo=n,this.settings=a,!(null==(i=this.playbackInfo)||null==(l=i.mkvMetadata)?void 0:l.subtitleTracks))return;for(let e of this.playbackInfo.mkvMetadata.subtitleTracks)this._addTrack(e);this._storeTrackStyles(),this._selectDefaultTrack(),io.info("Text tracks",this.videoElement.textTracks),io.info("Tracks",this.tracks)}}var id=n(35089);let iu=(0,x.eU)(null);function im(e){let{chapterCues:t}=e,n=(0,m.md)(i$),l=(0,m.md)(iP),i=(0,m.md)(iD),r=(0,m.md)(iG),[s,o]=(0,m.fp)(iB),[c,d]=(0,m.fp)(iK),[u,p]=(0,m.fp)(i2),x=(0,m.Xr)(i6),v=(0,m.md)(aZ),g=(0,m.md)(a3),y=(0,m.Xr)(aD),[b,j]=(0,m.fp)(i4),[w,N]=(0,m.fp)(i5),[k,S]=(0,m.fp)(i3),E=h.useMemo(()=>r/i*100,[r]),C=h.useMemo(()=>{if(!(null==t?void 0:t.length))return[{width:100,percentageOffset:0,label:null,start:0,end:0}];let e=0;return t.toSorted((e,t)=>e.startTime-t.startTime).filter(e=>(e.startTime||e.endTime)&&!(e.endTime>0&&e.endTime<e.startTime)).map(t=>{var n,a;let l=null!=(n=t.startTime)?n:0,r=null!=(a=t.endTime)?a:i,s=(r-l)/i*100,o={width:s,percentageOffset:e,label:t.text||null,start:l,end:r};return e+=s,o})},[t,i]),[I,_]=h.useState(l/i*100);h.useEffect(()=>{_(l/i*100)},[l,i]);let T=function(e){let t=null,n=null,a=function(e){let t=e.map(e=>lg(e.label)).filter(Boolean);return t.includes("Intro")&&!t.includes("Opening")}(e);for(let l of e){let e=lg(l.label);if(t||a||"Opening"!==e||(t=l),!t&&a&&"Intro"===e&&(t=l),n||a||"Ending"!==e||(n=l),!n&&a&&"Outro"===e&&(n=l),t&&n)break}return{opening:t,ending:n}}(C);function A(e){c||o(0)}function D(e){let t=function(e){let t=e.currentTarget.getBoundingClientRect();return Math.max(0,Math.min(100,(e.clientX-t.left)/t.width*100))}(e);c&&(e.stopPropagation(),_(t)),o(t)}h.useEffect(()=>{var e,t;((null==(e=T.opening)?void 0:e.end)||(null==(t=T.ending)?void 0:t.end))&&(isNaN(i)||i<=1||(T.opening&&T.opening.end&&l>=T.opening.start&&l<T.opening.end?g&&!k?(console.log("auto skip",T.opening.end),x({type:"seekTo",payload:{time:T.opening.end}}),y({message:"Skipped OP",duration:1e3})):j(T.opening.end):j(0),T.ending&&T.ending.end&&l>=T.ending.start&&l<T.ending.end&&l<i?g&&!k?(console.log("auto skip",T.ending.end),x({type:"seekTo",payload:{time:T.ending.end}}),y({message:"Skipped ED",duration:1e3})):N(T.ending.end):N(0)))},[l,g,T,i,k]);let P=(0,m.Xr)(iu);return(0,a.jsxs)("div",{ref:e=>{P(e)},className:(0,f.cn)("vc-time-range","w-full relative group/vc-time-range z-[2] flex h-8","cursor-pointer outline-none"),role:"slider",tabIndex:0,"aria-valuemin":0,"aria-valuenow":0,"aria-valuetext":"0%","aria-orientation":"horizontal","aria-label":"Video playback time",onPointerDown:function(e){e.stopPropagation(),n&&0===e.button&&(e.currentTarget.setPointerCapture(e.pointerId),d(!0),p(n.paused),n.paused||n.pause(),D(e),null==n||n.dispatchEvent(new Event("seeking")))},onPointerUp:function(e){e.stopPropagation(),0===e.button&&(e.currentTarget.releasePointerCapture(e.pointerId),d(!1),x({type:"seekTo",payload:{time:i*s/100}}),u||null==n||n.play())},onPointerLeave:A,onPointerCancel:A,onPointerMove:D,children:[(0,a.jsx)(ig,{chapters:C}),C.map((e,t)=>(0,a.jsx)(ih,{idx:t,progressPercentage:I,bufferedPercentage:E,chapter:e,showMarker:t<C.length-1&&v},t))]})}function ih(e){let t,n,i,r,s,o,c,d,u,h,p,x,v,g,y,b,j,w,N,k=(0,l.c)(48),{idx:S,chapter:E,progressPercentage:C,bufferedPercentage:I,showMarker:_}=e,T=(0,m.md)(iD),A=(0,m.md)(iB),D=(0,m.Xr)(i6),P=(0,m.md)(aJ),M=!!A&&E.percentageOffset<=A&&E.percentageOffset+E.width>=A,L=function(e,t){let n=(t-e.percentageOffset)*(100/e.width);return(n<=0?-3:n>=100?100:n)-100};k[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,f.cn)("vc-time-range-chapter-segment","relative","w-full h-full flex items-center",i_&&"bg-yellow-500/10"),k[0]=t):t=k[0];let O="".concat(E.width,"%");k[1]!==O?(n={width:O},k[1]=O,k[2]=n):n=k[2];let R=M&&"h-2";k[3]!==R?(i=(0,f.cn)("vc-time-range-chapter","relative h-1 transition-[height] flex items-center justify-center overflow-hidden rounded-lg",R,i_&&"bg-yellow-500/50"),k[3]=R,k[4]=i):i=k[4];let F=S>0?"calc(100% - ".concat(1.5,"px)"):"100%",U=S>0?"".concat(3,"px"):"0px";k[5]!==F||k[6]!==U?(r={width:F,marginLeft:U},k[5]=F,k[6]=U,k[7]=r):r=k[7],k[8]===Symbol.for("react.memo_cache_sentinel")?(s=(0,f.cn)("vc-time-range-chapter-progress-bar","bg-white absolute w-full h-full left-0 transform-gpu z-[10]"),k[8]=s):s=k[8];let z=T>1?"".concat(L(E,C),"%"):"-100%";k[9]!==z?(o={"--tw-translate-x":z},k[9]=z,k[10]=o):o=k[10];let K=o;k[11]!==K?(c=(0,a.jsx)("div",{className:s,style:K}),k[11]=K,k[12]=c):c=k[12],k[13]===Symbol.for("react.memo_cache_sentinel")?(d=(0,f.cn)("vc-time-range-chapter-seeking-target-bar","bg-white/30 absolute w-full h-full left-0 transform-gpu z-[9]"),k[13]=d):d=k[13];let B=T>1?"".concat(L(E,A),"%"):"-100%";k[14]!==B?(u={"--tw-translate-x":B},k[14]=B,k[15]=u):u=k[15];let V=u;k[16]!==V?(h=(0,a.jsx)("div",{className:d,style:V}),k[16]=V,k[17]=h):h=k[17],k[18]===Symbol.for("react.memo_cache_sentinel")?(p=(0,f.cn)("vc-time-range-chapter-buffer-bar","bg-white/10 absolute w-full h-full left-0 transform-gpu z-[8]"),k[18]=p):p=k[18];let G=T>1?"".concat(L(E,I),"%"):"-100%";k[19]!==G?(x={"--tw-translate-x":G},k[19]=G,k[20]=x):x=k[20];let H=x;return k[21]!==H?(v=(0,a.jsx)("div",{className:p,style:H}),k[21]=H,k[22]=v):v=k[22],k[23]!==E.label||k[24]!==P?(g=!!lg(E.label)&&P&&"bg-blue-300/50",k[23]=E.label,k[24]=P,k[25]=g):g=k[25],k[26]!==g?(y=(0,f.cn)("vc-time-range-chapter-bar","bg-white/20 absolute left-0 w-full h-full z-[1]",g),k[26]=g,k[27]=y):y=k[27],k[28]!==y?(b=(0,a.jsx)("div",{className:y}),k[28]=y,k[29]=b):b=k[29],k[30]!==c||k[31]!==h||k[32]!==v||k[33]!==b||k[34]!==i||k[35]!==r?(j=(0,a.jsxs)("div",{className:i,style:r,children:[c,h,v,b]}),k[30]=c,k[31]=h,k[32]=v,k[33]=b,k[34]=i,k[35]=r,k[36]=j):j=k[36],k[37]!==D||k[38]!==E.percentageOffset||k[39]!==E.width||k[40]!==T||k[41]!==S||k[42]!==_?(w=_&&(0,a.jsx)("button",{type:"button",onPointerDown:ix,onPointerUp:ip,onClick:e=>{e.stopPropagation(),D({type:"seekTo",payload:{time:T*(E.percentageOffset+E.width)/100}})},className:(0,f.cn)("vc-time-range-chapter-marker","absolute top-0 right-0 size-4 flex items-center justify-center -translate-y-1/2 translate-x-1/2 cursor-pointer z-[20] "),style:{right:"-".concat(1.5,"px")},"aria-label":"Seek to end of chapter ".concat(S+1),tabIndex:-1,children:(0,a.jsx)(aa.akn,{className:"size-2.5 text-white/20 hover:text-white/100 transition-colors duration-100"})}),k[37]=D,k[38]=E.percentageOffset,k[39]=E.width,k[40]=T,k[41]=S,k[42]=_,k[43]=w):w=k[43],k[44]!==n||k[45]!==j||k[46]!==w?(N=(0,a.jsxs)("div",{className:t,style:n,children:[j,w]}),k[44]=n,k[45]=j,k[46]=w,k[47]=N):N=k[47],N}function ip(e){return e.stopPropagation()}function ix(e){return e.stopPropagation()}let iv=(0,eY.v)("VIDEO CORE / TIME PREVIEW");function ig(e){let t,n,i,r,s,o,c,d,u=(0,l.c)(26),{chapters:p}=e;(0,m.md)(i$);let x=(0,m.md)(iD),v=(0,m.md)(iW),g=(0,m.md)(iB),y=(0,m.md)(iK);(0,m.Xr)(i6);let b=(0,m.md)(i0),j=(0,m.md)(iu),[w,N]=h.useState(null),k=x*g/100;if(u[0]!==p||u[1]!==g){let e;u[3]!==g?(e=e=>e.percentageOffset<=g&&e.percentageOffset+e.width>=g,u[3]=g,u[4]=e):e=u[4],n=p.find(e),u[0]=p,u[1]=g,u[2]=n}else n=u[2];let S=n;t=null==S?void 0:S.label,u[5]!==x||u[6]!==b||u[7]!==j?(i=async e=>{if(!b||!x||!j)return;N(null),j.removeAttribute("data-preview-image");let t=j.getBoundingClientRect(),n=Math.max(0,Math.min(1,(e.clientX-t.left)/t.width))*x;if(n>=0&&n<=x){let e=Math.floor(n/4);try{let t=await b.retrievePreviewForSegment(e);t&&(j.setAttribute("data-preview-image",t),N(t))}catch(e){iv.error("Failed to get thumbnail",e)}}},u[5]=x,u[6]=b,u[7]=j,u[8]=i):i=u[8];let E=i;u[9]!==E||u[10]!==j?(r=()=>{if(!j)return;let e=()=>{j.removeAttribute("data-preview-image"),N(null)};return j.addEventListener("mouseleave",e),j.addEventListener("mousemove",E),()=>{j.removeEventListener("mouseleave",e),j.removeEventListener("mousemove",E)}},s=[E,j],u[9]=E,u[10]=j,u[11]=r,u[12]=s):(r=u[11],s=u[12]),h.useEffect(r,s);let C=!v&&b&&(y||!!k)&&k<=4*b.getLastestCachedIndex();return u[13]!==x||u[14]!==w||u[15]!==C||u[16]!==k?(o=C&&(0,a.jsx)("div",{className:(0,f.cn)("absolute bottom-full aspect-video overflow-hidden rounded-md bg-black border border-white/50"),style:{left:"clamp(".concat(100,"px, ").concat(k/x*100,"%, calc(100% - ").concat(100,"px))"),width:"200px",transform:"translateX(-50%) translateY(-54%)"},children:!!w&&(0,a.jsx)(id.default,{src:w||"",alt:"Preview",fill:!0,sizes:"200px",className:"object-cover rounded-md",decoding:"async",loading:"lazy"})}),u[13]=x,u[14]=w,u[15]=C,u[16]=k,u[17]=o):o=u[17],u[18]!==t||u[19]!==x||u[20]!==y||u[21]!==k?(c=(y||!!k)&&(0,a.jsxs)("div",{className:(0,f.cn)("absolute bottom-full mb-3 px-2 py-1 bg-black/70 text-white text-center text-sm rounded-md","whitespace-nowrap z-20 pointer-events-none",""),style:{left:"".concat(k/x*100,"%"),transform:"translateX(-50%)"},children:[t&&(0,a.jsx)("p",{className:"text-xs font-medium max-w-2xl truncate",children:t}),(0,a.jsx)("p",{children:ly(k)}),(0,a.jsx)("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-black/70"})]}),u[18]=t,u[19]=x,u[20]=y,u[21]=k,u[22]=c):c=u[22],u[23]!==o||u[24]!==c?(d=(0,a.jsxs)(a.Fragment,{children:[o,c]}),u[23]=o,u[24]=c,u[25]=d):d=u[25],d}function iy(e){let t,n,i,r,s,o=(0,l.c)(13),{children:c}=e,d=(0,m.md)(iX),u=(0,m.md)(iq),h=(0,m.md)(iW),p=(0,m.md)(lk),x=(d||u||p)&&"opacity-100",v=h&&"top-0";o[0]!==x||o[1]!==v?(t=(0,f.cn)("vc-control-bar-top-section","top-8 absolute left-0 w-full py-4 px-5 duration-200 transition-opacity opacity-0 z-[999]",x,v),o[0]=x,o[1]=v,o[2]=t):t=o[2],o[3]!==c||o[4]!==t?(n=(0,a.jsx)("div",{"data-vc-control-bar-top-section":!0,className:t,children:c}),o[3]=c,o[4]=t,o[5]=n):n=o[5];let g=h&&u&&"opacity-100";return o[6]!==g?(i=(0,f.cn)("vc-control-bar-top-gradient pointer-events-none","absolute top-0 left-0 right-0 w-full z-[5] transition-opacity duration-300 opacity-0","bg-gradient-to-b from-black/60 to-transparent","h-20",g),o[6]=g,o[7]=i):i=o[7],o[8]!==i?(r=(0,a.jsx)("div",{className:i}),o[8]=i,o[9]=r):r=o[9],o[10]!==n||o[11]!==r?(s=(0,a.jsxs)(a.Fragment,{children:[n,r]}),o[10]=n,o[11]=r,o[12]=s):s=o[12],s}function ib(e){var t,n,i,r;let s,o,c,d,u=(0,l.c)(10),{state:h}=e;(0,m.md)(iX);let p=(0,m.md)(iq),x=(0,m.md)(iW),v=(0,m.md)(lk);if(x)return null;let g=(p||v)&&"opacity-100";u[0]!==g?(s=(0,f.cn)("transition-opacity duration-200 opacity-0",g),u[0]=g,u[1]=s):s=u[1];let y=null==(n=h.playbackInfo)||null==(t=n.episode)?void 0:t.displayTitle;u[2]!==y?(o=(0,a.jsx)("p",{className:"text-white font-bold text-lg",children:y}),u[2]=y,u[3]=o):o=u[3];let b=null==(r=h.playbackInfo)||null==(i=r.episode)?void 0:i.episodeTitle;return u[4]!==b?(c=(0,a.jsx)("p",{className:"text-white/50 text-base !font-normal",children:b}),u[4]=b,u[5]=c):c=u[5],u[6]!==s||u[7]!==o||u[8]!==c?(d=(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:s,children:[o,c]})}),u[6]=s,u[7]=o,u[8]=c,u[9]=d):d=u[9],d}var ij=n(24685),iw=n(25264),iN=n(31939),ik=n(62361),iS=n(49927),iE=n(61704);let iC=(0,eO.lR)(),iI=(0,eY.v)("VIDEO CORE"),i_=!1,iT=(0,x.eU)({width:1,height:1}),iA=(0,x.eU)({width:0,height:0}),iD=(0,x.eU)(1),iP=(0,x.eU)(0),iM=(0,x.eU)(1),iL=(0,x.eU)(0),iO=(0,x.eU)(!1),iR=(0,x.eU)(!1),iF=(0,x.eU)(1);(0,x.eU)(0);let iU=(0,x.eU)(!1),iz=(0,iN.C)([lp],e=>null!==e),iK=(0,x.eU)(!1),iB=(0,x.eU)(0),iV=(0,x.eU)(null),iG=(0,iN.C)([iV,iP],(e,t)=>{if(!e)return 0;let n=0;for(let a=0;a<e.length;a++){let l=e.start(a),i=e.end(a);if(t>=l&&t<=i)return i;i>=t&&n>i&&(n=i)}return n}),iH=(0,x.eU)(!1),iq=(0,x.eU)(!0),iW=(0,x.eU)(!1),iQ=(0,iN.C)([lk,ll],(e,t)=>e||!!t);(0,x.eU)({x:0,y:0});let iX=(0,x.eU)(!0),i$=(0,x.eU)(null),iY=(0,x.eU)(null),iZ=(0,x.eU)(null),iJ=(0,x.eU)(null),i0=(0,x.eU)(null),i1=(0,x.eU)(null),i2=(0,x.eU)(!1),i3=(0,x.eU)(0),i4=(0,x.eU)(null),i5=(0,x.eU)(null),i6=(0,x.eU)(null,(e,t,n)=>{let a=e(i$),l=e(iD),i=0;if(a)switch(n.type){case"seekTo":if(isNaN(l)||l<=1)return;a.currentTime=i=Math.min(l,Math.max(0,n.payload.time)),t(iP,i),n.payload.flashTime&&t(aD,{message:"".concat(ly(i)," / ").concat(ly(l)),type:"message"});break;case"seek":if(isNaN(l)||l<=1)return;a.currentTime=i=Math.min(l,Math.max(0,e(iP)+n.payload.time)),t(iP,i),n.payload.flashTime&&t(aD,{message:"".concat(ly(i)," / ").concat(ly(l)),type:"message"});break;case"togglePlay":a.paused?a.play():a.pause();break;case"restoreProgress":t(i3,Math.max(0,n.payload.time))}});function i8(e){let t,n=(0,l.c)(2),{children:i}=e;return n[0]!==i?(t=(0,a.jsx)(iC.Provider,{children:i}),n[0]=i,n[1]=t):t=n[1],t}function i7(e){var t,n,i,r,s,o,d,u,p,x,v,g,y,b,j,w,k,S,E,C,I,_,T;let A=(0,eU.v1)(),{state:D,aniSkipData:P,onTerminateStream:M,onEnded:L,onPlay:O,onCompleted:R,onPause:F,onTimeUpdate:U,onLoadedData:z,onLoadedMetadata:K,onVolumeChange:B,onSeeking:V,onSeeked:G,onError:H,onPlaybackRateChange:q,onFileUploaded:W,...Q}=e,X=(0,h.useRef)(null),$=(0,h.useRef)(null),Y=(0,m.Xr)(i$),Z=(0,m.Xr)(iA);!function(e){let t,n,a=(0,l.c)(16),i=(0,m.md)(i$),r=(0,m.Xr)(iT),s=(0,m.Xr)(iD),o=(0,m.Xr)(iP),c=(0,m.Xr)(iM),d=(0,m.Xr)(iL),u=(0,m.Xr)(iO),p=(0,m.Xr)(iR),f=(0,m.Xr)(iF),x=(0,m.Xr)(iV),v=(0,m.Xr)(iH),g=(0,m.Xr)(iq);a[0]!==x||a[1]!==u||a[2]!==o||a[3]!==s||a[4]!==v||a[5]!==p||a[6]!==g||a[7]!==c||a[8]!==d||a[9]!==r||a[10]!==f||a[11]!==i?(t=()=>{if(!i)return;let e=()=>{r({width:i.videoWidth,height:i.videoHeight}),s(i.duration),o(i.currentTime),c(i.playbackRate),d(i.readyState),u(i.readyState<3&&!i.paused),p(i.muted),f(i.volume),x(i.buffered.length>0?i.buffered:null),v(i.ended),g(i.paused)},t=["timeupdate","loadedmetadata","progress","play","pause","ratechange","volumechange","ended","loadeddata","resize","waiting","canplay","stalled"];return t.forEach(t=>i.addEventListener(t,e)),e(),()=>{console.log("Removing video event listeners"),t.forEach(t=>i.removeEventListener(t,e))}},a[0]=x,a[1]=u,a[2]=o,a[3]=s,a[4]=v,a[5]=p,a[6]=g,a[7]=c,a[8]=d,a[9]=r,a[10]=f,a[11]=i,a[12]=t):t=a[12],a[13]!==e||a[14]!==i?(n=[i,e],a[13]=e,a[14]=i,a[15]=n):n=a[15],(0,h.useEffect)(t,n)}(D.playbackInfo),function(){var e,t,n,a,i,r,s,o,c,d,u,p,f,x;let v,g,y,b,j,w,N,k,S=(0,l.c)(35),[,E]=(0,m.fp)(l9),C=(0,m.md)(aH.k),I=C.playbackInfo,_=null==(e=C.playbackInfo)?void 0:e.streamType,T=null==(n=C.playbackInfo)||null==(t=n.media)?void 0:t.id,A=null==(a=C.playbackInfo)?void 0:a.streamType,D=(null==I||null==(i=I.episode)?void 0:i.progressNumber)||0,{data:P}=(0,lJ._8)(T),{data:M,refetch:L}=(0,lZ.L)(T);S[0]!==T||S[1]!==L?(v=()=>{T&&L()},S[0]=T,S[1]=L,S[2]=v):v=S[2],S[3]!==T||S[4]!==C.playbackInfo?(g=[C.playbackInfo,T],S[3]=T,S[4]=C.playbackInfo,S[5]=g):g=S[5],(0,l8.A)(v,g),null==P||P.episodes,null==M||M.episodes;e:{let e;if(!M){let e;S[6]===Symbol.for("react.memo_cache_sentinel")?(e=[],S[6]=e):e=S[6],y=e;break e}if("localfile"===_){let e;S[7]!==(null==P?void 0:P.episodes)?(e=null!=(s=null==P||null==(r=P.episodes)?void 0:r.filter(ie))?s:[],S[7]=null==P?void 0:P.episodes,S[8]=e):e=S[8],y=e;break e}S[9]!==(null==M?void 0:M.episodes)?(e=null!=(o=null==M?void 0:M.episodes)?o:[],S[9]=null==M?void 0:M.episodes,S[10]=e):e=S[10],y=e}let O=y;S[11]!==D||S[12]!==O?(b=null!=(d=null==(c=O.find)?void 0:c.call(O,e=>e.progressNumber===D))?d:null,S[11]=D,S[12]=O,S[13]=b):b=S[13];let R=b;S[14]!==D||S[15]!==O?(j=null!=(p=null==(u=O.find)?void 0:u.call(O,e=>e.progressNumber===D-1))?p:null,S[14]=D,S[15]=O,S[16]=j):j=S[16];let F=j;S[17]!==D||S[18]!==O?(w=null!=(x=null==(f=O.find)?void 0:f.call(O,e=>e.progressNumber===D+1))?x:null,S[17]=D,S[18]=O,S[19]=w):w=S[19];let U=w;S[20]!==P||S[21]!==R||S[22]!==O||S[23]!==A||S[24]!==U||S[25]!==I||S[26]!==F||S[27]!==E?(N=()=>{if(!I||!R||!O.length||!P)return void E(null);E({type:A,episodes:null!=O?O:[],currentEpisode:R,previousEpisode:F,nextEpisode:U,animeEntry:P})},S[20]=P,S[21]=R,S[22]=O,S[23]=A,S[24]=U,S[25]=I,S[26]=F,S[27]=E,S[28]=N):N=S[28],S[29]!==P||S[30]!==R||S[31]!==U||S[32]!==I||S[33]!==F?(k=[P,I,R,F,U],S[29]=P,S[30]=R,S[31]=U,S[32]=I,S[33]=F,S[34]=k):k=S[34],h.useEffect(N,k)}();let ee=(0,h.useRef)(!1),et=(0,h.useRef)(null),[,en]=(0,m.fp)(iY),[ea,el]=(0,m.fp)(iZ),[ei,er]=(0,m.fp)(iJ),[es,eo]=(0,m.fp)(i0),[ec,ed]=(0,m.fp)(i1),[eu,em]=(0,m.fp)(lf),eh=(0,m.Xr)(lp),[ep,ef]=(0,m.fp)(aW),ex=(0,m.Xr)(iU),[ev,eg]=(0,m.fp)(lX),ey=(0,m.Xr)(i6),eb=(0,m.md)(aX),[ej,ew]=(0,m.fp)(iW),[eN,ek]=(0,m.fp)(iX),[eS,eE]=(0,m.fp)(iO),eC=(0,m.md)(iD);(0,m.md)(iU);let eI=(0,m.md)(iq);(0,m.md)(iL);let e_=(0,m.md)(a0),eT=(0,m.md)(iz),eA=(0,m.Xr)(aD),eD=(0,m.Xr)(i6),eP=(0,m.md)(iQ),[eM,eL]=(0,m.fp)(i4),[eR,ez]=(0,m.fp)(i5),[eB]=(0,m.fp)(a1),[eV]=(0,m.fp)(a2),[eG]=(0,m.fp)(a3),[eH]=(0,m.fp)(a4),[eq]=(0,m.fp)(a5),[eW,eQ]=(0,m.fp)(a6),{mutate:eX}=(0,aI.sq)(),{mutate:e$}=(0,aI.Bv)(),{mutate:eY}=(0,aI.P6)();h.useEffect(()=>{let e=setInterval(()=>{var e,t,n,a,l,i,r,s,o,c;X.current&&(null==A||null==(t=A.settings)||null==(e=t.discord)?void 0:e.enableRichPresence)&&(null==A||null==(a=A.settings)||null==(n=a.discord)?void 0:n.enableAnimeRichPresence)&&e$({progress:Math.floor(null!=(s=null==(l=X.current)?void 0:l.currentTime)?s:0),duration:Math.floor(null!=(o=null==(i=X.current)?void 0:i.duration)?o:0),paused:null!=(c=null==(r=X.current)?void 0:r.paused)&&c})},6e3);return()=>clearInterval(e)},[null==A||null==(t=A.settings)?void 0:t.discord,X.current]);let[eZ,{width:eJ,height:e0}]=(0,iE.A)();h.useEffect(()=>{Z({width:eJ,height:e0})},[eJ,e0]);let e1=(0,eK.jE)();function e2(){var e,t,n;(null==X||null==(e=X.current)?void 0:e.paused)?(null==X||null==(t=X.current)||t.play(),null==O||O(),eA({message:"PLAY",type:"icon"})):(null==X||null==(n=X.current)||n.pause(),null==F||F(),eA({message:"PAUSE",type:"icon"}))}h.useEffect(()=>{e1.invalidateQueries({queryKey:[eF.S.CONTINUITY.GetContinuityWatchHistory.key]}),e1.invalidateQueries({queryKey:[eF.S.CONTINUITY.GetContinuityWatchHistoryItem.key]}),D.playbackInfo&&D.playbackInfo.id===et.current||eY()},[D.playbackInfo]),h.useEffect(()=>{D.active&&X.current&&D.playbackInfo&&setTimeout(()=>{var e;null==(e=X.current)||e.focus()},100)},[D.active]),(0,ad.w5)(()=>{if(!D.playbackInfo){var e,t,n,a,l;iI.info("Cleaning up"),X.current&&(X.current.pause(),X.current.removeAttribute("src"),X.current.load(),X.current=null),Y(null),null==ea||null==(e=ea.destroy)||e.call(ea),el(null),null==es||null==(t=es.cleanup)||t.call(es),eo(null),er(null),null==ec||null==(n=ec.destroy)||n.call(ec),ed(null),null==eu||null==(a=eu.destroy)||a.call(eu),em(null),eh(null),null==ep||null==(l=ep.destroy)||l.call(ep),ef(null),ex(!1),ev&&(ev.setVideo(null),ev.destroy()),eg(null),et.current=null,X.current=null}D.playbackInfo&&(!et.current||D.playbackInfo.id!==et.current)&&(iI.info("New stream loaded"),lb(X.current))},[D.playbackInfo,X.current]);let e3=null==D||null==(r=D.playbackInfo)||null==(i=r.streamUrl)||null==(n=i.replace)?void 0:n.call(i,"{{SERVER_URL}}",(0,aC.M)()),[e4,e5]=(0,m.fp)(aO),{playEpisode:e6}=it(),[e8,e7]=h.useState(!1);h.useEffect(()=>{if(eP)return void e7(!0);let e=setTimeout(()=>{e7(!1)},800);return()=>{clearTimeout(e)}},[eP]);let e9=h.useRef(0),te=e=>{if(iI.info("Video clicked"),"click"===e.type&&(e8||e2(),setTimeout(()=>{ek(!1)},100)),"contextmenu"===e.type){let e=Date.now();e9.current&&e-e9.current<500&&(null==ep||ep.toggleFullscreen()),e9.current=e}};h.useEffect(()=>{X.current&&void 0!==eH&&eH!==X.current.volume&&(X.current.volume=eH)},[eH,X.current]),h.useEffect(()=>{X.current&&void 0!==eq&&eq!==X.current.muted&&(X.current.muted=eq)},[eq,X.current]),h.useEffect(()=>{X.current&&void 0!==eW&&eW!==X.current.playbackRate&&(X.current.playbackRate=eW)},[eW,X.current]),h.useEffect(()=>{eu&&X.current&&D.playbackInfo&&(eu.setVideo(X.current,D.playbackInfo),ea&&eu.setSubtitleManager(ea))},[eu,ea,X.current,D.playbackInfo]),h.useEffect(()=>{ep&&$.current&&ep.setContainer($.current)},[ep,$.current]),h.useEffect(()=>{ev&&X.current&&D.playbackInfo&&D.active?(ev.setVideo(X.current),ev.setPlaybackInfo(D.playbackInfo),ev.activate()):ev&&!D.active&&(iI.info("Video inactive, deactivating media session"),ev.deactivate())},[ev,X.current,D.playbackInfo,D.active,e6]),h.useEffect(()=>()=>{iI.info("VideoCore unmounting, cleaning up media session"),ev&&(ev.setVideo(null),ev.destroy())},[ev]);let tt=h.useRef(null),tn=h.useRef({x:0,y:0}),ta=(0,h.useMemo)(()=>{var e,t,n,a,l,i;if(null==(n=D.playbackInfo)||null==(t=n.mkvMetadata)||null==(e=t.chapters)?void 0:e.length){let e=lv(D.playbackInfo.mkvMetadata.chapters,eC);return iI.info("Chapter cues from MKV",e),e}if((null==P||null==(a=P.op)?void 0:a.interval)&&eC>0){let e=lv(function(e,t,n){var a,l,i,r,s,o,c,d,u,m,h;if(!(null==e||null==(a=e.op)?void 0:a.interval)||t<=0)return[];let p=[];return((null==e||null==(l=e.op)?void 0:l.interval)&&p.push({uid:91,start:e.op.interval.startTime>5?e.op.interval.startTime:0,end:e.op.interval.endTime,text:"Opening"}),(null==e||null==(i=e.ed)?void 0:i.interval)&&p.push({uid:92,start:e.ed.interval.startTime,end:e.ed.interval.endTime,text:"Ending"}),0===p.length)?[]:((null==(s=e.op)||null==(r=s.interval)?void 0:r.startTime)>5&&p.push({uid:90,start:0,end:e.op.interval.startTime,text:"Prologue"}),p.push({uid:93,start:(null==(c=e.op)||null==(o=c.interval)?void 0:o.endTime)||0,end:(null==(u=e.ed)||null==(d=u.interval)?void 0:d.startTime)||t,text:"MOVIE"!==n?"Episode":"Movie"}),(null==(h=e.ed)||null==(m=h.interval)?void 0:m.endTime)&&e.ed.interval.endTime<t-5&&p.push({uid:94,start:e.ed.interval.endTime,end:t,text:t-e.ed.interval.endTime>30?"Ending":"Preview"}),p.sort((e,t)=>e.start-t.start),p.length>0&&(p[p.length-1].end=t),p=p.map((e,n)=>({...e,start:1e6*e.start,end:e.end?n===p.length-1?1e6*t:1e6*e.end:void 0})))}(P,eC,null==D||null==(i=D.playbackInfo)||null==(l=i.media)?void 0:l.format),eC);return iI.info("Chapter cues from AniSkip",e),e}return[]},[null==(o=D.playbackInfo)||null==(s=o.mkvMetadata)?void 0:s.chapters,null==P||null==(d=P.op)?void 0:d.interval,null==P||null==(u=P.ed)?void 0:u.interval,eC,null==D||null==(x=D.playbackInfo)||null==(p=x.media)?void 0:p.format]),ti=(0,h.useCallback)(async e=>{var t,n,a,l;e.preventDefault(),iI.info("Upload event",e);let i=[...null!=(a=null==(t=null!=(n=e.dataTransfer)?n:e.clipboardData)?void 0:t.items)?a:[]],r=i.filter(e=>"file"===e.kind).map(e=>e.getAsFile()).filter(e=>null!==e);if(r.length>0){for(let e of r)if(e&&(l=e.name,/\.srt$|\.ass$|\.ssa$|\.vtt$|\.txt$|\.ttml$|\.stl$/i.test(l))){let t=await e.text();W({name:e.name,content:t})}}else{let e=i.filter(e=>"string"===e.kind&&"text/plain"===e.type);e.length>0&&e[0].getAsString(e=>{iI.info("Uploading subtitle content from clipboard");let t=function(e){let t=e.trim();return/^\[Script Info\]/im.test(t)||/^\[V4\+ Styles\]/im.test(t)||/^\[V4 Styles\]/im.test(t)?"ass":/^(?:\uFEFF)?WEBVTT\b/im.test(t)?"vtt":/^<\?xml[\s\S]*?<tt[:\s>]/im.test(t)||/^<tt[:\s>]/im.test(t)?"ttml":/^\{\d+\}/m.test(t)?"stl":/^\d+\s*\n\s*\d{2}:\d{2}:\d{2},\d{3}\s*-->\s*\d{2}:\d{2}:\d{2},\d{3}/m.test(t)||/\d{2}:\d{2}:\d{2},\d{3}\s*-->\s*\d{2}:\d{2}:\d{2},\d{3}/.test(t)?"srt":/\d{2}:\d{2}:\d{2}\.\d{3}\s*-->\s*\d{2}:\d{2}:\d{2}\.\d{3}/.test(t)?"vtt":/\d{2}:\d{2}:\d{2},\d{3}\s*-->\s*\d{2}:\d{2}:\d{2},\d{3}/.test(t)?"srt":"unknown"}(e);if(iI.info("Detected subtitle type",t),"unknown"===t){J.oR.error("Unknown subtitle type"),iI.info("Unknown subtitle type, skipping");return}W({name:"PLACEHOLDER.".concat(t),content:e})})}},[]);function tr(e){e.preventDefault()}(0,h.useEffect)(()=>{let e=$.current;if(e&&D.active)return e.addEventListener("paste",ti),e.addEventListener("drop",ti),e.addEventListener("dragover",tr),e.addEventListener("dragenter",tr),()=>{e.removeEventListener("paste",ti),e.removeEventListener("drop",ti),e.removeEventListener("dragover",tr),e.removeEventListener("dragenter",tr)}},[ti,D.active]);let[ts,to]=(0,m.fp)(i3);return h.useEffect(()=>{if(ec&&ts&&("off"===e4||null!==ec.canvas?(eA({message:"Progress restored",duration:1500}),eD({type:"seekTo",payload:{time:ts}})):"off"!==e4&&(eA({message:"Restoring progress",duration:1500}),ec.registerOnCanvasCreatedOnce(()=>{eD({type:"seekTo",payload:{time:ts}})})),to(0),eV)){var e;null==(e=X.current)||e.play()}},[ec,e4,ts,eV]),(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(eO.Ui,{atoms:[l3.N7,l3.Io,ij.l],children:[(0,a.jsx)(aR,{}),(0,a.jsx)(le,{}),D.active&&!ej&&(0,a.jsx)(iS.jp,{}),(0,a.jsx)(iw.d5,{isNativePlayerComponent:"overlay",show:D.active&&ej}),(0,a.jsxs)(lQ,{open:D.active,onOpenChange:e=>{e||(ej?M():ew(!0))},borderToBorder:!0,miniPlayer:ej,size:ej?"md":"full",side:ej?"right":"bottom",contentClass:(0,f.cn)("p-0 m-0",!ej&&"h-full"),allowOutsideInteraction:!0,overlayClass:(0,f.cn)(ej&&"hidden"),hideCloseButton:!0,closeClass:(0,f.cn)("z-[99]",tJ.X&&!ej&&"top-8",ej&&"left-4"),"data-native-player-drawer":!0,onMiniPlayerClick:()=>{e2()},children:[(0,a.jsx)(iw.d5,{isNativePlayerComponent:"top-section",show:!ej&&!((null==(v=D.playbackInfo)?void 0:v.streamUrl)&&!D.loadingState)}),(null==D?void 0:D.playbackError)&&(0,a.jsx)("div",{className:"h-full w-full bg-black/80 flex items-center justify-center z-[200] absolute p-4",children:(0,a.jsxs)("div",{className:"text-white text-center",children:[ej?(0,a.jsx)("h1",{className:(0,f.cn)("text-2xl font-bold",ej&&"text-lg"),children:"Playback Error"}):(0,a.jsx)(tS.D,{title:"Playback Error"}),(0,a.jsx)("p",{className:(0,f.cn)("text-base text-white/50",ej&&"text-sm max-w-lg mx-auto"),children:D.playbackError||"An error occurred while playing the stream. Please try again later."})]})}),(0,a.jsx)("div",{ref:e=>{$.current=e,en(e)},className:(0,f.cn)("relative w-full h-full bg-black overflow-clip flex items-center justify-center",!eN&&!ej&&"cursor-none"),onPointerMove:e=>{let{x:t,y:n}=e.nativeEvent,a=t-tn.current.x,l=n-tn.current.y;15>Math.abs(a)&&15>Math.abs(l)||((null==tt?void 0:tt.current)&&clearTimeout(tt.current),ek(!0),tt.current=setTimeout(()=>{eP||ek(!1)},1e3),tn.current={x:t,y:n})},children:(null==(g=D.playbackInfo)?void 0:g.streamUrl)&&!D.loadingState?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(lt,{videoRef:X,active:D.active,chapterCues:null!=ta?ta:[],introStartTime:null==P||null==(b=P.op)||null==(y=b.interval)?void 0:y.startTime,introEndTime:null==P||null==(w=P.op)||null==(j=w.interval)?void 0:j.endTime,endingStartTime:null==P||null==(S=P.ed)||null==(k=S.interval)?void 0:k.startTime,endingEndTime:null==P||null==(C=P.ed)||null==(E=C.interval)?void 0:E.endTime}),(0,a.jsx)(aP,{}),eS&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center z-[50] pointer-events-none",children:(0,a.jsx)("div",{className:"bg-black/20 backdrop-blur-sm rounded-full p-4",children:(0,a.jsx)(tl.zhB,{className:"size-12 text-white animate-spin"})})}),eN&&(0,a.jsxs)(a.Fragment,{children:[!!eM&&!ej&&(0,a.jsx)("div",{className:"absolute left-5 bottom-28 z-[60] native-player-hide-on-fullscreen",children:(0,a.jsx)(N.$n,{size:"sm",intent:"gray-basic",onClick:e=>{e.stopPropagation(),ey({type:"seekTo",payload:{time:eM||0}})},onPointerMove:e=>e.stopPropagation(),children:"Skip Opening"})}),!!eR&&!ej&&(0,a.jsx)("div",{className:"absolute right-5 bottom-28 z-[60] native-player-hide-on-fullscreen",children:(0,a.jsx)(N.$n,{size:"sm",intent:"gray-basic",onClick:e=>{e.stopPropagation(),ey({type:"seekTo",payload:{time:eR||0}})},onPointerMove:e=>e.stopPropagation(),children:"Skip Ending"})})]}),(0,a.jsx)("div",{className:"relative w-full h-full flex items-center justify-center",onClick:te,onContextMenu:te,children:(0,a.jsx)("video",{"data-video-core-element":!0,crossOrigin:"anonymous",preload:"auto",src:e3,ref:e=>{X.current=e,e&&eZ(e),Y(e)},onLoadedMetadata:e=>{var t,n,a,l,i,r,s,o,c,d,u,m,h,p,f,x,v,g,y,b,j,w,N,k,S,E,C;if(null==K||K(),!X.current)return;let I=X.current;if(iI.info("Loaded metadata",I.duration),iI.info("Audio tracks",I.audioTracks),iI.info("Text tracks",I.textTracks),iI.info("Subtitles changed",null==(S=X.current)?void 0:S.textTracks),X.current){let e=!1;for(let t=0;t<X.current.textTracks.length;t++){let n=X.current.textTracks[t];"showing"===n.mode&&(null==ea||ea.selectTrack(Number(n.id)),e=!0)}e||null==ea||ea.setNoTrack()}if(iI.info("Audio changed",null==(E=X.current)?void 0:E.audioTracks),null==(C=X.current)?void 0:C.audioTracks)for(let e=0;e<X.current.audioTracks.length;e++){let t=X.current.audioTracks[e];if(t.enabled){null==ei||ei.selectTrack(Number(t.id));break}}if(ey({type:"seek",payload:{time:-1}}),ee.current=!1,D.playbackInfo&&(et.current=D.playbackInfo.id,(null==(t=D.playbackInfo)?void 0:t.mkvMetadata)&&(el(e=>(e&&e.destroy(),new ic({videoElement:I,playbackInfo:D.playbackInfo,jassubOffscreenRender:!0,settings:eb}))),er(new aG({videoElement:I,playbackInfo:D.playbackInfo,settings:eb,onError:e=>{iI.error("Audio manager error",e),null==H||H(e)}}))),ed(e=>(e&&e.destroy(),new aB({videoElement:I,settings:eb,onFallback:e=>{eA({message:e,duration:2e3})},onOptionChanged:e=>{console.warn("here",e),e5(e)}}))),em(e=>{e&&e.destroy();let t=new lx(e=>{eh(e)});return t.setVideo(I,D.playbackInfo),t}),ef(e=>(e&&e.destroy(),new aQ(e=>{ex(e)}))),eg(e=>{e&&e.destroy();let t=new lY;return t.on("media-play-request",()=>{var e;(null==(e=X.current)?void 0:e.paused)&&X.current.play().catch(e=>{iI.error("Failed to play video from media session",e)})}),t.on("media-pause-request",()=>{X.current&&!X.current.paused&&X.current.pause()}),t.on("media-seek-request",e=>{let{seekTime:t}=e.detail;ey({type:"seekTo",payload:{time:t}})}),t.setPlaybackInfo(D.playbackInfo),t.setVideo(I),t}),iI.info("Initializing preview manager"),eo(e=>(e&&e.cleanup(),new il(I,e3))),(null==A||null==(a=A.settings)||null==(n=a.discord)?void 0:n.enableRichPresence)&&(null==A||null==(i=A.settings)||null==(l=i.discord)?void 0:l.enableAnimeRichPresence)&&(null==(s=D.playbackInfo)||null==(r=s.media)?void 0:r.id)&&(null==(c=D.playbackInfo)||null==(o=c.episode)?void 0:o.progressNumber))){let e=D.playbackInfo.media,t=null!=(j=null==(d=X.current)?void 0:d.currentTime)?j:0,n=null!=(w=null==(u=X.current)?void 0:u.duration)?w:0;iI.info("Setting discord activity",{videoProgress:t,videoDuration:n}),eX({mediaId:null!=(N=null==e?void 0:e.id)?N:0,title:(null==e||null==(m=e.title)?void 0:m.userPreferred)||(null==e||null==(h=e.title)?void 0:h.romaji)||(null==e||null==(p=e.title)?void 0:p.english)||"Watching",image:(null==e||null==(f=e.coverImage)?void 0:f.large)||(null==e||null==(x=e.coverImage)?void 0:x.medium)||"",isMovie:(null==e?void 0:e.format)==="MOVIE",episodeNumber:null!=(k=null==(g=D.playbackInfo)||null==(v=g.episode)?void 0:v.progressNumber)?k:0,progress:Math.floor(t),duration:Math.floor(n),totalEpisodes:null==e?void 0:e.episodes,currentEpisodeCount:(null==e||null==(y=e.nextAiringEpisode)?void 0:y.episode)?(null==e||null==(b=e.nextAiringEpisode)?void 0:b.episode)-1:null==e?void 0:e.episodes,episodeTitle:D.playbackInfo.episode.episodeTitle||void 0})}},onTimeUpdate:e=>{if(null==U||U(),!X.current)return;let t=X.current,n=t.currentTime/t.duration;t.duration&&!ee.current&&n>=.8&&(ee.current=!0,null==R||R())},onEnded:e=>{iI.info("Video ended"),null==L||L(),eB&&e6("next")},onPlay:e=>{iI.info("Video resumed"),null==O||O()},onPause:e=>{iI.info("Video paused"),null==F||F()},onDoubleClick:e=>{},onLoadedData:e=>{iI.info("Loaded data"),null==z||z(),X.current&&eV&&X.current.play().catch()},onVolumeChange:e=>{let t=e.currentTarget;iI.info("Volume changed",t.volume),null==B||B()},onRateChange:e=>{let t=e.currentTarget;iI.info("Playback rate changed",t.playbackRate),null==q||q(),t.playbackRate!==eW&&eQ(t.playbackRate)},onError:e=>{null==H||H("")},onWaiting:e=>{eE(!0)},onCanPlay:e=>{eE(!1)},onStalled:e=>{eE(!0)},autoPlay:eV,muted:eq,playsInline:!0,controls:!1,style:{border:"none",width:"100%",height:"auto",filter:eb.videoEnhancement.enabled&&e_?"contrast(".concat(eb.videoEnhancement.contrast,") saturate(").concat(eb.videoEnhancement.saturation,") brightness(").concat(eb.videoEnhancement.brightness,")"):"none",imageRendering:"crisp-edges"},children:null==(T=D.playbackInfo)||null==(_=T.mkvMetadata)||null==(I=_.subtitleTracks)?void 0:I.map(e=>(0,a.jsx)("track",{id:e.number.toString(),kind:"subtitles",srcLang:e.language||"eng",label:e.name},e.number))})}),(0,a.jsxs)(iy,{children:[(0,a.jsx)(ib,{state:D}),(0,a.jsx)("div",{className:(0,f.cn)("opacity-0","transition-opacity duration-200 ease-in-out",(eN||eI)&&"opacity-100"),children:(0,a.jsx)(i9,{part:"video",onTerminateStream:M})})]}),eT&&(0,a.jsx)("div",{className:"absolute top-0 left-0 w-full h-full z-[100] bg-black flex items-center justify-center",children:(0,a.jsx)(N.$n,{intent:"gray-outline",size:"xl",onClick:()=>{null==eu||eu.togglePip()},children:"Exit PiP"})}),(0,a.jsxs)(lS,{timeRange:(0,a.jsx)(im,{chapterCues:null!=ta?ta:[]}),children:[(0,a.jsx)(lC,{}),(0,a.jsx)(ia,{}),(0,a.jsx)(lI,{}),(0,a.jsx)(lD,{}),(0,a.jsx)("div",{className:"flex flex-1"}),(0,a.jsx)(iw.d5,{isNativePlayerComponent:"control-bar",show:!ej}),(0,a.jsx)(lz,{}),(0,a.jsx)(lM,{}),(0,a.jsx)(lR,{}),(0,a.jsx)(lV,{}),(0,a.jsx)(lG,{})]})]}):(0,a.jsxs)("div",{className:"w-full h-full absolute flex justify-center items-center flex-col space-y-4 bg-black rounded-md",children:[(0,a.jsx)(i9,{part:"loading",onTerminateStream:M}),D.loadingState&&(0,a.jsx)(c.kt,{title:D.loadingState||"Loading...",spinner:(0,a.jsx)(ik.kiM,{className:"size-20 text-white animate-spin"}),containerClass:"z-[1]"})]})})]})]})})}function i9(e){let t,n,i=(0,l.c)(13),{part:r,onTerminateStream:s}=e,o=(0,m.md)(iU),[c,d]=(0,m.fp)(iW);if(o)return null;i[0]!==c||i[1]!==s||i[2]!==d?(t=()=>(0,a.jsxs)(a.Fragment,{children:[!c&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(N.K0,{icon:(0,a.jsx)(P.eDi,{className:"text-2xl"}),intent:"gray-basic",className:"rounded-full absolute top-0 flex-none right-4 z-[999]",onClick:()=>{d(!0)}})}),c&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(N.K0,{type:"button",intent:"gray",size:"sm",className:(0,f.cn)("rounded-full text-2xl flex-none absolute z-[999] right-4 top-4 pointer-events-auto bg-black/30 hover:bg-black/40",c&&"text-xl"),icon:(0,a.jsx)(D.uSl,{}),onClick:()=>{d(!1)}}),(0,a.jsx)(N.K0,{type:"button",intent:"alert-subtle",size:"sm",className:(0,f.cn)("rounded-full text-2xl flex-none absolute z-[999] left-4 top-4 pointer-events-auto",c&&"text-xl"),icon:(0,a.jsx)(D.Gsv,{}),onClick:()=>{s()}})]})]}),i[0]=c,i[1]=s,i[2]=d,i[3]=t):t=i[3];let u=t;if("loading"===r){let e,t,n,l=c&&"top-0";return i[4]!==l?(e=(0,f.cn)("absolute top-8 w-full z-[100]",l),i[4]=l,i[5]=e):e=i[5],i[6]!==u?(t=(0,a.jsx)(u,{}),i[6]=u,i[7]=t):t=i[7],i[8]!==e||i[9]!==t?(n=(0,a.jsx)("div",{className:e,children:t}),i[8]=e,i[9]=t,i[10]=n):n=i[10],n}return i[11]!==u?(n=(0,a.jsx)(u,{}),i[11]=u,i[12]=n):n=i[12],n}var re=n(96876),rt=n(91180),rn=n(37723),ra=n(78216),rl=n(26603),ri=n(56859);function rr(e){console.warn(e)}function rs(e){console.log(e)}function ro(e){e&&J.oR.error(e)}function rc(e){e&&J.oR.warning(e)}function rd(e){e&&J.oR.success(e)}function ru(e){e&&J.oR.info(e)}var rm=n(55340),rh=n(80600);function rp(){let e,t=(0,l.c)(2),n=(0,eK.jE)();t[0]!==n?(e={type:u.c.INVALIDATE_QUERIES,onMessage:async e=>{await Promise.all(e.map(async e=>{await n.invalidateQueries({queryKey:[e]})}))}},t[0]=n,t[1]=e):e=t[1],(0,r.oA)(e)}var rf=n(86726),rx=n(42463);let rv=(0,aM.tG)("sea-dismissed-announcements",[]);function rg(){let{data:e,mutate:t}=(0,rf.mu)(),[n,l]=(0,m.fp)(rv),[i,s]=h.useState([]);function o(){t({platform:tJ.nH?"denshi":tJ.qe?"tauri":"web"})}(0,r.oA)({type:u.c.CHECK_FOR_ANNOUNCEMENTS,onMessage:()=>{o()}}),(0,rx.A)(()=>{o()}),(0,ad.w5)(()=>{e&&((0,eY.v)("Announcement").info("Fetched announcements",e),l(t=>t.filter(t=>e.some(e=>e.id===t))))},[e]);let c=h.useMemo(()=>e?e.filter(e=>!!e.notDismissible||!n.includes(e.id)).sort((e,t)=>t.priority-e.priority):[],[e,n]),d=c.filter(e=>"banner"===e.type),p=c.filter(e=>"dialog"===e.type),x=c.filter(e=>"toast"===e.type),v=e=>{l(t=>[...t,e])},g=e=>{switch(e){case"info":default:return(0,a.jsx)(P.S8s,{className:"size-5 mt-1"});case"warning":case"error":case"critical":return(0,a.jsx)(P.eHT,{className:"size-5 mt-1"})}},y=e=>{switch(e){case"info":default:return"info-basic";case"warning":return"warning-basic";case"error":case"critical":return"alert-basic"}};h.useEffect(()=>{x.forEach(e=>{i.includes(e.id)||(("error"===e.severity||"critical"===e.severity?J.oR.error:"warning"===e.severity?J.oR.warning:J.oR.info)(e.message,{position:"top-right",id:e.id,duration:1/0,action:e.notDismissible?void 0:{label:"OK",onClick:()=>v(e.id)},onDismiss:e.notDismissible?void 0:()=>v(e.id),onAutoClose:e.notDismissible?void 0:()=>v(e.id)}),s(t=>[...t,e.id]))})},[x,i]);let b=e=>{e.notDismissible||v(e.id)},j=e=>{"link"===e.type&&e.url&&window.open(e.url,"_blank")};return(0,a.jsxs)(a.Fragment,{children:[d.map((e,t)=>(0,a.jsx)("div",{className:(0,f.cn)("fixed bottom-0 left-0 right-0 z-[999] bg-[--background] border-b border-[--border] shadow-lg bg-gradient-to-br"),children:(0,a.jsx)(eu.F,{intent:y(e.severity),title:e.title,description:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{children:e.message}),e.actions&&e.actions.length>0&&(0,a.jsx)("div",{className:"flex gap-2",children:e.actions.map((e,t)=>(0,a.jsx)(N.$n,{size:"sm",intent:"white-outline",onClick:()=>j(e),children:e.label},t))})]}),icon:g(e.severity),onClose:e.notDismissible?void 0:()=>v(e.id),className:(0,f.cn)("rounded-none border-0 border-t shadow-[0_0_10px_0_rgba(0,0,0,0.05)] bg-gradient-to-br","critical"===e.severity&&"from-red-950/95 to-red-900/60 dark:text-red-100","error"===e.severity&&"from-red-950/95 to-red-900/60 dark:text-red-100","warning"===e.severity&&"from-amber-950/95 to-amber-900/60 dark:text-amber-100","info"===e.severity&&"from-blue-950/95 to-blue-900/60 dark:text-blue-100")})},e.id+""+String(t))),p.map((e,t)=>(0,a.jsx)(eh.a,{open:!0,onOpenChange:t=>{t||b(e)},hideCloseButton:e.notDismissible,title:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:(0,f.cn)("info"===e.severity&&"text-blue-300","warning"===e.severity&&"text-amber-300","error"===e.severity&&"text-red-300","critical"===e.severity&&"text-red-300"),children:g(e.severity)}),e.title||"Announcement"]}),overlayClass:"bg-gray-950/10",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-[--muted]",children:e.message}),(0,a.jsxs)("div",{className:"flex gap-2 pt-2",children:[e.actions&&e.actions.length>0&&(0,a.jsx)("div",{className:"flex gap-2 flex-wrap",children:e.actions.map((e,t)=>(0,a.jsx)(N.$n,{intent:"gray-outline",onClick:()=>j(e),children:e.label},t))}),(0,a.jsx)("div",{className:"flex-1"}),(0,a.jsx)(N.$n,{intent:"white",onClick:()=>b(e),children:"OK"})]})]})},e.id+""+String(t)))]})}var ry=n(83394),rb=n(98530),rj=function(e){return e.LOADED_METADATA="loaded-metadata",e.VIDEO_SEEKED="video-seeked",e.SUBTITLE_FILE_UPLOADED="subtitle-file-uploaded",e.VIDEO_PAUSED="video-paused",e.VIDEO_RESUMED="video-resumed",e.VIDEO_ENDED="video-ended",e.VIDEO_ERROR="video-error",e.VIDEO_CAN_PLAY="video-can-play",e.VIDEO_STARTED="video-started",e.VIDEO_COMPLETED="video-completed",e.VIDEO_TERMINATED="video-terminated",e.VIDEO_TIME_UPDATE="video-time-update",e}(rj||{});let rw=(0,eY.v)("NATIVE PLAYER");function rN(){var e,t,n,l,i,s,o,c,d,p,f,x;(0,eU.v1)();let v=(0,m.md)(rl.O1),{sendMessage:g}=(0,r.Y0)(),y=(0,m.md)(a1),b=(0,m.md)(i$),[j,w]=(0,m.fp)(aH.k),[N,k]=(0,m.fp)(iW),S=(0,m.md)(iZ),E=(0,m.Xr)(i6),{watchHistory:C,waitForWatchHistory:I,getEpisodeContinuitySeekTo:_}=(0,ry.vy)(null==j||null==(t=j.playbackInfo)||null==(e=t.media)?void 0:e.id),{data:T}=(0,rb.nI)(null==j||null==(l=j.playbackInfo)||null==(n=l.media)?void 0:n.idMal,null!=(f=null==j||null==(s=j.playbackInfo)||null==(i=s.episode)?void 0:i.progressNumber)?f:-1),A=(0,eK.jE)();h.useEffect(()=>{A.invalidateQueries({queryKey:[eF.S.CONTINUITY.GetContinuityWatchHistoryItem.key]})},[j]);let{mutate:D,isPending:P,isSuccess:M}=(0,lJ.iL)(null==(c=j.playbackInfo)||null==(o=c.media)?void 0:o.id,null!=(x=null==(p=j.playbackInfo)||null==(d=p.episode)?void 0:d.progressNumber)?x:0,!1),L=()=>{b&&g({type:u.c.NATIVE_PLAYER,payload:{clientId:v,type:rj.VIDEO_TIME_UPDATE,payload:{currentTime:b.currentTime,duration:b.duration,paused:b.paused}}})};function O(){b&&(rw.info("Cleaning up media"),b.pause()),k(!0),w(e=>{e.playbackInfo=null,e.playbackError=null,e.loadingState="Ending stream..."}),setTimeout(()=>{w(e=>{e.active=!1})},700),g({type:u.c.NATIVE_PLAYER,payload:{clientId:v,type:rj.VIDEO_TERMINATED}})}return h.useEffect(()=>{let e=setInterval(L,1e3);return()=>clearInterval(e)},[b]),(0,r.oA)({type:u.c.NATIVE_PLAYER,onMessage:e=>{let{type:t,payload:n}=e;switch(t){case"open-and-await":rw.info("Open and await event received",{payload:n}),w(e=>{e.active=!0,e.loadingState=n,e.playbackInfo=null,e.playbackError=null}),k(!1);break;case"watch":rw.info("Watch event received",{payload:n}),w(e=>{e.playbackInfo=n,e.loadingState=null,e.playbackError=null}),k(!1);break;case"subtitle-event":null==S||S.onSubtitleEvent(n);break;case"add-subtitle-track":rw.info("Add subtitle track event received",n),null==S||S.onTrackAdded(n);break;case"terminate":rw.info("Terminate event received"),O();break;case"error":rw.error("Error event received",n),J.oR.error("An error occurred while playing the stream. "+n.error),w(e=>{e.playbackError=n.error});break;case"pause":rw.info("Pause event received",n),null==b||b.pause();break;case"resume":rw.info("Play event received",n),null==b||b.play();break;case"seek":if(rw.info("Seek event received",n),b){let e=null==b?void 0:b.currentTime,t=null==b?void 0:b.duration,a=e+n;e&&t&&(b.currentTime=a)}break;case"seek-to":if(rw.info("Seek to event received",n),b){let e=null==b?void 0:b.currentTime,t=null==b?void 0:b.duration;e&&t&&(b.currentTime=n)}}}}),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(i7,{state:j,aniSkipData:T,onTerminateStream:O,onLoadedMetadata:()=>{var e,t,n,a,l,i,r,s;if(b){if(g({type:u.c.NATIVE_PLAYER,payload:{clientId:v,type:rj.LOADED_METADATA,payload:{currentTime:b.currentTime,duration:b.duration,paused:b.paused}}}),null==(e=j.playbackInfo)?void 0:e.isNakamaWatchParty)rw.info("This stream is a watch party, only listen");else if((null==(n=j.playbackInfo)||null==(t=n.episode)?void 0:t.progressNumber)&&(null==C?void 0:C.found)&&(null==(a=C.item)?void 0:a.episodeNumber)===(null==(i=j.playbackInfo)||null==(l=i.episode)?void 0:l.progressNumber)){let e=_(null==(s=j.playbackInfo)||null==(r=s.episode)?void 0:r.progressNumber,null==b?void 0:b.currentTime,null==b?void 0:b.duration);(0,eY.v)("MEDIA PLAYER").info("Watch continuity: Seeking to last watched time",{lastWatchedTime:e}),e>0&&((0,eY.v)("MEDIA PLAYER").info("Watch continuity: Seeking to",e),E({type:"restoreProgress",payload:{time:e}}))}}},onTimeUpdate:()=>{if(!b)return},onEnded:()=>{rw.info("Ended"),g({type:u.c.NATIVE_PLAYER,payload:{clientId:v,type:rj.VIDEO_ENDED,payload:{autoNext:y}}})},onSeeked:e=>{b&&(rw.info("Video seeked to",e),g({type:u.c.NATIVE_PLAYER,payload:{clientId:v,type:rj.VIDEO_SEEKED,payload:{currentTime:e,duration:b.duration}}}))},onCompleted:()=>{var e,t,n,a,l,i,r,s;b&&(g({type:u.c.NATIVE_PLAYER,payload:{clientId:v,type:rj.VIDEO_COMPLETED,payload:{currentTime:b.currentTime,duration:b.duration}}}),(null==(e=j.playbackInfo)?void 0:e.media)&&(null==(t=j.playbackInfo)?void 0:t.episode)&&D({mediaId:null==(a=j.playbackInfo)||null==(n=a.media)?void 0:n.id,totalEpisodes:(null==(i=j.playbackInfo)||null==(l=i.media)?void 0:l.episodes)||0,episodeNumber:null==(s=j.playbackInfo)||null==(r=s.episode)?void 0:r.progressNumber}))},onError:e=>{if(!b)return;let t=e||b.error,n=e||"Unknown error",a="";if(t instanceof MediaError){switch(t.code){case MediaError.MEDIA_ERR_ABORTED:n="Media playback aborted";break;case MediaError.MEDIA_ERR_NETWORK:n="Network error occurred";break;case MediaError.MEDIA_ERR_DECODE:n="Media decode error - codec not supported or corrupted file",a="This is likely a codec compatibility issue.";break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:n="Media format not supported",a="The video codec/container format is not supported.";break;default:n=t.message||"Unknown media error"}rw.error("Media error",{code:null==t?void 0:t.code,message:null==t?void 0:t.message,src:b.src,networkState:b.networkState,readyState:b.readyState})}let l=a?"".concat(n,"\n\n").concat(a):n;rw.error("Media error",l),g({type:u.c.NATIVE_PLAYER,payload:{clientId:v,type:rj.VIDEO_ERROR,payload:{error:l}}})},onPlay:()=>{b&&g({type:u.c.NATIVE_PLAYER,payload:{clientId:v,type:rj.VIDEO_RESUMED,payload:{currentTime:b.currentTime,duration:b.duration}}})},onPause:()=>{b&&g({type:u.c.NATIVE_PLAYER,payload:{clientId:v,type:rj.VIDEO_PAUSED,payload:{currentTime:b.currentTime,duration:b.duration}}})},onFileUploaded:function(e){g({type:u.c.NATIVE_PLAYER,payload:{clientId:v,type:rj.SUBTITLE_FILE_UPLOADED,payload:{filename:e.name,content:e.content}}})}})})}let rk=(0,eY.v)("IndefiniteLoader");function rS(){let e,t,n,i,s,o,c,m=(0,l.c)(10);m[0]===Symbol.for("react.memo_cache_sentinel")?(e=[],m[0]=e):e=m[0];let[p,f]=h.useState(e);return m[1]===Symbol.for("react.memo_cache_sentinel")?(t=()=>{let e=setTimeout(()=>{f([])},18e4);return()=>clearTimeout(e)},m[1]=t):t=m[1],m[2]!==p?(n=[p],m[2]=p,m[3]=n):n=m[3],h.useEffect(t,n),m[4]===Symbol.for("react.memo_cache_sentinel")?(i={type:u.c.SHOW_INDEFINITE_LOADER,onMessage:e=>{e&&(rk.info("Showing indefinite loader",e),f(t=>t.includes(e)?t:[...t,e]))}},m[4]=i):i=m[4],(0,r.oA)(i),m[5]===Symbol.for("react.memo_cache_sentinel")?(s={type:u.c.HIDE_INDEFINITE_LOADER,onMessage:e=>{e&&(rk.info("Hiding indefinite loader",e),f(t=>t.filter(t=>t!==e)))}},m[5]=s):s=m[5],(0,r.oA)(s),m[6]!==p.length?(o=p.length>0&&(0,a.jsx)("div",{className:"w-full bg-gray-950 fixed top-0 left-0 z-[100]",children:(0,a.jsx)(d.z,{size:"xs",isIndeterminate:!0})}),m[6]=p.length,m[7]=o):o=m[7],m[8]!==o?(c=(0,a.jsx)(a.Fragment,{children:o}),m[8]=o,m[9]=c):c=m[9],c}let rE=e=>{let t,n,s,o,c,d,f,x,v,y,b,j,w,N,k,S,E,C,I,_,T,D,P,M,O,F,U,z=(0,l.c)(35),{children:K}=e;(0,rt.m)(),(0,re.NZ)(),(0,tt.v7)(),function(){let e,t,n,a=(0,l.c)(7),i=(0,A.usePathname)(),s=(0,m.Xr)(nR),o=(0,eK.jE)(),{data:c}=(0,rn.s3)("/auto-downloader"!==i);a[0]!==o?(e={type:u.c.AUTO_DOWNLOADER_ITEM_ADDED,onMessage:e=>{o.invalidateQueries({queryKey:[eF.S.AUTO_DOWNLOADER.GetAutoDownloaderItems.key]})}},a[0]=o,a[1]=e):e=a[1],(0,r.oA)(e),a[2]!==c||a[3]!==s?(t=()=>{s(null!=c?c:[])},a[2]=c,a[3]=s,a[4]=t):t=a[4],a[5]!==c?(n=[c],a[5]=c,a[6]=n):n=a[6],(0,h.useEffect)(t,n)}(),function(){let e,t,n=(0,l.c)(4),a=(0,eK.jE)();n[0]!==a?(e={type:u.c.REFRESHED_ANILIST_ANIME_COLLECTION,onMessage:e=>{(async()=>{await a.invalidateQueries({queryKey:[eF.S.ANIME_COLLECTION.GetLibraryCollection.key]}),await a.invalidateQueries({queryKey:[eF.S.ANILIST.GetAnimeCollection.key]}),await a.invalidateQueries({queryKey:[eF.S.ANILIST.GetRawAnimeCollection.key]}),await a.invalidateQueries({queryKey:[eF.S.ANIME_ENTRIES.GetAnimeEntry.key]}),await a.invalidateQueries({queryKey:[eF.S.ANIME_ENTRIES.GetMissingEpisodes.key]}),await a.invalidateQueries({queryKey:[eF.S.ANIME_COLLECTION.GetAnimeCollectionSchedule.key]})})()}},n[0]=a,n[1]=e):e=n[1],(0,r.oA)(e),n[2]!==a?(t={type:u.c.REFRESHED_ANILIST_MANGA_COLLECTION,onMessage:e=>{(async()=>{await a.invalidateQueries({queryKey:[eF.S.MANGA.GetAnilistMangaCollection.key]}),await a.invalidateQueries({queryKey:[eF.S.MANGA.GetMangaEntry.key]})})()}},n[2]=a,n[3]=t):t=n[3],(0,r.oA)(t)}(),function(){let e,t,n,a,i,s,o=(0,l.c)(6);o[0]===Symbol.for("react.memo_cache_sentinel")?(e={type:u.c.INFO_TOAST,onMessage:ru},o[0]=e):e=o[0],(0,r.oA)(e),o[1]===Symbol.for("react.memo_cache_sentinel")?(t={type:u.c.SUCCESS_TOAST,onMessage:rd},o[1]=t):t=o[1],(0,r.oA)(t),o[2]===Symbol.for("react.memo_cache_sentinel")?(n={type:u.c.WARNING_TOAST,onMessage:rc},o[2]=n):n=o[2],(0,r.oA)(n),o[3]===Symbol.for("react.memo_cache_sentinel")?(a={type:u.c.ERROR_TOAST,onMessage:ro},o[3]=a):a=o[3],(0,r.oA)(a),o[4]===Symbol.for("react.memo_cache_sentinel")?(i={type:u.c.CONSOLE_LOG,onMessage:rs},o[4]=i):i=o[4],(0,r.oA)(i),o[5]===Symbol.for("react.memo_cache_sentinel")?(s={type:u.c.CONSOLE_WARN,onMessage:rr},o[5]=s):s=o[5],(0,r.oA)(s)}(),function(){let e,t,n,a=(0,l.c)(6),i=(0,eK.jE)();a[0]!==i?(e={type:u.c.EXTENSIONS_RELOADED,onMessage:()=>{(async()=>{await i.invalidateQueries({queryKey:[eF.S.EXTENSIONS.ListAnimeTorrentProviderExtensions.key]}),await i.invalidateQueries({queryKey:[eF.S.EXTENSIONS.ListMangaProviderExtensions.key]}),await i.invalidateQueries({queryKey:[eF.S.EXTENSIONS.ListOnlinestreamProviderExtensions.key]}),await i.invalidateQueries({queryKey:[eF.S.EXTENSIONS.ListExtensionData.key]}),await i.invalidateQueries({queryKey:[eF.S.EXTENSIONS.GetAllExtensions.key]}),await i.invalidateQueries({queryKey:[eF.S.EXTENSIONS.GetExtensionUserConfig.key]}),await i.invalidateQueries({queryKey:[eF.S.EXTENSIONS.GetExtensionUpdateData.key]}),await i.invalidateQueries({queryKey:[eF.S.EXTENSIONS.ListDevelopmentModeExtensions.key]})})()}},a[0]=i,a[1]=e):e=a[1],(0,r.oA)(e),a[2]!==i?(t={type:u.c.PLUGIN_UNLOADED,onMessage:()=>{(async()=>{await i.invalidateQueries({queryKey:[eF.S.EXTENSIONS.ListDevelopmentModeExtensions.key]})})()}},a[2]=i,a[3]=t):t=a[3],(0,r.oA)(t),a[4]!==i?(n={type:u.c.EXTENSION_UPDATES_FOUND,onMessage:async e=>{await i.invalidateQueries({queryKey:[eF.S.EXTENSIONS.GetExtensionUpdateData.key]}),await i.invalidateQueries({queryKey:[eF.S.EXTENSIONS.GetAllExtensions.key]})}},a[4]=i,a[5]=n):n=a[5],(0,r.oA)(n)}(),function(){let e,t,n=(0,l.c)(4),a=(0,eK.jE)();n[0]!==a?(e={type:u.c.REFRESHED_MANGA_DOWNLOAD_DATA,onMessage:e=>{(async()=>{await a.invalidateQueries({queryKey:[eF.S.MANGA_DOWNLOAD.GetMangaDownloadsList.key]})})()}},n[0]=a,n[1]=e):e=n[1],(0,r.oA)(e),n[2]!==a?(t={type:u.c.CHAPTER_DOWNLOAD_QUEUE_UPDATED,onMessage:e=>{(async()=>{await a.invalidateQueries({queryKey:[eF.S.MANGA_DOWNLOAD.GetMangaDownloadData.key]}),await a.invalidateQueries({queryKey:[eF.S.MANGA_DOWNLOAD.GetMangaDownloadQueue.key]}),await a.invalidateQueries({queryKey:[eF.S.MANGA_DOWNLOAD.GetMangaDownloadsList.key]})})()}},n[2]=a,n[3]=t):t=n[3],(0,r.oA)(t)}(),function(){let e,t=(0,l.c)(4),n=(0,m.md)(rl.O1),{externalPlayerLink:a}=(0,ra._V)(),{mutate:i}=(0,ta.a8)();t[0]!==n||t[1]!==a||t[2]!==i?(e={type:u.c.EXTERNAL_PLAYER_OPEN_URL,onMessage:e=>{if(!(null==a?void 0:a.length))return void J.oR.error("External player link is not set.");J.oR.info("Opening media file in external player."),(0,eY.v)("EXTERNAL PLAYER LINK").info("Opening external player",e);let t=new ri.R(a);t.setEpisodeNumber(e.episodeNumber),t.setMediaTitle(e.mediaTitle),t.setUrl(e.url),(0,nW.A)(t.getFullUrl()),0!=e.mediaId?((0,eY.v)("EXTERNAL PLAYER LINK").info("Starting manual tracking",{mediaId:e.mediaId,episodeNumber:e.episodeNumber,clientId:n||""}),i({mediaId:e.mediaId,episodeNumber:e.episodeNumber,clientId:n||""})):(0,eY.v)("EXTERNAL PLAYER LINK").info("No manual tracking",{url:e.url,mediaId:e.mediaId,episodeNumber:e.episodeNumber})}},t[0]=n,t[1]=a,t[2]=i,t[3]=e):e=t[3],(0,r.oA)(e)}(),function(){let e,t,n,a,i=(0,l.c)(9),s=(0,eK.jE)();i[0]!==s?(e={type:u.c.SYNC_LOCAL_FINISHED,onMessage:e=>{s.invalidateQueries({queryKey:[eF.S.LOCAL.LocalGetTrackedMediaItems.key]})}},i[0]=s,i[1]=e):e=i[1],(0,r.oA)(e);let[o,c]=h.useState(null);i[2]!==o?(t={type:u.c.SYNC_LOCAL_QUEUE_STATE,onMessage:e=>{(0,eY.v)("SYNC").info("Queue state",o),c(e)}},i[2]=o,i[3]=t):t=i[3],(0,r.oA)(t);let{setSyncIsActive:d}=eW();i[4]!==o||i[5]!==d?(n=()=>{d(!!o&&(Object.keys(o.animeTasks).length>0||Object.keys(o.mangaTasks).length>0))},i[4]=o,i[5]=d,i[6]=n):n=i[6],i[7]!==o?(a=[o],i[7]=o,i[8]=a):a=i[8],h.useEffect(n,a)}(),rp();let B=(0,eU.v1)(),V=(0,A.useRouter)(),G=(0,A.usePathname)(),[,H]=h.useState(!1),q=h.useRef(G);z[0]!==G?(t=()=>{q.current!==G&&"/"!==G&&H(!0),q.current=G},n=[G],z[0]=G,z[1]=t,z[2]=n):(t=z[1],n=z[2]),h.useEffect(t,n),z[3]!==G||z[4]!==V||z[5]!==(null==B?void 0:B.isOffline)?(s=()=>{!(null==B?void 0:B.isOffline)&&G.startsWith("/offline")&&V.push("/")},z[3]=G,z[4]=V,z[5]=null==B?void 0:B.isOffline,z[6]=s):s=z[6];let W=null==B?void 0:B.isOffline;if(z[7]!==G||z[8]!==W?(o=[W,G],z[7]=G,z[8]=W,z[9]=o):o=z[9],h.useEffect(s,o),null==B?void 0:B.isOffline){let e;return z[10]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(rh.q,{}),z[10]=e):e=z[10],e}return z[11]===Symbol.for("react.memo_cache_sentinel")?(D=(0,a.jsx)(L,{}),P=(0,a.jsx)(p,{}),M=(0,a.jsx)(eB,{}),O=(0,a.jsx)(i.U6,{}),c=(0,a.jsx)(al,{}),d=(0,a.jsx)(td.z,{}),f=(0,a.jsx)(tT,{}),x=(0,a.jsx)(iw.d5,{}),v=(0,a.jsx)(rm.r,{}),y=(0,a.jsx)(eE.M,{}),b=(0,a.jsx)(tj,{}),j=(0,a.jsx)(to,{}),w=(0,a.jsx)(R.m7,{}),N=(0,a.jsx)(g,{}),k=(0,a.jsx)(nI.Rg,{}),S=(0,a.jsx)(aE,{}),E=tJ.nH&&(0,a.jsx)(i8,{children:(0,a.jsx)(rN,{})}),C=(0,a.jsx)(n1.hw,{}),I=(0,a.jsx)(rS,{}),_=(0,a.jsx)(rg,{}),T=(0,a.jsx)(eR,{}),z[11]=c,z[12]=d,z[13]=f,z[14]=x,z[15]=v,z[16]=y,z[17]=b,z[18]=j,z[19]=w,z[20]=N,z[21]=k,z[22]=S,z[23]=E,z[24]=C,z[25]=I,z[26]=_,z[27]=T,z[28]=D,z[29]=P,z[30]=M,z[31]=O):(c=z[11],d=z[12],f=z[13],x=z[14],v=z[15],y=z[16],b=z[17],j=z[18],w=z[19],N=z[20],k=z[21],S=z[22],E=z[23],C=z[24],I=z[25],_=z[26],T=z[27],D=z[28],P=z[29],M=z[30],O=z[31]),z[32]===Symbol.for("react.memo_cache_sentinel")?(F=(0,a.jsx)(tZ.yR,{children:(0,a.jsx)(n2,{})}),z[32]=F):F=z[32],z[33]!==K?(U=(0,a.jsxs)(a.Fragment,{children:[D,P,M,O,c,d,f,x,v,y,b,j,w,N,k,S,E,C,I,_,T,(0,a.jsx)(tZ.Xv,{children:(0,a.jsxs)(tZ.e7,{withSidebar:!0,sidebarSize:"slim",children:[F,(0,a.jsx)(tZ.e7,{children:(0,a.jsx)(tZ.VZ,{children:K})})]})})]}),z[33]=K,z[34]=U):U=z[34],U};var rC=n(20051);function rI(){var e,t,n,i,r,s;let o,c,d,u,m,p,x,v,g,y,b,j,w,N,k,S,E,C,I,_,T,D,P,M,L,O,R,F,U=(0,l.c)(75),z=(0,eU.v1)(),K=(0,tZ.kb)(),B=(0,eL.Ky)(),[V,G]=h.useState(!1),H=B.expandSidebarOnHover?!K.isBelowBreakpoint&&!V:!K.isBelowBreakpoint,{mutate:q}=(0,rC.Uf)(),W=(0,A.usePathname)();U[0]!==K.isBelowBreakpoint||U[1]!==B.expandSidebarOnHover?(o=()=>{!K.isBelowBreakpoint&&B.expandSidebarOnHover&&G(!0)},U[0]=K.isBelowBreakpoint,U[1]=B.expandSidebarOnHover,U[2]=o):o=U[2];let Q=o;U[3]!==V||U[4]!==B.expandSidebarOnHover?(c=()=>{V&&B.expandSidebarOnHover&&G(!1)},U[3]=V,U[4]=B.expandSidebarOnHover,U[5]=c):c=U[5];let X=c;U[6]!==q?(d={title:"Disable offline mode",description:"Are you sure you want to disable offline mode?",actionText:"Yes",actionIntent:"primary",onConfirm:()=>{q({enabled:!1})}},U[6]=q,U[7]=d):d=U[7];let $=(0,tm.J)(d),Y=!K.isBelowBreakpoint&&V&&"w-[260px]",Z=!K.isBelowBreakpoint&&!B.disableSidebarTransparency&&"bg-transparent",J=!K.isBelowBreakpoint&&!B.disableSidebarTransparency&&B.expandSidebarOnHover&&"hover:bg-[--background]";U[8]!==Y||U[9]!==Z||U[10]!==J?(u=(0,f.cn)("h-full flex flex-col justify-between transition-gpu w-full transition-[width]",Y,Z,J),U[8]=Y,U[9]=Z,U[10]=J,U[11]=u):u=U[11],U[12]!==K.isBelowBreakpoint||U[13]!==B.disableSidebarTransparency||U[14]!==B.expandSidebarOnHover?(m=!K.isBelowBreakpoint&&B.expandSidebarOnHover&&B.disableSidebarTransparency&&(0,a.jsx)("div",{className:(0,f.cn)("fixed h-full translate-x-0 w-[50px] bg-gradient bg-gradient-to-r via-[--background] from-[--background] to-transparent","group-hover/main-sidebar:translate-x-[250px] transition opacity-0 duration-300 group-hover/main-sidebar:opacity-100")}),U[12]=K.isBelowBreakpoint,U[13]=B.disableSidebarTransparency,U[14]=B.expandSidebarOnHover,U[15]=m):m=U[15],U[16]===Symbol.for("react.memo_cache_sentinel")?(p=(0,a.jsx)("div",{className:"mb-4 p-4 pb-0 flex justify-center w-full",children:(0,a.jsx)("img",{src:"/seanime-logo.png",alt:"logo",className:"w-15 h-10 transition-all duration-300"})}),U[16]=p):p=U[16];let ee="/offline"===W;U[17]!==ee?(x={iconType:nJ.yPD,name:"Anime Library",href:"/offline",isCurrent:ee},U[17]=ee,U[18]=x):x=U[18],U[19]!==W||U[20]!==(null==z||null==(t=z.settings)||null==(e=t.library)?void 0:e.enableManga)?(v=(null==z||null==(i=z.settings)||null==(n=i.library)?void 0:n.enableManga)&&{iconType:ev.Z5q,name:"Manga",href:"/offline/manga",isCurrent:W.startsWith("/offline/manga")},U[19]=W,U[20]=null==z||null==(s=z.settings)||null==(r=s.library)?void 0:r.enableManga,U[21]=v):v=U[21],U[22]!==v?(g=[v].filter(Boolean),U[22]=v,U[23]=g):g=U[23];let et=g;U[24]!==x||U[25]!==et?(y=[x,...et].filter(Boolean),U[24]=x,U[25]=et,U[26]=y):y=U[26],U[27]!==K?(b=()=>K.setOpen(!1),U[27]=K,U[28]=b):b=U[28],U[29]!==H||U[30]!==y||U[31]!==b?(j=(0,a.jsx)(e$.m,{className:"px-4",collapsed:H,itemClass:"relative",items:y,onLinkItemClick:b}),U[29]=H,U[30]=y,U[31]=b,U[32]=j):j=U[32],U[33]!==H?(w=(0,a.jsx)(nC,{isCollapsed:H,handleExpandSidebar:rT,handleUnexpandedSidebar:r_}),U[33]=H,U[34]=w):w=U[34],U[35]===Symbol.for("react.memo_cache_sentinel")?(N=(0,a.jsx)(nN,{place:"sidebar"}),U[35]=N):N=U[35],U[36]!==j||U[37]!==w?(k=(0,a.jsxs)("div",{children:[p,j,w,N]}),U[36]=j,U[37]=w,U[38]=k):k=U[38],U[39]!==K?(S=()=>K.setOpen(!1),U[39]=K,U[40]=S):S=U[40],U[41]!==$?(E={iconType:nJ.njN,name:"Disable offline mode",onClick:()=>{$.open()}},U[41]=$,U[42]=E):E=U[42];let en="/settings"===W;return U[43]!==en?(C={iconType:ev.xPd,name:"Settings",href:"/settings",isCurrent:en},U[43]=en,U[44]=C):C=U[44],U[45]!==E||U[46]!==C?(I=[E,C],U[45]=E,U[46]=C,U[47]=I):I=U[47],U[48]!==H||U[49]!==S||U[50]!==I?(_=(0,a.jsx)("div",{children:(0,a.jsx)(e$.m,{collapsed:H,itemClass:"relative",onLinkItemClick:S,items:I})}),U[48]=H,U[49]=S,U[50]=I,U[51]=_):_=U[51],U[52]!==K.isBelowBreakpoint?(T=(0,f.cn)("w-full flex p-2.5 pt-1 items-center space-x-2",{hidden:K.isBelowBreakpoint}),U[52]=K.isBelowBreakpoint,U[53]=T):T=U[53],U[54]===Symbol.for("react.memo_cache_sentinel")?(D=(0,a.jsx)(nB,{size:"sm",className:"cursor-pointer"}),U[54]=D):D=U[54],U[55]!==V?(P=V&&(0,a.jsx)("p",{className:"truncate",children:"Offline"}),U[55]=V,U[56]=P):P=U[56],U[57]!==T||U[58]!==P?(M=(0,a.jsx)("div",{className:"flex w-full gap-2 flex-col",children:(0,a.jsxs)("div",{className:T,children:[D,P]})}),U[57]=T,U[58]=P,U[59]=M):M=U[59],U[60]!==_||U[61]!==M?(L=(0,a.jsxs)("div",{className:"flex w-full gap-2 flex-col px-4",children:[_,M]}),U[60]=_,U[61]=M,U[62]=L):L=U[62],U[63]!==Q||U[64]!==X||U[65]!==k||U[66]!==L||U[67]!==u||U[68]!==m?(O=(0,a.jsxs)(tZ.GK,{className:u,onMouseEnter:Q,onMouseLeave:X,children:[m,k,L]}),U[63]=Q,U[64]=X,U[65]=k,U[66]=L,U[67]=u,U[68]=m,U[69]=O):O=U[69],U[70]!==$?(R=(0,a.jsx)(tm.K,{...$}),U[70]=$,U[71]=R):R=U[71],U[72]!==O||U[73]!==R?(F=(0,a.jsxs)(a.Fragment,{children:[O,R]}),U[72]=O,U[73]=R,U[74]=F):F=U[74],F}function r_(){}function rT(){}function rA(e){let t,n,i,r,s,o,c,d,u,m,p,f,x=(0,l.c)(18),{children:v}=e,y=(0,eU.v1)(),b=(0,A.usePathname)(),j=(0,A.useRouter)();rp();let[w,N]=h.useState(!1);x[0]!==b||x[1]!==j?(t=()=>{if(b.startsWith("/offline")||b.startsWith("/settings")||b.startsWith("/mediastream")||b.startsWith("/medialinks"))return void N(!0);j.push("/offline")},x[0]=b,x[1]=j,x[2]=t):t=x[2];let k=null==y?void 0:y.isOffline;if(x[3]!==b||x[4]!==k?(n=[b,k],x[3]=b,x[4]=k,x[5]=n):n=x[5],h.useEffect(t,n),!w){let e;return x[6]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(rh.q,{}),x[6]=e):e=x[6],e}return x[7]===Symbol.for("react.memo_cache_sentinel")?(r=(0,a.jsx)(tj,{}),s=(0,a.jsx)(to,{}),o=(0,a.jsx)(R.m7,{}),c=(0,a.jsx)(g,{}),d=(0,a.jsx)(nI.Rg,{}),u=(0,a.jsx)(aE,{}),m=tJ.nH&&(0,a.jsx)(i8,{children:(0,a.jsx)(rN,{})}),i=(0,a.jsx)(rS,{}),x[7]=i,x[8]=r,x[9]=s,x[10]=o,x[11]=c,x[12]=d,x[13]=u,x[14]=m):(i=x[7],r=x[8],s=x[9],o=x[10],c=x[11],d=x[12],u=x[13],m=x[14]),x[15]===Symbol.for("react.memo_cache_sentinel")?(p=(0,a.jsx)(tZ.yR,{children:(0,a.jsx)(rI,{})}),x[15]=p):p=x[15],x[16]!==v?(f=(0,a.jsxs)(a.Fragment,{children:[r,s,o,c,d,u,m,i,(0,a.jsx)(tZ.Xv,{children:(0,a.jsxs)(tZ.e7,{withSidebar:!0,sidebarSize:"slim",children:[p,(0,a.jsx)(tZ.e7,{children:(0,a.jsx)(tZ.VZ,{children:v})})]})})]}),x[16]=v,x[17]=f):f=x[17],f}var rD=n(7013),rP=n(24038);let rM={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05,delayChildren:.1}},exit:{opacity:0,transition:{staggerChildren:.03,staggerDirection:-1}}},rL={hidden:{opacity:0,y:10},visible:{opacity:1,y:0},exit:{opacity:0,y:-10}},rO={enter:e=>({x:e>0?40:-40,opacity:0}),center:{zIndex:1,x:0,opacity:1},exit:e=>({zIndex:0,x:e<0?40:-40,opacity:0})},rR=[{id:"library",title:"Anime Library",description:"Choose your anime collection folder",icon:D.gNt,gradient:"from-blue-500 to-cyan-500"},{id:"player",title:"Media Player",description:"Configure your video player",icon:D.UIR,gradient:"from-green-500 to-emerald-500"},{id:"torrents",title:"Torrent Setup",description:"Set up downloading and providers",icon:D.Ah9,gradient:"from-orange-500 to-red-500"},{id:"debrid",title:"Debrid Service",description:"Optional premium streaming",icon:nZ.pzQ,gradient:"from-indigo-500 to-indigo-500"},{id:"features",title:"Features",description:"Enable additional features",icon:ev.rPP,gradient:"from-teal-500 to-blue-500"}];function rF(e){let t,n,i,r,s=(0,l.c)(7),{currentStep:o,onStepClick:c}=e;return s[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsx)("div",{className:"flex items-center justify-center mb-6",children:(0,a.jsx)("div",{className:"relative mx-auto size-16",children:(0,a.jsx)(a_.P.img,{src:"/seanime-logo.png",alt:"Seanime Logo",className:"w-full h-full object-contain",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3}})})}),s[0]=t):t=s[0],s[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsx)("div",{className:"text-center mb-8",children:(0,a.jsx)("p",{className:"text-[--muted] text-sm ",children:"These settings can be changed later"})}),s[1]=n):n=s[1],s[2]!==o||s[3]!==c?(i=rR.map((e,t)=>(0,a.jsxs)("div",{onClick:e=>{c(t)},className:(0,f.cn)("flex flex-col items-center relative group transition-all duration-200 focus:outline-none rounded-lg p-2 w-36","cursor-pointer"),children:[(0,a.jsx)(a_.P.div,{className:(0,f.cn)("w-12 h-12 rounded-full flex items-center justify-center mb-3 transition-all duration-200",t<=o?"bg-gradient-to-br from-brand-500/20 to-indigo-500/20 border border-brand-500/20":"bg-[--subtle] text-[--muted]",t<=o&&"group-hover:shadow-md"),initial:{scale:.9},animate:{scale:t===o?1.05:1},transition:{duration:.2},children:(0,a.jsx)(e.icon,{className:"w-6 h-6"})}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("h3",{className:(0,f.cn)("text-sm font-medium transition-colors duration-200 tracking-wide",t<=o?"text-white":"text-[--muted]","group-hover:text-[--brand]"),children:e.title})})]},e.id)),s[2]=o,s[3]=c,s[4]=i):i=s[4],s[5]!==i?(r=(0,a.jsxs)("div",{className:"mb-12",children:[t,n,(0,a.jsx)("div",{className:"flex items-start justify-between max-w-4xl mx-auto px-4 rounded-xl relative",children:i})]}),s[5]=i,s[6]=r):r=s[6],r}function rU(e){let t,n,i,r,s=(0,l.c)(8),{children:c,className:d}=e;return s[0]!==d?(t=(0,f.cn)("relative rounded-xl bg-gray-900/50 backdrop-blur-sm border",d),s[0]=d,s[1]=t):t=s[1],s[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsx)(rP.Z,{spread:40,glow:!0,disabled:!1,proximity:100,inactiveZone:.01,className:"opacity-30"}),s[2]=n):n=s[2],s[3]!==c?(i=(0,a.jsx)(o.Zp,{className:"bg-transparent border-none shadow-none p-6",children:c}),s[3]=c,s[4]=i):i=s[4],s[5]!==t||s[6]!==i?(r=(0,a.jsxs)(a_.P.div,{variants:rL,className:t,children:[n,i]}),s[5]=t,s[6]=i,s[7]=r):r=s[7],r}function rz(e){let t,n,i=(0,l.c)(2);return i[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsxs)(a_.P.div,{variants:rL,className:"text-center space-y-4",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold",children:"Anime Library"}),(0,a.jsx)("p",{className:"text-[--muted] text-sm max-w-lg mx-auto",children:"Choose the folder where your anime files are stored. This is where Seanime will scan for your collection."})]}),i[0]=t):t=i[0],i[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsxs)(a_.P.div,{variants:rM,initial:"hidden",animate:"visible",exit:"exit",className:"space-y-8",children:[t,(0,a.jsx)(rU,{className:"max-w-2xl mx-auto",children:(0,a.jsx)(a_.P.div,{variants:rL,children:(0,a.jsx)(W.D0.DirectorySelector,{name:"libraryPath",label:"Anime Library Path",leftIcon:(0,a.jsx)(D.gNt,{className:"text-blue-500"}),shouldExist:!0,help:"Select the main folder containing your anime collection. You can add more folders later.",className:"w-full"})})})]}),i[1]=n):n=i[1],n}function rK(e){let t,n,i,r,s,o,c,d,u,m,h,p,f,x,v=(0,l.c)(27),{status:g}=e;(0,t5.xW)(),v[0]===Symbol.for("react.memo_cache_sentinel")?(t={name:"defaultPlayer"},v[0]=t):t=v[0];let y=(0,t5.FH)(t);v[1]===Symbol.for("react.memo_cache_sentinel")?(n=tJ.nH&&(0,a.jsx)("div",{className:"max-w-3xl mx-auto p-4 rounded-xl border !mb-8 font-medium",children:"Seanime Denshi includes a built-in media player that is enabled by default. You can still configure an external media player."}),v[1]=n):n=v[1],v[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,a.jsxs)(a_.P.div,{variants:rL,className:"text-center space-y-4",children:[n,(0,a.jsxs)("h2",{className:"text-3xl font-bold",children:[tJ.X?"External ":"","Media Player"]}),(0,a.jsx)("p",{className:"text-[--muted] text-sm max-w-lg mx-auto",children:"Configure your preferred external media player for watching anime and tracking progress automatically."})]}),v[2]=i):i=v[2];let b=(null==g?void 0:g.os)!=="darwin"?"MPV is recommended for better subtitle rendering, torrent streaming.":"Both MPV and IINA are recommended for macOS.";return v[3]===Symbol.for("react.memo_cache_sentinel")?(r=(0,a.jsx)(D.UIR,{className:"text-green-500"}),s={label:"MPV (Recommended)",value:"mpv"},o={label:"VLC",value:"vlc"},v[3]=r,v[4]=s,v[5]=o):(r=v[3],s=v[4],o=v[5]),v[6]!==(null==g?void 0:g.os)?(c=[s,o,...(null==g?void 0:g.os)==="windows"?[{label:"MPC-HC",value:"mpc-hc"}]:[],...(null==g?void 0:g.os)==="darwin"?[{label:"IINA",value:"iina"}]:[]],v[6]=null==g?void 0:g.os,v[7]=c):c=v[7],v[8]!==b||v[9]!==c?(d=(0,a.jsx)(W.D0.Select,{name:"defaultPlayer",label:"Desktop Media Player",help:b,required:!0,leftIcon:r,options:c}),v[8]=b,v[9]=c,v[10]=d):d=v[10],v[11]!==y?(u="mpv"===y&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:"On Windows, install MPV easily using Scoop or Chocolatey. On macOS, install MPV using Homebrew."}),(0,a.jsxs)(a_.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4 p-4 rounded-lg bg-gray-800/30",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(n0.M_L,{className:"w-6 h-6 text-indigo-400"}),(0,a.jsx)("h4",{className:"font-semibold",children:"MPV Configuration"})]}),(0,a.jsx)(W.D0.Text,{name:"mpvSocket",label:"Socket / Pipe Path",help:"Path for MPV IPC communication"})]},"mpv")]}),v[11]=y,v[12]=u):u=v[12],v[13]!==y?(m="iina"===y&&(0,a.jsxs)(a_.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4 p-4 rounded-lg bg-gray-800/30",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(nJ._yA,{className:"w-6 h-6 text-blue-400"}),(0,a.jsx)("h4",{className:"font-semibold",children:"IINA Configuration"})]}),(0,a.jsx)(W.D0.Text,{name:"iinaSocket",label:"Socket / Pipe Path",help:"Path for IINA IPC communication"}),(0,a.jsx)(eu.F,{intent:"info-basic",description:(0,a.jsxs)("p",{children:["For IINA to work correctly with Seanime, make sure ",(0,a.jsx)("strong",{children:"Quit after all windows are closed"})," is ",(0,a.jsx)("span",{className:"underline",children:"checked"})," and ",(0,a.jsx)("strong",{children:"Keep window open after playback finishes"})," is ",(0,a.jsx)("span",{className:"underline",children:"unchecked"})," in your IINA general settings."]})})]},"iina"),v[13]=y,v[14]=m):m=v[14],v[15]!==y?(h="vlc"===y&&(0,a.jsxs)(a_.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4 p-4 rounded-lg bg-gray-800/30",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(n0.Fgm,{className:"w-6 h-6 text-orange-500"}),(0,a.jsx)("h4",{className:"font-semibold",children:"VLC Configuration"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(W.D0.Text,{name:"mediaPlayerHost",label:"Host"}),(0,a.jsx)(W.D0.Number,{name:"vlcPort",label:"Port",formatOptions:{useGrouping:!1}})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(W.D0.Text,{name:"vlcUsername",label:"Username"}),(0,a.jsx)(W.D0.Text,{name:"vlcPassword",label:"Password"})]}),(0,a.jsx)(W.D0.Text,{name:"vlcPath",label:"VLC Executable Path"})]},"vlc"),v[15]=y,v[16]=h):h=v[16],v[17]!==y?(p="mpc-hc"===y&&(0,a.jsxs)(a_.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4 p-4 rounded-lg bg-gray-800/30",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(lw.Fum,{className:"w-6 h-6 text-blue-500"}),(0,a.jsx)("h4",{className:"font-semibold",children:"MPC-HC Configuration"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(W.D0.Text,{name:"mediaPlayerHost",label:"Host"}),(0,a.jsx)(W.D0.Number,{name:"mpcPort",label:"Port",formatOptions:{useGrouping:!1}})]}),(0,a.jsx)(W.D0.Text,{name:"mpcPath",label:"MPC-HC Executable Path"})]},"mpc-hc"),v[17]=y,v[18]=p):p=v[18],v[19]!==u||v[20]!==m||v[21]!==h||v[22]!==p?(f=(0,a.jsxs)(lj.N,{mode:"wait",children:[u,m,h,p]}),v[19]=u,v[20]=m,v[21]=h,v[22]=p,v[23]=f):f=v[23],v[24]!==f||v[25]!==d?(x=(0,a.jsxs)(a_.P.div,{variants:rM,initial:"hidden",animate:"visible",exit:"exit",className:"space-y-8",children:[i,(0,a.jsx)(rU,{className:"max-w-2xl mx-auto",children:(0,a.jsxs)(a_.P.div,{variants:rL,className:"space-y-6",children:[d,f]})})]}),v[24]=f,v[25]=d,v[26]=x):x=v[26],x}function rB(e){let t,n,i,r,s,o,c,d,u,m,h=(0,l.c)(12);(0,t5.xW)(),h[0]===Symbol.for("react.memo_cache_sentinel")?(t={name:"defaultTorrentClient"},h[0]=t):t=h[0];let p=(0,t5.FH)(t);return h[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsxs)(a_.P.div,{variants:rL,className:"text-center space-y-4",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold",children:"Torrent Setup"}),(0,a.jsx)("p",{className:"text-[--muted] text-sm max-w-lg mx-auto",children:"Configure your default torrent provider and client."})]}),h[1]=n):n=h[1],h[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,a.jsx)(ey.j$e,{className:"w-6 h-6 text-orange-500"}),(0,a.jsx)("h3",{className:"text-xl font-semibold",children:"Torrent Provider"})]}),r=(0,a.jsx)("p",{className:"text-sm text-[--muted]",children:"Extension for finding anime torrents"}),h[2]=i,h[3]=r):(i=h[2],r=h[3]),h[4]===Symbol.for("react.memo_cache_sentinel")?(s=(0,a.jsx)(rU,{children:(0,a.jsxs)(a_.P.div,{variants:rL,className:"space-y-4",children:[i,r,(0,a.jsx)(W.D0.Select,{name:"torrentProvider",label:"Provider",required:!0,options:[{label:"AnimeTosho (Recommended)",value:nX.xF.ANIMETOSHO},{label:"Nyaa",value:nX.xF.NYAA},{label:"Nyaa (Non-English)",value:nX.xF.NYAA_NON_ENG}],help:"AnimeTosho search results are more precise in most cases."})]})}),h[4]=s):s=h[4],h[5]===Symbol.for("react.memo_cache_sentinel")?(o=(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,a.jsx)(ik.RlU,{className:"w-6 h-6 text-blue-500"}),(0,a.jsx)("h3",{className:"text-xl font-semibold",children:"Torrent Client"})]}),c=(0,a.jsx)("p",{className:"text-sm text-[--muted]",children:"Client used to download anime torrents"}),h[5]=o,h[6]=c):(o=h[5],c=h[6]),h[7]===Symbol.for("react.memo_cache_sentinel")?(d=(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 max-w-6xl mx-auto",children:[s,(0,a.jsx)(rU,{children:(0,a.jsxs)(a_.P.div,{variants:rL,className:"space-y-4",children:[o,c,(0,a.jsx)(W.D0.Select,{name:"defaultTorrentClient",label:"Client",options:[{label:"qBittorrent",value:"qbittorrent"},{label:"Transmission",value:"transmission"},{label:"None",value:"none"}]})]})})]}),h[7]=d):d=h[7],h[8]!==p?(u=("qbittorrent"===p||"transmission"===p)&&(0,a.jsx)(rU,{className:"max-w-4xl mx-auto",children:(0,a.jsxs)(a_.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"space-y-6",children:["qbittorrent"===p&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(n0.fy_,{className:"w-8 h-8 text-blue-600"}),(0,a.jsx)("h4",{className:"text-xl font-semibold",children:"qBittorrent Settings"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(W.D0.Text,{name:"qbittorrentHost",label:"Host"}),(0,a.jsx)(W.D0.Text,{name:"qbittorrentUsername",label:"Username"}),(0,a.jsx)(W.D0.Text,{name:"qbittorrentPassword",label:"Password"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 lg:grid-cols-[200px_1fr]",children:[(0,a.jsx)(W.D0.Number,{name:"qbittorrentPort",label:"Port",formatOptions:{useGrouping:!1}}),(0,a.jsx)(W.D0.Text,{name:"qbittorrentPath",label:"Executable Path"})]})]}),"transmission"===p&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(n0.nfy,{className:"w-8 h-8 text-red-600"}),(0,a.jsx)("h4",{className:"text-xl font-semibold",children:"Transmission Settings"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(W.D0.Text,{name:"transmissionHost",label:"Host"}),(0,a.jsx)(W.D0.Text,{name:"transmissionUsername",label:"Username"}),(0,a.jsx)(W.D0.Text,{name:"transmissionPassword",label:"Password"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 lg:grid-cols-[200px_1fr]",children:[(0,a.jsx)(W.D0.Number,{name:"transmissionPort",label:"Port",formatOptions:{useGrouping:!1}}),(0,a.jsx)(W.D0.Text,{name:"transmissionPath",label:"Executable Path"})]})]})]},p)}),h[8]=p,h[9]=u):u=h[9],h[10]!==u?(m=(0,a.jsxs)(a_.P.div,{variants:rM,initial:"hidden",animate:"visible",exit:"exit",className:"space-y-8",children:[n,d,(0,a.jsx)(lj.N,{mode:"wait",children:u})]}),h[10]=u,h[11]=m):m=h[11],m}function rV(e){let t,n,i,r,s,o=(0,l.c)(7);o[0]===Symbol.for("react.memo_cache_sentinel")?(t={name:"debridProvider"},o[0]=t):t=o[0];let c=(0,t5.FH)(t);return o[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsxs)(a_.P.div,{variants:rL,className:"text-center space-y-4",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold",children:"Debrid Service"}),(0,a.jsx)("p",{className:"text-[--muted] text-sm max-w-lg mx-auto",children:"Debrid services offer faster downloads and instant streaming from the cloud."})]}),o[1]=n):n=o[1],o[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,a.jsx)(W.D0.Select,{name:"debridProvider",label:"Debrid Service",leftIcon:(0,a.jsx)(nZ.pzQ,{className:"text-[--purple]"}),options:[{label:"None",value:"none"},{label:"TorBox",value:"torbox"},{label:"Real-Debrid",value:"realdebrid"}]}),o[2]=i):i=o[2],o[3]!==c?(r="none"!==c&&""!==c&&(0,a.jsx)(a_.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4 p-4 rounded-lg bg-gray-800/30",children:(0,a.jsx)(W.D0.Text,{name:"debridApiKey",label:"API Key",help:"The API key provided by the debrid service."})}),o[3]=c,o[4]=r):r=o[4],o[5]!==r?(s=(0,a.jsxs)(a_.P.div,{variants:rM,initial:"hidden",animate:"visible",exit:"exit",className:"space-y-8",children:[n,(0,a.jsx)(rU,{className:"max-w-2xl mx-auto",children:(0,a.jsxs)(a_.P.div,{variants:rL,className:"space-y-6",children:[i,(0,a.jsx)(lj.N,{children:r})]})})]}),o[5]=r,o[6]=s):s=o[6],s}function rG(e){let t,n,i,r=(0,l.c)(3);r[0]===Symbol.for("react.memo_cache_sentinel")?(t=[{name:"enableManga",icon:G.vd0,title:"Manga",description:"Read and download manga chapters",gradient:"from-orange-500 to-yellow-700"},{name:"enableTorrentStreaming",icon:D.Ah9,title:"Torrent Streaming",description:"Stream torrents without waiting for download",gradient:"from-cyan-500 to-teal-500"},{name:"enableAdultContent",icon:nZ.zeF,title:"NSFW Content",description:"Show adult content in library and search",gradient:"from-red-500 to-pink-500"},{name:"enableOnlinestream",icon:nZ.ir4,title:"Online Streaming",description:"Watch anime from online sources",gradient:"from-indigo-500 to-violet-500"},{name:"enableRichPresence",icon:G.O4U,title:"Discord Rich Presence",description:"Show what you're watching on Discord",gradient:"from-indigo-500 to-blue-500"},{name:"enableTranscode",icon:eg.hv2,title:"Transcoding / Direct Play",description:"Stream downloaded files on other devices",gradient:"from-cyan-500 to-indigo-500"}],r[0]=t):t=r[0];let s=t;return r[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsxs)(a_.P.div,{variants:rL,className:"text-center space-y-4",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold",children:"Additional Features"}),(0,a.jsx)("p",{className:"text-[--muted] text-sm max-w-lg mx-auto",children:"Choose which additional features you'd like to enable. You can enable or disable these later in settings."})]}),r[1]=n):n=r[1],r[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,a.jsxs)(a_.P.div,{variants:rM,initial:"hidden",animate:"visible",exit:"exit",className:"space-y-8",children:[n,(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 max-w-6xl mx-auto",children:s.map(rH)})]}),r[2]=i):i=r[2],i}function rH(e,t){return(0,a.jsx)(a_.P.div,{variants:rL,custom:t,children:(0,a.jsx)(W.D0.Checkbox,{name:e.name,label:(0,a.jsxs)("div",{className:"flex items-start space-x-4 p-4",children:[(0,a.jsx)("div",{className:(0,f.cn)("w-12 h-12 rounded-lg flex items-center justify-center","bg-gradient-to-br ".concat(e.gradient)),children:(0,a.jsx)(e.icon,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"font-semibold text-sm",children:e.title}),(0,a.jsx)("p",{className:"text-xs text-gray-400 mt-1 leading-relaxed",children:e.description})]})]}),size:"lg",labelClass:(0,f.cn)("block cursor-pointer transition-all duration-200 overflow-hidden w-full rounded-xl","bg-gray-900/50 hover:bg-gray-800/80","border border-gray-700/50","data-[checked=true]:bg-gradient-to-br data-[checked=true]:from-gray-900 data-[checked=true]:to-gray-900","data-[checked=true]:border-gray-400"),containerClass:"flex items-center justify-between h-full",className:"absolute top-2 right-2 z-10",fieldClass:"relative"})},e.name)}function rq(e){let{status:t}=e,n=(0,A.useRouter)(),{getDefaultVlcPath:l,getDefaultQBittorrentPath:i,getDefaultTransmissionPath:r}=(0,nX.iK)(),s=(0,eU.LX)(),{mutate:o,data:c,isPending:d,isSuccess:u}=(0,rD.JW)(),[m,p]=h.useState(0),[f,x]=h.useState(0);h.useEffect(()=>{!d&&(null==c?void 0:c.settings)&&(s(c),n.push("/"))},[c,d]);let v=h.useMemo(()=>l(t.os),[t.os]),g=h.useMemo(()=>i(t.os),[t.os]),y=h.useMemo(()=>r(t.os),[t.os]),b=h.useMemo(()=>(0,nX.Cc)(t.os),[t.os]),j=h.useMemo(()=>(0,nX.aD)(t.os),[t.os]),w=()=>{m<rR.length-1&&(x(1),p(m+1))},k=()=>{m>0&&(x(-1),p(m-1))},S=e=>{e>=0&&e<rR.length&&(x(e>m?1:-1),p(e))};return d?(0,a.jsx)(rh.q,{}):c?void 0:(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-[--background] via-[--background] to-indigo-900/10 relative",children:[(0,a.jsxs)("div",{className:"fixed h-100vh w-100vw inset-0",children:[(0,a.jsx)("div",{className:"fixed h-100vh w-100vw bg-gray-950/20 z-[1] backdrop-blur-md inset-0"}),(0,a.jsx)(id.default,{src:"https://wallpaper.forfun.com/fetch/bd/bd5226068e173245023c12b8c24a301e.jpeg?w=1470&r=0.5625",alt:"bg",fill:!0,sizes:"100vw",className:"opacity-[0.05]"})]}),(0,a.jsx)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none"}),(0,a.jsxs)("div",{className:"container max-w-6xl mx-auto px-4 py-8 relative z-10",children:[(0,a.jsx)(W.lV,{schema:nX.nG,onSubmit:e=>{m===rR.length-1?o((0,nX.lA)(e)):w()},defaultValues:{mediaPlayerHost:"127.0.0.1",vlcPort:8080,mpcPort:13579,defaultPlayer:"mpv",vlcPath:v,qbittorrentPath:g,qbittorrentHost:"127.0.0.1",qbittorrentPort:8081,transmissionPath:y,transmissionHost:"127.0.0.1",transmissionPort:9091,mpcPath:"C:/Program Files/MPC-HC/mpc-hc64.exe",torrentProvider:nX.r5,mpvSocket:b,iinaSocket:j,enableRichPresence:!1,autoScan:!1,enableManga:!0,enableOnlinestream:!1,enableAdultContent:!0,enableTorrentStreaming:!0,enableTranscode:!1,debridProvider:"none",debridApiKey:"",nakamaUsername:"",enableWatchContinuity:!0},children:e=>(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)(rF,{currentStep:m,totalSteps:rR.length,onStepClick:S}),(0,a.jsx)(lj.N,{mode:"wait",custom:f,children:(0,a.jsxs)(a_.P.div,{custom:f,variants:rO,initial:"enter",animate:"center",exit:"exit",transition:{x:{duration:.3,ease:"easeInOut"},opacity:{duration:.2}},className:"",children:[0===m&&(0,a.jsx)(rz,{form:e}),1===m&&(0,a.jsx)(rK,{form:e,status:t}),2===m&&(0,a.jsx)(rB,{form:e}),3===m&&(0,a.jsx)(rV,{form:e}),4===m&&(0,a.jsx)(rG,{form:e})]},m)}),(0,a.jsxs)(a_.P.div,{className:"flex justify-between items-center max-w-2xl mx-auto pt-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:[(0,a.jsx)(N.$n,{type:"button",intent:"gray-outline",onClick:e=>{e.preventDefault(),k()},disabled:0===m,className:"flex items-center space-x-2",leftIcon:(0,a.jsx)(D.MQY,{className:"text-xl"}),children:"Previous"}),m===rR.length-1?(0,a.jsx)(N.$n,{type:"submit",className:"flex items-center bg-gradient-to-r from-brand-600 to-indigo-600 hover:ring-2 ring-brand-600",loading:d,rightIcon:(0,a.jsx)(D.wDW,{className:"size-6"}),children:(0,a.jsx)("span",{children:"Launch Seanime"})}):(0,a.jsx)(N.$n,{type:"button",intent:"gray-glass",onClick:e=>{e.preventDefault(),w()},className:"flex items-center space-x-2",rightIcon:(0,a.jsx)(D.XWt,{className:"text-xl"}),children:"Next"})]})]})}),(0,a.jsx)(a_.P.p,{className:"text-center text-[--muted] mt-12",initial:{opacity:0},animate:{opacity:1},transition:{delay:1},children:"By 5rahim"})]})]})}function rW(e){var t;let n,i,s,c,d,p,f,x=(0,l.c)(43),{host:v,children:g}=e,y=(0,A.usePathname)(),b=(0,A.useRouter)(),j=(0,eU.v1)(),w=(0,eU.LX)(),k=(0,m.md)(eH.uQ),{data:S,isLoading:E,refetch:C}=(0,rf.wy)();x[0]!==S||x[1]!==w?(n=()=>{S&&w(S)},x[0]=S,x[1]=w,x[2]=n):n=x[2],x[3]!==S?(i=[S],x[3]=S,x[4]=i):i=x[4],h.useEffect(n,i),x[5]!==C?(s={type:u.c.ANILIST_DATA_LOADED,onMessage:()=>{(0,eY.v)("Data Wrapper").info("Anilist data loaded, refetching server status"),C()}},x[5]=C,x[6]=s):s=x[6],(0,r.oA)(s);let[I,_]=h.useState(!1);x[7]!==k||x[8]!==y||x[9]!==j?(c=()=>{j&&((null==j?void 0:j.serverHasPassword)&&!k&&"/public/auth"!==y?(window.location.href="/public/auth",_(!1),console.warn("Redirecting to auth")):_(!0))},x[7]=k,x[8]=y,x[9]=j,x[10]=c):c=x[10];let T=null==j?void 0:j.serverHasPassword;x[11]!==k||x[12]!==y||x[13]!==T?(d=[T,k,y],x[11]=k,x[12]=y,x[13]=T,x[14]=d):d=x[14],h.useEffect(c,d);let D=h.useRef(null);x[15]!==C||x[16]!==(null==j?void 0:j.serverReady)?(p=()=>((null==j?void 0:j.serverReady)||(D.current=setInterval(()=>{(0,eY.v)("Data Wrapper").info("Refetching server status"),C()},2e3)),()=>{(0,eY.v)("Data Wrapper").info("Clearing interval"),D.current&&(clearInterval(D.current),D.current=null)}),x[15]=C,x[16]=null==j?void 0:j.serverReady,x[17]=p):p=x[17];let P=null==j?void 0:j.serverReady;if(x[18]!==P?(f=[P],x[18]=P,x[19]=f):f=x[19],h.useEffect(p,f),E||!j||!I){let e;return x[20]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(rh.q,{}),x[20]=e):e=x[20],e}if(!(null==j?void 0:j.serverReady)){let e;return x[21]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(rh.q,{title:"L o a d i n g"}),x[21]=e):e=x[21],e}if(y.startsWith("/auth/callback"))return g;if(!(null==j?void 0:j.settings)){let e;return x[22]!==j?(e=(0,a.jsx)(rq,{status:j}),x[22]=j,x[23]=e):e=x[23],e}if(null==j?void 0:j.updating){let e;return x[24]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsxs)("div",{className:"container max-w-3xl py-10",children:[(0,a.jsx)("div",{className:"mb-4 flex justify-center w-full",children:(0,a.jsx)("img",{src:"/seanime-logo.png",alt:"logo",className:"w-14 h-auto"})}),(0,a.jsx)("p",{className:"text-center text-lg",children:"Seanime is currently updating. Refresh the page once the update is complete and the connection has been reestablished."})]}),x[24]=e):e=x[24],e}if(!(null==j||null==(t=j.mediastreamSettings)?void 0:t.transcodeEnabled)&&y.startsWith("/mediastream")){let e;return x[25]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(tS.D,{title:"Transcoding not enabled"}),x[25]=e):e=x[25],e}if((null==j?void 0:j.user)||"127.0.0.1:43211"!==v||tJ.X){if(!(null==j?void 0:j.user)){let e,t,n,l,i,r,s,c;return x[33]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsx)("div",{className:"mb-4 flex justify-center w-full",children:(0,a.jsx)("img",{src:"/logo.png",alt:"logo",className:"w-24 h-auto"})}),e=(0,a.jsx)("h3",{children:"Welcome!"}),x[33]=e,x[34]=t):(e=x[33],t=x[34]),x[35]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsx)(nY(),{href:nQ.tL,target:"_blank",children:(0,a.jsx)(N.$n,{leftIcon:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",width:"24",height:"24",viewBox:"0 0 24 24",role:"img",children:(0,a.jsx)("path",{d:"M6.361 2.943 0 21.056h4.942l1.077-3.133H11.4l1.052 3.133H22.9c.71 0 1.1-.392 1.1-1.101V17.53c0-.71-.39-1.101-1.1-1.101h-6.483V4.045c0-.71-.392-1.102-1.101-1.102h-2.422c-.71 0-1.101.392-1.101 1.102v1.064l-.758-2.166zm2.324 5.948 1.688 5.018H7.144z"})}),intent:"white",size:"md",children:"Get AniList token"})}),x[35]=n):n=x[35],x[36]===Symbol.for("react.memo_cache_sentinel")?(l=(0,W.Jo)(rQ),x[36]=l):l=x[36],x[37]!==b?(i=e=>{b.push("/auth/callback#access_token="+e.token.trim())},x[37]=b,x[38]=i):i=x[38],x[39]===Symbol.for("react.memo_cache_sentinel")?(r=(0,a.jsx)(W.D0.Textarea,{name:"token",label:"Enter the token",fieldClass:"px-4"}),s=(0,a.jsx)(W.D0.Submit,{showLoadingOverlayOnSuccess:!0,children:"Continue"}),x[39]=r,x[40]=s):(r=x[39],s=x[40]),x[41]!==i?(c=(0,a.jsx)("div",{className:"container max-w-3xl py-10",children:(0,a.jsx)(o.Zp,{className:"md:py-10",children:(0,a.jsx)(tZ.KZ,{children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[t,e,n,(0,a.jsxs)(W.lV,{schema:l,onSubmit:i,children:[r,s]})]})})})}),x[41]=i,x[42]=c):c=x[42],c}}else{let e,t,n,l,i;return x[26]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsx)("div",{className:"mb-4 flex justify-center w-full",children:(0,a.jsx)("img",{src:"/logo.png",alt:"logo",className:"w-24 h-auto"})}),e=(0,a.jsx)("h3",{children:"Welcome!"}),x[26]=e,x[27]=t):(e=x[26],t=x[27]),x[28]!==(null==j?void 0:j.anilistClientId)?(n=()=>{let e=(null==j?void 0:j.anilistClientId)?"https://anilist.co/api/v2/oauth/authorize?client_id=".concat(null==j?void 0:j.anilistClientId,"&response_type=token"):nQ.$M;window.open(e,"_self")},x[28]=null==j?void 0:j.anilistClientId,x[29]=n):n=x[29],x[30]===Symbol.for("react.memo_cache_sentinel")?(l=(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",width:"24",height:"24",viewBox:"0 0 24 24",role:"img",children:(0,a.jsx)("path",{d:"M6.361 2.943 0 21.056h4.942l1.077-3.133H11.4l1.052 3.133H22.9c.71 0 1.1-.392 1.1-1.101V17.53c0-.71-.39-1.101-1.1-1.101h-6.483V4.045c0-.71-.392-1.102-1.101-1.102h-2.422c-.71 0-1.101.392-1.101 1.102v1.064l-.758-2.166zm2.324 5.948 1.688 5.018H7.144z"})}),x[30]=l):l=x[30],x[31]!==n?(i=(0,a.jsx)("div",{className:"container max-w-3xl py-10",children:(0,a.jsx)(o.Zp,{className:"md:py-10",children:(0,a.jsx)(tZ.KZ,{children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[t,e,(0,a.jsx)(N.$n,{onClick:n,leftIcon:l,intent:"primary",size:"xl",children:"Log in with AniList"})]})})})}),x[31]=n,x[32]=i):i=x[32],i}return g}function rQ(e){let{z:t}=e;return t.object({token:t.string().min(1,"Token is required")})}function rX(e){let t,n,i,r,s,o=(0,l.c)(14),{children:c}=e,d=(0,eU.v1)(),[u,m]=h.useState("");if(o[0]===Symbol.for("react.memo_cache_sentinel")?(t=()=>{var e,t;m((null==(t=window)||null==(e=t.location)?void 0:e.host)||"")},n=[],o[0]=t,o[1]=n):(t=o[0],n=o[1]),h.useEffect(t,n),null==d?void 0:d.isOffline){let e,t,n;return o[2]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(nE,{}),o[2]=e):e=o[2],o[3]!==c?(t=(0,a.jsx)(rA,{children:(0,a.jsxs)("div",{"data-offline-layout-container":!0,className:"h-auto",children:[e,(0,a.jsx)("div",{"data-offline-layout-content":!0,children:c})]})}),o[3]=c,o[4]=t):t=o[4],o[5]!==u||o[6]!==t?(n=(0,a.jsx)(rW,{host:u,children:t}),o[5]=u,o[6]=t,o[7]=n):n=o[7],n}return o[8]===Symbol.for("react.memo_cache_sentinel")?(i=(0,a.jsx)(nE,{}),o[8]=i):i=o[8],o[9]!==c?(r=(0,a.jsx)(rE,{children:(0,a.jsxs)("div",{"data-main-layout-container":!0,className:"h-auto",children:[i,(0,a.jsx)("div",{"data-main-layout-content":!0,children:c})]})}),o[9]=c,o[10]=r):r=o[10],o[11]!==u||o[12]!==r?(s=(0,a.jsx)(rW,{host:u,children:r}),o[11]=u,o[12]=r,o[13]=s):s=o[13],s}let r$="force-static"},17205:(e,t,n)=>{"use strict";n.d(t,{DO:()=>u,ID:()=>c,Iu:()=>p,UT:()=>h,Xu:()=>m,Ym:()=>f,ke:()=>o,nC:()=>d,pK:()=>x});var a=n(19749),l=n(7675),i=n(74889),r=n(46278),s=n(69554);function o(e,t){let n,s,o,c=(0,a.c)(8),d=(0,r.jE)(),u=String(e);return c[0]!==t||c[1]!==u?(n=[i.S.MANGA_DOWNLOAD.DownloadMangaChapters.key,u,t],c[0]=t,c[1]=u,c[2]=n):n=c[2],c[3]!==d?(s=async()=>{await d.invalidateQueries({queryKey:[i.S.MANGA_DOWNLOAD.GetMangaDownloadData.key]})},c[3]=d,c[4]=s):s=c[4],c[5]!==n||c[6]!==s?(o={endpoint:i.S.MANGA_DOWNLOAD.DownloadMangaChapters.endpoint,method:i.S.MANGA_DOWNLOAD.DownloadMangaChapters.methods[0],mutationKey:n,onSuccess:s},c[5]=n,c[6]=s,c[7]=o):o=c[7],(0,l.qk)(o)}function c(e){let t,n,r=(0,a.c)(7),s=String(e.mediaId),o=String(e.cached);r[0]!==s||r[1]!==o?(t=[i.S.MANGA_DOWNLOAD.GetMangaDownloadData.key,s,o],r[0]=s,r[1]=o,r[2]=t):t=r[2];let c=!!e.mediaId;return r[3]!==t||r[4]!==e||r[5]!==c?(n={endpoint:i.S.MANGA_DOWNLOAD.GetMangaDownloadData.endpoint,method:i.S.MANGA_DOWNLOAD.GetMangaDownloadData.methods[0],queryKey:t,data:e,enabled:c},r[3]=t,r[4]=e,r[5]=c,r[6]=n):n=r[6],(0,l.fl)(n)}function d(){let e,t=(0,a.c)(1);return t[0]===Symbol.for("react.memo_cache_sentinel")?(e={endpoint:i.S.MANGA_DOWNLOAD.GetMangaDownloadQueue.endpoint,method:i.S.MANGA_DOWNLOAD.GetMangaDownloadQueue.methods[0],queryKey:[i.S.MANGA_DOWNLOAD.GetMangaDownloadQueue.key],enabled:!0},t[0]=e):e=t[0],(0,l.fl)(e)}function u(){let e,t,n=(0,a.c)(3),o=(0,r.jE)();return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.MANGA_DOWNLOAD.StartMangaDownloadQueue.key],n[0]=e):e=n[0],n[1]!==o?(t={endpoint:i.S.MANGA_DOWNLOAD.StartMangaDownloadQueue.endpoint,method:i.S.MANGA_DOWNLOAD.StartMangaDownloadQueue.methods[0],mutationKey:e,onSuccess:async()=>{await o.invalidateQueries({queryKey:[i.S.MANGA_DOWNLOAD.GetMangaDownloadQueue.key]}),s.oR.info("Downloading chapters")}},n[1]=o,n[2]=t):t=n[2],(0,l.qk)(t)}function m(){let e,t,n=(0,a.c)(3),o=(0,r.jE)();return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.MANGA_DOWNLOAD.StopMangaDownloadQueue.key],n[0]=e):e=n[0],n[1]!==o?(t={endpoint:i.S.MANGA_DOWNLOAD.StopMangaDownloadQueue.endpoint,method:i.S.MANGA_DOWNLOAD.StopMangaDownloadQueue.methods[0],mutationKey:e,onSuccess:async()=>{await o.invalidateQueries({queryKey:[i.S.MANGA_DOWNLOAD.GetMangaDownloadQueue.key]}),s.oR.success("Download queue stopped")}},n[1]=o,n[2]=t):t=n[2],(0,l.qk)(t)}function h(){let e,t,n=(0,a.c)(3),o=(0,r.jE)();return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.MANGA_DOWNLOAD.ClearAllChapterDownloadQueue.key],n[0]=e):e=n[0],n[1]!==o?(t={endpoint:i.S.MANGA_DOWNLOAD.ClearAllChapterDownloadQueue.endpoint,method:i.S.MANGA_DOWNLOAD.ClearAllChapterDownloadQueue.methods[0],mutationKey:e,onSuccess:async()=>{await o.invalidateQueries({queryKey:[i.S.MANGA_DOWNLOAD.GetMangaDownloadQueue.key]}),s.oR.success("Download queue cleared")}},n[1]=o,n[2]=t):t=n[2],(0,l.qk)(t)}function p(){let e,t,n=(0,a.c)(3),o=(0,r.jE)();return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.MANGA_DOWNLOAD.ResetErroredChapterDownloadQueue.key],n[0]=e):e=n[0],n[1]!==o?(t={endpoint:i.S.MANGA_DOWNLOAD.ResetErroredChapterDownloadQueue.endpoint,method:i.S.MANGA_DOWNLOAD.ResetErroredChapterDownloadQueue.methods[0],mutationKey:e,onSuccess:async()=>{await o.invalidateQueries({queryKey:[i.S.MANGA_DOWNLOAD.GetMangaDownloadQueue.key]}),s.oR.success("Reset errored chapters")}},n[1]=o,n[2]=t):t=n[2],(0,l.qk)(t)}function f(e,t){let n,o,c,d=(0,a.c)(8),u=(0,r.jE)(),m=String(e);return d[0]!==t||d[1]!==m?(n=[i.S.MANGA_DOWNLOAD.DeleteMangaDownloadedChapters.key,m,t],d[0]=t,d[1]=m,d[2]=n):n=d[2],d[3]!==u?(o=async()=>{await u.invalidateQueries({queryKey:[i.S.MANGA_DOWNLOAD.GetMangaDownloadData.key]}),s.oR.success("Chapters deleted")},d[3]=u,d[4]=o):o=d[4],d[5]!==n||d[6]!==o?(c={endpoint:i.S.MANGA_DOWNLOAD.DeleteMangaDownloadedChapters.endpoint,method:i.S.MANGA_DOWNLOAD.DeleteMangaDownloadedChapters.methods[0],mutationKey:n,onSuccess:o},d[5]=n,d[6]=o,d[7]=c):c=d[7],(0,l.qk)(c)}function x(){let e,t=(0,a.c)(1);return t[0]===Symbol.for("react.memo_cache_sentinel")?(e={endpoint:i.S.MANGA_DOWNLOAD.GetMangaDownloadsList.endpoint,method:i.S.MANGA_DOWNLOAD.GetMangaDownloadsList.methods[0],queryKey:[i.S.MANGA_DOWNLOAD.GetMangaDownloadsList.key],enabled:!0},t[0]=e):e=t[0],(0,l.fl)(e)}},29648:(e,t,n)=>{"use strict";n.d(t,{U6:()=>E,gw:()=>S,ho:()=>k});var a=n(95155),l=n(19749),i=n(7675),r=n(74889),s=n(15044),o=n(46278),c=n(69554),d=n(48555),u=n(83563),m=n(96826),h=n(24038),p=n(244),f=n(84127),x=n(76049),v=n(57073),g=n(60695),y=n(73832),b=n(42500),j=n(29724),w=n(12115),N=n(75780);let k=(0,b.eU)(!1),S=(0,b.eU)(!1);function E(){var e,t,n,b,E;let T,A,D,P,M,L,O,R,F,U,z,K,B,V,G,H,q,W,Q,X,$,Y,Z,J,ee,et=(0,l.c)(65),en=(0,m.v1)(),[ea,el]=(0,j.fp)(k),[,ei]=(0,j.fp)(S),[er]=(0,j.fp)(d.Qy),es=(0,y.C)(!0),eo=(0,y.C)(!0),ec=(0,y.C)(!0);et[0]!==el?(T=()=>{el(!1)},et[0]=el,et[1]=T):T=et[1];let{mutate:ed,isPending:eu}=function(e){let t,n,a=(0,l.c)(5),d=(0,o.jE)(),{mutate:u}=(0,s.H2)();return a[0]===Symbol.for("react.memo_cache_sentinel")?(t=[r.S.SCAN.ScanLocalFiles.key],a[0]=t):t=a[0],a[1]!==e||a[2]!==d||a[3]!==u?(n={endpoint:r.S.SCAN.ScanLocalFiles.endpoint,method:r.S.SCAN.ScanLocalFiles.methods[0],mutationKey:t,onSuccess:async()=>{await d.invalidateQueries({queryKey:[r.S.ANIME_COLLECTION.GetLibraryCollection.key]}),c.oR.success("Library scanned"),u(),await d.invalidateQueries({queryKey:[r.S.ANIME_ENTRIES.GetMissingEpisodes.key]}),await d.invalidateQueries({queryKey:[r.S.AUTO_DOWNLOADER.GetAutoDownloaderItems.key]}),await d.invalidateQueries({queryKey:[r.S.ANIME_ENTRIES.GetAnimeEntry.key]}),null==e||e()}},a[1]=e,a[2]=d,a[3]=u,a[4]=n):n=a[4],(0,i.qk)(n)}(T);et[2]!==es||et[3]!==(null==er?void 0:er.length)?(A=()=>{(null==er?void 0:er.length)?es.on():es.off()},et[2]=es,et[3]=null==er?void 0:er.length,et[4]=A):A=et[4],et[5]!==er?(D=[er],et[5]=er,et[6]=D):D=et[6],w.useEffect(A,D),et[7]!==eu||et[8]!==ei?(P=()=>{ei(eu)},et[7]=eu,et[8]=ei,et[9]=P):P=et[9],et[10]!==eu?(M=[eu],et[10]=eu,et[11]=M):M=et[11],w.useEffect(P,M),et[12]!==es.active||et[13]!==ed||et[14]!==el||et[15]!==ec.active||et[16]!==eo.active?(L=function(){ed({enhanced:!es.active,skipLockedFiles:eo.active,skipIgnoredFiles:ec.active}),el(!1)},et[12]=es.active,et[13]=ed,et[14]=el,et[15]=ec.active,et[16]=eo.active,et[17]=L):L=et[17];let em=L,{inject:eh,remove:ep}=(0,u.H)();et[18]!==em||et[19]!==eh||et[20]!==ep?(O=()=>(eh("scanner-controls",{priority:1,items:[{id:"refresh",value:"refresh",heading:"Library",render:_,onSelect:e=>{let{ctx:t}=e;t.close(),setTimeout(()=>{em()},500)},showBasedOnInput:"startsWith"}],filter:I,shouldShow:C,showBasedOnInput:"startsWith"}),()=>ep("scanner-controls")),et[18]=em,et[19]=eh,et[20]=ep,et[21]=O):O=et[21],et[22]===Symbol.for("react.memo_cache_sentinel")?(R=[],et[22]=R):R=et[22],w.useEffect(O,R),et[23]!==el?(F=e=>{el(e)},et[23]=el,et[24]=F):F=et[24],et[25]===Symbol.for("react.memo_cache_sentinel")?(U=(0,a.jsx)(h.Z,{spread:50,glow:!0,disabled:!1,proximity:100,inactiveZone:.01,className:"!mt-0 opacity-30"}),et[25]=U):U=et[25],et[26]!==(null==en||null==(e=en.user)?void 0:e.isSimulated)?(z=(null==en||null==(b=en.user)?void 0:b.isSimulated)&&(0,a.jsx)("div",{className:"border border-dashed rounded-md py-2 px-4 !mt-5",children:"Using this feature without an AniList account is not recommended if you have a large library, as it may lead to rate limits and slower scanning. Please consider using an account for a better experience."}),et[26]=null==en||null==(E=en.user)?void 0:E.isSimulated,et[27]=z):z=et[27],et[28]===Symbol.for("react.memo_cache_sentinel")?(K=(0,a.jsx)("h5",{className:"text-[--muted]",children:"Local files"}),et[28]=K):K=et[28],et[29]!==eo?(B=e=>eo.set(e),et[29]=eo,et[30]=B):B=et[30],et[31]!==eo.active||et[32]!==B?(V=(0,a.jsx)(g.d,{side:"right",label:"Skip locked files",value:eo.active,onValueChange:B}),et[31]=eo.active,et[32]=B,et[33]=V):V=et[33],et[34]!==ec?(G=e=>ec.set(e),et[34]=ec,et[35]=G):G=et[35],et[36]!==ec.active||et[37]!==G?(H=(0,a.jsx)(g.d,{side:"right",label:"Skip ignored files",value:ec.active,onValueChange:G}),et[36]=ec.active,et[37]=G,et[38]=H):H=et[38],et[39]===Symbol.for("react.memo_cache_sentinel")?(q=(0,a.jsx)(v.w,{}),et[39]=q):q=et[39],et[40]===Symbol.for("react.memo_cache_sentinel")?(W=(0,a.jsx)("h5",{className:"text-[--muted]",children:"Matching data"}),et[40]=W):W=et[40],et[41]!==es?(Q=e=>es.set(e),et[41]=es,et[42]=Q):Q=et[42],et[43]!==es.active?(X=es.active?"":(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{className:"text-[--orange]",children:"Slower for large libraries"}),". For faster scanning, add the anime entries present in your library to your lists and re-enable this before scanning."]}),et[43]=es.active,et[44]=X):X=et[44];let ef=!(null==er?void 0:er.length);et[45]!==es.active||et[46]!==Q||et[47]!==X||et[48]!==ef?($=(0,a.jsxs)(p.KZ,{className:"space-y-2",children:[W,(0,a.jsx)(g.d,{side:"right",label:"Use my AniList lists only",moreHelp:"Disabling this will cause Seanime to send more API requests which may lead to rate limits and slower scanning",value:es.active,onValueChange:Q,help:X,disabled:ef})]}),et[45]=es.active,et[46]=Q,et[47]=X,et[48]=ef,et[49]=$):$=et[49],et[50]!==V||et[51]!==H||et[52]!==$?(Y=(0,a.jsx)("div",{className:"space-y-4","data-scanner-modal-content":!0,children:(0,a.jsxs)(p.KZ,{className:"space-y-2",children:[K,V,H,q,$]})}),et[50]=V,et[51]=H,et[52]=$,et[53]=Y):Y=et[53],et[54]===Symbol.for("react.memo_cache_sentinel")?(Z=(0,a.jsx)(N.CKj,{}),et[54]=Z):Z=et[54];let ex=!(null==en||null==(n=en.settings)||null==(t=n.library)?void 0:t.libraryPath);return et[55]!==em||et[56]!==eu||et[57]!==ex?(J=(0,a.jsx)(f.$n,{onClick:em,intent:"primary",leftIcon:Z,loading:eu,className:"w-full",disabled:ex,children:"Scan"}),et[55]=em,et[56]=eu,et[57]=ex,et[58]=J):J=et[58],et[59]!==ea||et[60]!==z||et[61]!==Y||et[62]!==J||et[63]!==F?(ee=(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(x.a,{"data-scanner-modal":!0,open:ea,onOpenChange:F,title:"Library Scanner",titleClass:"text-center",contentClass:"space-y-4 max-w-2xl bg-gray-950 bg-opacity-70 backdrop-blur-sm firefox:bg-opacity-100 firefox:backdrop-blur-none rounded-xl",overlayClass:"bg-gray-950/70 backdrop-blur-sm",children:[U,z,Y,J]})}),et[59]=ea,et[60]=z,et[61]=Y,et[62]=J,et[63]=F,et[64]=ee):ee=et[64],ee}function C(e){let{ctx:t}=e;return"/"===t.router.pathname}function I(e){let{item:t,input:n}=e;return!n||t.value.toLowerCase().includes(n.toLowerCase())}function _(){return(0,a.jsx)("p",{children:"Refresh library"})}},39076:(e,t,n)=>{"use strict";n.d(t,{$0:()=>m,I2:()=>v,Sv:()=>h,Vb:()=>p});var a=n(19749),l=n(17205),i=n(24780),r=n(42500),s=n(29724),o=n(12115),c=n(69554);let d=(0,r.eU)(void 0),u=(0,r.eU)(e=>{let t=[],n=e(d);if(n){for(let e in n.downloaded)t=t.concat(n.downloaded[e].map(t=>({provider:e,chapterId:t.chapterId,chapterNumber:t.chapterNumber,queued:!1,downloaded:!0})));for(let e in n.queued)t=t.concat(n.queued[e].map(t=>({provider:e,chapterId:t.chapterId,chapterNumber:t.chapterNumber,queued:!0,downloaded:!1})))}return t});function m(){return(0,s.md)(u)}function h(e){let t,n,i,r,c=(0,a.c)(11),u=e?Number(e):void 0;c[0]!==u?(t={mediaId:u},c[0]=u,c[1]=t):t=c[1];let{data:m,isLoading:h,isError:p}=(0,l.ID)(t),f=(0,s.Xr)(d);return c[2]!==m||c[3]!==f?(n=()=>{f(m)},c[2]=m,c[3]=f,c[4]=n):n=c[4],c[5]!==m?(i=[m],c[5]=m,c[6]=i):i=c[6],o.useEffect(n,i),c[7]!==m||c[8]!==p||c[9]!==h?(r={downloadData:m,downloadDataLoading:h,downloadDataError:p},c[7]=m,c[8]=p,c[9]=h,c[10]=r):r=c[10],r}function p(e){let t,n,r=(0,a.c)(7),{selectedProvider:s}=(0,i.c2)(e),{mutate:o,isPending:c}=(0,l.ke)(e,s);return r[0]!==e||r[1]!==o||r[2]!==s?(t=t=>{s&&o({mediaId:Number(e),provider:s,chapterIds:t.map(x),startNow:!1},{onSuccess:f})},r[0]=e,r[1]=o,r[2]=s,r[3]=t):t=r[3],r[4]!==c||r[5]!==t?(n={downloadChapters:t,isSendingDownloadRequest:c},r[4]=c,r[5]=t,r[6]=n):n=r[6],n}function f(){c.oR.success("Chapters added to download queue")}function x(e){return e.id}function v(){let e,t=(0,a.c)(12),{data:n,isLoading:i,isError:r}=(0,l.nC)(),{mutate:s,isPending:o}=(0,l.DO)(),{mutate:c,isPending:d}=(0,l.Xu)(),{mutate:u,isPending:m}=(0,l.Iu)(),{mutate:h,isPending:p}=(0,l.UT)();return t[0]!==h||t[1]!==n||t[2]!==p||t[3]!==r||t[4]!==i||t[5]!==m||t[6]!==o||t[7]!==d||t[8]!==u||t[9]!==s||t[10]!==c?(e={downloadQueue:n,downloadQueueLoading:i,downloadQueueError:r,startDownloadQueue:s,isStartingDownloadQueue:o,stopDownloadQueue:c,isStoppingDownloadQueue:d,resetErroredChapters:u,isResettingErroredChapters:m,clearDownloadQueue:h,isClearingDownloadQueue:p},t[0]=h,t[1]=n,t[2]=p,t[3]=r,t[4]=i,t[5]=m,t[6]=o,t[7]=d,t[8]=u,t[9]=s,t[10]=c,t[11]=e):e=t[11],e}},55226:(e,t,n)=>{"use strict";function a(e){return(navigator.userAgent||"").includes(e)}function l(){return navigator.vendor.includes("Apple")&&!function(){return a("Tizen")}()}n.d(t,{Fr:()=>i,f8:()=>l});function i(){let e="";return navigator.userAgent&&(e=navigator.userAgent),!!/iPhone|iPad|iPod|Android/.test(e)||l()&&navigator.maxTouchPoints>1}},62322:(e,t,n)=>{"use strict";n.d(t,{W:()=>u,v:()=>d});var a=n(19749),l=n(7675),i=n(74889),r=n(96826),s=n(46278),o=n(6066),c=n(69554);function d(){let e,t,n,d,u=(0,a.c)(10),m=(0,s.jE)(),h=(0,o.useRouter)(),p=(0,r.LX)();return u[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.AUTH.Login.key],u[0]=e):e=u[0],u[1]!==m||u[2]!==h||u[3]!==p?(t=async e=>{e&&(c.oR.success("Successfully authenticated"),await m.invalidateQueries({queryKey:[i.S.ANIME_COLLECTION.GetLibraryCollection.key]}),await m.invalidateQueries({queryKey:[i.S.ANILIST.GetRawAnimeCollection.key]}),await m.invalidateQueries({queryKey:[i.S.ANILIST.GetAnimeCollection.key]}),await m.invalidateQueries({queryKey:[i.S.MANGA.GetMangaCollection.key]}),p(e),h.push("/"),m.invalidateQueries({queryKey:[i.S.ANIME_ENTRIES.GetMissingEpisodes.key]}),m.invalidateQueries({queryKey:[i.S.ANIME_ENTRIES.GetAnimeEntry.key]}),m.invalidateQueries({queryKey:[i.S.MANGA.GetMangaEntry.key]}))},u[1]=m,u[2]=h,u[3]=p,u[4]=t):t=u[4],u[5]!==h?(n=async e=>{c.oR.error(e.message),h.push("/")},u[5]=h,u[6]=n):n=u[6],u[7]!==t||u[8]!==n?(d={endpoint:i.S.AUTH.Login.endpoint,method:i.S.AUTH.Login.methods[0],mutationKey:e,onSuccess:t,onError:n},u[7]=t,u[8]=n,u[9]=d):d=u[9],(0,l.qk)(d)}function u(){let e,t,n=(0,a.c)(4),d=(0,s.jE)(),u=(0,o.useRouter)();return(0,r.LX)(),n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.AUTH.Logout.key],n[0]=e):e=n[0],n[1]!==d||n[2]!==u?(t={endpoint:i.S.AUTH.Logout.endpoint,method:i.S.AUTH.Logout.methods[0],mutationKey:e,onSuccess:async()=>{c.oR.success("Successfully logged out"),await d.invalidateQueries({queryKey:[i.S.ANIME_COLLECTION.GetLibraryCollection.key]}),await d.invalidateQueries({queryKey:[i.S.ANILIST.GetRawAnimeCollection.key]}),await d.invalidateQueries({queryKey:[i.S.ANILIST.GetAnimeCollection.key]}),await d.invalidateQueries({queryKey:[i.S.MANGA.GetMangaCollection.key]}),u.push("/"),d.invalidateQueries({queryKey:[i.S.ANIME_ENTRIES.GetMissingEpisodes.key]}),d.invalidateQueries({queryKey:[i.S.ANIME_ENTRIES.GetAnimeEntry.key]}),d.invalidateQueries({queryKey:[i.S.MANGA.GetMangaEntry.key]})}},n[1]=d,n[2]=u,n[3]=t):t=n[3],(0,l.qk)(t)}},63188:(e,t,n)=>{Promise.resolve().then(n.bind(n,16629))},80600:(e,t,n)=>{"use strict";n.d(t,{q:()=>h});var a=n(95155),l=n(19749),i=n(84218),r=n(12115);let s=e=>{let t,n,s,o,c,d,u,m,h=(0,l.c)(18),{startingGap:p,Breathing:f,gradientColors:x,gradientStops:v,animationSpeed:g,breathingRange:y,topOffset:b,containerClassName:j}=e,w=void 0===p?125:p,N=void 0===f||f;h[0]!==x?(t=void 0===x?["transparent","#312887","#3D5AFE","#FF80AB","#FF6D00","#FFD600","#00E676"]:x,h[0]=x,h[1]=t):t=h[1];let k=t;h[2]!==v?(n=void 0===v?[35,50,60,70,80,90,100]:v,h[2]=v,h[3]=n):n=h[3];let S=n,E=void 0===g?.02:g,C=void 0===y?5:y,I=void 0===b?0:b;if(k.length!==S.length)throw Error("GradientColors and GradientStops must have the same length.\n     Received gradientColors length: ".concat(k.length,",\n     gradientStops length: ").concat(S.length));let _=(0,r.useRef)(null);h[4]!==N||h[5]!==E||h[6]!==C||h[7]!==k||h[8]!==S||h[9]!==w||h[10]!==I?(s=()=>{let e,t,n;t=w,n=1;let a=()=>{t>=w+C&&(n=-1),t<=w-C&&(n=1),N||(n=0),t+=n*E;let l=S.map((e,t)=>"".concat(k[t]," ").concat(e,"%")).join(", "),i="radial-gradient(".concat(t,"% ").concat(t+I,"% at 50% 20%, ").concat(l,")");_.current&&(_.current.style.background=i),e=requestAnimationFrame(a)};return e=requestAnimationFrame(a),()=>cancelAnimationFrame(e)},o=[w,N,k,S,E,C,I],h[4]=N,h[5]=E,h[6]=C,h[7]=k,h[8]=S,h[9]=w,h[10]=I,h[11]=s,h[12]=o):(s=h[11],o=h[12]),(0,r.useEffect)(s,o),h[13]===Symbol.for("react.memo_cache_sentinel")?(c={opacity:0,scale:1.5},h[13]=c):c=h[13],h[14]===Symbol.for("react.memo_cache_sentinel")?(d={opacity:.2,scale:1,transition:{duration:2,ease:[.25,.1,.25,1]}},h[14]=d):d=h[14];let T="absolute inset-0 z-[0] overflow-hidden ".concat(void 0===j?"":j);return h[15]===Symbol.for("react.memo_cache_sentinel")?(u=(0,a.jsx)("div",{ref:_,className:"absolute inset-0 transition-transform"}),h[15]=u):u=h[15],h[16]!==T?(m=(0,a.jsx)(i.P.div,{initial:c,animate:d,className:T,children:u},"animated-gradient-background"),h[16]=T,h[17]=m):m=h[17],m};var o=n(42692),c=n(84127),d=n(2091),u=n(94077),m=n(35089);function h(e){let t,n,i,r,h,f=(0,l.c)(9),{refetch:x,title:v}=e;f[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsx)(m.default,{src:"/seanime-logo.png",alt:"Loading...",priority:!0,width:100,height:100,className:"animate-pulse z-[1]"}),n=(0,a.jsx)(s,{}),f[0]=t,f[1]=n):(t=f[0],n=f[1]);let g=null!=v?v:"S e a n i m e";return f[2]!==g?(i=(0,a.jsx)(o.W,{className:"text-lg mt-2 text-[--muted] animate-pulse z-[1]",words:g}),f[2]=g,f[3]=i):i=f[3],f[4]!==x?(r=u.X&&!!x&&(0,a.jsx)(c.$n,{onClick:p,className:"mt-4 z-[1]",intent:"gray-outline",size:"sm",children:"Reload"}),f[4]=x,f[5]=r):r=f[5],f[6]!==i||f[7]!==r?(h=(0,a.jsxs)(d.p8,{showSpinner:!1,children:[t,n,i,r]}),f[6]=i,f[7]=r,f[8]=h):h=f[8],h}function p(){return window.location.reload()}},92952:(e,t,n)=>{"use strict";n.d(t,{d:()=>_,r:()=>I});var a=n(95155),l=n(2159),i=n(58092),r=n(9478),s=n(81845),o=n(92224),c=n(14680),d=n(5249),u=n(244),m=n(84127),h=n(63352),p=n(91360),f=n(15388),x=n(2091),v=n(76136),g=n(52885),y=n(12556),b=n(42500),j=n(29724),w=n(12115),N=n(3692),k=n(28718),S=n(75780),E=n(80893),C=n(69554);let I=(0,b.eU)(!1);function _(e){var t,n;let{unmatchedGroups:b}=e,[_,T]=(0,j.fp)(I),[A,D]=w.useState(0),P=b.length-1,[M,L]=w.useState(null==b?void 0:b[0]),[O,R]=w.useState([]),[F,U]=w.useState(0),{mutate:z}=(0,i.E)(),{data:K,mutate:B,isPending:V,reset:G}=(0,l.XD)(),{mutate:H,isPending:q}=(0,r.bU)(),{mutate:W,isPending:Q}=(0,l.Zx)(),X=q||Q,[$,Y]=w.useState(0),Z=w.useCallback(e=>{e&&!isNaN(Number(e))&&(U(Number(e)),Y(e=>e+1))},[]);w.useLayoutEffect(()=>{var e,t;R(null!=(t=null==M||null==(e=M.localFiles)?void 0:e.map(e=>e.path))?t:[])},[M]),w.useEffect(()=>{D(0),L(b[0])},[_,b]),w.useEffect(()=>{L(b[A]),U(0),G()},[A,b]);let J=w.useCallback(()=>(0,a.jsx)(v.Q,{value:F,onValueChange:e=>U(e),formatOptions:{useGrouping:!1}}),[null==M?void 0:M.dir,$]);function ee(){0===A&&1===b.length&&T(!1),U(0),G(),D(0),L(b[0])}let et=w.useCallback(()=>{B({dir:M.dir},{onSuccess:e=>{setTimeout(()=>{(null==e?void 0:e.length)||C.oR.warning("No suggestions found, try searching manually")},500)}})},[null==M?void 0:M.dir,B]);w.useEffect(()=>{M||T(!1)},[M]);let{setSeaCommandInput:en,setSeaCommandOpen:ea}=(0,s.W)(),{searchAndSelectMedia:el,selectedAnime:ei,onAcknowledgeSelection:er}=(0,o.U)();return(w.useEffect(()=>{ei&&(U(ei.id),Y(e=>e+1),er(),ea(!1))},[ei]),M)?(0,a.jsx)(f._s,{"data-unmatched-file-manager-drawer":!0,open:_,onOpenChange:()=>T(!1),size:"xl",title:"Unmatched files",children:(0,a.jsxs)(u.KZ,{className:"mt-4",children:[(0,a.jsxs)("div",{className:(0,p.cn)("flex w-full justify-between",{hidden:b.length<=1}),children:[(0,a.jsx)(m.$n,{intent:"gray-subtle",leftIcon:(0,a.jsx)(N.QVr,{}),disabled:0===A,onClick:()=>{D(e=>e-1)},className:(0,p.cn)("transition-opacity",{"opacity-0":0===A}),children:"Previous"}),(0,a.jsxs)("p",{children:[A+1," / ",P+1]}),(0,a.jsx)(m.$n,{intent:"gray-subtle",rightIcon:(0,a.jsx)(N.Z0P,{}),disabled:A>=P,onClick:()=>{D(e=>e+1)},className:(0,p.cn)("transition-opacity",{"opacity-0":A>=P}),children:"Next"})]}),(0,a.jsxs)("div",{className:"bg-gray-900 border text-sm tracking-wide p-2 px-4 rounded-[--radius-md] line-clamp-1 flex gap-2 items-center cursor-pointer transition hover:bg-opacity-80",onClick:()=>z({path:M.dir}),children:[(0,a.jsx)(k.WNP,{className:"text-2xl"}),M.dir]}),(0,a.jsx)("div",{className:"flex items-center flex-wrap gap-2",children:(0,a.jsxs)("div",{className:"flex gap-2 items-center w-full",children:[(0,a.jsx)("p",{className:"flex-none text-lg mr-2 font-semibold",children:"Anilist ID"}),(0,a.jsx)(J,{}),(0,a.jsx)(m.$n,{intent:"white",onClick:function(){M&&F>0&&O.length>0&&W({paths:O,mediaId:F},{onSuccess:()=>{ee()}})},disabled:X,children:"Match selection"})]})}),(0,a.jsxs)("div",{className:"bg-gray-950 border p-2 px-2 divide-y divide-[--border] rounded-[--radius-md] max-h-[50vh] max-w-full overflow-x-auto overflow-y-auto text-sm",children:[(0,a.jsx)("div",{className:"p-2",children:(0,a.jsx)(h.Sc,{label:"Select all files",value:O.length===(null==M||null==(t=M.localFiles)?void 0:t.length)||0!==O.length&&"indeterminate",onValueChange:e=>{"boolean"==typeof e&&R(e=>{var t,n,a;return e.length===(null==M||null==(t=M.localFiles)?void 0:t.length)?[]:null!=(a=null==M||null==(n=M.localFiles)?void 0:n.map(e=>e.path))?a:[]})},fieldClass:"w-[fit-content]"})}),null==(n=M.localFiles)?void 0:n.sort((e,t)=>{var n,a,l,i;return Number(null!=(l=null==(n=e.parsedInfo)?void 0:n.episode)?l:0)-Number(null!=(i=null==(a=t.parsedInfo)?void 0:a.episode)?i:0)}).map((e,t)=>(0,a.jsx)("div",{className:"p-2 ",children:(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(h.Sc,{label:"".concat(y.V.basename(e.path)),value:O.includes(e.path),onValueChange:t=>{"boolean"==typeof t&&R(n=>t?[...n,e.path]:n.filter(t=>t!==e.path))},labelClass:"text-sm tracking-wide data-[checked=false]:opacity-50",fieldClass:"w-[fit-content]"})})},"".concat(e.path,"-").concat(t)))]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-1",children:[(0,a.jsx)(m.$n,{leftIcon:(0,a.jsx)(S.CKj,{}),intent:"white-link",onClick:et,children:"Fetch suggestions"}),(0,a.jsx)(m.$n,{intent:"white-subtle",onClick:function(){el("anime"),ea(!0),setTimeout(()=>{var e,t,n,a;en("/search "+((null==M||null==(a=M.localFiles)||null==(n=a[0])||null==(t=n.parsedFolderInfo)||null==(e=t[0])?void 0:e.title)||""))},200)},children:"Search on AniList"}),(0,a.jsx)("div",{className:"flex flex-1"}),(0,a.jsx)(m.$n,{leftIcon:(0,a.jsx)(E.dxg,{className:"text-lg"}),intent:"warning-subtle",size:"sm",rounded:!0,disabled:X,onClick:function(){O.length>0&&H({paths:O,action:"ignore"},{onSuccess:()=>{ee(),C.oR.success("Files ignored")}})},children:"Ignore selection"})]}),V&&(0,a.jsx)(x.kt,{}),!V&&!!(null==K?void 0:K.length)&&(0,a.jsx)(g.z,{defaultValue:"1",fieldClass:"w-full",fieldLabelClass:"text-md",label:"Select Anime",value:String(F),onValueChange:Z,options:null==K?void 0:K.map(e=>{var t,n,l,i,r,s,o;return{label:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-base md:text-md font-medium !-mt-1.5 line-clamp-1",children:(null==(t=e.title)?void 0:t.userPreferred)||(null==(n=e.title)?void 0:n.english)||(null==(l=e.title)?void 0:l.romaji)||"N/A"}),(0,a.jsxs)("div",{className:"mt-2 flex w-full gap-4",children:[(null==(i=e.coverImage)?void 0:i.medium)&&(0,a.jsx)("div",{className:"h-28 w-28 flex-none rounded-[--radius-md] object-cover object-center relative overflow-hidden",children:(0,a.jsx)(c.r,{src:e.coverImage.medium,alt:"",fill:!0,quality:100,priority:!0,sizes:"10rem",className:"object-cover object-center"})}),(0,a.jsxs)("div",{className:"text-[--muted]",children:[(0,a.jsxs)("p",{children:["Type: ",(0,a.jsx)("span",{className:"text-gray-200 font-semibold",children:e.format})]}),(0,a.jsxs)("p",{children:["Aired: ",(null==(r=e.startDate)?void 0:r.year)?new Intl.DateTimeFormat("en-US",{year:"numeric"}).format(new Date((null==(s=e.startDate)?void 0:s.year)||0,(null==(o=e.startDate)?void 0:o.month)||0)):"-"]}),(0,a.jsxs)("p",{children:["Status: ",e.status]}),(0,a.jsx)(d.i,{href:"https://anilist.co/anime/".concat(e.id),target:"_blank",children:(0,a.jsx)(m.$n,{intent:"primary-link",size:"sm",className:"px-0",children:"Open on AniList"})})]})]})]}),value:String(e.id)||""}}),stackClass:"grid grid-cols-1 md:grid-cols-2 gap-2 space-y-0",itemContainerClass:(0,p.cn)("items-start cursor-pointer transition border-transparent rounded-[--radius] p-4 w-full","bg-gray-50 hover:bg-[--subtle] dark:bg-gray-900","data-[state=checked]:bg-white dark:data-[state=checked]:bg-gray-950","focus:ring-2 ring-brand-100 dark:ring-brand-900 ring-offset-1 ring-offset-[--background] focus-within:ring-2 transition","border border-transparent data-[state=checked]:border-[--brand] data-[state=checked]:ring-offset-0"),itemClass:(0,p.cn)("border-transparent absolute top-2 right-2 bg-transparent dark:bg-transparent dark:data-[state=unchecked]:bg-transparent","data-[state=unchecked]:bg-transparent data-[state=unchecked]:hover:bg-transparent dark:data-[state=unchecked]:hover:bg-transparent","focus-visible:ring-0 focus-visible:ring-offset-0 focus-visible:ring-offset-transparent"),itemIndicatorClass:"hidden",itemLabelClass:"font-medium flex flex-col items-center data-[state=checked]:text-[--brand] cursor-pointer"})]})}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[7518,3873,5271,3380,844,9204,6446,2150,6711,585,5479,4506,5897,8087,5760,3603,7753,7949,2362,4613,512,9910,8429,8481,2202,4777,386,7825,1805,5290,4762,4218,4791,7228,6905,9986,1597,7528,5045,4809,9690,9325,9360,8154,1298,5340,4101,1029,8668,5050,1078,1683,5334,6862,4033,9484,9832,5565,2975,7363,5667,8441,6891,7358],()=>t(63188)),_N_E=e.O()}]);