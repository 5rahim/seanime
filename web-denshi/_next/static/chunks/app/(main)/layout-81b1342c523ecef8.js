(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2076],{17205:(e,t,n)=>{"use strict";n.d(t,{DO:()=>u,ID:()=>c,Iu:()=>p,UT:()=>x,Xu:()=>m,Ym:()=>h,ke:()=>o,nC:()=>d,pK:()=>f});var a=n(19749),l=n(7675),i=n(74889),s=n(46278),r=n(69554);function o(e,t){let n,r,o,c=(0,a.c)(8),d=(0,s.jE)(),u=String(e);return c[0]!==t||c[1]!==u?(n=[i.S.MANGA_DOWNLOAD.DownloadMangaChapters.key,u,t],c[0]=t,c[1]=u,c[2]=n):n=c[2],c[3]!==d?(r=async()=>{await d.invalidateQueries({queryKey:[i.S.MANGA_DOWNLOAD.GetMangaDownloadData.key]})},c[3]=d,c[4]=r):r=c[4],c[5]!==n||c[6]!==r?(o={endpoint:i.S.MANGA_DOWNLOAD.DownloadMangaChapters.endpoint,method:i.S.MANGA_DOWNLOAD.DownloadMangaChapters.methods[0],mutationKey:n,onSuccess:r},c[5]=n,c[6]=r,c[7]=o):o=c[7],(0,l.qk)(o)}function c(e){let t,n,s=(0,a.c)(7),r=String(e.mediaId),o=String(e.cached);s[0]!==r||s[1]!==o?(t=[i.S.MANGA_DOWNLOAD.GetMangaDownloadData.key,r,o],s[0]=r,s[1]=o,s[2]=t):t=s[2];let c=!!e.mediaId;return s[3]!==t||s[4]!==e||s[5]!==c?(n={endpoint:i.S.MANGA_DOWNLOAD.GetMangaDownloadData.endpoint,method:i.S.MANGA_DOWNLOAD.GetMangaDownloadData.methods[0],queryKey:t,data:e,enabled:c},s[3]=t,s[4]=e,s[5]=c,s[6]=n):n=s[6],(0,l.fl)(n)}function d(){let e,t=(0,a.c)(1);return t[0]===Symbol.for("react.memo_cache_sentinel")?(e={endpoint:i.S.MANGA_DOWNLOAD.GetMangaDownloadQueue.endpoint,method:i.S.MANGA_DOWNLOAD.GetMangaDownloadQueue.methods[0],queryKey:[i.S.MANGA_DOWNLOAD.GetMangaDownloadQueue.key],enabled:!0},t[0]=e):e=t[0],(0,l.fl)(e)}function u(){let e,t,n=(0,a.c)(3),o=(0,s.jE)();return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.MANGA_DOWNLOAD.StartMangaDownloadQueue.key],n[0]=e):e=n[0],n[1]!==o?(t={endpoint:i.S.MANGA_DOWNLOAD.StartMangaDownloadQueue.endpoint,method:i.S.MANGA_DOWNLOAD.StartMangaDownloadQueue.methods[0],mutationKey:e,onSuccess:async()=>{await o.invalidateQueries({queryKey:[i.S.MANGA_DOWNLOAD.GetMangaDownloadQueue.key]}),r.oR.info("Downloading chapters")}},n[1]=o,n[2]=t):t=n[2],(0,l.qk)(t)}function m(){let e,t,n=(0,a.c)(3),o=(0,s.jE)();return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.MANGA_DOWNLOAD.StopMangaDownloadQueue.key],n[0]=e):e=n[0],n[1]!==o?(t={endpoint:i.S.MANGA_DOWNLOAD.StopMangaDownloadQueue.endpoint,method:i.S.MANGA_DOWNLOAD.StopMangaDownloadQueue.methods[0],mutationKey:e,onSuccess:async()=>{await o.invalidateQueries({queryKey:[i.S.MANGA_DOWNLOAD.GetMangaDownloadQueue.key]}),r.oR.success("Download queue stopped")}},n[1]=o,n[2]=t):t=n[2],(0,l.qk)(t)}function x(){let e,t,n=(0,a.c)(3),o=(0,s.jE)();return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.MANGA_DOWNLOAD.ClearAllChapterDownloadQueue.key],n[0]=e):e=n[0],n[1]!==o?(t={endpoint:i.S.MANGA_DOWNLOAD.ClearAllChapterDownloadQueue.endpoint,method:i.S.MANGA_DOWNLOAD.ClearAllChapterDownloadQueue.methods[0],mutationKey:e,onSuccess:async()=>{await o.invalidateQueries({queryKey:[i.S.MANGA_DOWNLOAD.GetMangaDownloadQueue.key]}),r.oR.success("Download queue cleared")}},n[1]=o,n[2]=t):t=n[2],(0,l.qk)(t)}function p(){let e,t,n=(0,a.c)(3),o=(0,s.jE)();return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.MANGA_DOWNLOAD.ResetErroredChapterDownloadQueue.key],n[0]=e):e=n[0],n[1]!==o?(t={endpoint:i.S.MANGA_DOWNLOAD.ResetErroredChapterDownloadQueue.endpoint,method:i.S.MANGA_DOWNLOAD.ResetErroredChapterDownloadQueue.methods[0],mutationKey:e,onSuccess:async()=>{await o.invalidateQueries({queryKey:[i.S.MANGA_DOWNLOAD.GetMangaDownloadQueue.key]}),r.oR.success("Reset errored chapters")}},n[1]=o,n[2]=t):t=n[2],(0,l.qk)(t)}function h(e,t){let n,o,c,d=(0,a.c)(8),u=(0,s.jE)(),m=String(e);return d[0]!==t||d[1]!==m?(n=[i.S.MANGA_DOWNLOAD.DeleteMangaDownloadedChapters.key,m,t],d[0]=t,d[1]=m,d[2]=n):n=d[2],d[3]!==u?(o=async()=>{await u.invalidateQueries({queryKey:[i.S.MANGA_DOWNLOAD.GetMangaDownloadData.key]}),r.oR.success("Chapters deleted")},d[3]=u,d[4]=o):o=d[4],d[5]!==n||d[6]!==o?(c={endpoint:i.S.MANGA_DOWNLOAD.DeleteMangaDownloadedChapters.endpoint,method:i.S.MANGA_DOWNLOAD.DeleteMangaDownloadedChapters.methods[0],mutationKey:n,onSuccess:o},d[5]=n,d[6]=o,d[7]=c):c=d[7],(0,l.qk)(c)}function f(){let e,t=(0,a.c)(1);return t[0]===Symbol.for("react.memo_cache_sentinel")?(e={endpoint:i.S.MANGA_DOWNLOAD.GetMangaDownloadsList.endpoint,method:i.S.MANGA_DOWNLOAD.GetMangaDownloadsList.methods[0],queryKey:[i.S.MANGA_DOWNLOAD.GetMangaDownloadsList.key],enabled:!0},t[0]=e):e=t[0],(0,l.fl)(e)}},39076:(e,t,n)=>{"use strict";n.d(t,{$0:()=>m,I2:()=>g,Sv:()=>x,Vb:()=>p});var a=n(19749),l=n(17205),i=n(24780),s=n(42500),r=n(29724),o=n(12115),c=n(69554);let d=(0,s.eU)(void 0),u=(0,s.eU)(e=>{let t=[],n=e(d);if(n){for(let e in n.downloaded)t=t.concat(n.downloaded[e].map(t=>({provider:e,chapterId:t.chapterId,chapterNumber:t.chapterNumber,queued:!1,downloaded:!0})));for(let e in n.queued)t=t.concat(n.queued[e].map(t=>({provider:e,chapterId:t.chapterId,chapterNumber:t.chapterNumber,queued:!0,downloaded:!1})))}return t});function m(){return(0,r.md)(u)}function x(e){let t,n,i,s,c=(0,a.c)(11),u=e?Number(e):void 0;c[0]!==u?(t={mediaId:u},c[0]=u,c[1]=t):t=c[1];let{data:m,isLoading:x,isError:p}=(0,l.ID)(t),h=(0,r.Xr)(d);return c[2]!==m||c[3]!==h?(n=()=>{h(m)},c[2]=m,c[3]=h,c[4]=n):n=c[4],c[5]!==m?(i=[m],c[5]=m,c[6]=i):i=c[6],o.useEffect(n,i),c[7]!==m||c[8]!==p||c[9]!==x?(s={downloadData:m,downloadDataLoading:x,downloadDataError:p},c[7]=m,c[8]=p,c[9]=x,c[10]=s):s=c[10],s}function p(e){let t,n,s=(0,a.c)(7),{selectedProvider:r}=(0,i.c2)(e),{mutate:o,isPending:c}=(0,l.ke)(e,r);return s[0]!==e||s[1]!==o||s[2]!==r?(t=t=>{r&&o({mediaId:Number(e),provider:r,chapterIds:t.map(f),startNow:!1},{onSuccess:h})},s[0]=e,s[1]=o,s[2]=r,s[3]=t):t=s[3],s[4]!==c||s[5]!==t?(n={downloadChapters:t,isSendingDownloadRequest:c},s[4]=c,s[5]=t,s[6]=n):n=s[6],n}function h(){c.oR.success("Chapters added to download queue")}function f(e){return e.id}function g(){let e,t=(0,a.c)(12),{data:n,isLoading:i,isError:s}=(0,l.nC)(),{mutate:r,isPending:o}=(0,l.DO)(),{mutate:c,isPending:d}=(0,l.Xu)(),{mutate:u,isPending:m}=(0,l.Iu)(),{mutate:x,isPending:p}=(0,l.UT)();return t[0]!==x||t[1]!==n||t[2]!==p||t[3]!==s||t[4]!==i||t[5]!==m||t[6]!==o||t[7]!==d||t[8]!==u||t[9]!==r||t[10]!==c?(e={downloadQueue:n,downloadQueueLoading:i,downloadQueueError:s,startDownloadQueue:r,isStartingDownloadQueue:o,stopDownloadQueue:c,isStoppingDownloadQueue:d,resetErroredChapters:u,isResettingErroredChapters:m,clearDownloadQueue:x,isClearingDownloadQueue:p},t[0]=x,t[1]=n,t[2]=p,t[3]=s,t[4]=i,t[5]=m,t[6]=o,t[7]=d,t[8]=u,t[9]=r,t[10]=c,t[11]=e):e=t[11],e}},40275:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>lC,dynamic:()=>lk});var a=n(95155),l=n(19749),i=n(29648),s=n(14490),r=n(45754),o=n(52963),c=n(2091),d=n(6773),u=n(23862),m=n(29724),x=n(12115);function p(){let e,t,n,p,h,f,g,v,y=(0,l.c)(14),[b]=(0,m.fp)(i.gw),[j,N]=(0,x.useState)(0),[w,S]=(0,x.useState)("Scanning...");return(y[0]!==b?(e=()=>{b||(N(0),S("Scanning..."))},t=[b],y[0]=b,y[1]=e,y[2]=t):(e=y[1],t=y[2]),x.useEffect(e,t),y[3]===Symbol.for("react.memo_cache_sentinel")?(n={type:u.c.SCAN_PROGRESS,onMessage:e=>{console.log("Scan progress",e),N(e)}},y[3]=n):n=y[3],(0,s.oA)(n),y[4]===Symbol.for("react.memo_cache_sentinel")?(p={type:u.c.SCAN_STATUS,onMessage:e=>{console.log("Scan status",e),S(e)}},y[4]=p):p=y[4],(0,s.oA)(p),b)?(y[5]!==j?(h=(0,a.jsx)("div",{className:"w-full bg-gray-950 fixed top-0 left-0 z-[100]","data-scan-progress-bar-container":!0,children:(0,a.jsx)(d.z,{size:"xs",value:j})}),y[5]=j,y[6]=h):h=y[6],y[7]===Symbol.for("react.memo_cache_sentinel")?(f=(0,a.jsx)(c.y$,{className:"size-6"}),y[7]=f):f=y[7],y[8]!==j||y[9]!==w?(g=(0,a.jsx)("div",{className:"z-50 fixed bottom-4 right-4","data-scan-progress-bar-card-container":!0,children:(0,a.jsx)(r.f,{children:(0,a.jsx)(o.Zp,{className:"w-fit max-w-[400px] relative","data-scan-progress-bar-card":!0,children:(0,a.jsx)(o.aR,{children:(0,a.jsxs)(o.BT,{className:"flex items-center gap-2 text-base text-[--foregorund]",children:[f," ",j,"% - ",w]})})})})}),y[8]=j,y[9]=w,y[10]=g):g=y[10],y[11]!==h||y[12]!==g?(v=(0,a.jsxs)(a.Fragment,{children:[h,g]}),y[11]=h,y[12]=g,y[13]=v):v=y[13],v):null}var h=n(91360),f=n(42500);let g=(0,f.eU)(!1);function v(){let e,t,n=(0,l.c)(4),[i]=(0,m.fp)(g);return n[0]!==i?(e=i&&(0,a.jsx)("div",{className:(0,h.cn)("error-explainer-ui","fixed z-[100] bottom-8 w-fit left-20 h-fit flex","transition-all duration-300 select-none"),children:(0,a.jsx)("div",{className:(0,h.cn)("p-4 bg-gray-900 border text-white rounded-xl","transition-colors duration-300")})}),n[0]=i,n[1]=e):e=n[1],n[2]!==e?(t=(0,a.jsx)(a.Fragment,{children:e}),n[2]=e,n[3]=t):t=n[3],t}(0,f.eU)(null);var y=n(42094),b=n(38900),j=n(14680),N=n(5249),w=n(84127),S=n(30033),C=n(14370),k=n(14180),I=n(13890),E=n(68847),_=n(86694),A=n.n(_),T=n(6066),D=n(70376),M=n(75780);let O=(0,f.eU)(!1);function L(){var e,t,n,i,s,r,o,d;let u,p,f,g,v,_,L,P,F,U,z,H,K,G,W,B,q,V=(0,l.c)(36),[Q,$]=x.useState(""),Y=(0,C.d)(Q,500),X=(0,x.useRef)(null),[Z,J]=x.useState("anime"),ee=(0,T.useRouter)(),[et,en]=(0,m.fp)(O);V[0]!==et?(u=()=>{et&&setTimeout(()=>{var e;console.log("open",et,X.current),console.log("focusing"),null==(e=X.current)||e.focus()},300)},p=[et],V[0]=et,V[1]=u,V[2]=p):(u=V[1],p=V[2]),(0,x.useEffect)(u,p),V[3]===Symbol.for("react.memo_cache_sentinel")?(f=["FINISHED","CANCELLED","NOT_YET_RELEASED","RELEASING"],g=["SEARCH_MATCH"],V[3]=f,V[4]=g):(f=V[3],g=V[4]),V[5]!==Y?(v={search:Y,page:1,perPage:10,status:f,sort:g},V[5]=Y,V[6]=v):v=V[6];let{data:ea,isLoading:el,isFetching:ei}=(0,y.qN)(v,Y.length>0&&"anime"===Z);V[7]===Symbol.for("react.memo_cache_sentinel")?(_=["FINISHED","CANCELLED","NOT_YET_RELEASED","RELEASING"],L=["SEARCH_MATCH"],V[7]=_,V[8]=L):(_=V[7],L=V[8]),V[9]!==Y?(P={search:Y,page:1,perPage:10,status:_,sort:L},V[9]=Y,V[10]=P):P=V[10];let{data:es,isLoading:er,isFetching:eo}=(0,b.cE)(P,Y.length>0&&"manga"===Z),ec="anime"===Z?el:er,ed="anime"===Z?ei:eo;return V[11]!==(null==ea||null==(e=ea.Page)?void 0:e.media)||V[12]!==(null==es||null==(t=es.Page)?void 0:t.media)||V[13]!==Z?(U="anime"===Z?null==ea||null==(i=ea.Page)||null==(n=i.media)?void 0:n.filter(Boolean):null==es||null==(r=es.Page)||null==(s=r.media)?void 0:s.filter(Boolean),V[11]=null==ea||null==(o=ea.Page)?void 0:o.media,V[12]=null==es||null==(d=es.Page)?void 0:d.media,V[13]=Z,V[14]=U):U=V[14],F=U,V[15]===Symbol.for("react.memo_cache_sentinel")?(z=()=>$(""),V[15]=z):z=V[15],V[16]===Symbol.for("react.memo_cache_sentinel")?(H=(0,a.jsx)(k.e.Child,{as:x.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 transition-opacity backdrop-blur-sm"})}),V[16]=H):H=V[16],V[17]!==en?(K=(0,a.jsx)("div",{className:"absolute right-2 -top-7 z-10",children:(0,a.jsx)(N.i,{href:"/search",className:"text-[--muted] hover:text-[--foreground] font-bold",onClick:()=>en(!1),children:"Advanced search →"})}),V[17]=en,V[18]=K):K=V[18],V[19]!==Y||V[20]!==ed||V[21]!==ec||V[22]!==F||V[23]!==ee||V[24]!==en||V[25]!==Z?(G=(0,a.jsx)(I.G,{children:e=>{var t,n,l;let{activeOption:i}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"relative border bg-gray-950 shadow-2xl ring-1 ring-black ring-opacity-5 w-full rounded-xl",children:[(0,a.jsx)(M.CKj,{className:"pointer-events-none absolute top-4 left-4 h-6 w-6 text-[--muted]","aria-hidden":"true"}),(0,a.jsx)(I.G.Input,{ref:X,className:"h-14 w-full border-0 bg-transparent pl-14 pr-4 text-white placeholder-[--muted] focus:ring-0 sm:text-md",placeholder:"Search...",onChange:e=>$(e.target.value)}),(0,a.jsx)("div",{className:"block fixed lg:absolute top-2 right-2 z-1",children:(0,a.jsx)(S.l,{fieldClass:"w-fit",value:Z,onValueChange:e=>J(e),options:[{value:"anime",label:"Anime"},{value:"manga",label:"Manga"}]})})]}),!!F&&F.length>0&&(0,a.jsxs)(I.G.Options,{as:"div",static:!0,hold:!0,className:"flex divide-[--border] bg-gray-950 shadow-2xl ring-1 ring-black ring-opacity-5 rounded-xl border",children:[(0,a.jsx)("div",{className:(0,h.cn)("max-h-96 min-w-0 flex-auto scroll-py-2 overflow-y-auto px-6 py-2 my-2",{"sm:h-96":i}),children:(0,a.jsx)("div",{className:"-mx-2 text-sm text-[--foreground]",children:F.map(e=>(0,a.jsx)(I.G.Option,{as:"div",value:e,onClick:()=>{"anime"===Z?ee.push("/entry?id=".concat(e.id)):ee.push("/manga/entry?id=".concat(e.id)),en(!1)},className:R,children:t=>{var n,l,i;let{active:s}=t;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"h-10 w-10 flex-none rounded-[--radius-md] object-cover object-center relative overflow-hidden",children:(null==(n=e.coverImage)?void 0:n.medium)&&(0,a.jsx)(j.r,{src:null==(l=e.coverImage)?void 0:l.medium,alt:"",fill:!0,quality:50,priority:!0,sizes:"10rem",className:"object-cover object-center"})}),(0,a.jsx)("span",{className:"ml-3 flex-auto truncate",children:null==(i=e.title)?void 0:i.userPreferred}),s&&(0,a.jsx)(D.XWt,{className:"ml-3 h-7 w-7 flex-none text-gray-400","aria-hidden":"true"})]})}},e.id))})}),i&&(0,a.jsxs)("div",{className:"hidden min-h-96 w-1/2 flex-none flex-col overflow-y-auto sm:flex p-4",children:[(0,a.jsxs)("div",{className:"flex-none p-6 text-center",children:[(0,a.jsx)("div",{className:"h-40 w-32 mx-auto flex-none rounded-[--radius-md] object-cover object-center relative overflow-hidden",children:(null==(t=i.coverImage)?void 0:t.large)&&(0,a.jsx)(j.r,{src:null==(n=i.coverImage)?void 0:n.large,alt:"",fill:!0,quality:100,priority:!0,sizes:"10rem",className:"object-cover object-center"})}),(0,a.jsx)("h4",{className:"mt-3 font-semibold text-[--foreground] line-clamp-3",children:null==(l=i.title)?void 0:l.userPreferred}),(0,a.jsxs)("p",{className:"text-sm leading-6 text-[--muted]",children:[i.format,i.season?" - ".concat(A()(i.season)," "):" - ",i.seasonYear?i.seasonYear:"-"]})]}),(0,a.jsx)(N.i,{href:"anime"===Z?"/entry?id=".concat(i.id):"/manga/entry?id=".concat(i.id),onClick:()=>en(!1),children:(0,a.jsx)(w.$n,{type:"button",className:"w-full",intent:"gray-subtle",children:"Open"})})]})]}),""!==Y&&(!F||0===F.length)&&(ec||ed)&&(0,a.jsx)(c.kt,{}),""!==Y&&!ec&&!ed&&(!F||0===F.length)&&(0,a.jsxs)("div",{className:"py-14 px-6 text-center text-sm sm:px-14",children:[(0,a.jsx)("div",{className:"h-[10rem] w-[10rem] mx-auto flex-none rounded-[--radius-md] object-cover object-center relative overflow-hidden",children:(0,a.jsx)(j.r,{src:"/luffy-01.png",alt:"",fill:!0,quality:100,priority:!0,sizes:"10rem",className:"object-contain object-top"})}),(0,a.jsx)("h5",{className:"mt-4 font-semibold text-[--foreground]",children:"Nothing found"}),(0,a.jsx)("p",{className:"mt-2 text-[--muted]",children:"We couldn't find anything with that name. Please try again."})]})]})}}),V[19]=Y,V[20]=ed,V[21]=ec,V[22]=F,V[23]=ee,V[24]=en,V[25]=Z,V[26]=G):G=V[26],V[27]!==K||V[28]!==G?(W=(0,a.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto p-4 sm:p-6 md:p-20",children:(0,a.jsx)(k.e.Child,{as:x.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(E.l.Panel,{className:"mx-auto max-w-3xl transform space-y-4 transition-all",children:[K,G]})})}),V[27]=K,V[28]=G,V[29]=W):W=V[29],V[30]!==en||V[31]!==W?(B=(0,a.jsxs)(E.l,{as:"div",className:"relative z-50",onClose:en,children:[H,W]}),V[30]=en,V[31]=W,V[32]=B):B=V[32],V[33]!==et||V[34]!==B?(q=(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(k.e.Root,{show:et,as:x.Fragment,afterLeave:z,appear:!0,children:B})}),V[33]=et,V[34]=B,V[35]=q):q=V[35],q}function R(e){let{active:t}=e;return(0,h.cn)("flex select-none items-center rounded-[--radius-md] p-2 text-[--muted] cursor-pointer",t&&"bg-gray-800 text-white")}var P=n(76793),F=n(97447),U=n(92952),z=n(15044),H=n(58092),K=n(9478),G=n(48555),W=n(41611),B=n(3692);function q(e){let t,n,i,s,r=(0,l.c)(11),{fileNodes:o}=e,[c]=(0,m.fp)(W.fR),[d]=(0,m.fp)(W.Ob),[,u]=(0,m.fp)(W.yl);r[0]!==o||r[1]!==d?(t=null==o?void 0:o.filter(e=>d.has(e.path)&&"file"===e.kind),r[0]=o,r[1]=d,r[2]=t):t=r[2];let x=t;r[3]!==u?(n=()=>{u(!0)},r[3]=u,r[4]=n):n=r[4];let p=n;return r[5]!==p||r[6]!==c||r[7]!==(null==x?void 0:x.length)?(i=c&&!!(null==x?void 0:x.length)&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(w.$n,{leftIcon:(0,a.jsx)(B.wwX,{className:"text-xl"}),size:"sm",intent:"white-link",onClick:p,children:"Super update"})}),r[5]=p,r[6]=c,r[7]=null==x?void 0:x.length,r[8]=i):i=r[8],r[9]!==i?(s=(0,a.jsx)(a.Fragment,{children:i}),r[9]=i,r[10]=s):s=r[10],s}var V=n(63352),Q=n(14033),$=n(75435),Y=n(57073),X=n(53712),Z=n(77022),J=n(78453),ee=n(69554);let et=(0,Q.Jo)(e=>{let{z:t}=e;return t.object({searchText:t.string(),replaceText:t.string(),useRegex:t.boolean().default(!1),caseSensitive:t.boolean().default(!1),matchAllOccurrences:t.boolean().default(!1),enumerateItems:t.boolean().default(!1),editMetadata:t.boolean().default(!1)})});function en(e,t){return e=(e=e.replace(/\$\{\}/g,t.toString())).replace(/\$\{([^}]+)\}/g,(e,n)=>{let a={};for(let e of n.split(";")){let[t,n]=e.split("=");if(t&&n){let e=t.trim(),l=parseInt(n.trim());isNaN(l)||(a[e]=l)}}let l=a.padding||0,i=a.increment||1,s=(a.start||0)+t*i;return l>0?s.toString().padStart(l,"0"):s.toString()})}function ea(e){return e?e.trim():""}function el(e){let t=e.match(/^([a-zA-Z]*)(\d+)$/);if(t)return{prefix:t[1].toUpperCase(),number:parseInt(t[2],10)};let n=parseInt(e,10);return isNaN(n)?{prefix:"",number:0}:{prefix:"",number:n}}function ei(e){let t=e.split(";").map(e=>e.trim()),n={episodeConditions:[],anidbConditions:[]};for(let e of t)if(e.startsWith("type="))n.types=e.substring(5).split("|").filter(e=>["main","special","nc"].includes(e));else if(e.startsWith("!type="))n.excludeTypes=e.substring(6).split("|").filter(e=>["main","special","nc"].includes(e));else if(e.startsWith("anidb>=")){let t=el(e.substring(7));n.anidbConditions.push({operator:">=",value:t.number,prefix:t.prefix})}else if(e.startsWith("anidb<=")){let t=el(e.substring(7));n.anidbConditions.push({operator:"<=",value:t.number,prefix:t.prefix})}else if(e.startsWith("anidb>")){let t=el(e.substring(6));n.anidbConditions.push({operator:">",value:t.number,prefix:t.prefix})}else if(e.startsWith("anidb<")){let t=el(e.substring(6));n.anidbConditions.push({operator:"<",value:t.number,prefix:t.prefix})}else if(e.startsWith("anidb!=")){let t=el(e.substring(7));n.anidbConditions.push({operator:"!=",value:t.number,prefix:t.prefix})}else if(e.startsWith("!anidb=")){let t=el(e.substring(7));n.anidbConditions.push({operator:"!=",value:t.number,prefix:t.prefix})}else if(e.startsWith("anidb=")){let t=el(e.substring(6));n.anidbConditions.push({operator:"=",value:t.number,prefix:t.prefix})}else if(e.startsWith(">=")){let t=parseInt(e.substring(2));isNaN(t)||n.episodeConditions.push({operator:">=",value:t})}else if(e.startsWith("<=")){let t=parseInt(e.substring(2));isNaN(t)||n.episodeConditions.push({operator:"<=",value:t})}else if(e.startsWith(">")){let t=parseInt(e.substring(1));isNaN(t)||n.episodeConditions.push({operator:">",value:t})}else if(e.startsWith("<")){let t=parseInt(e.substring(1));isNaN(t)||n.episodeConditions.push({operator:"<",value:t})}else if(e.startsWith("!=")){let t=parseInt(e.substring(2));isNaN(t)||n.episodeConditions.push({operator:"!=",value:t})}else if(e.startsWith("!")){let t=parseInt(e.substring(1));isNaN(t)||n.episodeConditions.push({operator:"!=",value:t})}else if(e.startsWith("=")){let t=parseInt(e.substring(1));isNaN(t)||n.episodeConditions.push({operator:"=",value:t})}else if(/^\d+$/.test(e)){let t=parseInt(e);isNaN(t)||n.episodeConditions.push({operator:"=",value:t})}return n}function es(e,t,n,a){for(let t of a.episodeConditions)switch(t.operator){case">=":if(e<t.value)return!1;break;case"<=":if(e>t.value)return!1;break;case">":if(e<=t.value)return!1;break;case"<":if(e>=t.value)return!1;break;case"=":if(e!==t.value)return!1;break;case"!=":if(e===t.value)return!1}for(let e of a.anidbConditions){let t=el(n);if(void 0!==e.prefix&&e.prefix!==t.prefix)return!1;switch(e.operator){case">=":if(t.number<e.value)return!1;break;case"<=":if(t.number>e.value)return!1;break;case">":if(t.number<=e.value)return!1;break;case"<":if(t.number>=e.value)return!1;break;case"=":if(t.number!==e.value)return!1;break;case"!=":if(t.number===e.value)return!1}}return!(a.types&&!a.types.includes(t)||a.excludeTypes&&a.excludeTypes.includes(t))}function er(e,t){switch(t){case"lowercase":return e.toLowerCase();case"uppercase":return e.toUpperCase();case"titlecase":return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();case"capitalize":return e.replace(/\b\w/g,e=>e.toUpperCase());default:return e}}function eo(e){let{fileNodes:t}=e,[n,l]=(0,m.fp)(W.yl),i=(0,m.md)(W.Ob),[s,r]=(0,x.useState)("none"),[o,c]=(0,x.useState)([]),[d,u]=(0,x.useState)({searchText:"",replaceText:"",useRegex:!0,caseSensitive:!1,matchAllOccurrences:!1,enumerateItems:!0,editMetadata:!1}),{mutate:p,isPending:f}=(0,z.Gm)(),g=(0,x.useMemo)(()=>(null==t?void 0:t.filter(e=>i.has(e.path)&&"file"===e.kind))||[],[t,i]),v=(0,x.useMemo)(()=>{let e={...d,textFormatting:s};return g.map((t,n)=>{var a;let l=t.name,i=function(e,t){if(!e||""===e.trim())return t;let n=e.lastIndexOf("."),a=e,l="";n>0&&n<e.length-1&&(a=e.substring(0,n),l=e.substring(n));let i=a.replace(/[<>:"/\\|?*]/g,"_").replace(/\.\./g,"_").trim();if(""===i||/^[.\s]*$/.test(i))return t;let s=250-l.length;if(i.length>s&&s>0){let e=i.substring(0,s).trim();return""===e||/^[.\s]*$/.test(e)?t:e+l}return i+l}(function(e,t,n){let a=e.lastIndexOf("."),l=e,i="";a>0&&a<e.length-1&&(l=e.substring(0,a),i=e.substring(a));let s=l;if(!t.searchText)return t.enumerateItems&&(s=en(s,n)),(s=er(s,t.textFormatting))+i;try{if(t.useRegex){let e=t.caseSensitive?"g":"gi",n=new RegExp(t.searchText,e);t.matchAllOccurrences,s=l.replace(n,t.replaceText)}else{let e=t.caseSensitive?t.searchText:t.searchText.toLowerCase(),n=t.caseSensitive?l:l.toLowerCase();if(t.matchAllOccurrences){let a=n.split(e);if(s=a.join(t.replaceText),!t.caseSensitive){let e="",n=0;for(let i=0;i<a.length;i++)i>0&&(e+=t.replaceText),a[i]&&(e+=l.substr(n,a[i].length),n+=a[i].length+(i<a.length-1?t.searchText.length:0));s=e}}else{let a=n.indexOf(e);-1!==a&&(s=l.substring(0,a)+t.replaceText+l.substring(a+t.searchText.length))}}return t.enumerateItems&&(s=en(s,n)),(s=er(s,t.textFormatting))+i}catch(t){return e}}(l,e,n),l),s=null==(a=t.localFile)?void 0:a.metadata,r=d.editMetadata?function(e,t,n){let a,l,i;if(!e||0===t.length)return e;for(let r of t)switch(r.type){case"episode":{let t=ei(r.searchText);es(e.episode,e.type,e.aniDBEpisode,t)&&(a=function(e,t,n){let a=e;if(t.startsWith("increment=")){let n=parseInt(t.substring(10));isNaN(n)||(a=e+n)}else if(t.startsWith("decrement=")){let n=parseInt(t.substring(10));isNaN(n)||(a=e-n)}else{let e=parseInt(t);isNaN(e)||(a=e)}var l=a;if("string"==typeof l){let e=parseInt(l);return isNaN(e)?0:Math.max(0,e)}return"number"==typeof l?isNaN(l)?0:Math.max(0,Math.floor(l)):0}(e.episode,r.replaceText,0));break}case"anidb":{let t=!0;if(r.anidbSearchText&&r.anidbSearchText.trim()){let n=ei(r.anidbSearchText);t=es(e.episode,e.type,e.aniDBEpisode,n)}if(t)try{if(r.useRegex){let t=r.caseSensitive?"g":"gi",a=new RegExp(r.searchText,t);if(a.test(e.aniDBEpisode)){let t=e.aniDBEpisode.replace(a,r.replaceText);t=en(t,n),l=ea(t)}}else{let t=r.caseSensitive?r.searchText:r.searchText.toLowerCase();if((r.caseSensitive?e.aniDBEpisode:e.aniDBEpisode.toLowerCase()).includes(t)){let t=e.aniDBEpisode.replace(new RegExp(r.searchText.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r.caseSensitive?"g":"gi"),r.replaceText);t=en(t,n),l=ea(t)}}}catch(e){console.warn("Invalid regex in AniDB edit:",r.searchText,e)}break}case"type":{var s;let t=ei(r.searchText);es(e.episode,e.type,e.aniDBEpisode,t)&&(i=["main","special","nc"].includes(s=r.replaceText)?s:"nc")}}let r={...e};return void 0!==a&&(r.episode=a),void 0!==l&&(r.aniDBEpisode=l),void 0!==i&&(r.type=i),r}(s,o,n):s,c=d.editMetadata&&s&&r&&(s.episode!==r.episode||s.aniDBEpisode!==r.aniDBEpisode||s.type!==r.type);return{originalPath:t.path,originalName:l,newName:i,willChange:i!==l,originalMetadata:s,newMetadata:r,metadataWillChange:!!c}})},[g,d,s,o]),y=v.filter(e=>e.willChange||e.metadataWillChange),b=()=>{let e={id:Date.now().toString(),type:"episode",searchText:"",anidbSearchText:"",replaceText:""};c(t=>[...t,e])},j=(e,t)=>{c(n=>n.map(n=>n.id===e?{...n,...t}:n))},N=e=>{c(t=>t.filter(t=>t.id!==e))};return(0,a.jsx)(Z.Tr,{open:n,onOpenChange:l,children:(0,a.jsxs)(Z.Cz,{className:(0,h.cn)("bg-gray-950 h-[90%] lg:h-[85%] bg-opacity-95 firefox:bg-opacity-100 lg:mx-[2rem]"),children:[(0,a.jsx)("p",{className:"p-4 pb-0",children:(0,a.jsx)("span",{className:"text-sm text-[--muted]",children:"Update multiple file names and metadata at once."})}),(0,a.jsxs)("div",{className:"p-6 flex-1 overflow-hidden flex flex-col",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(Q.lV,{schema:et,onSubmit:e=>{let t=y.filter(e=>(!e.willChange||!!e.newName&&""!==e.newName.trim()&&e.newName!==e.originalName)&&(e.willChange||e.metadataWillChange));if(0===t.length)return void ee.oR.error("No valid changes to apply. Please check your settings.");let n=t.map(e=>({path:e.originalPath,...e.willChange&&{newName:e.newName},...e.metadataWillChange&&{metadata:e.newMetadata}}));if(t.length<y.length){let e=y.length-t.length;ee.oR.warning("Applying ".concat(t.length," changes, skipping ").concat(e," invalid changes"))}console.log("filesToUpdate",n),p({files:n},{onSuccess:()=>{let e=n.filter(e=>e.newName).length,t=n.filter(e=>e.metadata).length,a="Successfully updated ";e>0&&t>0?a+="".concat(e," filename(s) and ").concat(t," metadata"):e>0?a+="".concat(e," filename(s)"):t>0&&(a+="".concat(t," metadata")),ee.oR.success(a),l(!1),u({searchText:"",replaceText:"",useRegex:!0,caseSensitive:!1,matchAllOccurrences:!1,enumerateItems:!0,editMetadata:!1}),r("none"),c([])},onError:e=>{ee.oR.error("Failed to rename files: "+e.message)}})},onChange:e=>u(t=>({...t,...e})),defaultValues:d,id:"super-update-form",children:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4",children:[(0,a.jsx)(Q.D0.Text,{name:"searchText",label:"Search for",placeholder:"Enter text to search for..."}),(0,a.jsx)(Q.D0.Text,{name:"replaceText",label:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{children:"Replace with"}),(0,a.jsx)($.A,{className:"w-full max-w-2xl",trigger:(0,a.jsx)(J.ExT,{className:"transition-opacity opacity-45 hover:opacity-90"}),children:(0,a.jsxs)("div",{className:"p-3 bg-gray-800 rounded-md",children:[(0,a.jsx)("p",{className:"text-sm text-gray-300 mb-2",children:"Enumeration patterns:"}),(0,a.jsxs)("div",{className:"text-xs text-gray-400 space-y-1 font-mono",children:[(0,a.jsxs)("div",{children:["$","{}"," - Simple counter (0, 1, 2...)"]}),(0,a.jsxs)("div",{children:["$","{start=5}"," - Start from 5 (5, 6, 7...)"]}),(0,a.jsxs)("div",{children:["$","{increment=2}"," - Increment by 2 (0, 2, 4...)"]}),(0,a.jsxs)("div",{children:["$","{padding=3}"," - Pad with zeros (000, 001, 002...)"]}),(0,a.jsxs)("div",{children:["$","{padding=3;start=10}"," - Combined (010, 011, 012...)"]}),(0,a.jsxs)("div",{children:["$","{padding=2;increment=5}"," - Pad + increment (00, 05, 10...)"]}),(0,a.jsxs)("div",{children:["$","{increment=2;start=1;padding=3}"," - All combined (001, 003, 005...)"]})]})]})})]}),placeholder:"Enter replacement text..."})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 mb-4",children:[(0,a.jsx)(Q.D0.Checkbox,{name:"useRegex",label:"Use regex",fieldClass:"w-fit"}),(0,a.jsx)(Q.D0.Checkbox,{name:"caseSensitive",label:"Case sensitive",fieldClass:"w-fit"}),(0,a.jsx)(Q.D0.Checkbox,{name:"matchAllOccurrences",label:"Match all occurrences",fieldClass:"w-fit"}),(0,a.jsx)(Q.D0.Checkbox,{name:"enumerateItems",label:"Enumerate items",fieldClass:"w-fit"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Text formatting"}),(0,a.jsx)("div",{className:"flex gap-2",children:[{value:"none",label:"None"},{value:"lowercase",label:"aa"},{value:"uppercase",label:"AA"},{value:"titlecase",label:"Aa"},{value:"capitalize",label:"Aa Aa"}].map(e=>(0,a.jsx)("button",{type:"button",className:(0,h.cn)("px-3 py-1 rounded border text-sm font-mono",s===e.value?"bg-brand-500 border-brand-500 text-white":"bg-gray-800 border-gray-600 text-gray-300 hover:bg-gray-700"),onClick:()=>r(e.value),children:e.label},e.value))})]}),(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(Q.D0.Checkbox,{name:"editMetadata",label:"Edit file metadata",fieldClass:"w-fit"})}),e.watch("editMetadata")&&(0,a.jsxs)("div",{className:"mb-4 p-4 bg-gray-900 border rounded-md max-h-[230px] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-300"}),(0,a.jsx)(w.$n,{leftIcon:(0,a.jsx)(D.Ca6,{}),intent:"gray-outline",size:"sm",onClick:b,children:"Add Rule"})]}),0===o.length?(0,a.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:'No metadata edit rules. Click "Add Rule" to create one.'}):(0,a.jsx)("div",{className:"space-y-4",children:o.map((e,t)=>(0,a.jsx)(ec,{edit:e,index:t,onUpdate:t=>j(e.id,t),onRemove:()=>N(e.id)},e.id))})]})]})})}),(0,a.jsx)(Y.w,{className:"mb-4"}),(0,a.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,a.jsxs)("div",{className:"mb-4 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex gap-6",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-300",children:["Original (",g.length,")"]}),(0,a.jsxs)("span",{className:"text-sm text-gray-300",children:["Renamed (",y.length,")"]})]}),(0,a.jsxs)(w.$n,{type:"submit",form:"super-update-form",disabled:0===y.length||f,loading:f,leftIcon:(0,a.jsx)(D.Y$T,{}),intent:"white",size:"sm",children:["Apply (",y.length,")"]})]}),(0,a.jsx)("div",{className:(0,h.cn)("overflow-y-auto flex-1 bg-gray-950 border rounded-md p-2 h-[calc(100%-55px)]"),children:0===v.length?(0,a.jsx)("div",{className:"text-center text-gray-500 py-8",children:"No files selected"}):(0,a.jsx)("div",{className:"space-y-2",children:v.map((e,t)=>(0,a.jsxs)("div",{className:(0,h.cn)("flex items-center gap-3 p-2 rounded",e.willChange||e.metadataWillChange?"bg-green-900/20":"bg-gray-800/20 hover:bg-gray-800/30"),children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"text-sm text-gray-300 truncate tracking-wide select-text",children:e.originalName}),e.willChange&&(0,a.jsx)("div",{className:"text-md text-green-200 truncate tracking-wide",children:e.newName}),e.metadataWillChange&&e.originalMetadata&&e.newMetadata&&(0,a.jsxs)("div",{className:"text-xs text-blue-300 mt-1 space-y-1",children:[e.originalMetadata.episode!==e.newMetadata.episode&&(0,a.jsxs)("div",{children:["Episode: ",e.originalMetadata.episode," → ",e.newMetadata.episode]}),e.originalMetadata.aniDBEpisode!==e.newMetadata.aniDBEpisode&&(0,a.jsxs)("div",{children:['AniDB: "',e.originalMetadata.aniDBEpisode,'" → "',e.newMetadata.aniDBEpisode,'"']}),e.originalMetadata.type!==e.newMetadata.type&&(0,a.jsxs)("div",{children:["Type: ",e.originalMetadata.type," → ",e.newMetadata.type]})]})]}),(e.willChange||e.metadataWillChange)&&(0,a.jsxs)("div",{className:"text-xs flex-shrink-0 flex flex-col gap-1",children:[e.willChange&&(0,a.jsx)("div",{className:(0,h.cn)(e.newName===e.originalName?"text-yellow-500":"text-green-500"),children:e.newName===e.originalName?"No Change":"Renamed"}),e.metadataWillChange&&(0,a.jsx)("div",{className:"text-blue-500",children:"Metadata"})]})]},e.originalPath))})})]})]})]})})}function ec(e){let t,n,i,s,r,o,c,d,u,m,x,p,h,f,g,v,y,b,j,N,C,k,I=(0,l.c)(59),{edit:E,index:_,onUpdate:A,onRemove:T}=e;I[0]!==E.type?(t=()=>{switch(E.type){case"episode":return"e.g.: >=1;<=12;!=5;type=main|special;!type=nc";case"anidb":return"Enter text or regex pattern";case"type":return"e.g.: >=1;<12;=5;type=main;!type=special";default:return""}},I[0]=E.type,I[1]=t):t=I[1];let M=t;I[2]!==E.type?(n=()=>{switch(E.type){case"episode":return"e.g.: increment=1, decrement=1, or direct value like 5";case"anidb":return"Replacement text (supports enumeration patterns)";case"type":return"Select new type";default:return""}},I[2]=E.type,I[3]=n):n=I[3];let O=n;I[4]!==E.type?(i=()=>{switch(E.type){case"episode":return"Operators: >=, <=, >, <, =, !=, ! | Types: type=main|special|nc, !type=special";case"anidb":return"Supports regex patterns and case sensitivity options";case"type":return"Same operators as episode: >=, <=, >, <, =, !=, ! | Types: type=main, !type=special";default:return""}},I[4]=E.type,I[5]=i):i=I[5];let L=i,R=_+1;I[6]!==R?(s=(0,a.jsxs)("span",{className:"text-xs font-mono text-gray-400",children:["#",R]}),I[6]=R,I[7]=s):s=I[7],I[8]===Symbol.for("react.memo_cache_sentinel")?(r=[{value:"episode",label:"Episode Number"},{value:"anidb",label:"AniDB Episode"},{value:"type",label:"File Type"}],I[8]=r):r=I[8],I[9]!==A?(o=e=>{A({type:e}),"anidb"===e&&(A({searchText:"^(.*)$"}),A({useRegex:!0}))},I[9]=A,I[10]=o):o=I[10],I[11]!==E.type||I[12]!==o?(c=(0,a.jsx)(S.l,{options:r,value:E.type,onValueChange:o,size:"sm"}),I[11]=E.type,I[12]=o,I[13]=c):c=I[13],I[14]===Symbol.for("react.memo_cache_sentinel")?(d=(0,a.jsx)("div",{className:"flex-1"}),I[14]=d):d=I[14],I[15]===Symbol.for("react.memo_cache_sentinel")?(u=(0,a.jsx)(D.id1,{}),I[15]=u):u=I[15],I[16]!==T?(m=(0,a.jsx)(w.K0,{icon:u,intent:"alert-subtle",size:"sm",onClick:T}),I[16]=T,I[17]=m):m=I[17],I[18]!==m||I[19]!==s||I[20]!==c?(x=(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[s,c,d,m]}),I[18]=m,I[19]=s,I[20]=c,I[21]=x):x=I[21],I[22]!==E.anidbSearchText||I[23]!==E.type||I[24]!==A?(p="anidb"===E.type&&(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Filter (Optional)"}),(0,a.jsx)(X.k,{placeholder:function(){return"e.g.: anidb>=1;anidb=S1;anidb!=C2;type=special"}(),value:E.anidbSearchText||"",onValueChange:e=>A({anidbSearchText:e||""}),size:"sm"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:function(){return"AniDB operators: anidb>=, anidb<=, anidb=, anidb!=, !anidb= | Format: numbers (1,12) or prefixed (S1,C2,T1)"}()})]}),I[22]=E.anidbSearchText,I[23]=E.type,I[24]=A,I[25]=p):p=I[25];let P="anidb"===E.type?"Find (Text/Regex)":"Search";I[26]!==P?(h=(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:P}),I[26]=P,I[27]=h):h=I[27];let F="anidb"===E.type?"Enter text or regex pattern":M();I[28]!==A?(f=e=>A({searchText:e||""}),I[28]=A,I[29]=f):f=I[29],I[30]!==E.searchText||I[31]!==F||I[32]!==f?(g=(0,a.jsx)(X.k,{placeholder:F,value:E.searchText,onValueChange:f,size:"sm"}),I[30]=E.searchText,I[31]=F,I[32]=f,I[33]=g):g=I[33],I[34]!==h||I[35]!==g?(v=(0,a.jsxs)("div",{className:"flex-1",children:[h,g]}),I[34]=h,I[35]=g,I[36]=v):v=I[36],I[37]===Symbol.for("react.memo_cache_sentinel")?(y=(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Replace"}),I[37]=y):y=I[37],I[38]!==E.replaceText||I[39]!==E.type||I[40]!==O||I[41]!==A?(b=(0,a.jsxs)("div",{className:"flex-1",children:[y,"type"===E.type?(0,a.jsx)(S.l,{options:[{value:"main",label:"Main"},{value:"special",label:"Special"},{value:"nc",label:"NC"}],value:E.replaceText,onValueChange:e=>A({replaceText:e||""}),placeholder:"Select type",size:"sm"}):(0,a.jsx)(X.k,{placeholder:O(),value:E.replaceText,onValueChange:e=>A({replaceText:e||""}),size:"sm"})]}),I[38]=E.replaceText,I[39]=E.type,I[40]=O,I[41]=A,I[42]=b):b=I[42],I[43]!==p||I[44]!==v||I[45]!==b?(j=(0,a.jsx)("div",{className:"space-y-3 mb-3",children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row gap-3",children:[p,v,b]})}),I[43]=p,I[44]=v,I[45]=b,I[46]=j):j=I[46],I[47]!==E.caseSensitive||I[48]!==E.type||I[49]!==E.useRegex||I[50]!==A?(N="anidb"===E.type&&(0,a.jsxs)("div",{className:"flex gap-4 mb-2",children:[(0,a.jsx)(V.Sc,{label:"Use regex",value:E.useRegex||!1,onValueChange:e=>A({useRegex:!!e}),size:"sm",labelClass:"text-xs text-gray-300"}),(0,a.jsx)(V.Sc,{label:"Case sensitive",value:E.caseSensitive||!1,onValueChange:e=>A({caseSensitive:!!e}),size:"sm",labelClass:"text-xs text-gray-300"})]}),I[47]=E.caseSensitive,I[48]=E.type,I[49]=E.useRegex,I[50]=A,I[51]=N):N=I[51];let U=L();return I[52]!==U?(C=(0,a.jsx)("p",{className:"text-xs text-gray-500",children:U}),I[52]=U,I[53]=C):C=I[53],I[54]!==x||I[55]!==j||I[56]!==N||I[57]!==C?(k=(0,a.jsxs)("div",{className:"p-3 bg-gray-950 rounded-xl border",children:[x,j,N,C]}),I[54]=x,I[55]=j,I[56]=N,I[57]=C,I[58]=k):k=I[58],k}function ed(e){let t=[];if("file"===e.kind)t.push(e.path);else if("directory"===e.kind&&e.children)for(let n of e.children)t.push(...ed(n));return t}function eu(e){if(!e)return[];let t=[];if("file"===e.kind)t.push(e);else if("directory"===e.kind&&e.children)for(let n of e.children)t.push(...eu(n));return t}var em=n(75733),ex=n(50558),ep=n(63717),eh=n(47342),ef=n(76049),eg=n(97400),ev=n(12556),ey=n(62816),eb=n(65057),ej=n(43994),eN=n(41452),ew=n(40568),eS=n(64685),eC=n(68090),ek=n(28668),eI=n(94936),eE=n(47601),e_=n(61585),eA=n(32754);function eT(e,t,n){var a,l,i,s,r,o,c;if("file"===t.kind)switch(n){case"UNMATCHED":return!!t.localFile&&!(null==(l=t.localFile)?void 0:l.mediaId)&&!t.localFile.ignored;case"UNLOCKED":return!!(null==(i=t.localFile)?void 0:i.mediaId)&&!t.localFile.locked&&!t.localFile.ignored;case"IGNORED":return!!(null==(s=t.localFile)?void 0:s.ignored);case"UNKNOWN_MEDIA":return!!(null==(r=t.localFile)?void 0:r.mediaId)&&!(null==e?void 0:e.find(e=>e.id===t.localFile.mediaId))&&!(null==(o=t.localFile)?void 0:o.ignored);default:return!0}return null!=(c=null==(a=t.children)?void 0:a.some(t=>eT(e,t,n)))&&c}function eD(e,t,n,a){let l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],r="directory"===t.kind,o=t.children&&t.children.length>0,c=a&&t.children?t.children.filter(e=>(function e(t,n){return!!t.name.toLowerCase().includes(n)||!!t.children&&t.children.some(t=>e(t,n))})(e,a)):t.children;if(l&&c){if(r&&!eT(e,t,l))return s;c=c.filter(t=>{var n,a,i,s,r,o,c;if("directory"===t.kind)return eT(e,t,l);switch(l){case"UNMATCHED":return!(null==(n=t.localFile)?void 0:n.mediaId)&&!(null==(a=t.localFile)?void 0:a.ignored);case"UNLOCKED":return!!(null==(i=t.localFile)?void 0:i.mediaId)&&!t.localFile.locked&&!(null==(s=t.localFile)?void 0:s.ignored);case"IGNORED":return!!(null==(r=t.localFile)?void 0:r.ignored);case"UNKNOWN_MEDIA":return!!(null==(o=t.localFile)?void 0:o.mediaId)&&!(null==e?void 0:e.find(e=>e.id===t.localFile.mediaId))&&!(null==(c=t.localFile)?void 0:c.ignored);default:return!0}})}return(!a||t.name.toLowerCase().includes(a)||c&&c.length>0)&&(s.push({node:t,level:i,index:s.length}),r&&o&&n.has(t.path)&&(c||[]).forEach(t=>{eD(e,t,n,a,l,i+1,s)})),s}function eM(){var e,t;let{data:n,isLoading:l}=(0,z.Gd)(),i=(0,z.H2)(),[s,r]=(0,m.fp)(W._S),[o,d]=x.useState(""),[u,p]=x.useState(new Set),[f]=(0,m.fp)(W.qE),[g,v]=(0,m.fp)(W.fR),[y,b]=x.useState(void 0),j=(0,m.md)(G.Qy),[N]=(0,m.fp)(W.m7),S=x.useRef(null),{mutate:C}=(0,K.bU)(),{mutate:k}=(0,H.E)(),[,I]=(0,m.fp)(U.r),[,E]=(0,m.fp)(F.$),[,_]=(0,m.fp)(W.m7),A=e=>{C({paths:e,action:"unmatch"})},T=e=>{C({paths:e,action:"lock"})},M=e=>{C({paths:e,action:"unlock"})},O=e=>{C({paths:e,action:"ignore"})},L=e=>{C({paths:e,action:"unignore"})},R=e=>{var t,n;_(null!=(n=null==e||null==(t=e.filter(e=>{var t;return e.localFile&&!(null==(t=e.localFile)?void 0:t.mediaId)}))?void 0:t.map(e=>e.localFile))?n:[]),x.startTransition(()=>{I(!0)})},P=e=>{_(null!=e?e:[]),x.startTransition(()=>{E(!0)})},B=e=>{k({path:e})},V=x.useCallback(e=>{p(t=>{let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},[]),Q=x.useRef(u),Y=x.useRef(null);x.useEffect(()=>(Y.current&&(clearTimeout(Y.current),Y.current=null),Y.current=setTimeout(()=>{if(0===u.size)return;let e=Array.from(Q.current).filter(e=>!u.has(e));if(e.length>0){let t=[];e.forEach(e=>{Array.from(u).forEach(n=>{n.startsWith(e+"/")&&t.push(n)})}),t.length>0&&p(e=>{let n=new Set(e);return t.forEach(e=>n.delete(e)),n})}Q.current=u},100),()=>{Y.current&&(clearTimeout(Y.current),Y.current=null)}),[u]);let Z=x.useCallback(e=>{r(e)},[]),J=x.useCallback(()=>{v(e=>!e)},[]),[ee,et]=(0,m.fp)(W.Ob);x.useEffect(()=>{g||et(new Set)},[g]);let en=x.useCallback((e,t)=>{et(n=>{let a=new Set(n);if("file"===e.kind)t?a.add(e.path):a.delete(e.path);else{let n=ed(e);t?n.forEach(e=>a.add(e)):n.forEach(e=>a.delete(e))}return a})},[]),{width:ea}=(0,eC.A)(),el=eu(null==n?void 0:n.root),ei=null==el?void 0:el.filter(e=>{var t;return!(null==(t=e.localFile)?void 0:t.ignored)}),es=null==ei?void 0:ei.some(e=>!e.localFile),er=x.useMemo(()=>(null==n?void 0:n.root)?eD(j,n.root,u,o.toLowerCase(),y):[],[null==n?void 0:n.root,u,o,y,j]),[ec,em]=(0,m.fp)(W._J),ep=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!ec)return null;if(e.path.toLowerCase()===ec.toLowerCase())return{node:e,parents:t};if(e.children)for(let n of e.children){let a=ep(n,[...t,e.path]);if(a)return a}return null};x.useEffect(()=>{if(ec&&f&&(null==n?void 0:n.root)){let e=ep(n.root);if(e){r(e.node);let t=new Set([...e.parents,ec]);p(e=>new Set([...e,...t])),setTimeout(()=>{let e=eD(j,n.root,t,o.toLowerCase(),y).findIndex(e=>e.node.path.toLowerCase()===ec.toLowerCase());if(e>=0){var a;null==(a=S.current)||a.scrollToIndex({index:e,align:"start"})}},500)}em(null)}},[ec,f,null==n?void 0:n.root,ep,o,y,j]);let eh=null==ei?void 0:ei.some(e=>e.localFile&&!!e.localFile.mediaId&&!e.localFile.locked),ef=null==ei?void 0:ei.filter(e=>!!e.localFile&&!e.localFile.mediaId),eg=null==ei?void 0:ei.filter(e=>!!e.localFile&&!!e.localFile.mediaId&&(null==j?void 0:j.findIndex(t=>t.id===e.localFile.mediaId))===-1),ey=e=>{if(!e)return b(void 0);b(e)};return l?(0,a.jsx)("div",{className:"p-4 lg:p-8 flex-1 overflow-y-auto flex items-center justify-center",children:(0,a.jsx)(c.kt,{})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"hidden lg:flex h-full",children:[(0,a.jsxs)("div",{className:"flex-1 flex flex-col border-r bg-gray-950",children:[(0,a.jsxs)("div",{className:"p-4 border-b space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-100 2xl:block hidden",children:"Library Explorer"}),eh&&(0,a.jsx)(ex.F,{intent:"info",className:"text-sm py-1 px-3 cursor-pointer",description:"Lock all correctly matched files",onClick:()=>{b("UNLOCKED")}}),!!(null==ef?void 0:ef.length)&&(0,a.jsx)(ex.F,{intent:"warning",className:"text-sm py-1 px-3 cursor-pointer",description:"".concat(ef.length," unmatched file").concat(1!=ef.length?"s":""),onClick:()=>{b("UNMATCHED")}}),!!(null==eg?void 0:eg.length)&&(0,a.jsx)(ex.F,{intent:"warning",className:"text-sm py-1 px-3 cursor-pointer",description:"".concat(eg.length," file").concat(1!=eg.length?"s":""," with hidden media"),onClick:()=>{b("UNKNOWN_MEDIA")}})]}),(0,a.jsx)("div",{className:"flex flex-1"}),(0,a.jsx)(eO,{fileNodes:el,handleMatchFiles:R,handleUnmatchFiles:A,handleIgnoreFiles:O,handleUnignoreFiles:L}),(0,a.jsx)(q,{fileNodes:el}),!y&&(0,a.jsxs)($.A,{trigger:(0,a.jsx)(w.$n,{leftIcon:(0,a.jsx)(ej.y_E,{className:"text-xl"}),size:"sm",intent:y?"white":"gray-subtle",onClick:()=>{ey()},className:(0,h.cn)(!!y&&"animate-pulse"),children:"Filter"}),children:[(0,a.jsx)(w.$n,{intent:"gray-link",size:"sm",className:"w-full",onClick:()=>ey("UNMATCHED"),children:"Unmatched files"}),(0,a.jsx)(w.$n,{intent:"gray-link",size:"sm",className:"w-full",onClick:()=>ey("UNLOCKED"),children:"Unlocked files"}),(0,a.jsx)(w.$n,{intent:"gray-link",size:"sm",className:"w-full",onClick:()=>ey("IGNORED"),children:"Ignored files"}),(0,a.jsx)(w.$n,{intent:"gray-link",size:"sm",className:"w-full",onClick:()=>ey("UNKNOWN_MEDIA"),children:"Unknown media"})]}),!!y&&(0,a.jsxs)(w.$n,{leftIcon:(0,a.jsx)(ej.k7K,{className:"text-xl"}),size:"sm",intent:"white",onClick:()=>{ey()},className:(0,h.cn)("animate-pulse"),children:["Filter: ",y?(0,eb.fL)(y):""]}),(0,a.jsxs)(w.$n,{leftIcon:(0,a.jsx)(D.Y$T,{className:"text-xl"}),size:"sm",intent:g?"white":"gray-subtle",onClick:J,className:(0,h.cn)(g&&"animate-pulse"),children:["Select",g?"ing":""]}),(0,a.jsx)(w.K0,{icon:(0,a.jsx)(ej.Z05,{}),size:"sm",intent:"gray-subtle",onClick:()=>{i.mutate()},loading:i.isPending})]}),(0,a.jsx)(X.k,{placeholder:"Search files and folders...",value:o,onChange:e=>d(e.target.value),leftIcon:(0,a.jsx)(D.iyI,{}),size:"sm"}),es&&(0,a.jsx)(ex.F,{intent:"warning",description:"Some files have not been scanned yet. Please scan the library to be able to perform actions on them."})]}),(0,a.jsx)("div",{className:"flex-1 library-explorer-tree-container",children:(0,a.jsx)(ek.aY,{ref:S,data:er,itemContent:(e,t)=>(0,a.jsx)(eF,{item:t,isExpanded:u.has(t.node.path),onToggleExpand:V,onSelect:Z,selectedPath:null==s?void 0:s.path,localFiles:null==n?void 0:n.localFiles,selectedPaths:ee,onPathSelection:en,windowWidth:ea,onUnmatchFiles:A,onLockFiles:T,onUnlockFiles:M,onIgnoreFiles:O,onUnignoreFiles:L,onMatchFiles:R,onResolveMedia:P,onOpenInExplorer:B},t.node.path),style:{height:"100%"},components:{Footer:()=>(0,a.jsx)("div",{className:"p-2",children:(0,a.jsx)("p",{className:"text-xs text-gray-400 text-center py-2",children:"End"})})}})})]}),(0,a.jsx)("div",{className:"flex flex-col flex-none bg-gray-950/50 w-80",children:(0,a.jsx)(eU,{localFiles:null==n?void 0:n.localFiles})})]}),(0,a.jsx)(U.d,{unmatchedGroups:[{dir:ev.V.dirname((null==(e=N[0])?void 0:e.path)||""),localFiles:N}]}),(0,a.jsx)(F.U,{unknownGroups:[{mediaId:(null==(t=N[0])?void 0:t.mediaId)||0,localFiles:N}],onActionComplete:()=>{E(!1),_([])}}),(0,a.jsx)(eo,{fileNodes:el})]})}function eO(e){let t,n,i,s,r,o,c,d,u=(0,l.c)(28),{fileNodes:x,handleMatchFiles:p,handleUnmatchFiles:h,handleIgnoreFiles:f,handleUnignoreFiles:g}=e,[v]=(0,m.fp)(W.fR),[y]=(0,m.fp)(W.Ob);u[0]!==x||u[1]!==y?(i=null==(t=null==x?void 0:x.filter(e=>y.has(e.path)))?void 0:t.some(eP),n=null==t?void 0:t.some(eR),s=null==t?void 0:t.every(eL),u[0]=x,u[1]=y,u[2]=t,u[3]=n,u[4]=i,u[5]=s):(t=u[2],n=u[3],i=u[4],s=u[5]);let b=s;u[6]!==p||u[7]!==h||u[8]!==t||u[9]!==y||u[10]!==i?(r=function(){i?h(Array.from(y)):p(t)},u[6]=p,u[7]=h,u[8]=t,u[9]=y,u[10]=i,u[11]=r):r=u[11];let j=r;u[12]!==f||u[13]!==g||u[14]!==y||u[15]!==n||u[16]!==b?(o=function(){n?f(Array.from(y)):b&&g(Array.from(y))},u[12]=f,u[13]=g,u[14]=y,u[15]=n,u[16]=b,u[17]=o):o=u[17];let N=o;return u[18]!==j||u[19]!==N||u[20]!==v||u[21]!==t||u[22]!==n||u[23]!==b||u[24]!==i?(c=v&&!!(null==t?void 0:t.length)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(w.$n,{leftIcon:(0,a.jsx)(eN.eXw,{className:"text-xl"}),size:"sm",intent:i?"warning-link":"success-link",onClick:j,children:[i?"Unmatch":"Match"," ",t.length," file",1!=t.length?"s":""]}),(n||b)&&(0,a.jsxs)(w.$n,{leftIcon:(0,a.jsx)(ej.ofU,{className:"text-xl"}),size:"sm",intent:"gray-link",onClick:N,children:[n?"Ignore":"Un-ignore"," ",t.length," file",1!=t.length?"s":""]})]}),u[18]=j,u[19]=N,u[20]=v,u[21]=t,u[22]=n,u[23]=b,u[24]=i,u[25]=c):c=u[25],u[26]!==c?(d=(0,a.jsx)(a.Fragment,{children:c}),u[26]=c,u[27]=d):d=u[27],d}function eL(e){return"file"===e.kind&&!!e.localFile&&e.localFile.ignored}function eR(e){return"file"===e.kind&&!!e.localFile&&!e.localFile.ignored}function eP(e){var t;return"file"===e.kind&&!!e.localFile&&!!(null==(t=e.localFile)?void 0:t.mediaId)}let eF=(0,x.memo)(e=>{var t,n,l,i,s,r,o,c,d,u,p,f,g,v,y,b,N,S,C,k,I,E;let{item:_,isExpanded:A,onToggleExpand:T,onSelect:O,selectedPath:L,localFiles:R,selectedPaths:P,onPathSelection:F,windowWidth:U,onUnmatchFiles:z,onLockFiles:H,onUnlockFiles:q,onIgnoreFiles:$,onUnignoreFiles:Y,onMatchFiles:X,onResolveMedia:Z,onOpenInExplorer:J}=e,{node:et,level:en}=_,ea="directory"===et.kind,el=L===et.path,ei=et.children&&et.children.some(e=>"directory"===e.kind),es=et.children&&et.children.length>0,er=(0,m.md)(G.Qy),eo=(0,m.md)(W.fR),ec=(0,m.Xr)(W.Ob),ex=(0,m.Xr)(W.yl),[ev,eb]=x.useState(!1),{updateLocalFile:eC}=(0,K.sS)();x.useCallback(e=>{e.stopPropagation()},[]);let ek=x.useCallback(e=>{e.stopPropagation()},[]),e_=x.useCallback(e=>{F(et,!0===e)},[et]),eT=32*en+8,eD=(null==(t=et.mediaIds)?void 0:t.length)===1?null==er?void 0:er.find(e=>{var t;return e.id===(null==(t=et.mediaIds)?void 0:t[0])}):void 0,eM=(null==(n=et.mediaIds)?void 0:n.length)===1&&!eD,eO=eu(et),eL=null==eO?void 0:eO.filter(e=>{var t;return!(null==(t=e.localFile)?void 0:t.ignored)}),eR=null==eL?void 0:eL.filter(e=>{var t;return!!(null==(t=e.localFile)?void 0:t.mediaId)}),eP=null!=(k=null==eL?void 0:eL.length)?k:0,eF=null!=(I=null==eR?void 0:eR.length)?I:0,eU=null!=(E=null==eL?void 0:eL.every(e=>{var t;return!!(null==(t=e.localFile)?void 0:t.mediaId)}))&&E,ez=null==eO?void 0:eO.every(e=>{var t;return!!(null==(t=e.localFile)?void 0:t.ignored)}),eH=null==eL?void 0:eL.every(e=>!!e.localFile),eK=null==eL?void 0:eL.every(e=>{var t;return!!(null==(t=e.localFile)?void 0:t.locked)||!e.localFile}),[eG,eW]=x.useState(null!=eK&&eK);x.useEffect(()=>{eW(null!=eK&&eK)},[eK]);let eB=x.useMemo(()=>U-eT-620,[U,eT,null==eD||null==(l=eD.title)?void 0:l.userPreferred]),{isPending:eq}=(0,K.bU)(),eV=()=>{if(!eq){if(ea)eG?q(ed(et)):H(ed(et));else{var e;(null==(e=et.localFile)?void 0:e.locked)?q([et.path]):H([et.path])}eW(e=>!e)}},eQ=e=>{e.stopPropagation(),eV()},{setPreviewModalMediaId:e$}=(0,eA.D)(),eY=!!et.localFile,[eX,eZ]=x.useState(!1),eJ=(0,em.J)({title:"Lock all files",description:"This will lock all files in the directory. Are you sure you want to proceed?",actionText:"Lock all",actionIntent:"primary",onConfirm:async()=>{eQ(new MouseEvent("click"))}}),e0=(0,em.J)({title:"Unlock all files",description:"This will unlock all files in the directory. Are you sure you want to proceed?",actionText:"Unlock all",actionIntent:"primary",onConfirm:async()=>{eQ(new MouseEvent("click"))}});return(0,a.jsxs)("div",{className:"px-2",children:[(0,a.jsx)(em.K,{...eJ}),(0,a.jsx)(em.K,{...e0}),(0,a.jsx)(eE.i,{onOpenChange:eZ,content:(0,a.jsxs)(ey.Q2,{children:[(0,a.jsx)(eh.F7,{className:"text-[--muted] line-clamp-2 py-0 my-2 text-xs tracking-wide",children:et.name}),(null==(i=et.mediaIds)?void 0:i.length)===1&&(0,a.jsxs)(eh.kt,{onClick:function(){var e,t,n;let a=null!=(n=null!=(t=null==eD?void 0:eD.id)?t:null==(e=et.mediaIds)?void 0:e[0])?n:0;if(!a)return void ee.oR.error("No media found");e$(a,"anime")},children:[(0,a.jsx)(ej.ZT8,{})," Preview anime"]}),eM&&(0,a.jsxs)(eh.kt,{onClick:()=>{var e,t,n,a,l;let i=null!=(a=null!=(n=null==eD?void 0:eD.id)?n:null==(e=et.mediaIds)?void 0:e[0])?a:0;if(!i||!R)return void ee.oR.error("No media found");Z(null!=(l=null==(t=Object.values(R))?void 0:t.filter(e=>e.mediaId===i))?l:[])},children:[(0,a.jsx)(ej._rf,{})," Resolve unknown media"]}),(0,a.jsxs)(eh.kt,{onClick:function(){ea?(ec(new Set(ed(et))),x.startTransition(()=>{ex(!0)})):(ec(new Set([et.path])),x.startTransition(()=>{ex(!0)}))},children:[(0,a.jsx)(B.wwX,{})," Super update"]}),ea&&!!eP&&(0,a.jsxs)(a.Fragment,{children:[eU&&(0,a.jsxs)(eh.kt,{onClick:()=>{z(ed(et))},className:(0,h.cn)("text-[--orange]",eq&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(eN.eXw,{className:"text-lg"})," Unmatch files"]}),!eU&&(0,a.jsxs)(eh.kt,{onClick:()=>{X(eu(et))},className:(0,h.cn)("text-[--green]",eq&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(eN.Raw,{className:"text-lg"})," Match files"]}),!ez&&(0,a.jsxs)(eh.kt,{onClick:()=>{$(ed(et))},className:(0,h.cn)("",eq&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(ej.ofU,{className:"text-lg"})," Ignore files"]}),ez&&(0,a.jsxs)(eh.kt,{onClick:()=>{Y(ed(et))},className:(0,h.cn)("text-purple-300",eq&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(ej.uKT,{className:"text-lg"})," Un-ignore files"]})]}),!ea&&eY&&(0,a.jsxs)(a.Fragment,{children:[!!(null==(s=et.localFile)?void 0:s.mediaId)&&(0,a.jsxs)(eh.kt,{onClick:()=>eb(!0),className:(0,h.cn)("text-[--blue]",eq&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(ej.Pcz,{className:"text-lg"})," Edit metadata"]}),!!(null==(r=et.localFile)?void 0:r.mediaId)&&(0,a.jsxs)(eh.kt,{onClick:()=>{z([et.path])},className:(0,h.cn)("text-[--orange]",eq&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(eN.eXw,{className:"text-lg"})," Unmatch file"]}),!(null==(o=et.localFile)?void 0:o.mediaId)&&(0,a.jsxs)(eh.kt,{onClick:()=>{X(eu(et))},className:(0,h.cn)("text-[--green]",eq&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(eN.Raw,{className:"text-lg"})," Match file"]}),!(null==et||null==(c=et.localFile)?void 0:c.ignored)&&(0,a.jsxs)(eh.kt,{onClick:()=>{$([et.path])},className:(0,h.cn)("",eq&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(ej.ofU,{className:"text-lg"})," Ignore file"]}),(null==et||null==(d=et.localFile)?void 0:d.ignored)&&(0,a.jsxs)(eh.kt,{onClick:()=>{Y([et.path])},className:(0,h.cn)("text-purple-300",eq&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(ej.uKT,{className:"text-lg"})," Un-ignore file"]})]}),(0,a.jsx)(eh.K5,{className:"!my-2"}),(0,a.jsxs)(eh.kt,{onClick:()=>{J(et.path)},children:[(0,a.jsx)(D.gNt,{})," Open in explorer"]})]}),children:(0,a.jsx)(eh.Rc,{children:(0,a.jsxs)("div",{className:(0,h.cn)("flex items-center px-2 h-10 rounded-md cursor-pointer select-none group/tree-node transition-colors",!el&&"hover:bg-gray-800/50",el&&"bg-brand-500/20 text-brand-100",eX&&"bg-gray-800/30"),style:{paddingLeft:eT},onClick:()=>{O(et),ea&&es&&T(et.path)},children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[ea&&es&&(0,a.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:A?(0,a.jsx)(D.nwe,{className:"size-4 text-gray-400"}):(0,a.jsx)(D.XWt,{className:"size-4 text-gray-400"})}),eo&&(ea||eY)&&(0,a.jsx)("div",{className:"flex h-full items-center",children:(0,a.jsx)(V.Sc,{size:"md",fieldClass:"flex-shrink-0 flex items-center",value:function(e,t){if("file"===e.kind)return t.has(e.path);let n=ed(e);if(0===n.length)return!1;let a=n.filter(e=>t.has(e)).length;return 0!==a&&(a===n.length||"indeterminate")}(et,P),onClick:ek,onValueChange:e_})}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(()=>{var e,t,n,l,i;return ea?0===en?(0,a.jsx)(M.nOB,{className:"size-5 text-brand-400"}):A?(0,a.jsx)(ew.b$g,{className:(0,h.cn)("size-5 text-brand-400/90",!(null==(l=et.mediaIds)?void 0:l.length)&&"text-[--muted]")}):(0,a.jsx)(M.UDU,{className:(0,h.cn)("size-5 text-brand-400/80",!(null==(i=et.mediaIds)?void 0:i.length)&&"text-[--muted]")}):et.localFile?(0,a.jsx)(ej.bs1,{className:(0,h.cn)("size-4 text-[--muted]",(null==(e=et.localFile.metadata)?void 0:e.type)==="main"&&"text-brand-400/70",(null==(t=et.localFile.metadata)?void 0:t.type)==="special"&&"text-cyan-200/50",(null==(n=et.localFile.metadata)?void 0:n.type)==="nc"&&"text-gray-200/30")}):(0,a.jsx)(ej.AHA,{className:"size-4 text-[--muted]"})})()}),ea&&!!eD&&(0,a.jsx)("div",{className:"size-6 flex-none rounded-[--radius-md] object-cover object-center relative overflow-hidden ml-2",children:(0,a.jsx)(j.r,{src:(null==(u=eD.coverImage)?void 0:u.medium)||"",alt:(null==(p=eD.title)?void 0:p.userPreferred)||"",fill:!0,sizes:"1rem",className:"object-cover object-center"})}),ea&&!eD&&!!(null==(f=et.mediaIds)?void 0:f.length)&&(null==(g=et.mediaIds)?void 0:g.length)>1&&(0,a.jsx)("div",{className:"h-6 px-2 flex-none rounded-[--radius-md] flex items-center justify-center bg-gray-800 ml-2 text-white text-xs font-semibold",children:null==(v=et.mediaIds)?void 0:v.length}),(0,a.jsxs)("span",{className:"text-md tracking-wide text-gray-200 break-all group-hover/tree-node:text-gray-100 flex gap-1 items-center w-full overflow-hidden",style:{maxWidth:eB+"px"},children:[(0,a.jsx)("span",{className:(0,h.cn)("truncate min-w-0",!ea&&!!et.localFile&&!et.localFile.mediaId&&"text-orange-200",!ea&&!eY&&"text-red-200",!ea&&(null==(y=et.localFile)?void 0:y.ignored)&&"text-[--muted] italic"),children:"root"===et.name?"Anime Libraries":et.name}),(!!eD||eM)&&(0,a.jsxs)("span",{className:(0,h.cn)("hidden tracking-normal 2xl:flex text-[--muted] text-sm flex-shrink whitespace-nowrap line-clamp-1 items-center gap-1"),style:{maxWidth:200},children:[(0,a.jsx)("span",{children:" - "}),(0,a.jsx)("span",{children:eM?"(?)":null==eD||null==(b=eD.title)?void 0:b.userPreferred})]}),eM&&(0,a.jsx)(eg.m_,{trigger:(0,a.jsx)(ep.E,{intent:"unstyled",children:"Unknown media"}),children:"This media is not in your collection."}),ez&&ea&&(0,a.jsxs)("span",{className:(0,h.cn)("hidden 2xl:flex text-[--muted] text-sm flex-shrink whitespace-nowrap line-clamp-1 items-center gap-1"),style:{maxWidth:200},children:[(0,a.jsx)("span",{children:" "}),(0,a.jsx)("span",{children:"(Ignored)"})]})]})]}),ea&&!!eP&&!ez&&(0,a.jsx)(eg.m_,{trigger:(0,a.jsxs)("span",{className:(0,h.cn)("text-xs bg-green-500/20 text-[--green] px-2 py-0.5 rounded-full",eP!==eF&&"bg-orange-500/20 text-[--orange]",!eH&&"bg-red-500/20 text-[--red]"),children:[eF," / ",eP]}),children:"Matched files"}),!ea&&eY&&!(null==(N=et.localFile)?void 0:N.mediaId)&&!(null==(S=et.localFile)?void 0:S.ignored)&&(0,a.jsx)("div",{className:"text-xs text-orange-200",children:"Not matched"}),!ea&&!eY&&(0,a.jsx)("div",{className:"text-xs text-red-200",children:"Not scanned"}),(ea&&!ei&&(null==eR?void 0:eR.length)>0||eY&&!!et.localFile.mediaId)&&(0,a.jsx)(eg.m_,{trigger:(0,a.jsx)(w.K0,{icon:eG?(0,a.jsx)(eS.zu7,{}):(0,a.jsx)(D.iXN,{}),intent:eG?"success-subtle":"warning-subtle",size:"xs",className:"hover:opacity-60 ml-2",loading:eq,onClick:eQ}),children:eG?ea?"Unlock all files":"Unlock":ea?"Lock all files":"Lock"}),ea&&ei&&(null==eR?void 0:eR.length)>0&&(0,a.jsx)(eg.m_,{trigger:(0,a.jsx)(w.K0,{icon:eG?(0,a.jsx)(eS.zu7,{}):(0,a.jsx)(D.iXN,{}),intent:eG?"success-subtle":"warning-subtle",size:"xs",className:"hover:opacity-60 ml-2",loading:eq,onClick:e=>{e.stopPropagation(),eG?e0.open():eJ.open()}}),children:eG?"Unlock all files":"Lock all files"})]})})}),et.localFile&&(0,a.jsxs)(ef.a,{open:ev,onOpenChange:()=>eb(!1),title:"File metadata",titleClass:"text-center",contentClass:"max-w-xl",children:[(0,a.jsx)("p",{className:"w-full line-clamp-2 text-sm px-4 text-center py-2 flex-none",children:null==(C=et.localFile)?void 0:C.name}),(0,a.jsxs)(Q.lV,{schema:eI.Qx,onSubmit:e=>{if(et.localFile){var t;eC(et.localFile,{metadata:{...null==(t=et.localFile)?void 0:t.metadata,type:e.type,episode:e.episode,aniDBEpisode:e.aniDBEpisode}},()=>{eb(!1),ee.oR.success("Metadata saved")})}},onError:console.log,defaultValues:{...et.localFile.metadata},children:[(0,a.jsx)(Q.D0.Number,{label:"Episode number",name:"episode",help:"Relative episode number. If movie, episode number = 1",required:!0}),(0,a.jsx)(Q.D0.Text,{label:"AniDB episode",name:"aniDBEpisode",help:"Specials typically contain the letter S"}),(0,a.jsx)(Q.D0.Select,{label:"Type",name:"type",options:[{label:"Main",value:"main"},{label:"Special",value:"special"},{label:"NC/Other",value:"nc"}]}),(0,a.jsx)("div",{className:"w-full flex justify-end",children:(0,a.jsx)(Q.D0.Submit,{role:"save",intent:"success",loading:eq,children:"Save"})})]})]})]})});function eU(e){var t,n,i,s,r,o,c,d,u,x,p,f,g,v,y,b,j,N,w,S,C,k,I,E,_,A,T,D,O,L,R,P,F,U,z,H;let K,B,q,V,Q,$,X,Z,J,ee,et,en,ea,el,ei,es,er,eo,ec,ed=(0,l.c)(55),eu=(0,m.md)(W._S),em=(0,m.md)(G.Qy),ex=(null==eu?void 0:eu.kind)==="directory";ed[0]!==ex||ed[1]!==(null==eu?void 0:eu.name)?(K=ex?null:null==eu||null==(o=eu.name.split(".").pop())?void 0:o.toUpperCase(),ed[0]=ex,ed[1]=null==eu?void 0:eu.name,ed[2]=K):K=ed[2];let ep=K;ed[3]!==(null==eu||null==(t=eu.mediaIds)?void 0:t[0])||ed[4]!==(null==eu||null==(n=eu.mediaIds)?void 0:n.length)||ed[5]!==em?(B=(null==eu||null==(c=eu.mediaIds)?void 0:c.length)===1?null==em?void 0:em.find(e=>{var t;return e.id===(null==eu||null==(t=eu.mediaIds)?void 0:t[0])}):void 0,ed[3]=null==eu||null==(d=eu.mediaIds)?void 0:d[0],ed[4]=null==eu||null==(u=eu.mediaIds)?void 0:u.length,ed[5]=em,ed[6]=B):B=ed[6];let eh=B;ed[7]!==(null==eu?void 0:eu.children)?(q=null!=(f=null==eu||null==(p=eu.children)||null==(x=p.filter(eH))?void 0:x.length)?f:0,ed[7]=null==eu?void 0:eu.children,ed[8]=q):q=ed[8];let ef=q;ed[9]!==(null==eu?void 0:eu.children)?(V=null!=(y=null==eu||null==(v=eu.children)||null==(g=v.filter(ez))?void 0:g.length)?y:0,ed[9]=null==eu?void 0:eu.children,ed[10]=V):V=ed[10];let eg=V,ev=null==em?void 0:em.filter(e=>{var t;return null==eu||null==(t=eu.mediaIds)?void 0:t.includes(e.id)}),{setPreviewModalMediaId:ey}=(0,eA.D)();if(!eu){let e;return ed[11]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)("div",{className:"p-4 flex-1 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center text-gray-500",children:[(0,a.jsx)(M.UDU,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),(0,a.jsx)("p",{className:"text-sm",children:"Select a file or folder to view details"})]})}),ed[11]=e):e=ed[11],e}ed[12]!==ex||ed[13]!==(null==(s=eu.localFile)||null==(i=s.metadata)?void 0:i.type)||ed[14]!==(null==(r=eu.mediaIds)?void 0:r.length)?(Q=(0,a.jsx)("div",{className:"w-16 h-16 flex items-center justify-center mb-3",children:ex?(0,a.jsx)(M.UDU,{className:(0,h.cn)("w-12 h-12 text-brand-400",!(null==(b=eu.mediaIds)?void 0:b.length)&&"text-[--muted]")}):(0,a.jsx)(eN.tO7,{className:(0,h.cn)("w-12 h-12 text-[--muted]",(null==(N=eu.localFile)||null==(j=N.metadata)?void 0:j.type)==="main"&&"text-brand-400/80",(null==(S=eu.localFile)||null==(w=S.metadata)?void 0:w.type)==="special"&&"text-cyan-200/50",(null==(k=eu.localFile)||null==(C=k.metadata)?void 0:C.type)==="nc"&&"text-gray-200/30")})}),ed[12]=ex,ed[13]=null==(E=eu.localFile)||null==(I=E.metadata)?void 0:I.type,ed[14]=null==(_=eu.mediaIds)?void 0:_.length,ed[15]=Q):Q=ed[15],ed[16]!==eu.name?($=(0,a.jsx)("h3",{className:"font-semibold text-gray-100 break-all text-sm leading-tight",children:eu.name}),ed[16]=eu.name,ed[17]=$):$=ed[17],ed[18]!==ep?(X=ep&&(0,a.jsxs)("span",{className:"text-xs text-gray-400 mt-1",children:[ep," File"]}),ed[18]=ep,ed[19]=X):X=ed[19],ed[20]!==Q||ed[21]!==$||ed[22]!==X?(Z=(0,a.jsxs)("div",{className:"flex flex-col items-center text-center mb-6",children:[Q,$,X]}),ed[20]=Q,ed[21]=$,ed[22]=X,ed[23]=Z):Z=ed[23],ed[24]===Symbol.for("react.memo_cache_sentinel")?(J=(0,a.jsx)(Y.w,{className:"mb-4"}),ed[24]=J):J=ed[24],ed[25]===Symbol.for("react.memo_cache_sentinel")?(ee=(0,a.jsx)("dt",{className:"text-gray-400 text-sm uppercase tracking-wide mb-1",children:"Type"}),ed[25]=ee):ee=ed[25];let eb=ex?"Folder":"File";ed[26]!==eb?(et=(0,a.jsxs)("div",{children:[ee,(0,a.jsx)("dd",{className:"text-gray-200",children:eb})]}),ed[26]=eb,ed[27]=et):et=ed[27],ed[28]===Symbol.for("react.memo_cache_sentinel")?(en=(0,a.jsx)("dt",{className:"text-gray-400 text-sm uppercase tracking-wide mb-1",children:"Path"}),ed[28]=en):en=ed[28],ed[29]!==eu.path?(ea=(0,a.jsxs)("div",{children:[en,(0,a.jsx)("dd",{className:"text-gray-200 text-xs font-mono bg-gray-900 p-2 rounded break-all",children:eu.path})]}),ed[29]=eu.path,ed[30]=ea):ea=ed[30],ed[31]!==eu.size?(el=eu.size&&(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-gray-400 text-sm uppercase tracking-wide mb-1",children:"Size"}),(0,a.jsx)("dd",{className:"text-gray-200",children:function(e){let t=["B","KB","MB","GB","TB"],n=e,a=0;for(;n>=1024&&a<t.length-1;)n/=1024,a++;return"".concat(n.toFixed(1)," ").concat(t[a])}(eu.size)})]}),ed[31]=eu.size,ed[32]=el):el=ed[32];let ej=ex&&eu.mediaIds&&eu.mediaIds.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-gray-400 text-sm uppercase tracking-wide mb-1",children:"Associated Media"}),(0,a.jsxs)("dd",{className:"text-gray-200",children:[eu.mediaIds.length," anime series"]}),eu.mediaIds.length>1&&eu.mediaIds.length<=5&&(null==ev?void 0:ev.map(e=>{var t;return(0,a.jsx)("dd",{onClick:()=>ey(e.id,"anime"),className:"text-gray-200 cursor-pointer underline line-clamp-2 hover:opacity-80",children:null==(t=e.title)?void 0:t.userPreferred},e.id)}))]});return ed[33]!==eu.localFile?(ei=eu.localFile&&(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsx)("dt",{className:"text-gray-400 text-sm uppercase tracking-wide",children:"Library File"}),(null==(A=eu.localFile)?void 0:A.mediaId)>0&&(0,a.jsx)("dd",{className:"text-[--green] text-sm",children:"✓ Matched"}),(null==(T=eu.localFile)?void 0:T.mediaId)===0&&(0,a.jsx)("dd",{className:"text-[--orange] text-sm",children:"Not matched"}),(0,a.jsxs)("dd",{className:"text-gray-200 text-sm",children:["Episode: ",(0,a.jsx)("span",{className:"font-semibold",children:null!=(z=null==(O=eu.localFile)||null==(D=O.metadata)?void 0:D.episode)?z:"N/A"})]}),(0,a.jsxs)("dd",{className:"text-gray-200 text-sm",children:["AniDB Episode: ",(0,a.jsx)("span",{className:"font-semibold",children:null!=(H=null==(R=eu.localFile)||null==(L=R.metadata)?void 0:L.aniDBEpisode)?H:"N/A"})]}),(0,a.jsxs)("dd",{className:"text-gray-200 text-sm",children:["Type: ",(0,a.jsx)("span",{className:"font-semibold",children:null==(U=eu.localFile)||null==(F=U.metadata)||null==(P=F.type)?void 0:P.toUpperCase()})]})]}),ed[33]=eu.localFile,ed[34]=ei):ei=ed[34],ed[35]!==ef||ed[36]!==eg||ed[37]!==ex||ed[38]!==eu.children?(es=ex&&eu.children&&(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-gray-400 text-sm uppercase tracking-wide mb-1",children:"Contents"}),(0,a.jsxs)("dd",{className:"text-gray-200",children:[ef," folder",1!=ef?"s":"",", "," ",eg," file",1!=eg?"s":""]})]}),ed[35]=ef,ed[36]=eg,ed[37]=ex,ed[38]=eu.children,ed[39]=es):es=ed[39],ed[40]!==eh||ed[41]!==ey?(er=!!eh&&(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(e_.V,{media:eh,type:"anime",onClick:()=>{ey(eh.id,"anime")}})}),ed[40]=eh,ed[41]=ey,ed[42]=er):er=ed[42],ed[43]!==et||ed[44]!==ea||ed[45]!==el||ed[46]!==ej||ed[47]!==ei||ed[48]!==es||ed[49]!==er?(eo=(0,a.jsxs)("div",{className:"space-y-3 text-sm",children:[et,ea,el,ej,ei,es,er]}),ed[43]=et,ed[44]=ea,ed[45]=el,ed[46]=ej,ed[47]=ei,ed[48]=es,ed[49]=er,ed[50]=eo):eo=ed[50],ed[51]!==J||ed[52]!==eo||ed[53]!==Z?(ec=(0,a.jsxs)("div",{className:"p-4 flex flex-col",children:[Z,J,eo]}),ed[51]=J,ed[52]=eo,ed[53]=Z,ed[54]=ec):ec=ed[54],ec}function ez(e){return"file"===e.kind}function eH(e){return"directory"===e.kind}var eK=n(91332),eG=n(78259);function eW(e){let t,n,i,s,r,o=(0,l.c)(8);(0,eK.Ky)();let[c,d]=(0,m.fp)(W.qE);return o[0]!==d?(t=e=>d(e),o[0]=d,o[1]=t):t=o[1],o[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,h.cn)("bg-gray-950 h-[90%] lg:h-[80%] bg-opacity-95 firefox:bg-opacity-100 lg:mx-[2rem] overflow-hidden"),o[2]=n):n=o[2],o[3]===Symbol.for("react.memo_cache_sentinel")?(i=(0,a.jsx)(eG.Ui,{atoms:[U.r,F.$],children:(0,a.jsx)(eM,{})}),o[3]=i):i=o[3],o[4]===Symbol.for("react.memo_cache_sentinel")?(s=(0,a.jsxs)(Z.Cz,{className:n,children:[i,(0,a.jsx)("div",{className:"block lg:hidden",children:(0,a.jsx)("p",{className:"text-center text-white text-lg font-semibold py-4",children:"Library explorer can only be rendered on larger screens."})})]}),o[4]=s):s=o[4],o[5]!==c||o[6]!==t?(r=(0,a.jsx)(Z.Tr,{open:c,onOpenChange:t,children:s}),o[5]=c,o[6]=t,o[7]=r):r=o[7],r}var eB=n(74889),eq=n(96826),eV=n(73832),eQ=n(46278);function e$(e){var t,n,d,p,h,f,g,v;let y,b,j,N,S,C,k=(0,l.c)(29),I=(0,eQ.jE)(),E=(0,eq.v1)(),[_,A]=(0,x.useState)(null),T=(0,eV.C)(!1),O=(0,eV.C)(!1),L=(0,eV.C)(!1),[R,P]=(0,x.useState)(0),F=(0,m.Xr)(i.ho);k[0]!==T||k[1]!==(null==E||null==(n=E.settings)||null==(t=n.library)?void 0:t.autoScan)?(y={type:u.c.LIBRARY_WATCHER_FILE_ADDED,onMessage:e=>{var t,n;console.log("Library watcher",e),(null==E||null==(n=E.settings)||null==(t=n.library)?void 0:t.autoScan)||(T.on(),A(e))}},k[0]=T,k[1]=null==E||null==(f=E.settings)||null==(h=f.library)?void 0:h.autoScan,k[2]=y):y=k[2],(0,s.oA)(y),k[3]!==O||k[4]!==(null==E||null==(p=E.settings)||null==(d=p.library)?void 0:d.autoScan)?(b={type:u.c.LIBRARY_WATCHER_FILE_REMOVED,onMessage:e=>{var t,n;console.log("Library watcher",e),(null==E||null==(n=E.settings)||null==(t=n.library)?void 0:t.autoScan)||(O.on(),A(e))}},k[3]=O,k[4]=null==E||null==(v=E.settings)||null==(g=v.library)?void 0:g.autoScan,k[5]=b):b=k[5],(0,s.oA)(b),k[6]!==T||k[7]!==O?(j={type:u.c.SCAN_PROGRESS,onMessage:e=>{A(null),T.off(),O.off(),P(e),100===e&&setTimeout(()=>{P(0)},2e3)}},k[6]=T,k[7]=O,k[8]=j):j=k[8],(0,s.oA)(j),k[9]!==L?(N={type:u.c.AUTO_SCAN_STARTED,onMessage:e=>{L.on()}},k[9]=L,k[10]=N):N=k[10],(0,s.oA)(N),k[11]!==L||k[12]!==I?(S={type:u.c.AUTO_SCAN_COMPLETED,onMessage:e=>{L.off(),ee.oR.success("Library scanned"),I.invalidateQueries({queryKey:[eB.S.ANIME_COLLECTION.GetLibraryCollection.key]}),I.invalidateQueries({queryKey:[eB.S.ANIME_ENTRIES.GetMissingEpisodes.key]}),I.invalidateQueries({queryKey:[eB.S.AUTO_DOWNLOADER.GetAutoDownloaderItems.key]})}},k[11]=L,k[12]=I,k[13]=S):S=k[13],(0,s.oA)(S),k[14]!==T||k[15]!==O?(C=function(){A(null),T.off(),O.off()},k[14]=T,k[15]=O,k[16]=C):C=k[16];let U=C;if(L.active&&R>0){let e,t;return k[17]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(c.y$,{className:"size-6"}),k[17]=e):e=k[17],k[18]!==R?(t=(0,a.jsx)("div",{className:"z-50 fixed bottom-4 right-4",children:(0,a.jsx)(r.f,{children:(0,a.jsx)(o.Zp,{className:"w-fit max-w-[400px]",children:(0,a.jsx)(o.aR,{children:(0,a.jsxs)(o.BT,{className:"flex items-center gap-2 text-base",children:[e," ",R,"% Refreshing your library..."]})})})})}),k[18]=R,k[19]=t):t=k[19],t}if(_){let e,t,n,l,i;return k[20]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsxs)(o.aR,{children:[(0,a.jsxs)(o.ZB,{className:"text-lg flex items-center gap-2",children:[(0,a.jsx)(D.nlg,{className:"text-brand-400"}),"Library watcher"]}),(0,a.jsx)(o.BT,{className:"flex items-center gap-2 text-base",children:"A change has been detected in your library, refresh your entries."})]}),k[20]=e):e=k[20],k[21]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsx)(M.CKj,{}),k[21]=t):t=k[21],k[22]!==F?(n=(0,a.jsx)(o.wL,{children:(0,a.jsx)(w.$n,{intent:"primary-outline",leftIcon:t,size:"sm",onClick:()=>F(!0),className:"rounded-full",children:"Scan your library"})}),k[22]=F,k[23]=n):n=k[23],k[24]!==U?(l=(0,a.jsx)(w.Jn,{className:"absolute top-2 right-2",onClick:U}),k[24]=U,k[25]=l):l=k[25],k[26]!==n||k[27]!==l?(i=(0,a.jsx)("div",{className:"z-50 fixed bottom-4 right-4",children:(0,a.jsx)(r.f,{children:(0,a.jsxs)(o.Zp,{className:"w-full max-w-[400px] min-h-[150px] relative",children:[e,n,l]})})}),k[26]=n,k[27]=l,k[28]=i):i=k[28],i}return null}var eY=n(62322),eX=n(17946),eZ=n(35349);let eJ=(0,f.eU)(!1);function e0(){let e,t=(0,l.c)(3),[n,a]=(0,m.fp)(eJ);return t[0]!==a||t[1]!==n?(e={syncIsActive:n,setSyncIsActive:a},t[0]=a,t[1]=n,t[2]=e):e=t[2],e}var e1=n(61816),e2=n(10554),e3=n(28296),e4=n(39797),e5=n(93715),e6=n(66380);let e8=(0,f.eU)(!1),e7=(0,f.eU)(!1),e9=(0,f.eU)(!1);function te(e){var t,n,l,i,r,o,c,d;let p=(0,eq.v1)(),[h,f]=(0,m.fp)(e8),[g,v]=(0,m.fp)(e9),{data:y,isLoading:b,refetch:j}=(0,e2.A2)(!!p&&!(null==p||null==(n=p.settings)||null==(t=n.library)?void 0:t.disableUpdateCheck));(0,s.oA)({type:u.c.CHECK_FOR_UPDATES,onMessage:()=>{j().then(()=>{G()})}});let[S,C]=x.useState(!0),[k,I]=x.useState(!1),[E,_]=x.useState(""),[A,T]=(0,m.fp)(e7),[O,L]=x.useState(!1),[R,P]=x.useState(!1),[F,U]=x.useState(0),z=(null==(l=window.electron)?void 0:l.platform)==="darwin",{mutate:H,isPending:K}=(0,e1.BE)(),G=x.useCallback(()=>{try{window.electron&&(C(!0),window.electron.checkForUpdates().then(e=>{I(e),C(!1)}).catch(e=>{(0,e5.v)("ELECTRON").error("Failed to check for updates",e),_(JSON.stringify(e)),C(!1)}))}catch(e){(0,e5.v)("ELECTRON").error("Failed to check for updates",e),v(!1)}},[z]);async function W(){if(k&&!g)try{if(v(!0),window.electron){if(z){var e,t;if(!(null==y||null==(e=y.release)?void 0:e.version)){ee.oR.error("Update version not found"),v(!1);return}let n=null==(t=y.release.assets)?void 0:t.find(e=>e.name.includes("denshi")&&e.name.includes("MacOS")&&e.name.includes("arm64")&&e.name.endsWith(".zip"));if(!n){ee.oR.error("macOS update asset not found"),v(!1);return}ee.oR.info("Downloading and installing update..."),L(!0),H({download_url:n.browser_download_url,version:y.release.version},{onSuccess:()=>{T(!0),ee.oR.success("Update installed! Closing app..."),setTimeout(()=>{var e;null==(e=window.electron)||e.send("quit-app")},2e3)},onError:e=>{(0,e5.v)("ELECTRON").error("Failed to install macOS update",e),ee.oR.error("Failed to install update: ".concat(e.message)),v(!1),L(!1)}});return}if(!R){ee.oR.info("Downloading update..."),L(!0),await window.electron.checkForUpdates();return}try{ee.oR.info("Shutting down server..."),await window.electron.killServer()}catch(e){(0,e5.v)("ELECTRON").error("Failed to kill server",e)}ee.oR.info("Installing update..."),await window.electron.installUpdate(),T(!0),ee.oR.info("Update installed. Restarting app...")}}catch(e){(0,e5.v)("ELECTRON").error("Failed to install update",e),ee.oR.error("Failed to install update: ".concat(JSON.stringify(e))),v(!1),L(!1)}}return(x.useEffect(()=>{if(G(),window.electron){let e=window.electron.on("update-downloaded",()=>{z||(ee.oR.success("Update downloaded and ready to install"),L(!1),P(!0),U(100))}),t=window.electron.on("update-error",e=>{(0,e5.v)("ELECTRON").error("Update error",e),z||(ee.oR.error("Update error: ".concat(e)),v(!1),L(!1))}),n=window.electron.on("download-progress",e=>{z||U(Math.round(e.percent))}),a=window.electron.on("update-available",()=>{L(!0),P(!1),U(0),ee.oR.info("Update found, downloading...")});return()=>{null==e||e(),null==t||t(),null==n||n(),null==a||a()}}},[]),x.useEffect(()=>{y&&y.release&&f(!0)},[y]),x.useEffect(()=>{R&&g&&!O&&W()},[R,g,O]),(null==p||null==(r=p.settings)||null==(i=r.library)?void 0:i.disableUpdateCheck)||b||S||!y||!y.release)?null:A?(0,a.jsx)("div",{className:"fixed top-0 left-0 w-full h-full bg-[--background] flex items-center z-[9999]",children:(0,a.jsxs)("div",{className:"container max-w-4xl py-10",children:[(0,a.jsx)("div",{className:"mb-4 flex justify-center w-full",children:(0,a.jsx)("img",{src:"/seanime-logo.png",alt:"logo",className:"w-14 h-auto"})}),(0,a.jsx)("p",{className:"text-center text-lg",children:"Update installed. The app will restart automatically."})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e4.m,{collapsed:e.collapsed,items:[{iconType:J.$S7,name:"Update available",onClick:()=>f(!0)}],itemIconClass:"text-brand-300"}),(0,a.jsx)(ef.a,{open:h,onOpenChange:e=>!g&&f(e),contentClass:"max-w-3xl",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"text-center",children:"A new update is available!"}),(0,a.jsxs)("h4",{className:"font-bold flex gap-2 text-center items-center justify-center",children:[(0,a.jsx)("span",{className:"text-[--muted]",children:y.current_version})," ",(0,a.jsx)(M.dyV,{}),(0,a.jsx)("span",{className:"text-indigo-200",children:y.release.version})]}),!k&&!z&&(0,a.jsx)(ex.F,{intent:"warning",children:"This update is not yet available for desktop clients. Wait a few minutes or check the GitHub page for more information."}),(0,a.jsx)(e3.O,{updateData:y}),(0,a.jsxs)("div",{className:"flex gap-2 w-full !mt-4",children:[k&&!z&&(0,a.jsx)(w.$n,{leftIcon:(0,a.jsx)(e6.$Wp,{className:"text-2xl"}),onClick:W,loading:g||O||K,disabled:b,children:O?"Downloading... ".concat(F,"%"):R?"Install now":"Download & Install"}),k&&z&&(0,a.jsx)(w.$n,{leftIcon:(0,a.jsx)(e6.$Wp,{className:"text-2xl"}),onClick:W,loading:g||K,disabled:b,children:K?"Installing...":"Install now"}),(0,a.jsx)("div",{className:"flex flex-1"}),!(null==y||null==(c=y.release)||null==(o=c.tag_name)?void 0:o.includes("v2."))&&(0,a.jsx)(N.i,{href:(null==y||null==(d=y.release)?void 0:d.html_url)||"",target:"_blank",children:(0,a.jsx)(w.$n,{intent:"white-subtle",rightIcon:(0,a.jsx)(D.zaF,{}),children:"See on GitHub"})})]})]})})]})}var tt=n(48683),tn=n(21335),ta=n(15388);let tl=(0,h.u)({root:(0,tn.F)(["UI-NavigationMenu__root","relative inline-block z-10 max-w-full"]),item:(0,tn.F)(["UI-NavigationMenu__item","relative group/navigationMenu_item inline-flex !text-[1.15rem] items-center h-full select-none rounded-[--radius] leading-none no-underline outline-none transition-colors","text-[--muted] hover:text-[--foreground]","data-[current=true]:text-white","font-[600] leading-none","focus-visible:ring-1 focus-visible:ring-inset focus-visible:ring-[--ring]"],{variants:{size:{sm:"px-3 h-8 text-sm",md:"px-2 sm",lg:"px-3 h-12 text-base"}},defaultVariants:{size:"md"}}),icon:(0,tn.F)(["UI-VerticalNav__icon","flex-shrink-0 mr-3","text-[--muted] group-hover/navigationMenu_item:text-[--foreground] data-[current=true]:text-[--brand] data-[current=true]:group-hover/navigationMenu_item:text-[--brand]"],{variants:{size:{sm:"size-4",md:"size-5",lg:"size-6"}},defaultVariants:{size:"md"}}),itemChevron:(0,tn.F)(["UI-VerticalNav__itemChevron","ml-2 w-4 h-4 transition-transform duration-200 group-hover/navigationMenu_item:rotate-180"]),desktopList:(0,tn.F)(["UI-VerticalNav__desktopList","inline-block space-x-2"],{variants:{switchToDrawerBelow:{sm:"hidden sm:flex",md:"hidden md:flex",lg:"hidden lg:flex",never:"flex"}},defaultVariants:{switchToDrawerBelow:"md"}}),mobileTrigger:(0,tn.F)(["UI-VerticalNav__mobileTrigger","items-center justify-center rounded-[--radius] p-2 text-[--muted] hover:bg-[--subtle] hover:text-[--foreground]","focus:outline-none focus:ring-2 focus:ring-inset focus:ring-[--ring]"],{variants:{switchToDrawerBelow:{sm:"inline-flex sm:hidden",md:"inline-flex md:hidden",lg:"inline-flex lg:hidden",never:"hidden"}},defaultVariants:{switchToDrawerBelow:"md"}}),menuContainer:(0,tn.F)(["UI-NavigationMenu__menuContainer","absolute left-0 top-0 p-1 data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out","data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52","data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52","data-[motion=to-start]:slide-out-to-left-52 w-full sm:min-w-full"]),viewport:(0,tn.F)(["UI-NavigationMenu__viewport","relative mt-1.5 duration-300 h-[var(--radix-navigation-menu-viewport-height)]","w-full min-w-96 rounded-[--radius] shadow-sm border bg-[--paper] text-[--foreground]","data-[state=open]:animate-in data-[state=open]:zoom-in-90 data-[state=open]:fade-in-25","data-[state=closed]:animate-out data-[state=closed]:zoom-out-100 data-[state=closed]:fade-out-0"])}),ti=x.forwardRef((e,t)=>{let n,i,s,r,o,c,d,u,m,p,f,g,v,y,b,j,w,S,C,k,I,E,_,A,T,D,M,O,L,R,P,F,U,z=(0,l.c)(69);if(z[0]!==e){let{children:t,iconClass:a,itemClass:l,desktopListClass:x,itemChevronClass:h,mobileTriggerClass:j,menuContainerClass:N,viewportClass:w,className:S,switchToDrawerBelow:C,mobileDrawerHeader:k,mobileDrawerContent:I,mobileDrawerProps:E,items:_,size:A,...T}=e;s=a,o=l,i=x,r=h,f=j,d=N,b=w,n=S,y=C,m=k,u=I,p=E,c=_,v=A,g=T,z[0]=e,z[1]=n,z[2]=i,z[3]=s,z[4]=r,z[5]=o,z[6]=c,z[7]=d,z[8]=u,z[9]=m,z[10]=p,z[11]=f,z[12]=g,z[13]=v,z[14]=y,z[15]=b}else n=z[1],i=z[2],s=z[3],r=z[4],o=z[5],c=z[6],d=z[7],u=z[8],m=z[9],p=z[10],f=z[11],g=z[12],v=z[13],y=z[14],b=z[15];let[H,K]=x.useState(!1);z[16]!==s||z[17]!==v?(j=e=>{let{item:t}=e;return t.iconType?(0,a.jsx)(t.iconType,{className:(0,h.cn)(tl.icon({size:v}),s),"aria-hidden":"true","data-current":t.isCurrent}):null},z[16]=s,z[17]=v,z[18]=j):j=z[18];let G=j;return z[19]!==n?(w=(0,h.cn)(tl.root(),n),z[19]=n,z[20]=w):w=z[20],z[21]!==f||z[22]!==y?(S=(0,h.cn)(tl.mobileTrigger({switchToDrawerBelow:y}),f),z[21]=f,z[22]=y,z[23]=S):S=z[23],z[24]===Symbol.for("react.memo_cache_sentinel")?(C=()=>K(ts),k=(0,a.jsx)("span",{className:"sr-only",children:"Open main menu"}),z[24]=C,z[25]=k):(C=z[24],k=z[25]),z[26]!==H?(I=H?(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"block h-6 w-6",children:[(0,a.jsx)("line",{x1:"18",x2:"6",y1:"6",y2:"18"}),(0,a.jsx)("line",{x1:"6",x2:"18",y1:"6",y2:"18"})]}):(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"block h-6 w-6",children:[(0,a.jsx)("line",{x1:"4",x2:"20",y1:"12",y2:"12"}),(0,a.jsx)("line",{x1:"4",x2:"20",y1:"6",y2:"6"}),(0,a.jsx)("line",{x1:"4",x2:"20",y1:"18",y2:"18"})]}),z[26]=H,z[27]=I):I=z[27],z[28]!==S||z[29]!==I?(E=(0,a.jsxs)("button",{className:S,onClick:C,children:[k,I]}),z[28]=S,z[29]=I,z[30]=E):E=z[30],z[31]===Symbol.for("react.memo_cache_sentinel")?(_=e=>K(e),z[31]=_):_=z[31],z[32]===Symbol.for("react.memo_cache_sentinel")?(A=()=>K(!1),z[32]=A):A=z[32],z[33]!==c?(T=(0,a.jsx)(e4.m,{items:c,className:"mt-2",onLinkItemClick:A}),z[33]=c,z[34]=T):T=z[34],z[35]!==u||z[36]!==m||z[37]!==p||z[38]!==H||z[39]!==T?(D=(0,a.jsxs)(ta._s,{open:H,onOpenChange:_,side:"left",...p,children:[m,T,u]}),z[35]=u,z[36]=m,z[37]=p,z[38]=H,z[39]=T,z[40]=D):D=z[40],z[41]!==i||z[42]!==y?(M=(0,h.cn)(tl.desktopList({switchToDrawerBelow:y}),i),z[41]=i,z[42]=y,z[43]=M):M=z[43],z[44]!==G||z[45]!==r||z[46]!==o||z[47]!==c||z[48]!==d||z[49]!==H||z[50]!==t||z[51]!==v?(O=c.map(e=>e.subContent?(0,a.jsxs)(tt.q7,{children:[(0,a.jsxs)(tt.l9,{className:(0,h.cn)(tl.item({size:v}),o),"data-current":e.isCurrent,children:[(0,a.jsx)(G,{item:e}),(0,a.jsx)("span",{className:"flex-none",children:e.name}),(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:(0,h.cn)(tl.itemChevron(),r),"data-open":"".concat(H),children:(0,a.jsx)("polyline",{points:"6 9 12 15 18 9"})})]}),(0,a.jsx)(tt.UC,{ref:t,className:(0,h.cn)(tl.menuContainer(),d),children:(0,a.jsx)("div",{className:"w-full",children:e.subContent&&e.subContent})})]},e.name):(0,a.jsx)(tt.q7,{children:(0,a.jsx)(tt.Ws,{asChild:!0,children:e.href?(0,a.jsxs)(N.i,{href:e.href,className:(0,h.cn)(tl.item({size:v}),o),"data-current":e.isCurrent,children:[(0,a.jsx)(G,{item:e}),(0,a.jsx)("span",{className:"flex-none",children:e.name}),e.addon]}):(0,a.jsxs)("button",{className:(0,h.cn)(tl.item({size:v}),o),"data-current":e.isCurrent,children:[(0,a.jsx)(G,{item:e}),(0,a.jsx)("span",{className:"flex-none",children:e.name}),e.addon]})})},e.name)),z[44]=G,z[45]=r,z[46]=o,z[47]=c,z[48]=d,z[49]=H,z[50]=t,z[51]=v,z[52]=O):O=z[52],z[53]!==M||z[54]!==O?(L=(0,a.jsx)(tt.B8,{className:M,children:O}),z[53]=M,z[54]=O,z[55]=L):L=z[55],z[56]===Symbol.for("react.memo_cache_sentinel")?(R=(0,h.cn)("perspective-[2000px] absolute left-0 top-full w-full flex justify-center"),z[56]=R):R=z[56],z[57]!==b?(P=(0,h.cn)(tl.viewport(),b),z[57]=b,z[58]=P):P=z[58],z[59]!==P?(F=(0,a.jsx)("div",{className:R,children:(0,a.jsx)(tt.LM,{className:P})}),z[59]=P,z[60]=F):F=z[60],z[61]!==t||z[62]!==g||z[63]!==w||z[64]!==D||z[65]!==L||z[66]!==F||z[67]!==E?(U=(0,a.jsxs)(tt.bL,{ref:t,className:w,...g,children:[E,D,L,F]}),z[61]=t,z[62]=g,z[63]=w,z[64]=D,z[65]=L,z[66]=F,z[67]=E,z[68]=U):U=z[68],U});function ts(e){return!e}ti.displayName="NavigationMenu";let tr=e=>{var t,n,i,s,r,o,c,d;let u,m,x,p,h,f,g=(0,l.c)(12),v=(0,eq.v1)(),y=(0,T.usePathname)();null==v||null==(n=v.settings)||null==(t=n.library)||t.enableManga;let b="/offline"===y;g[0]!==b?(m={href:"/offline",isCurrent:b,name:"Anime Library"},g[0]=b,g[1]=m):m=g[1],g[2]!==y||g[3]!==(null==v||null==(s=v.settings)||null==(i=s.library)?void 0:i.enableManga)?(x=(null==v||null==(o=v.settings)||null==(r=o.library)?void 0:r.enableManga)&&{href:"/offline/manga",icon:null,isCurrent:y.includes("/offline/manga"),name:"Manga"},g[2]=y,g[3]=null==v||null==(d=v.settings)||null==(c=d.library)?void 0:c.enableManga,g[4]=x):x=g[4],g[5]!==x?(p=[x].filter(Boolean),g[5]=x,g[6]=p):p=g[6];let j=p;return g[7]!==m||g[8]!==j?(h=[m,...j].filter(Boolean),g[7]=m,g[8]=j,g[9]=h):h=g[9],u=h,g[10]!==u?(f=(0,a.jsx)(ti,{className:"p-0 hidden lg:inline-block",itemClass:"text-xl",items:u}),g[10]=u,g[11]=f):f=g[11],f};function to(){let e,t,n=(0,l.c)(4),i=(0,T.usePathname)();return n[0]!==i?(e=!i.startsWith("/entry")&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{"data-layout-header-background":!0,className:(0,h.cn)("bg-[#000] opacity-50 bg-contain bg-center bg-repeat z-[-2] w-full h-[20rem] absolute bottom-0")}),(0,a.jsx)("div",{"data-layout-header-background-gradient":!0,className:"w-full absolute bottom-0 h-[8rem] bg-gradient-to-t from-[--background] to-transparent z-[-2]"})]}),n[0]=i,n[1]=e):e=n[1],n[2]!==e?(t=(0,a.jsx)(a.Fragment,{children:e}),n[2]=e,n[3]=t):t=n[3],t}var tc=n(52116);let td=e=>{var t,n,i,s,r,o,c,d;let u,m,x,p,h,f,g,v,y,b,j,N,w=(0,l.c)(27),S=(0,eq.v1)(),C=(0,T.usePathname)();(0,tc.Wk)(),null==S||null==(n=S.settings)||null==(t=n.library)||t.enableManga;let k="/"===C;w[0]!==k?(m={href:"/",isCurrent:k,name:"Home"},w[0]=k,w[1]=m):m=w[1],w[2]!==C?(x=C.startsWith("/schedule"),w[2]=C,w[3]=x):x=w[3],w[4]!==x?(p={href:"/schedule",icon:null,isCurrent:x,name:"Schedule"},w[4]=x,w[5]=p):p=w[5],w[6]!==C||w[7]!==(null==S||null==(s=S.settings)||null==(i=s.library)?void 0:i.enableManga)?(h=(null==S||null==(o=S.settings)||null==(r=o.library)?void 0:r.enableManga)&&{href:"/manga",icon:null,isCurrent:C.startsWith("/manga"),name:"Manga"},w[6]=C,w[7]=null==S||null==(d=S.settings)||null==(c=d.library)?void 0:c.enableManga,w[8]=h):h=w[8],w[9]!==h?(f=[h].filter(Boolean),w[9]=h,w[10]=f):f=w[10];let I=f;return w[11]!==C?(g=C.startsWith("/lists"),w[11]=C,w[12]=g):g=w[12],w[13]!==g?(v={href:"/lists",icon:null,isCurrent:g,name:"My lists"},w[13]=g,w[14]=v):v=w[14],w[15]!==C?(y=C.startsWith("/discover")||C.startsWith("/search"),w[15]=C,w[16]=y):y=w[16],w[17]!==y?(b={href:"/discover",icon:null,isCurrent:y,name:"Discover"},w[17]=y,w[18]=b):b=w[18],w[19]!==b||w[20]!==m||w[21]!==p||w[22]!==I||w[23]!==v?(j=[m,p,...I,v,b].filter(Boolean),w[19]=b,w[20]=m,w[21]=p,w[22]=I,w[23]=v,w[24]=j):j=w[24],u=j,w[25]!==u?(N=(0,a.jsx)(ti,{className:"p-0 hidden lg:inline-block",items:u,desktopListClass:"space-x-0","data-top-menu":!0}),w[25]=u,w[26]=N):N=w[26],N};var tu=n(10109),tm=n(28002);let tx=(0,f.eU)(!1),tp=(0,f.eU)(!1);function th(e){let t,n,i=(0,l.c)(6),{asSidebarButton:s}=e,[r]=(0,m.fp)(tx),[,o]=(0,m.fp)(tp);return i[0]!==s||i[1]!==r||i[2]!==o?(t=r&&(0,a.jsx)(a.Fragment,{children:s?(0,a.jsx)(w.K0,{"data-manual-progress-tracking-button":!0,intent:"primary-subtle",className:(0,h.cn)("animate-pulse"),icon:(0,a.jsx)(tm.OpB,{}),onClick:()=>o(!0)}):(0,a.jsx)(w.$n,{"data-manual-progress-tracking-button":!0,intent:"primary",className:(0,h.cn)("animate-pulse"),leftIcon:(0,a.jsx)(tm.OpB,{}),onClick:()=>o(!0),children:"Currently watching"})}),i[0]=s,i[1]=r,i[2]=o,i[3]=t):t=i[3],i[4]!==t?(n=(0,a.jsx)(a.Fragment,{children:t}),i[4]=t,i[5]=n):n=i[5],n}function tf(){let e,t,n,i,r,o,c,d,p,h,f,g,v,y=(0,l.c)(38),[b,N]=(0,m.fp)(tx),S=x.useRef(null),[C,k]=x.useState(null),[I,E]=(0,m.fp)(tp);y[0]!==b||y[1]!==N?(e={type:u.c.PLAYBACK_MANAGER_MANUAL_TRACKING_PLAYBACK_STATE,onMessage:e=>{b||N(!0),k(e)}},y[0]=b,y[1]=N,y[2]=e):e=y[2],(0,s.oA)(e),y[3]!==E||y[4]!==C?(t=()=>{null===S.current&&E(!0),S.current=C},y[3]=E,y[4]=C,y[5]=t):t=y[5],y[6]!==C?(n=[C],y[6]=C,y[7]=n):n=y[7],x.useEffect(t,n),y[8]!==N||y[9]!==E?(i={type:u.c.PLAYBACK_MANAGER_MANUAL_TRACKING_STOPPED,onMessage:()=>{N(!1),E(!1),k(null)}},y[8]=N,y[9]=E,y[10]=i):i=y[10],(0,s.oA)(i);let{mutate:_,isPending:A}=(0,tu.gv)(),{isPending:T}=(0,tu.a8)();y[11]!==N||y[12]!==E?(r={onSuccess:()=>{E(!1),k(null),N(!1)}},y[11]=N,y[12]=E,y[13]=r):r=y[13];let{mutate:D,isPending:M}=(0,tu.mS)(r),O=I&&b;y[14]!==E?(o=e=>E(e),y[14]=E,y[15]=o):o=y[15],y[16]!==C?(c=C&&(0,a.jsxs)("div",{"data-manual-progress-tracking-modal-content":!0,className:"text-center relative overflow-hidden space-y-2",children:[(0,a.jsx)("p",{className:"text-[--muted]",children:"Playing externally"}),C.mediaCoverImage&&(0,a.jsx)("div",{className:"size-16 rounded-full relative mx-auto overflow-hidden mb-3",children:(0,a.jsx)(j.r,{src:C.mediaCoverImage,alt:"cover image",fill:!0,className:"object-cover object-center"})}),(0,a.jsx)("h3",{className:"text-lg font-medium line-clamp-1",children:null==C?void 0:C.mediaTitle}),(0,a.jsxs)("p",{className:"text-2xl font-bold",children:["Episode ",null==C?void 0:C.episodeNumber,(0,a.jsxs)("span",{className:"text-[--muted]",children:[" / ",(null==C?void 0:C.mediaTotalEpisodes)&&(null==C?void 0:C.mediaTotalEpisodes)>0?null==C?void 0:C.mediaTotalEpisodes:"-"]})]})]}),y[16]=C,y[17]=c):c=y[17];let L=A||T||M;y[18]!==_?(d=()=>_(),y[18]=_,y[19]=d):d=y[19],y[20]!==A||y[21]!==L||y[22]!==d?(p=(0,a.jsx)(w.$n,{intent:"primary-subtle",disabled:L,onClick:d,className:"w-full",loading:A,children:"Update progress now"}),y[20]=A,y[21]=L,y[22]=d,y[23]=p):p=y[23];let R=A||T||M;return y[24]!==D?(h=()=>D(),y[24]=D,y[25]=h):h=y[25],y[26]!==M||y[27]!==R||y[28]!==h?(f=(0,a.jsx)(w.$n,{intent:"alert-subtle",disabled:R,onClick:h,className:"w-full",loading:M,children:"Stop"}),y[26]=M,y[27]=R,y[28]=h,y[29]=f):f=y[29],y[30]!==p||y[31]!==f?(g=(0,a.jsxs)("div",{"data-manual-progress-tracking-modal-buttons":!0,className:"flex gap-2 w-full",children:[p,f]}),y[30]=p,y[31]=f,y[32]=g):g=y[32],y[33]!==g||y[34]!==O||y[35]!==o||y[36]!==c?(v=(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(ef.a,{"data-manual-progress-tracking-modal":!0,open:O,onOpenChange:o,titleClass:"text-center",contentClass:"!space-y-2 relative max-w-2xl",children:[c,g]})}),y[33]=g,y[34]=O,y[35]=o,y[36]=c,y[37]=v):v=y[37],v}var tg=n(73499),tv=n(37614);function ty(e){let t,n,i,s,r,o,c,d,u,m=(0,l.c)(23),{autoplayState:x,onCancel:p,onPlayNow:h}=e,{isActive:f,countdown:g,nextEpisode:v}=x;m[0]!==p?(t=()=>{(0,e5.v)("AutoplayCountdownModal").info("User cancelled autoplay"),p()},m[0]=p,m[1]=t):t=m[1];let y=t;m[2]!==h?(n=()=>{(0,e5.v)("AutoplayCountdownModal").info("User requested immediate play"),null==h||h()},m[2]=h,m[3]=n):n=m[3];let b=n;return f?((()=>{if(v){var e,t,n;return v.displayTitle,v.episodeTitle,(null==(e=v.episodeMetadata)?void 0:e.image)||null==(n=v.baseAnime)||null==(t=n.coverImage)||t.large}})(),m[4]!==y?(i=e=>{e||y()},m[4]=y,m[5]=i):i=m[5],m[6]!==g?(s=(0,a.jsx)("div",{className:"rounded-[--radius-md] text-center",children:(0,a.jsx)("h3",{className:"text-5xl font-bold",children:g})}),m[6]=g,m[7]=s):s=m[7],m[8]!==y?(r=(0,a.jsx)(w.$n,{intent:"gray-basic",onClick:y,className:"flex-1",size:"sm",children:"Cancel"}),m[8]=y,m[9]=r):r=m[9],m[10]!==b||m[11]!==h?(o=h&&(0,a.jsx)(w.$n,{intent:"primary",onClick:b,className:"flex-1",size:"sm",leftIcon:(0,a.jsx)(D.XTW,{}),children:"Play Now"}),m[10]=b,m[11]=h,m[12]=o):o=m[12],m[13]!==r||m[14]!==o?(c=(0,a.jsxs)("div",{className:"flex gap-2 pt-2",children:[r,o]}),m[13]=r,m[14]=o,m[15]=c):c=m[15],m[16]!==s||m[17]!==c?(d=(0,a.jsxs)("div",{className:"text-center space-y-4",children:[s,c]}),m[16]=s,m[17]=c,m[18]=d):d=m[18],m[19]!==f||m[20]!==i||m[21]!==d?(u=(0,a.jsx)(ef.a,{open:f,onOpenChange:i,titleClass:"text-center",hideCloseButton:!0,title:"Playing next episode in",contentClass:"!space-y-4 relative max-w-xl border-transparent !rounded-3xl",closeClass:"!text-[--red]",children:d}),m[19]=f,m[20]=i,m[21]=d,m[22]=u):u=m[22],u):null}var tb=n(35656),tj=n(4573),tN=n.n(tj);let tw=(0,f.eU)(!1),tS=(0,f.eU)(!1),tC=(0,f.eU)(!1),tk=(0,e5.v)("PLAYBACK MANAGER");function tI(e){let t,n,i=(0,l.c)(6),{asSidebarButton:s}=e,[,r]=(0,m.fp)(tw),o=(0,m.md)(tS),c=(0,m.md)(tC),d=o||c;return i[0]!==s||i[1]!==r||i[2]!==d?(t=d&&(0,a.jsx)(a.Fragment,{children:s?(0,a.jsx)(w.K0,{"data-progress-tracking-button":!0,intent:"primary-subtle",className:(0,h.cn)("animate-pulse"),icon:(0,a.jsx)(tm.OpB,{}),onClick:()=>r(!0)}):(0,a.jsx)(w.$n,{"data-progress-tracking-button":!0,intent:"primary",className:(0,h.cn)("animate-pulse"),leftIcon:(0,a.jsx)(tm.OpB,{}),onClick:()=>r(!0),children:"Currently watching"})}),i[0]=s,i[1]=r,i[2]=d,i[3]=t):t=i[3],i[4]!==t?(n=(0,a.jsx)(a.Fragment,{children:t}),i[4]=t,i[5]=n):n=i[5],n}function tE(){var e,t,n,i,r,o,c,p,f,g,v;let y,b,N,S,C,k,I,E,_,A,T,M,O,L,R,P,F,U,z,H,K,G,W,B,q,V,Q,$=(0,l.c)(101),Y=(0,eq.v1)(),X=(0,eQ.jE)(),[Z,J]=(0,m.fp)(tw),[et,en]=(0,m.fp)(tS),[ea,el]=(0,m.fp)(tC),ei=et||ea,[es,er]=x.useState(null),[eo,ec]=x.useState(null),{state:ed,startAutoplay:eu,cancelAutoplay:ex}=(0,tg.bN)(),ep=(0,tg.A9)((null==es?void 0:es.mediaId)||0,(null==es?void 0:es.episodeNumber)||0),{currentPlaylist:eh}=(0,tv.n)(),{mutate:eg,isPending:ev}=(0,tu.gv)(),ey=null==eo||null==(e=eo.current)?void 0:e.name;$[0]!==ey?(y=[ey],$[0]=ey,$[1]=y):y=$[1];let{mutate:eb,isSuccess:ej}=(0,tu.YI)(y),ew=null==eo||null==(t=eo.current)?void 0:t.name;$[2]!==ew?(b=[ew],$[2]=ew,$[3]=b):b=$[3];let{mutate:eS,isSuccess:eC}=(0,tu.QQ)(b),ek=null==es?void 0:es.filename;$[4]!==ek?(N=[ek],$[4]=ek,$[5]=N):N=$[5];let{mutate:eI,isSuccess:eE,isPending:e_}=(0,tu.R7)(N);$[6]!==el||$[7]!==en||$[8]!==J?(S={type:u.c.PLAYBACK_MANAGER_PROGRESS_TRACKING_STARTED,onMessage:e=>{tk.info("Tracking started",e),en(!0),el(!1),J(!0),er(e)}},$[6]=el,$[7]=en,$[8]=J,$[9]=S):S=$[9],(0,s.oA)(S),$[10]!==el?(C={type:u.c.PLAYBACK_MANAGER_PROGRESS_VIDEO_COMPLETED,onMessage:e=>{tk.info("Video completed",e),el(!0),er(e)}},$[10]=el,$[11]=C):C=$[11],(0,s.oA)(C),$[12]!==ed||$[13]!==eh||$[14]!==ep||$[15]!==X||$[16]!==el||$[17]!==en||$[18]!==eu||$[19]!==es?(k={type:u.c.PLAYBACK_MANAGER_PROGRESS_TRACKING_STOPPED,onMessage:e=>{tk.info("Tracking stopped",e,"Completion percentage:",null==es?void 0:es.completionPercentage),en(!1),(null==es?void 0:es.progressUpdated)&&(tk.info("Progress updated, setting isCompleted to false"),el(!1),er(null)),"Player closed"===e?(ee.oR.info("Player closed"),.8>=((null==es?void 0:es.completionPercentage)||0)&&el(!1)):"Tracking stopped"===e||ee.oR.error(e),X.invalidateQueries({queryKey:[eB.S.CONTINUITY.GetContinuityWatchHistory.key]}).then(),!eh&&es&&es.completionPercentage&&es.completionPercentage>.7&&!ed.isActive&&eu(es,ep||void 0,"local")}},$[12]=ed,$[13]=eh,$[14]=ep,$[15]=X,$[16]=el,$[17]=en,$[18]=eu,$[19]=es,$[20]=k):k=$[20],(0,s.oA)(k),$[21]!==et||$[22]!==en?(I={type:u.c.PLAYBACK_MANAGER_PROGRESS_PLAYBACK_STATE,onMessage:e=>{et||en(!0),er(e)}},$[21]=et,$[22]=en,$[23]=I):I=$[23],(0,s.oA)(I);let eA=(0,eQ.jE)();$[24]!==eA?(E={type:u.c.PLAYBACK_MANAGER_PROGRESS_UPDATED,onMessage:e=>{e&&(eA.invalidateQueries({queryKey:[eB.S.ANIME_ENTRIES.GetAnimeEntry.key,String(e.mediaId)]}),eA.invalidateQueries({queryKey:[eB.S.ANIME_COLLECTION.GetLibraryCollection.key]}),eA.invalidateQueries({queryKey:[eB.S.ANILIST.GetAnimeCollection.key]}),er(e),ee.oR.success("Progress updated"))}},$[24]=eA,$[25]=E):E=$[25],(0,s.oA)(E),$[26]===Symbol.for("react.memo_cache_sentinel")?(_={type:u.c.PLAYBACK_MANAGER_PLAYLIST_STATE,onMessage:e=>{ec(e)}},$[26]=_):_=$[26],(0,s.oA)(_),$[27]!==eb||$[28]!==ej?(A={title:"Play next episode",description:"Are you sure you want to play the next episode?",actionText:"Confirm",actionIntent:"success",onConfirm:()=>{ej||eb()}},$[27]=eb,$[28]=ej,$[29]=A):A=$[29];let eT=(0,em.J)(A);$[30]!==ex||$[31]!==ev||$[32]!==eI||$[33]!==eb||$[34]!==eo||$[35]!==(null==es?void 0:es.canPlayNext)||$[36]!==(null==es?void 0:es.completionPercentage)||$[37]!==eg?(T=()=>(tN().bind("u",()=>{!ev&&(null==es?void 0:es.completionPercentage)&&(null==es?void 0:es.completionPercentage)>.7&&eg()}),tN().bind("space",()=>{!ev&&(null==es?void 0:es.completionPercentage)&&(null==es?void 0:es.completionPercentage)>.7&&(ex(),(null==es?void 0:es.canPlayNext)&&!eo&&eI(),(null==eo?void 0:eo.next)&&eb())}),t_),$[30]=ex,$[31]=ev,$[32]=eI,$[33]=eb,$[34]=eo,$[35]=null==es?void 0:es.canPlayNext,$[36]=null==es?void 0:es.completionPercentage,$[37]=eg,$[38]=T):T=$[38];let eD=(null==es?void 0:es.completionPercentage)&&(null==es?void 0:es.completionPercentage)>.7,eM=null==es?void 0:es.canPlayNext,eO=!!(null==eo?void 0:eo.next);$[39]!==ex||$[40]!==eD||$[41]!==eM||$[42]!==eO?(M=[eD,eM,eO,ex],$[39]=ex,$[40]=eD,$[41]=eM,$[42]=eO,$[43]=M):M=$[43],x.useEffect(T,M),$[44]!==eI||$[45]!==eE?(O={title:"Play next episode",description:"Are you sure you want to play the next episode?",actionText:"Confirm",actionIntent:"success",onConfirm:()=>{eE||eI()}},$[44]=eI,$[45]=eE,$[46]=O):O=$[46];let eL=(0,em.J)(O);$[47]!==eS||$[48]!==eC?(L={title:"Play next",actionText:"Confirm",actionIntent:"alert",description:"Are you sure you want to stop the playlist? It will be deleted.",onConfirm:()=>{eC||eS()}},$[47]=eS,$[48]=eC,$[49]=L):L=$[49];let eR=(0,em.J)(L);$[50]!==eg?(R=function(){eg()},$[50]=eg,$[51]=R):R=$[51];let eP=R,eF=Z&&ei;return $[52]!==J?(P=e=>J(e),$[52]=J,$[53]=P):P=$[53],$[54]!==es?(F=!!(null==es?void 0:es.completionPercentage)&&(0,a.jsx)("div",{"data-progress-tracking-modal-progress-bar":!0,className:"absolute left-0 top-0 w-full",children:(0,a.jsx)(d.z,{className:"h-2 rounded-lg",value:100*es.completionPercentage})}),$[54]=es,$[55]=F):F=$[55],$[56]!==(null==Y||null==(i=Y.settings)||null==(n=i.library)?void 0:n.autoUpdateProgress)||$[57]!==es?(U=es&&(0,a.jsxs)("div",{"data-progress-tracking-main-content":!0,className:"text-center relative overflow-hidden py-2 space-y-2",children:[es.mediaCoverImage&&(0,a.jsx)("div",{className:"size-16 rounded-full relative mx-auto overflow-hidden mb-3",children:(0,a.jsx)(j.r,{src:es.mediaCoverImage,alt:"cover image",fill:!0,className:"object-cover object-center"})}),(0,a.jsxs)("div",{"data-progress-tracking-title":!0,children:[(0,a.jsx)("h3",{className:"text-lg font-medium line-clamp-1",children:null==es?void 0:es.mediaTitle}),(0,a.jsxs)("p",{className:"text-2xl font-bold",children:["Episode ",null==es?void 0:es.episodeNumber,(0,a.jsxs)("span",{className:"text-[--muted]",children:[" / ",(null==es?void 0:es.mediaTotalEpisodes)||"-"]})]})]}),(null==Y||null==(o=Y.settings)||null==(r=o.library)?void 0:r.autoUpdateProgress)&&!(null==es?void 0:es.progressUpdated)&&(0,a.jsx)("p",{"data-progress-tracking-auto-update-progress":!0,className:"text-[--muted] text-center text-sm",children:"Your progress will be automatically updated"}),(null==es?void 0:es.progressUpdated)&&(0,a.jsx)("p",{"data-progress-tracking-progress-updated":!0,className:"text-green-300 text-center",children:"Progress updated"})]}),$[56]=null==Y||null==(p=Y.settings)||null==(c=p.library)?void 0:c.autoUpdateProgress,$[57]=es,$[58]=U):U=$[58],$[59]!==eP||$[60]!==ev||$[61]!==es?(z=!!(null==es?void 0:es.completionPercentage)&&(null==es?void 0:es.completionPercentage)>.7&&!es.progressUpdated&&(0,a.jsx)("div",{"data-progress-tracking-update-progress-button":!0,className:"flex gap-2 justify-center items-center",children:(0,a.jsx)(w.$n,{intent:"primary-subtle",disabled:ev||(null==es?void 0:es.progressUpdated),onClick:eP,className:"w-full animate-pulse",loading:ev,children:"Update progress now"})}),$[59]=eP,$[60]=ev,$[61]=es,$[62]=z):z=$[62],$[63]!==ex||$[64]!==eL||$[65]!==eo||$[66]!==(null==es?void 0:es.canPlayNext)||$[67]!==(null==es?void 0:es.completionPercentage)||$[68]!==eE||$[69]!==e_?(H=!!(null==es?void 0:es.completionPercentage)&&(null==es?void 0:es.completionPercentage)>.7&&(null==es?void 0:es.canPlayNext)&&!eo&&(0,a.jsx)("div",{"data-progress-tracking-play-next-episode-button":!0,className:"flex gap-2 justify-center items-center",children:(0,a.jsx)(w.$n,{intent:"gray-subtle",onClick:()=>{ex(),eL.open()},className:"w-full",disabled:eE,loading:e_,leftIcon:(0,a.jsx)(D.XTW,{className:"text-2xl"}),children:"Play next episode"})}),$[63]=ex,$[64]=eL,$[65]=eo,$[66]=null==es?void 0:es.canPlayNext,$[67]=null==es?void 0:es.completionPercentage,$[68]=eE,$[69]=e_,$[70]=H):H=$[70],$[71]!==ex||$[72]!==eT||$[73]!==eR||$[74]!==eo||$[75]!==ej||$[76]!==eC?(K=!!(null==eo?void 0:eo.next)&&(0,a.jsx)("div",{"data-progress-tracking-playlist":!0,className:"border rounded-[--radius-md] p-4 text-center relative overflow-hidden",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-lg font-medium text-center text-[--muted] mb-2 uppercase tracking-wide",children:"Playlist"}),!!eo.remaining&&(0,a.jsxs)("p",{"data-progress-tracking-playlist-remaining":!0,className:"text-[--muted]",children:[eo.remaining," episode",eo.remaining>1?"s":""," after this one"]}),(0,a.jsxs)("p",{"data-progress-tracking-playlist-next":!0,className:"text-center truncate line-clamp-1",children:["Next: ",(0,a.jsx)("span",{className:"font-semibold",children:null==eo||null==(f=eo.next)?void 0:f.name})]})]}),(0,a.jsxs)("div",{"data-progress-tracking-playlist-next-episode-button":!0,className:(0,h.cn)("w-full rounded-[--radius-md] relative overflow-hidden",ej?"opacity-50 pointer-events-none":"cursor-pointer"),onClick:()=>{ej||(ex(),eT.open())},children:[(null==(g=eo.next)?void 0:g.mediaImage)&&(0,a.jsx)(j.r,{"data-progress-tracking-playlist-next-episode-button-image":!0,src:(null==(v=eo.next)?void 0:v.mediaImage)||"",placeholder:(0,tb.r)(700,475),sizes:"10rem",fill:!0,alt:"",className:"object-center object-cover z-[1]"}),(0,a.jsx)("div",{"data-progress-tracking-playlist-next-episode-button-container":!0,className:"inset-0 relative z-[2] bg-black border bg-opacity-70 hover:bg-opacity-80 transition flex flex-col gap-2 items-center justify-center p-4",children:(0,a.jsxs)("p",{"data-progress-tracking-playlist-next-episode-button-text":!0,className:"flex gap-2 items-center",children:[(0,a.jsx)(D.XTW,{className:"block text-2xl"})," Play next"]})})]}),(0,a.jsx)("div",{"data-progress-tracking-playlist-next-episode-button-stop-button-container":!0,className:"absolute -top-0.5 right-2",children:(0,a.jsx)(w.K0,{intent:"alert-subtle",onClick:()=>{eC||(ex(),eR.open())},size:"sm",disabled:ej,loading:eC,icon:(0,a.jsx)(eN.uDv,{})})})]})}),$[71]=ex,$[72]=eT,$[73]=eR,$[74]=eo,$[75]=ej,$[76]=eC,$[77]=K):K=$[77],$[78]!==eF||$[79]!==P||$[80]!==F||$[81]!==U||$[82]!==z||$[83]!==H||$[84]!==K?(G=(0,a.jsxs)(ef.a,{"data-progress-tracking-modal":!0,open:eF,onOpenChange:P,titleClass:"text-center",contentClass:"!space-y-0 relative max-w-2xl overflow-hidden",children:[F,U,z,H,K]}),$[78]=eF,$[79]=P,$[80]=F,$[81]=U,$[82]=z,$[83]=H,$[84]=K,$[85]=G):G=$[85],$[86]!==ed||$[87]!==ex?(W=(0,a.jsx)(ty,{autoplayState:ed,onCancel:ex}),$[86]=ed,$[87]=ex,$[88]=W):W=$[88],$[89]!==eT?(B=(0,a.jsx)(em.K,{...eT}),$[89]=eT,$[90]=B):B=$[90],$[91]!==eR?(q=(0,a.jsx)(em.K,{...eR}),$[91]=eR,$[92]=q):q=$[92],$[93]!==eL?(V=(0,a.jsx)(em.K,{...eL}),$[93]=eL,$[94]=V):V=$[94],$[95]!==G||$[96]!==W||$[97]!==B||$[98]!==q||$[99]!==V?(Q=(0,a.jsxs)(a.Fragment,{children:[G,W,B,q,V]}),$[95]=G,$[96]=W,$[97]=B,$[98]=q,$[99]=V,$[100]=Q):Q=$[100],Q}function t_(){tN().unbind("u"),tN().unbind("space")}var tA=n(17205),tT=n(39076),tD=n(78106),tM=n(22960),tO=n(80893);let tL=(0,f.eU)(!1);function tR(e){let t,n,i,s,r=(0,l.c)(9),[o,c]=(0,m.fp)(tL),{data:d}=(0,b.QJ)();return r[0]!==d?(t=(0,a.jsx)(tP,{mangaCollection:d}),r[0]=d,r[1]=t):t=r[1],r[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsx)(tK,{}),r[2]=n):n=r[2],r[3]!==t?(i=(0,a.jsxs)("div",{className:"py-4 space-y-8","data-chapter-downloads-modal-content":!0,children:[t,n]}),r[3]=t,r[4]=i):i=r[4],r[5]!==o||r[6]!==c||r[7]!==i?(s=(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(ef.a,{open:o,onOpenChange:c,contentClass:"max-w-5xl",title:"Downloaded chapters","data-chapter-downloads-modal":!0,children:i})}),r[5]=o,r[6]=c,r[7]=i,r[8]=s):s=r[8],s}function tP(e){let t,n,i,s,r,u,m,x,p=(0,l.c)(31),{mangaCollection:f}=e,{downloadQueue:g,downloadQueueLoading:v,downloadQueueError:y,startDownloadQueue:b,stopDownloadQueue:j,isStartingDownloadQueue:S,isStoppingDownloadQueue:C,resetErroredChapters:k,isResettingErroredChapters:I,clearDownloadQueue:E,isClearingDownloadQueue:_}=(0,tT.I2)(),A=S||C||I||_;return p[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsx)("h3",{children:"Queue"}),n=(0,a.jsx)("div",{className:"flex flex-1","data-chapter-download-queue-header-spacer":!0}),p[0]=t,p[1]=n):(t=p[0],n=p[1]),p[2]!==E||p[3]!==g||p[4]!==y||p[5]!==v||p[6]!==_||p[7]!==A||p[8]!==I||p[9]!==S||p[10]!==C||p[11]!==k||p[12]!==b||p[13]!==j?(i=!v&&!y&&(0,a.jsxs)("div",{className:"flex gap-2 items-center","data-chapter-download-queue-header-actions":!0,children:[!!(null==g?void 0:g.find(tH))&&(0,a.jsx)(w.$n,{intent:"warning-outline",size:"sm",disabled:A,onClick:()=>k(),loading:I,children:"Reset errored chapters"}),(null==g?void 0:g.find(tz))?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(w.$n,{intent:"alert-subtle",size:"sm",onClick:()=>j(),loading:C,children:"Stop"})}):(0,a.jsxs)(a.Fragment,{children:[!!(null==g?void 0:g.length)&&(0,a.jsx)(w.$n,{intent:"alert-subtle",size:"sm",disabled:A,onClick:()=>E(),leftIcon:(0,a.jsx)(eN.Tfw,{className:"text-xl"}),loading:_,children:"Clear all"}),!!(null==g?void 0:g.length)&&!!(null==g?void 0:g.find(tU))&&(0,a.jsx)(w.$n,{intent:"success",size:"sm",disabled:A,onClick:()=>b(),leftIcon:(0,a.jsx)(tO.EnF,{className:"text-xl"}),loading:S,children:"Start"})]})]}),p[2]=E,p[3]=g,p[4]=y,p[5]=v,p[6]=_,p[7]=A,p[8]=I,p[9]=S,p[10]=C,p[11]=k,p[12]=b,p[13]=j,p[14]=i):i=p[14],p[15]!==i?(s=(0,a.jsxs)("div",{className:"flex w-full items-center","data-chapter-download-queue-header":!0,children:[t,n,i]}),p[15]=i,p[16]=s):s=p[16],p[17]!==y||p[18]!==v?(r=v?(0,a.jsx)(c.kt,{}):y?(0,a.jsx)(tD.D,{title:"Oops!",children:(0,a.jsx)("p",{children:"Could not fetch the download queue"})}):null,p[17]=y,p[18]=v,p[19]=r):r=p[19],p[20]!==g||p[21]!==y||p[22]!==v||p[23]!==(null==f?void 0:f.lists)?(u=(null==g?void 0:g.length)?(0,a.jsx)(tM.F,{className:"h-[14rem]","data-chapter-download-queue-scroll-area":!0,children:(0,a.jsx)("div",{className:"space-y-2","data-chapter-download-queue-scroll-area-content":!0,children:g.map(e=>{var t,n,l,i;let s=null==f||null==(l=f.lists)||null==(n=l.flatMap(tF))||null==(t=n.find(t=>{var n;return(null==t||null==(n=t.media)?void 0:n.id)===e.mediaId}))?void 0:t.media;return(0,a.jsxs)(o.Zp,{className:(0,h.cn)("px-3 py-2 bg-gray-900 space-y-1.5","errored"===e.status&&"border-[--orange]"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[!!s&&(0,a.jsx)(N.i,{className:"font-semibold max-w-[180px] text-ellipsis truncate underline",href:"/manga/entry?id=".concat(s.id),children:null==(i=s.title)?void 0:i.userPreferred}),(0,a.jsxs)("p",{children:["Chapter ",e.chapterNumber," ",(0,a.jsxs)("span",{className:"text-[--muted] italic",children:["(id: ",e.chapterId,")"]})]}),"errored"===e.status&&(0,a.jsxs)("div",{className:"flex gap-1 items-center text-[--orange]",children:[(0,a.jsx)(tm.ZtR,{className:"text-2xl text-[--orange]"}),(0,a.jsx)("p",{children:"Errored"})]})]}),"downloading"===e.status&&(0,a.jsx)(d.z,{size:"sm",isIndeterminate:!0})]},e.mediaId+e.provider+e.chapterId)})})}):!v&&!y&&(0,a.jsx)("p",{className:"text-center text-[--muted] text-sm","data-chapter-download-queue-empty-state":!0,children:"Nothing in the queue"}),p[20]=g,p[21]=y,p[22]=v,p[23]=null==f?void 0:f.lists,p[24]=u):u=p[24],p[25]!==r||p[26]!==u?(m=(0,a.jsxs)(o.Zp,{className:"p-4 space-y-2","data-chapter-download-queue-card":!0,children:[r,u]}),p[25]=r,p[26]=u,p[27]=m):m=p[27],p[28]!==s||p[29]!==m?(x=(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"space-y-4","data-chapter-download-queue-container":!0,children:[s,m]})}),p[28]=s,p[29]=m,p[30]=x):x=p[30],x}function tF(e){return e.entries}function tU(e){return"not_started"===e.status}function tz(e){return"downloading"===e.status}function tH(e){return"errored"===e.status}function tK(e){let t,n,i,s,r=(0,l.c)(11),{data:o,isLoading:d,isError:u}=(0,tA.pK)();return r[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsxs)("div",{className:"flex w-full items-center","data-chapter-download-list-header":!0,children:[(0,a.jsx)("h3",{children:"Downloaded"}),(0,a.jsx)("div",{className:"flex flex-1","data-chapter-download-list-header-spacer":!0})]}),r[0]=t):t=r[0],r[1]!==u||r[2]!==d?(n=d?(0,a.jsx)(c.kt,{}):u?(0,a.jsx)(tD.D,{title:"Oops!",children:(0,a.jsx)("p",{children:"Could not fetch the download queue"})}):null,r[1]=u,r[2]=d,r[3]=n):n=r[3],r[4]!==o||r[5]!==u||r[6]!==d?(i=(null==o?void 0:o.length)?(0,a.jsxs)(a.Fragment,{children:[null==o?void 0:o.filter(t2).sort(t1).sort(tZ).map(tY),(0,a.jsx)("div",{"data-chapter-download-list-media-grid":!0,className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-4 xl:grid-cols-4 2xl:grid-cols-4 gap-4",children:null==o?void 0:o.filter(t$).sort(tQ).sort(tB).map(tG)})]}):!d&&!u&&(0,a.jsx)("p",{className:"text-center text-[--muted] italic","data-chapter-download-list-empty-state":!0,children:"No chapters downloaded"}),r[4]=o,r[5]=u,r[6]=d,r[7]=i):i=r[7],r[8]!==n||r[9]!==i?(s=(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"space-y-4","data-chapter-download-list-container":!0,children:[t,(0,a.jsxs)("div",{className:"py-4 space-y-2","data-chapter-download-list-content":!0,children:[n,i]})]})}),r[8]=n,r[9]=i,r[10]=s):s=r[10],s}function tG(e){var t;let n=Object.values(e.downloadData).flatMap(tW).length;return(0,a.jsx)("div",{className:"col-span-1",children:(0,a.jsx)(e_.V,{media:e.media,type:"manga",hideUnseenCountBadge:!0,hideAnilistEntryEditButton:!0,overlay:(0,a.jsxs)("p",{className:"font-semibold text-white bg-gray-950 z-[-1] absolute right-0 w-fit px-4 py-1.5 text-center !bg-opacity-90 text-sm lg:text-base rounded-none rounded-bl-lg",children:[n," chapter",1===n?"":"s"]})})},null==(t=e.media)?void 0:t.id)}function tW(e){return e}function tB(e,t){return Object.values(t.downloadData).flatMap(tV).length-Object.values(e.downloadData).flatMap(tq).length}function tq(e){return e}function tV(e){return e}function tQ(e,t){return e.mediaId-t.mediaId}function t$(e){return!!e.media}function tY(e){return(0,a.jsxs)(o.Zp,{className:(0,h.cn)("px-3 py-2 bg-gray-900 space-y-1"),children:[(0,a.jsxs)(N.i,{className:"font-semibold underline",href:"/manga/entry?id=".concat(e.mediaId),children:["Media ",e.mediaId]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("p",{children:[Object.values(e.downloadData).flatMap(tX).length," chapters"]})," - ",(0,a.jsx)("em",{className:"text-[--muted]",children:"Not in your AniList collection"})]})]},e.mediaId)}function tX(e){return e}function tZ(e,t){return Object.values(t.downloadData).flatMap(t0).length-Object.values(e.downloadData).flatMap(tJ).length}function tJ(e){return e}function t0(e){return e}function t1(e,t){return e.mediaId-t.mediaId}function t2(e){return!e.media}function t3(e){let t,n,i,s=(0,l.c)(5),r=(0,T.usePathname)(),o=(0,m.Xr)(tL);return r.startsWith("/manga")?(s[0]!==o?(t=()=>o(!0),s[0]=o,s[1]=t):t=s[1],s[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsx)(ej.anB,{}),s[2]=n):n=s[2],s[3]!==t?(i=(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(w.$n,{onClick:t,intent:"white-subtle",rounded:!0,size:"sm",leftIcon:n,children:"Downloads"})}),s[3]=t,s[4]=i):i=s[4],i):null}var t4=n(244),t5=n(94077),t6=n(4022),t8=n(69402),t7=n(52885),t9=n(60695),ne=n(74092),nt=n(21410),nn=n(5290),na=n(31561);function nl(e){return{label:e.label,value:String(e.value)}}function ni(e){return{label:e.label,value:String(e.value)}}function ns(e,t){var n;return t.name&&(e[t.name]=null!=(n=t.value)?n:""),e}function nr(e,t){if(!t.name)return e;switch(t.type){case"input":case"select":case"radio":e[t.name]=nn.Yj().optional();break;case"number":e[t.name]=nn.ai().optional();break;case"checkbox":e[t.name]=nn.zM().optional();break;case"date":e[t.name]=nn.p6().optional()}return e}var no=n(77885);let nc=new Map([["flex",function(e){let t,n,i,s,r,o,c=(0,l.c)(16),{items:d,direction:u,gap:m,style:x,className:p}=e;c[0]!==d?(t=void 0===d?[]:d,c[0]=d,c[1]=t):t=c[1];let f=t,g=void 0===u?"row":u;c[2]!==p?(n=(0,h.cn)("flex",p),c[2]=p,c[3]=n):n=c[3],c[4]!==x?(i=x||{},c[4]=x,c[5]=i):i=c[5];let v="".concat(.25*(void 0===m?2:m),"rem");return c[6]!==g||c[7]!==i||c[8]!==v?(s={...i,gap:v,flexDirection:g},c[6]=g,c[7]=i,c[8]=v,c[9]=s):s=c[9],c[10]!==f?(r=f&&f.length>0&&(0,a.jsx)(nm,{data:f}),c[10]=f,c[11]=r):r=c[11],c[12]!==n||c[13]!==s||c[14]!==r?(o=(0,a.jsx)("div",{className:n,style:s,children:r}),c[12]=n,c[13]=s,c[14]=r,c[15]=o):o=c[15],o}],["text",function(e){let t,n,i=(0,l.c)(6),{text:s,style:r,className:o}=e;return i[0]!==o?(t=(0,h.cn)("w-full break-all",o),i[0]=o,i[1]=t):t=i[1],i[2]!==r||i[3]!==t||i[4]!==s?(n=(0,a.jsx)("p",{className:t,style:r,children:s}),i[2]=r,i[3]=t,i[4]=s,i[5]=n):n=i[5],n}],["div",function(e){let t,n,i,s,r,o=(0,l.c)(15),{items:c,style:d,onClick:u,className:m}=e;o[0]!==c?(t=void 0===c?[]:c,o[0]=c,o[1]=t):t=o[1];let x=t,{sendEventHandlerTriggeredEvent:p}=(0,na._L)(),{trayIcon:f}=nb();o[2]!==u||o[3]!==p||o[4]!==f?(n=function(){u&&p({handlerName:u,event:{}},f.extensionId)},o[2]=u,o[3]=p,o[4]=f,o[5]=n):n=o[5];let g=n;return o[6]!==m?(i=(0,h.cn)("relative",m),o[6]=m,o[7]=i):i=o[7],o[8]!==x?(s=x&&x.length>0&&(0,a.jsx)(nm,{data:x}),o[8]=x,o[9]=s):s=o[9],o[10]!==g||o[11]!==d||o[12]!==i||o[13]!==s?(r=(0,a.jsx)("div",{className:i,style:d,onClick:g,children:s}),o[10]=g,o[11]=d,o[12]=i,o[13]=s,o[14]=r):r=o[14],r}],["stack",function(e){let t,n,i,s,r,o,c=(0,l.c)(15),{items:d,style:u,gap:m,className:x}=e;c[0]!==d?(t=void 0===d?[]:d,c[0]=d,c[1]=t):t=c[1];let p=t;c[2]!==x?(n=(0,h.cn)("flex",x),c[2]=x,c[3]=n):n=c[3],c[4]!==u?(i=u||{},c[4]=u,c[5]=i):i=c[5];let f="".concat(.25*(void 0===m?2:m),"rem");return c[6]!==i||c[7]!==f?(s={...i,gap:f,flexDirection:"column"},c[6]=i,c[7]=f,c[8]=s):s=c[8],c[9]!==p?(r=p&&p.length>0&&(0,a.jsx)(nm,{data:p}),c[9]=p,c[10]=r):r=c[10],c[11]!==n||c[12]!==s||c[13]!==r?(o=(0,a.jsx)("div",{className:n,style:s,children:r}),c[11]=n,c[12]=s,c[13]=r,c[14]=o):o=c[14],o}],["input",function(e){var t,n,i;let s,r,o,c,d,u,m,p,h=(0,l.c)(44),{trayIcon:f}=nb(),{sendEventHandlerTriggeredEvent:g}=(0,na._L)(),{sendFieldRefSendValueEvent:v}=(0,na.B8)(),[y,b]=x.useState(e.value||(null==(t=e.fieldRef)?void 0:t.current)),j=(0,C.d)(y,200),N=x.useRef(null),w=x.useRef(null),S=x.useRef(!0);h[0]!==j||h[1]!==e.fieldRef||h[2]!==e.onChange||h[3]!==g||h[4]!==v||h[5]!==f.extensionId?(s=()=>{if(S.current){S.current=!1;return}e.onChange&&g({handlerName:e.onChange,event:{value:j}},f.extensionId),e.fieldRef&&v({fieldRef:e.fieldRef.__ID,value:j},f.extensionId)},h[0]=j,h[1]=e.fieldRef,h[2]=e.onChange,h[3]=g,h[4]=v,h[5]=f.extensionId,h[6]=s):s=h[6],h[7]!==j?(r=[j],h[7]=j,h[8]=r):r=h[8],(0,x.useEffect)(s,r),h[9]!==(null==(n=e.fieldRef)?void 0:n.__ID)?(o=t=>{var n;t.fieldRef===(null==(n=e.fieldRef)?void 0:n.__ID)&&b(t.value)},h[9]=null==(i=e.fieldRef)?void 0:i.__ID,h[10]=o):o=h[10],(0,na.Ql)(o,f.extensionId);let[k,I]=x.useState(null),E=(0,C.d)(k,400);h[11]!==e.onSelect||h[12]!==e.textarea?(c=function(t){if(e.onSelect){var n,a,l,i,s,r;let t=e.textarea?null==(n=w.current)?void 0:n.selectionStart:null==(a=N.current)?void 0:a.selectionStart,o=e.textarea?null==(l=w.current)?void 0:l.selectionEnd:null==(i=N.current)?void 0:i.selectionEnd,c=e.textarea?null==(s=w.current)?void 0:s.value.slice(null!=t?t:0,null!=o?o:0):null==(r=N.current)?void 0:r.value.slice(null!=t?t:0,null!=o?o:0);I({value:null!=c?c:"",cursorStart:null!=t?t:0,cursorEnd:null!=o?o:0})}},h[11]=e.onSelect,h[12]=e.textarea,h[13]=c):c=h[13];let _=c;h[14]!==E||h[15]!==e.onSelect||h[16]!==g||h[17]!==f.extensionId?(d=()=>{e.onSelect&&E&&g({handlerName:e.onSelect,event:{value:E.value,cursorStart:E.cursorStart,cursorEnd:E.cursorEnd}},f.extensionId)},h[14]=E,h[15]=e.onSelect,h[16]=g,h[17]=f.extensionId,h[18]=d):d=h[18];let A=null==E?void 0:E.value,T=null==E?void 0:E.cursorStart,D=null==E?void 0:E.cursorEnd;if(h[19]!==A||h[20]!==T||h[21]!==D?(u=[A,T,D],h[19]=A,h[20]=T,h[21]=D,h[22]=u):u=h[22],(0,x.useEffect)(d,u),e.textarea){let t,n;return h[23]===Symbol.for("react.memo_cache_sentinel")?(t=e=>b(e),h[23]=t):t=h[23],h[24]!==_||h[25]!==e.className||h[26]!==e.disabled||h[27]!==e.id||h[28]!==e.label||h[29]!==e.placeholder||h[30]!==e.style||h[31]!==y?(n=(0,a.jsx)(ne.T,{id:e.id,label:e.label,placeholder:e.placeholder,style:e.style,value:y,onValueChange:t,onSelect:_,disabled:e.disabled,fieldClass:e.className,ref:w}),h[24]=_,h[25]=e.className,h[26]=e.disabled,h[27]=e.id,h[28]=e.label,h[29]=e.placeholder,h[30]=e.style,h[31]=y,h[32]=n):n=h[32],n}h[33]===Symbol.for("react.memo_cache_sentinel")?(m=e=>b(e),h[33]=m):m=h[33];let M=e.size||"md";return h[34]!==_||h[35]!==e.className||h[36]!==e.disabled||h[37]!==e.id||h[38]!==e.label||h[39]!==e.placeholder||h[40]!==e.style||h[41]!==M||h[42]!==y?(p=(0,a.jsx)(X.k,{id:e.id,label:e.label,placeholder:e.placeholder,style:e.style,value:y,onValueChange:m,onSelect:_,disabled:e.disabled,size:M,fieldClass:e.className,ref:N}),h[34]=_,h[35]=e.className,h[36]=e.disabled,h[37]=e.id,h[38]=e.label,h[39]=e.placeholder,h[40]=e.style,h[41]=M,h[42]=y,h[43]=p):p=h[43],p}],["button",function(e){let t,n,i=(0,l.c)(13),{sendEventHandlerTriggeredEvent:s}=(0,na._L)(),{trayIcon:r}=nb();i[0]!==e.onClick||i[1]!==s||i[2]!==r?(t=function(){e.onClick&&s({handlerName:e.onClick,event:{}},r.extensionId)},i[0]=e.onClick,i[1]=s,i[2]=r,i[3]=t):t=i[3];let o=t,c=e.intent||"white-subtle",d=e.size||"sm",u=e.label||"Button";return i[4]!==o||i[5]!==e.className||i[6]!==e.disabled||i[7]!==e.loading||i[8]!==e.style||i[9]!==c||i[10]!==d||i[11]!==u?(n=(0,a.jsx)(w.$n,{intent:c,style:e.style,onClick:o,disabled:e.disabled,loading:e.loading,size:d,className:e.className,children:u}),i[4]=o,i[5]=e.className,i[6]=e.disabled,i[7]=e.loading,i[8]=e.style,i[9]=c,i[10]=d,i[11]=u,i[12]=n):n=i[12],n}],["anchor",function(e){let t,n,i,s=(0,l.c)(15),{sendEventHandlerTriggeredEvent:r}=(0,na._L)(),{trayIcon:o}=nb();s[0]!==e.href||s[1]!==e.onClick||s[2]!==e.text||s[3]!==r||s[4]!==o?(t=function(t){e.onClick&&(t.preventDefault(),r({handlerName:e.onClick,event:{href:e.href,text:e.text}},o.extensionId))},s[0]=e.href,s[1]=e.onClick,s[2]=e.text,s[3]=r,s[4]=o,s[5]=t):t=s[5];let c=t,d=e.href,u=e.target||"_blank",m=e.style;s[6]!==e.className?(n=(0,h.cn)("underline cursor-pointer",e.className),s[6]=e.className,s[7]=n):n=s[7];let x=e.text||"Link";return s[8]!==c||s[9]!==e.href||s[10]!==e.style||s[11]!==u||s[12]!==n||s[13]!==x?(i=(0,a.jsx)("a",{href:d,target:u,rel:"noopener noreferrer",style:m,onClick:c,className:n,children:x}),s[8]=c,s[9]=e.href,s[10]=e.style,s[11]=u,s[12]=n,s[13]=x,s[14]=i):i=s[14],i}],["form",function(e){let t,n,i,r,o,d,u,m,p=(0,l.c)(24),{name:h,fields:f}=e;(0,s.Y0)();let[g,v]=x.useState(f);nn.Ik(g.reduce(nr,{})),p[0]!==g?(t=g.reduce(ns,{}),p[0]=g,p[1]=t):t=p[1],p[2]!==t?(n={defaultValues:t},p[2]=t,p[3]=n):n=p[3];let y=(0,nt.mN)(n),{trayIcon:b}=nb(),{sendFormSubmittedEvent:j}=(0,na.q_)();p[4]!==h||p[5]!==j||p[6]!==b.extensionId?(i=e=>{j({formName:h,data:e},b.extensionId)},p[4]=h,p[5]=j,p[6]=b.extensionId,p[7]=i):i=p[7];let N=i;return p[8]!==f||p[9]!==y||p[10]!==h?(r=e=>{e.formName===h&&(e.fieldToReset?y.resetField(e.fieldToReset):(y.reset(),v([]),setTimeout(()=>{v(f)},250)))},p[8]=f,p[9]=y,p[10]=h,p[11]=r):r=p[11],(0,na.Fp)(r,b.extensionId),p[12]!==y||p[13]!==h?(o=e=>{if(e.formName===h)for(let[t,n]of Object.entries(e.data))y.setValue(t,n)},p[12]=y,p[13]=h,p[14]=o):o=p[14],(0,na.iA)(o,b.extensionId),p[15]!==y||p[16]!==N?(d=y.handleSubmit(N),p[15]=y,p[16]=N,p[17]=d):d=p[17],p[18]!==g||p[19]!==y?(u=(null==g?void 0:g.length)?g.map(e=>{var t,n,l,i,s;if(!e.name&&"submit"!==e.type)return null;switch(e.type){case"input":return(0,a.jsx)(X.k,{label:e.label,placeholder:e.placeholder,...y.register(e.name)},e.id);case"number":return(0,a.jsx)(X.k,{type:"number",label:e.label,placeholder:e.placeholder,...y.register(e.name)},e.id);case"select":return(0,a.jsx)(nt.xI,{control:y.control,name:e.name,defaultValue:null!=(t=e.value)?t:"",render:t=>{var n,l;let{field:i}=t;return(0,a.jsx)(S.l,{label:e.label,name:e.name,options:null!=(l=null==(n=e.options)?void 0:n.map(ni))?l:[],placeholder:e.placeholder,value:i.value,onValueChange:e=>i.onChange(e)},e.id)}},e.id);case"checkbox":return(0,a.jsx)(nt.xI,{control:y.control,name:e.name,defaultValue:null!=(n=e.value)&&n,render:t=>{let{field:n}=t;return(0,a.jsx)(V.Sc,{label:e.label,value:n.value,onValueChange:e=>n.onChange(e)},e.id)}},e.id);case"switch":return(0,a.jsx)(nt.xI,{control:y.control,name:e.name,defaultValue:null!=(l=e.value)&&l,render:t=>{let{field:n}=t;return(0,a.jsx)(t9.d,{label:e.label,value:n.value,onValueChange:e=>n.onChange(e)},e.id)}},e.id);case"radio":return(0,a.jsx)(nt.xI,{control:y.control,name:e.name,defaultValue:null!=(i=e.value)?i:"",render:t=>{var n,l;let{field:i}=t;return(0,a.jsx)(t7.z,{label:e.label,name:e.name,options:null!=(l=null==(n=e.options)?void 0:n.map(nl))?l:[],value:i.value,onValueChange:e=>i.onChange(e)},e.id)}},e.id);case"date":return(0,a.jsx)(nt.xI,{control:y.control,name:e.name,defaultValue:null!=(s=e.value)?s:"",render:t=>{let{field:n}=t;return(0,a.jsx)(t8.lr,{name:e.name,label:e.label,value:n.value,onValueChange:e=>n.onChange(e)},e.id)}},e.id);case"submit":return(0,a.jsx)(w.$n,{type:"submit",children:e.label},e.id);default:return null}}):(0,a.jsx)(c.kt,{}),p[18]=g,p[19]=y,p[20]=u):u=p[20],p[21]!==d||p[22]!==u?(m=(0,a.jsx)("form",{onSubmit:d,className:"space-y-4",children:u}),p[21]=d,p[22]=u,p[23]=m):m=p[23],m}],["switch",function(e){var t,n,i;let s,r,o,c,d,u=(0,l.c)(21),{trayIcon:m}=nb(),{sendEventHandlerTriggeredEvent:p}=(0,na._L)(),{sendFieldRefSendValueEvent:h}=(0,na.B8)(),[f,g]=x.useState(e.value||(null==(t=e.fieldRef)?void 0:t.current)),v=(0,C.d)(f,200),y=x.useRef(!0);u[0]!==e.fieldRef||u[1]!==e.onChange||u[2]!==p||u[3]!==h||u[4]!==m.extensionId||u[5]!==f?(s=()=>{if(y.current){y.current=!1;return}e.onChange&&p({handlerName:e.onChange,event:{value:f}},m.extensionId),e.fieldRef&&h({fieldRef:e.fieldRef.__ID,value:f},m.extensionId)},u[0]=e.fieldRef,u[1]=e.onChange,u[2]=p,u[3]=h,u[4]=m.extensionId,u[5]=f,u[6]=s):s=u[6],u[7]!==v?(r=[v],u[7]=v,u[8]=r):r=u[8],(0,x.useEffect)(s,r),u[9]!==(null==(n=e.fieldRef)?void 0:n.__ID)?(o=t=>{var n;t.fieldRef===(null==(n=e.fieldRef)?void 0:n.__ID)&&g(t.value)},u[9]=null==(i=e.fieldRef)?void 0:i.__ID,u[10]=o):o=u[10],(0,na.Ql)(o,m.extensionId);let b=e.side||"right";u[11]===Symbol.for("react.memo_cache_sentinel")?(c=e=>g(e),u[11]=c):c=u[11];let j=e.size||"sm";return u[12]!==e.className||u[13]!==e.disabled||u[14]!==e.id||u[15]!==e.label||u[16]!==e.style||u[17]!==b||u[18]!==j||u[19]!==f?(d=(0,a.jsx)(t9.d,{side:b,id:e.id,label:e.label,style:e.style,value:f,onValueChange:c,disabled:e.disabled,size:j,fieldClass:e.className}),u[12]=e.className,u[13]=e.disabled,u[14]=e.id,u[15]=e.label,u[16]=e.style,u[17]=b,u[18]=j,u[19]=f,u[20]=d):d=u[20],d}],["radio-group",function(e){var t,n,i;let s,r,o,c,d,u=(0,l.c)(20),{trayIcon:m}=nb(),{sendEventHandlerTriggeredEvent:p}=(0,na._L)(),{sendFieldRefSendValueEvent:h}=(0,na.B8)(),[f,g]=x.useState(e.value||(null==(t=e.fieldRef)?void 0:t.current)),v=(0,C.d)(f,200),y=x.useRef(!0);u[0]!==e.fieldRef||u[1]!==e.onChange||u[2]!==p||u[3]!==h||u[4]!==m.extensionId||u[5]!==f?(s=()=>{if(y.current){y.current=!1;return}e.onChange&&p({handlerName:e.onChange,event:{value:f}},m.extensionId),e.fieldRef&&h({fieldRef:e.fieldRef.__ID,value:f},m.extensionId)},u[0]=e.fieldRef,u[1]=e.onChange,u[2]=p,u[3]=h,u[4]=m.extensionId,u[5]=f,u[6]=s):s=u[6],u[7]!==v?(r=[v],u[7]=v,u[8]=r):r=u[8],(0,x.useEffect)(s,r),u[9]!==(null==(n=e.fieldRef)?void 0:n.__ID)?(o=t=>{var n;t.fieldRef===(null==(n=e.fieldRef)?void 0:n.__ID)&&g(t.value)},u[9]=null==(i=e.fieldRef)?void 0:i.__ID,u[10]=o):o=u[10],(0,na.Ql)(o,m.extensionId),u[11]===Symbol.for("react.memo_cache_sentinel")?(c=e=>g(e),u[11]=c):c=u[11];let b=e.size||"md";return u[12]!==e.className||u[13]!==e.disabled||u[14]!==e.id||u[15]!==e.label||u[16]!==e.options||u[17]!==b||u[18]!==f?(d=(0,a.jsx)(t7.z,{id:e.id,label:e.label,options:e.options,value:f,onValueChange:c,disabled:e.disabled,size:b,fieldClass:e.className}),u[12]=e.className,u[13]=e.disabled,u[14]=e.id,u[15]=e.label,u[16]=e.options,u[17]=b,u[18]=f,u[19]=d):d=u[19],d}],["checkbox",function(e){var t,n,i;let s,r,o,c,d,u=(0,l.c)(20),{trayIcon:m}=nb(),{sendEventHandlerTriggeredEvent:p}=(0,na._L)(),{sendFieldRefSendValueEvent:h}=(0,na.B8)(),[f,g]=x.useState(e.value||(null==(t=e.fieldRef)?void 0:t.current)),v=(0,C.d)(f,200),y=x.useRef(!0);u[0]!==e.fieldRef||u[1]!==e.onChange||u[2]!==p||u[3]!==h||u[4]!==m.extensionId||u[5]!==f?(s=()=>{if(y.current){y.current=!1;return}e.onChange&&p({handlerName:e.onChange,event:{value:f}},m.extensionId),e.fieldRef&&h({fieldRef:e.fieldRef.__ID,value:f},m.extensionId)},u[0]=e.fieldRef,u[1]=e.onChange,u[2]=p,u[3]=h,u[4]=m.extensionId,u[5]=f,u[6]=s):s=u[6],u[7]!==v?(r=[v],u[7]=v,u[8]=r):r=u[8],(0,x.useEffect)(s,r),u[9]!==(null==(n=e.fieldRef)?void 0:n.__ID)?(o=t=>{var n;t.fieldRef===(null==(n=e.fieldRef)?void 0:n.__ID)&&g(t.value)},u[9]=null==(i=e.fieldRef)?void 0:i.__ID,u[10]=o):o=u[10],(0,na.Ql)(o,m.extensionId),u[11]===Symbol.for("react.memo_cache_sentinel")?(c=e=>"boolean"==typeof e&&g(e),u[11]=c):c=u[11];let b=e.size||"md";return u[12]!==e.className||u[13]!==e.disabled||u[14]!==e.id||u[15]!==e.label||u[16]!==e.style||u[17]!==b||u[18]!==f?(d=(0,a.jsx)(V.Sc,{id:e.id,label:e.label,style:e.style,value:f,onValueChange:c,disabled:e.disabled,size:b,fieldClass:e.className}),u[12]=e.className,u[13]=e.disabled,u[14]=e.id,u[15]=e.label,u[16]=e.style,u[17]=b,u[18]=f,u[19]=d):d=u[19],d}],["select",function(e){var t,n,i;let s,r,o,c,d,u=(0,l.c)(21),{trayIcon:m}=nb(),{sendEventHandlerTriggeredEvent:p}=(0,na._L)(),{sendFieldRefSendValueEvent:h}=(0,na.B8)(),[f,g]=x.useState(e.value||(null==(t=e.fieldRef)?void 0:t.current)),v=(0,C.d)(f,200),y=x.useRef(!0);u[0]!==v||u[1]!==e.fieldRef||u[2]!==e.onChange||u[3]!==p||u[4]!==h||u[5]!==m.extensionId?(s=()=>{if(y.current){y.current=!1;return}e.onChange&&p({handlerName:e.onChange,event:{value:v}},m.extensionId),e.fieldRef&&h({fieldRef:e.fieldRef.__ID,value:v},m.extensionId)},u[0]=v,u[1]=e.fieldRef,u[2]=e.onChange,u[3]=p,u[4]=h,u[5]=m.extensionId,u[6]=s):s=u[6],u[7]!==v?(r=[v],u[7]=v,u[8]=r):r=u[8],(0,x.useEffect)(s,r),u[9]!==(null==(n=e.fieldRef)?void 0:n.__ID)?(o=t=>{var n;t.fieldRef===(null==(n=e.fieldRef)?void 0:n.__ID)&&g(t.value)},u[9]=null==(i=e.fieldRef)?void 0:i.__ID,u[10]=o):o=u[10],(0,na.Ql)(o,m.extensionId),u[11]===Symbol.for("react.memo_cache_sentinel")?(c=e=>g(e),u[11]=c):c=u[11];let b=e.size||"md";return u[12]!==e.className||u[13]!==e.disabled||u[14]!==e.id||u[15]!==e.label||u[16]!==e.options||u[17]!==e.style||u[18]!==b||u[19]!==f?(d=(0,a.jsx)(S.l,{id:e.id,label:e.label,style:e.style,options:e.options,value:f,onValueChange:c,disabled:e.disabled,size:b,fieldClass:e.className}),u[12]=e.className,u[13]=e.disabled,u[14]=e.id,u[15]=e.label,u[16]=e.options,u[17]=e.style,u[18]=b,u[19]=f,u[20]=d):d=u[20],d}]]);function nd(e){let t,n=(0,l.c)(2),{type:i}=e;return n[0]!==i?(t=(0,a.jsxs)("div",{className:"p-4 text-muted-foreground",children:['Component type "',i,'" not found']}),n[0]=i,n[1]=t):t=n[1],t}function nu(e){let t,n,i=(0,l.c)(3),{error:s}=e;return i[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsx)("p",{children:"Something went wrong:"}),i[0]=t):t=i[0],i[1]!==s.message?(n=(0,a.jsxs)("div",{className:"p-4 text-destructive",role:"alert",children:[t,(0,a.jsx)("pre",{className:"mt-2 text-sm",children:s.message})]}),i[1]=s.message,i[2]=n):n=i[2],n}function nm(e){let t,n,i=(0,l.c)(17),{data:s,fallback:r}=e,o=void 0===r?nd:r,c=function(){let e=(0,x.useContext)(nx);if(!e)throw Error("usePluginRegistry must be used within a PluginProvider");return e}();if(Array.isArray(s)){let e,t;if(i[0]!==o||i[1]!==s){let t;i[3]!==o?(t=e=>(0,a.jsx)(nm,{data:e,fallback:o},e.key||e.id),i[3]=o,i[4]=t):t=i[4],e=s.map(t),i[0]=o,i[1]=s,i[2]=e}else e=i[2];return i[5]!==e?(t=(0,a.jsx)(a.Fragment,{children:e}),i[5]=e,i[6]=t):t=i[6],t}i[7]!==s.type||i[8]!==c?(t=c.get(s.type),i[7]=s.type,i[8]=c,i[9]=t):t=i[9];let d=t;if(!d){let e;return i[10]!==o||i[11]!==s.type?(e=(0,a.jsx)(o,{type:s.type}),i[10]=o,i[11]=s.type,i[12]=e):e=i[12],e}return i[13]!==d||i[14]!==s.id||i[15]!==s.props?(n=(0,a.jsx)(no.tH,{FallbackComponent:nu,children:(0,a.jsx)(d,{...s.props},s.id)}),i[13]=d,i[14]=s.id,i[15]=s.props,i[16]=n):n=i[16],n}let nx=(0,x.createContext)(null);function np(e){let t,n=(0,l.c)(3),{children:i,registry:s}=e;return n[0]!==i||n[1]!==s?(t=(0,a.jsx)(nx.Provider,{value:s,children:i}),n[0]=i,n[1]=s,n[2]=t):t=n[2],t}function nh(e,t){var n;let a=((null==(n=e.ownerDocument)?void 0:n.defaultView)||window).getComputedStyle(e);return a.getPropertyValue(t)||a[t]}function nf(e){return e?nh(e,"fontSize")||nf(e.parentElement):nh(window.document.documentElement,"fontSize")}var ng=n(21096);let nv=x.createContext({place:"sidebar",width:null,isPinned:!1,trayIcon:{extensionId:"",extensionName:"",iconUrl:"",withContent:!1,isDrawer:!1,tooltipText:"",badgeNumber:0,badgeIntent:"info",width:"30rem",minHeight:"auto"}});function ny(e){let t,n=(0,l.c)(3);return n[0]!==e.children||n[1]!==e.props?(t=(0,a.jsx)(nv.Provider,{value:e.props,children:e.children}),n[0]=e.children,n[1]=e.props,n[2]=t):t=n[2],t}function nb(){let e=x.useContext(nv);if(!e)throw Error("usePluginTray must be used within a PluginTrayProvider");return e}function nj(e){let[t,n]=x.useState(!1),[l,i]=x.useState(0),[s,r]=x.useState("info"),{sendTrayOpenedEvent:o}=(0,na.ob)(),{sendTrayClosedEvent:c}=(0,na.z0)(),{sendTrayClickedEvent:d}=(0,na._n)();(0,m.md)(nC);let[u,p]=(0,m.fp)(nk),[f,g]=(0,m.fp)(nI),v=x.useRef(!0);x.useEffect(()=>{if(v.current){v.current=!1;return}t?o({},e.trayIcon.extensionId):c({},e.trayIcon.extensionId)},[t]);let y=x.useRef(!1);function b(){d({},e.trayIcon.extensionId)}x.useEffect(()=>{if((null==u?void 0:u.extensionId)===e.trayIcon.extensionId&&(g(e.trayIcon.extensionId),!y.current)){let e=setTimeout(()=>{n(!0),y.current=!0},100);return()=>clearTimeout(e)}},[u]),x.useEffect(()=>{(null==u?void 0:u.extensionId)===e.trayIcon.extensionId&&!t&&y.current&&(p(null),y.current=!1)},[t]),(0,na.Y8)(e=>{i(e.badgeNumber),r(e.badgeIntent)},e.trayIcon.extensionId),(0,na.yi)(e=>{n(!0)},e.trayIcon.extensionId),(0,na.of)(e=>{n(!1)},e.trayIcon.extensionId);let N=e.trayIcon.extensionName,S=()=>(0,a.jsxs)("div",{"data-plugin-tray-icon":!0,className:"w-8 h-8 rounded-full flex items-center justify-center hover:bg-gray-800 cursor-pointer transition-all relative select-none",onClick:b,children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center overflow-hidden relative","data-plugin-tray-icon-inner-container":!0,children:e.trayIcon.iconUrl?(0,a.jsx)(j.r,{src:e.trayIcon.iconUrl,alt:"logo",fill:!0,className:"p-1 w-full h-full object-contain","data-plugin-tray-icon-image":!0}):(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center","data-plugin-tray-icon-image-fallback":!0,children:(0,a.jsx)(ej.Low,{className:"text-2xl"})})}),!!l&&(0,a.jsx)(ep.E,{intent:"".concat(s,"-solid"),size:"sm",className:"absolute -top-2 -right-2 z-10 select-none pointer-events-none","data-plugin-tray-icon-badge":!0,children:l})]}),C=function e(t,n){var a,l;if(t.trim().startsWith("calc(")){let a=t.replace(/^calc\(\s*/,"").replace(/\s*\)$/,"").replace(/(-?[\d.]+[a-z%]+)/g,t=>isNaN(Number(t))?e(t,n).toString():t);try{let e=a.replace(/\s+/g," ").replace(/\s*([+\-*/()])\s*/g,"$1");return Function("'use strict'; return (".concat(e,")"))()}catch(e){return console.error("Error evaluating calc() expression:",e),0}}let i=null!=(l=null==n||null==(a=n.ownerDocument)?void 0:a.defaultView)?l:window,s=i.document.documentElement||i.document.body,[r,o]=function(e){var t,n;let a=e||"0";if(a.trim().startsWith("calc(")){return n=0,[0,"calc"]}let l=Number.parseFloat(a),i=a.match(/[\d-.]+(\w+)$/);return[l,(null!=(t=null==i?void 0:i[1])?t:"").toLowerCase()]}(t);switch(o){case"rem":return r*e(nf(window.document.documentElement));case"em":return r*e(nf(n),null==n?void 0:n.parentElement);case"in":return 96*r;case"q":return 96*r/25.4/4;case"mm":return 96*r/25.4;case"cm":return 96*r*10/25.4;case"pt":return 96*r/72;case"pc":return 96*r/6;case"vh":return(r*i.innerHeight||s.clientWidth)/100;case"vw":return(r*i.innerWidth||s.clientHeight)/100;case"vmin":return r*Math.min(i.innerWidth||s.clientWidth,i.innerHeight||s.clientHeight)/100;case"vmax":return r*Math.max(i.innerWidth||s.clientWidth,i.innerHeight||s.clientHeight)/100;default:return r}}(e.trayIcon.width||"30rem"),k=e.width&&e.width<1024?C>=e.width?"calc(100vw - 30px)":C:e.trayIcon.width||"30rem";if(!e.trayIcon.withContent)return(0,a.jsx)("div",{className:"cursor-pointer",children:N?(0,a.jsx)(eg.m_,{side:"right",trigger:(0,a.jsx)("div",{"data-plugin-tray-icon-tooltip-trigger":!0,children:(0,a.jsx)(S,{})}),"data-plugin-tray-icon-tooltip":!0,children:N}):(0,a.jsx)(S,{})});x.useEffect(()=>{t&&(g(e.trayIcon.extensionId),setTimeout(()=>{document.body.style.pointerEvents="auto"},500))},[e.trayIcon.isDrawer,t]),x.useLayoutEffect(()=>{f!==e.trayIcon.extensionId&&n(!1)},[f]);let{isMobile:I}=(0,eK.al)();return e.trayIcon.isDrawer?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{"data-plugin-tray-icon-trigger":e.trayIcon.extensionId,onClick:()=>{g(e.trayIcon.extensionId),n(!0)},className:"cursor-pointer","data-plugin-tray-icon-trigger-drawer":!0,children:N?(0,a.jsx)(eg.m_,{side:"sidebar"===e.place?"right":"bottom",trigger:(0,a.jsx)("div",{"data-plugin-tray-icon-tooltip-trigger":!0,children:(0,a.jsx)(S,{})}),"data-plugin-tray-icon-tooltip":!0,children:N}):(0,a.jsx)(S,{})}),(0,a.jsx)(Z.Tr,{open:t&&f===e.trayIcon.extensionId,onOpenChange:n,modal:!1,children:(0,a.jsxs)(Z.Cz,{className:(0,h.cn)("bg-gray-950 p-0 rounded-t-xl mx-auto rounded-b-none border-b-0 !min-h-[120px]"),onOpenAutoFocus:e=>e.preventDefault(),style:{width:I?"100vw":k,minHeight:e.trayIcon.minHeight||"auto"},"data-plugin-tray-popover-content":e.trayIcon.extensionId,children:[(0,a.jsx)("div",{className:"absolute inset-0 top-[-2.5rem]",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm border font-medium text-gray-300 px-1.5 py-0.5 rounded-lg bg-black/60","data-plugin-tray-vaul-title":!0,children:e.trayIcon.extensionName}),(0,a.jsx)(w.K0,{icon:(0,a.jsx)(D.Gsv,{}),"data-plugin-tray-vaul-close-button":!0,intent:"gray-glass",size:"sm",className:"rounded-full",onClick:()=>n(!1)})]})}),(0,a.jsx)(ny,{props:e,children:(0,a.jsx)(nN,{open:t,setOpen:n,...e})})]})})]}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(ng.bL,{open:t,onOpenChange:n,modal:!1,children:[(0,a.jsx)(ng.l9,{asChild:!0,children:(0,a.jsx)("div",{"data-plugin-tray-icon-trigger":e.trayIcon.extensionId,children:N?(0,a.jsx)(eg.m_,{side:"sidebar"===e.place?"right":"bottom",trigger:(0,a.jsx)("div",{"data-plugin-tray-icon-tooltip-trigger":!0,children:(0,a.jsx)(S,{})}),"data-plugin-tray-icon-tooltip":!0,children:N}):(0,a.jsx)(S,{})})}),(0,a.jsx)(ng.ZL,{children:(0,a.jsx)(ng.UC,{sideOffset:10,side:"sidebar"===e.place?"right":"bottom",className:(0,h.cn)($.x.root(),"bg-gray-950 p-0 shadow-xl rounded-xl mb-4"),onOpenAutoFocus:e=>e.preventDefault(),style:{width:k,minHeight:e.trayIcon.minHeight||"auto",marginLeft:e.width&&e.width<1024?"10px":void 0},"data-plugin-tray-popover-content":e.trayIcon.extensionId,children:(0,a.jsx)(ny,{props:e,children:(0,a.jsx)(nN,{open:t,setOpen:n,...e})})})})]})})}function nN(e){let t,n,i,s,r,o=(0,l.c)(10),{trayIcon:d,open:u}=e,{sendRenderTrayEvent:m}=(0,na.$w)();o[0]!==u||o[1]!==m||o[2]!==d.extensionId?(t=()=>{u&&m({},d.extensionId)},o[0]=u,o[1]=m,o[2]=d.extensionId,o[3]=t):t=o[3],o[4]!==u?(n=[u],o[4]=u,o[5]=n):n=o[5],x.useEffect(t,n);let[p,f]=x.useState(null);return o[6]===Symbol.for("react.memo_cache_sentinel")?(i=e=>{f(e)},o[6]=i):i=o[6],(0,na.lg)(i,d.extensionId),o[7]===Symbol.for("react.memo_cache_sentinel")?(s=(0,h.cn)("max-h-[35rem] overflow-y-auto p-3"),o[7]=s):s=o[7],o[8]!==p?(r=(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:s,children:(0,a.jsx)(np,{registry:nc,children:p&&p.components?(0,a.jsx)(nm,{data:p.components}):(0,a.jsx)(c.kt,{})})})}),o[8]=p,o[9]=r):r=o[9],r}var nw=n(50943);let nS=(0,f.eU)([]),nC=(0,f.eU)(!1),nk=(0,f.eU)(null),nI=(0,f.eU)(null),nE=e=>{let t,n,i,s,r,o,c,d,u,p,f,g,v,y,b=(0,l.c)(52),{place:N,developmentModeExtensions:S,isReloadingExtension:C,reloadExternalExtension:k,trayIcons:I,settings:E,width:_}=e,{mutate:A,isPending:T}=(0,eX.D3)();b[0]!==(null==E?void 0:E.pinnedTrayPluginIds)?(t=(null==E?void 0:E.pinnedTrayPluginIds)||[],b[0]=null==E?void 0:E.pinnedTrayPluginIds,b[1]=t):t=b[1];let D=t;b[2]!==D?(n=e=>D.includes(e),b[2]=D,b[3]=n):n=b[3];let M=n,[O,L]=(0,m.fp)(nk),[R,P]=(0,m.fp)(nI),[F,U]=x.useState(!1);b[4]!==M||b[5]!==(null==O?void 0:O.extensionId)?(i=e=>M(e.extensionId)||e.extensionId===(null==O?void 0:O.extensionId),b[4]=M,b[5]=null==O?void 0:O.extensionId,b[6]=i):i=b[6];let z=I.filter(i);b[7]!==M||b[8]!==P||b[9]!==L||b[10]!==I?(s=e=>{e.extensionId&&(M(e.extensionId)||(L(I.find(t=>t.extensionId===e.extensionId)||null),P(e.extensionId)))},b[7]=M,b[8]=P,b[9]=L,b[10]=I,b[11]=s):s=b[11],(0,na.yi)(s,""),b[12]!==M||b[13]!==R||b[14]!==P||b[15]!==L||b[16]!==(null==O?void 0:O.extensionId)?(r=e=>{e.extensionId&&(M(e.extensionId)||(null==O?void 0:O.extensionId)!==e.extensionId||L(null),R===e.extensionId&&P(null))},b[12]=M,b[13]=R,b[14]=P,b[15]=L,b[16]=null==O?void 0:O.extensionId,b[17]=r):r=b[17],(0,na.of)(r,"");let H="top"===N&&"flex-row w-auto my-0 justify-start px-2 py-2 border-none",K=z.length>0&&"border-[--border]";b[18]!==H||b[19]!==K?(o=(0,h.cn)("w-10 mx-auto p-1 my-2","flex flex-col gap-1 items-center border border-transparent justify-center rounded-full transition-all duration-300 select-none",H,K),b[18]=H,b[19]=K,b[20]=o):o=b[20];let G="top"===N?"bottom":"right";b[21]===Symbol.for("react.memo_cache_sentinel")?(c=(0,a.jsx)("div",{children:(0,a.jsx)(eg.m_,{side:"right",trigger:(0,a.jsx)(w.K0,{intent:"gray-basic",size:"sm",icon:(0,a.jsx)(ej.ZKr,{className:"size-5 text-[--muted]"}),className:"rounded-full hover:rotate-360 transition-all duration-300"}),children:"Tray Plugins"})}),b[21]=c):c=b[21],b[22]!==M||b[23]!==T||b[24]!==D||b[25]!==A||b[26]!==L||b[27]!==I?(d=null==I?void 0:I.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2 justify-between bg-[--subtle] rounded-md px-2 py-1 max-w-full",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer max-w-full",onClick:()=>{L(e),U(!1)},children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center overflow-hidden relative flex-none",children:e.iconUrl?(0,a.jsx)(j.r,{src:e.iconUrl,alt:"logo",fill:!0,className:"p-1 w-full h-full object-contain","data-plugin-tray-icon-image":!0}):(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-none","data-plugin-tray-icon-image-fallback":!0,children:(0,a.jsx)(ej.Low,{className:"text-2xl"})})}),(0,a.jsx)("p",{className:"text-sm font-medium line-clamp-1 tracking-wide",children:e.extensionName})]}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:(0,a.jsx)(eg.m_,{trigger:(0,a.jsx)("div",{children:M(e.extensionId)?(0,a.jsx)(w.K0,{intent:"primary-basic",size:"sm",icon:(0,a.jsx)(tO.lur,{className:"size-5"}),className:"rounded-full",onClick:()=>{A({pinnedTrayPluginIds:D.filter(t=>t!==e.extensionId)})},disabled:T}):(0,a.jsx)(w.K0,{intent:"gray-basic",size:"sm",icon:(0,a.jsx)(tO.xi4,{className:"size-5 text-[--muted]"}),className:"rounded-full",onClick:()=>{A({pinnedTrayPluginIds:[...D,e.extensionId]})},disabled:T})}),children:M(e.extensionId)?"Unpin":"Pin"})})]},e.extensionId)),b[22]=M,b[23]=T,b[24]=D,b[25]=A,b[26]=L,b[27]=I,b[28]=d):d=b[28],b[29]!==I.length?(u=!I.length&&(0,a.jsx)("p",{className:"text-sm text-[--muted] py-1 text-center w-full",children:"No tray plugins"}),b[29]=I.length,b[30]=u):u=b[30],b[31]!==d||b[32]!==u?(p=(0,a.jsxs)("div",{className:"space-y-1 max-h-[310px] overflow-y-auto","data-plugin-sidebar-debug-popover-content":!0,children:[d,u]}),b[31]=d,b[32]=u,b[33]=p):p=b[33],b[34]!==G||b[35]!==p||b[36]!==F?(f=(0,a.jsx)($.A,{open:F,onOpenChange:U,side:G,trigger:c,className:"p-2 w-[300px]","data-plugin-sidebar-debug-popover":!0,modal:!1,children:p}),b[34]=G,b[35]=p,b[36]=F,b[37]=f):f=b[37],b[38]!==S||b[39]!==C||b[40]!==N||b[41]!==k?(g=!!S.length&&(0,a.jsx)($.A,{side:"top"===N?"bottom":"right",trigger:(0,a.jsx)("div",{children:(0,a.jsx)(w.K0,{intent:"warning-basic",size:"sm",icon:(0,a.jsx)(ej.XGn,{className:"size-4"}),className:"rounded-full"})}),className:"p-2","data-plugin-sidebar-debug-popover":!0,modal:!1,children:(0,a.jsxs)("div",{className:"space-y-1","data-plugin-sidebar-debug-popover-content":!0,children:[(0,a.jsxs)("div",{className:"text-sm space-y-1",children:[(0,a.jsx)("p",{className:"font-bold",children:"Debug"}),(0,a.jsx)("p",{className:"text-xs text-[--muted]",children:"These extensions are loaded in development mode."})]}),null==S?void 0:S.sort(nT).map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2 justify-between bg-[--subtle] rounded-md px-2 py-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:e.id}),(0,a.jsx)("div",{children:(0,a.jsx)(w.K0,{intent:"warning-basic",size:"sm",icon:(0,a.jsx)(ej.JbZ,{className:"size-5"}),className:"rounded-full",onClick:()=>k({id:e.id}),loading:C})})]},e.id))]})}),b[38]=S,b[39]=C,b[40]=N,b[41]=k,b[42]=g):g=b[42],b[43]!==M||b[44]!==N||b[45]!==_?(v=(e,t)=>(0,a.jsx)(nj,{trayIcon:e,isPinned:M(e.extensionId),place:N,width:_},e.extensionId),b[43]=M,b[44]=N,b[45]=_,b[46]=v):v=b[46];let W=z.map(v);return b[47]!==f||b[48]!==g||b[49]!==W||b[50]!==o?(y=(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{"data-plugin-sidebar-tray":!0,className:o,children:[f,g,W]})}),b[47]=f,b[48]=g,b[49]=W,b[50]=o,b[51]=y):y=b[51],y};function n_(e){let t,n,i,r,o,c,d,p,h,f,g,v,y,b=(0,l.c)(47),{place:j}=e,{width:N}=(0,nw.lW)(),[S,C]=(0,m.fp)(nS),[k,I]=(0,m.fp)(nC),E=(0,T.usePathname)(),{data:_}=(0,eX.s8)(),[A,D]=x.useState(!1),[M,O]=x.useState(null),L=x.useContext(t6.P),R=x.useRef(!0);b[0]!==k||b[1]!==I?(t=()=>{if(R.current){R.current=!1;return}k||I(!0)},b[0]=k,b[1]=I,b[2]=t):t=b[2],b[3]!==k||b[4]!==E?(n=[E,k],b[3]=k,b[4]=E,b[5]=n):n=b[5],x.useEffect(t,n);let{sendListTrayIconsEvent:P}=(0,na.$M)();b[6]!==P?(i=()=>{P({},"")},b[6]=P,b[7]=i):i=b[7],b[8]===Symbol.for("react.memo_cache_sentinel")?(r=[],b[8]=r):r=b[8],x.useEffect(i,r),b[9]!==C?(o=(e,t)=>{C(n=>[...n.filter(e=>e.extensionId!==t),{...e}].sort(nA))},b[9]=C,b[10]=o):o=b[10],(0,na.l9)(o,""),b[11]!==j||b[12]!==N?(c=e=>{N&&N<1024&&"top"===j&&(O(e.extensionId||""),window.scrollTo({top:0,behavior:"smooth"}),D(!0))},b[11]=j,b[12]=N,b[13]=c):c=b[13],(0,na.yi)(c,""),b[14]!==j||b[15]!==N?(d=e=>{N&&N<1024&&"top"===j&&(O(null),setTimeout(()=>{D(!1)},300))},b[14]=j,b[15]=N,b[16]=d):d=b[16],(0,na.of)(d,""),b[17]!==A||b[18]!==M||b[19]!==L?(p=()=>{if(A&&M&&L){let e=setTimeout(()=>{let e=new MessageEvent("message",{data:JSON.stringify({type:"plugin",payload:{type:"tray:open",extensionId:M,payload:{extensionId:M}}})});L.dispatchEvent(e)},100);return()=>clearTimeout(e)}},h=[A,M,L],b[17]=A,b[18]=M,b[19]=L,b[20]=p,b[21]=h):(p=b[20],h=b[21]),x.useEffect(p,h);let{data:F,refetch:U}=(0,eX.EZ)(),{mutate:z,isPending:H}=(0,eX.dh)();b[22]!==U||b[23]!==C?(f={type:u.c.PLUGIN_UNLOADED,onMessage:e=>{C(t=>t.filter(t=>t.extensionId!==e)),setTimeout(()=>{U()},1e3)}},b[22]=U,b[23]=C,b[24]=f):f=b[24],(0,s.oA)(f);let K=N&&N<1024;return S?(b[25]!==F||b[26]!==K||b[27]!==H||b[28]!==j||b[29]!==_||b[30]!==z||b[31]!==S||b[32]!==N?(g=!K&&"sidebar"===j&&(0,a.jsx)(nE,{place:j,developmentModeExtensions:F||[],isReloadingExtension:H,reloadExternalExtension:z,trayIcons:S,settings:_,width:N}),b[25]=F,b[26]=K,b[27]=H,b[28]=j,b[29]=_,b[30]=z,b[31]=S,b[32]=N,b[33]=g):g=b[33],b[34]!==F||b[35]!==K||b[36]!==H||b[37]!==A||b[38]!==j||b[39]!==_||b[40]!==z||b[41]!==S||b[42]!==N?(v=K&&"top"===j&&(0,a.jsx)("div",{className:"",children:(0,a.jsx)($.A,{open:A,onOpenChange:D,side:"bottom",trigger:(0,a.jsx)("div",{children:(0,a.jsx)(w.K0,{intent:"gray-basic",size:"sm",icon:(0,a.jsx)(ej.sVt,{className:"size-5 text-[--muted]"})})}),className:"rounded-full p-0 overflow-y-auto bg-[--background] mx-4",style:{width:N?N-50:"100%"},children:(0,a.jsx)(nE,{place:j,developmentModeExtensions:F||[],isReloadingExtension:H,reloadExternalExtension:z,trayIcons:S,settings:_,width:N})})}),b[34]=F,b[35]=K,b[36]=H,b[37]=A,b[38]=j,b[39]=_,b[40]=z,b[41]=S,b[42]=N,b[43]=v):v=b[43],b[44]!==g||b[45]!==v?(y=(0,a.jsxs)(a.Fragment,{children:[g,v]}),b[44]=g,b[45]=v,b[46]=y):y=b[46],y):null}function nA(e,t){return e.extensionId.localeCompare(t.extensionId,void 0,{numeric:!0})}function nT(e,t){return e.id.localeCompare(t.id,void 0,{numeric:!0})}function nD(e){let t,n,i,s,r,o,c,d,u,m,x,p=(0,l.c)(18),f=(0,eq.v1)(),g=null==f?void 0:f.isOffline,v=((0,eK.Ky)().hideTopNavbar||t5.X)&&"lg:hidden";return p[0]!==v?(t=(0,h.cn)("w-full h-[5rem] relative overflow-hidden flex items-center",v),p[0]=v,p[1]=t):t=p[1],p[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsx)(t4.Mz,{}),p[2]=n):n=p[2],p[3]!==g?(i=g?(0,a.jsx)(tr,{}):(0,a.jsx)(td,{}),p[3]=g,p[4]=i):i=p[4],p[5]===Symbol.for("react.memo_cache_sentinel")?(s=(0,a.jsx)(tI,{}),r=(0,a.jsx)(th,{}),o=(0,a.jsx)("div",{"data-top-navbar-content-separator":!0,className:"flex flex-1"}),c=(0,a.jsx)(n_,{place:"top"}),p[5]=s,p[6]=r,p[7]=o,p[8]=c):(s=p[5],r=p[6],o=p[7],c=p[8]),p[9]!==g?(d=!g&&(0,a.jsx)(t3,{}),p[9]=g,p[10]=d):d=p[10],p[11]!==i||p[12]!==d?(u=(0,a.jsx)("div",{"data-top-navbar-content-container":!0,className:"relative z-10 px-4 w-full flex flex-row md:items-center overflow-x-auto overflow-y-hidden",children:(0,a.jsxs)("div",{"data-top-navbar-content":!0,className:"flex items-center w-full gap-3",children:[n,i,s,r,o,c,d]})}),p[11]=i,p[12]=d,p[13]=u):u=p[13],p[14]===Symbol.for("react.memo_cache_sentinel")?(m=(0,a.jsx)(to,{}),p[14]=m):m=p[14],p[15]!==t||p[16]!==u?(x=(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{"data-top-navbar":!0,className:t,children:[u,m]})}),p[15]=t,p[16]=u,p[17]=x):x=p[17],x}function nM(e){let t,n,i,s,r,o=(0,l.c)(13),{isCollapsed:c,handleExpandSidebar:d,handleUnexpandedSidebar:u}=e,x=(0,eq.v1)(),p=(0,eK.Ky)(),h=(0,T.usePathname)(),f=(0,m.Xr)(tL);o[0]!==h?(t=h.startsWith("/manga"),o[0]=h,o[1]=t):t=o[1];let g=t;return p.hideTopNavbar,o[2]!==d||o[3]!==u||o[4]!==c||o[5]!==g||o[6]!==f||o[7]!==(null==x?void 0:x.isOffline)?(n=!(null==x?void 0:x.isOffline)&&(0,a.jsx)(e4.m,{"data-sidebar-navbar-vertical-menu":!0,className:"px-4",collapsed:c,itemClass:"relative",onMouseEnter:d,onMouseLeave:u,isSidebar:!0,items:[...g?[{iconType:ej.anB,name:"Manga Downloads",onClick:()=>{f(!0)}}]:[]]}),o[2]=d,o[3]=u,o[4]=c,o[5]=g,o[6]=f,o[7]=null==x?void 0:x.isOffline,o[8]=n):n=o[8],o[9]===Symbol.for("react.memo_cache_sentinel")?(i=(0,a.jsx)("div",{"data-sidebar-navbar-playback-manager-progress-tracking-button":!0,className:"flex justify-center",children:(0,a.jsx)(tI,{asSidebarButton:!0})}),o[9]=i):i=o[9],o[10]===Symbol.for("react.memo_cache_sentinel")?(s=(0,a.jsx)("div",{"data-sidebar-navbar-manual-progress-tracking-button":!0,className:"flex justify-center",children:(0,a.jsx)(th,{asSidebarButton:!0})}),o[10]=s):s=o[10],o[11]!==n?(r=(0,a.jsxs)("div",{"data-sidebar-navbar":!0,className:"flex flex-col gap-1",children:[n,i,s]}),o[11]=n,o[12]=r):r=o[12],r}var nO=n(81845),nL=n(22148);let nR=(0,f.eU)(!1),nP=(0,f.eU)(!1);function nF(e){var t,n,i,r,o;let c,d,p,h,f,g,v,y,b,j,S,C,k,I,E,_,A,T,O,L,R,P,F,U,z,H=(0,l.c)(62),K=(0,eq.v1)(),[G,W]=(0,m.fp)(nR),[,B]=(0,m.fp)(nP),{data:q,isLoading:V,refetch:Q}=(0,e2.A2)(!!K&&!(null==K||null==(n=K.settings)||null==(t=n.library)?void 0:t.disableUpdateCheck));H[0]!==Q?(c={type:u.c.CHECK_FOR_UPDATES,onMessage:()=>{Q()}},H[0]=Q,H[1]=c):c=H[1],(0,s.oA)(c);let{mutate:$,isPending:Y}=(0,e2.zf)();x.useState(""),H[2]!==W||H[3]!==q?(d=()=>{if(q&&q.release){localStorage.setItem("latest-available-update",JSON.stringify(q.release.version));let e=localStorage.getItem("notified-available-update");e&&e===JSON.stringify(q.release.version)||W(!0)}},H[2]=W,H[3]=q,H[4]=d):d=H[4],H[5]!==q?(p=[q],H[5]=q,H[6]=p):p=H[6],x.useEffect(d,p),H[7]!==W||H[8]!==q?(h=()=>{q&&q.release&&(localStorage.setItem("notified-available-update",JSON.stringify(q.release.version)),W(!1))},H[7]=W,H[8]=q,H[9]=h):h=H[9];let X=h;H[10]!==$?(f=function(){$({fallback_destination:""})},H[10]=$,H[11]=f):f=H[11];let Z=f;if((null==K||null==(r=K.settings)||null==(i=r.library)?void 0:i.disableUpdateCheck)||V||!q||!q.release)return null;H[12]!==W?(g=[{iconType:J.$S7,name:"Update available",onClick:()=>W(!0)}],H[12]=W,H[13]=g):g=H[13],H[14]!==e.collapsed||H[15]!==g?(v=(0,a.jsx)(e4.m,{collapsed:e.collapsed,items:g,itemIconClass:"text-brand-300"}),H[14]=e.collapsed,H[15]=g,H[16]=v):v=H[16],H[17]!==X?(y=()=>X(),H[17]=X,H[18]=y):y=H[18],H[19]!==q.release?(b=(0,a.jsx)(nU,{release:q.release}),H[19]=q.release,H[20]=b):b=H[20],H[21]===Symbol.for("react.memo_cache_sentinel")?(j=(0,a.jsx)("h3",{className:"text-center",children:"A new update is available!"}),H[21]=j):j=H[21],H[22]!==q.current_version?(S=(0,a.jsx)("span",{className:"text-[--muted]",children:q.current_version}),H[22]=q.current_version,H[23]=S):S=H[23],H[24]===Symbol.for("react.memo_cache_sentinel")?(C=(0,a.jsx)(M.dyV,{}),H[24]=C):C=H[24],H[25]!==q.release.version?(k=(0,a.jsx)("span",{className:"text-indigo-200",children:q.release.version}),H[25]=q.release.version,H[26]=k):k=H[26],H[27]!==S||H[28]!==k?(I=(0,a.jsxs)("h4",{className:"font-bold flex gap-2 text-center items-center justify-center",children:[S," ",C,k]}),H[27]=S,H[28]=k,H[29]=I):I=H[29],H[30]!==(null==K?void 0:K.isDesktopSidecar)?(E=(null==K?void 0:K.isDesktopSidecar)&&(0,a.jsx)(ex.F,{intent:"info",description:"Update Seanime from the desktop application."}),H[30]=null==K?void 0:K.isDesktopSidecar,H[31]=E):E=H[31],H[32]!==q?(_=(0,a.jsx)(e3.O,{updateData:q}),H[32]=q,H[33]=_):_=H[33],H[34]!==Z||H[35]!==Y||H[36]!==(null==K?void 0:K.isDesktopSidecar)?(A=!(null==K?void 0:K.isDesktopSidecar)&&(0,a.jsx)(ef.a,{trigger:(0,a.jsx)(w.$n,{leftIcon:(0,a.jsx)(e6.$Wp,{className:"text-2xl"}),children:"Update now"}),contentClass:"max-w-xl",title:(0,a.jsx)("span",{children:"Update Seanime"}),children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{children:"Seanime will perform an update by downloading and replacing existing files. Refer to the documentation for more information."}),(0,a.jsx)(w.$n,{className:"w-full",onClick:Z,disabled:Y,children:"Download and Install"})]})}),H[34]=Z,H[35]=Y,H[36]=null==K?void 0:K.isDesktopSidecar,H[37]=A):A=H[37],H[38]===Symbol.for("react.memo_cache_sentinel")?(T=(0,a.jsx)("div",{className:"flex flex-1"}),H[38]=T):T=H[38];let ee=(null==q||null==(o=q.release)?void 0:o.html_url)||"";return H[39]===Symbol.for("react.memo_cache_sentinel")?(O=(0,a.jsx)(w.$n,{intent:"white-subtle",rightIcon:(0,a.jsx)(D.zaF,{}),children:"See on GitHub"}),H[39]=O):O=H[39],H[40]!==ee?(L=(0,a.jsx)(N.i,{href:ee,target:"_blank",children:O}),H[40]=ee,H[41]=L):L=H[41],H[42]!==(null==K?void 0:K.isDesktopSidecar)||H[43]!==B?(R=!(null==K?void 0:K.isDesktopSidecar)&&(0,a.jsx)(w.$n,{intent:"white",leftIcon:(0,a.jsx)(D.Ah9,{}),onClick:()=>B(!0),children:"Download"}),H[42]=null==K?void 0:K.isDesktopSidecar,H[43]=B,H[44]=R):R=H[44],H[45]!==A||H[46]!==L||H[47]!==R?(P=(0,a.jsxs)("div",{className:"flex gap-2 w-full items-center !mt-4",children:[A,T,L,R]}),H[45]=A,H[46]=L,H[47]=R,H[48]=P):P=H[48],H[49]!==I||H[50]!==E||H[51]!==_||H[52]!==P?(F=(0,a.jsxs)("div",{className:"space-y-2",children:[j,I,E,_,P]}),H[49]=I,H[50]=E,H[51]=_,H[52]=P,H[53]=F):F=H[53],H[54]!==F||H[55]!==y||H[56]!==b||H[57]!==G?(U=(0,a.jsxs)(ef.a,{open:G,onOpenChange:y,contentClass:"max-w-3xl",children:[b,F]}),H[54]=F,H[55]=y,H[56]=b,H[57]=G,H[58]=U):U=H[58],H[59]!==U||H[60]!==v?(z=(0,a.jsxs)(a.Fragment,{children:[v,U]}),H[59]=U,H[60]=v,H[61]=z):z=H[61],z}function nU(e){let t,n,i,s,r,o,c,d,u,p,f,g=(0,l.c)(28),[v,y]=(0,m.fp)(nP),[b,j]=x.useState(""),[N,S]=x.useState(""),{release:C}=e,{mutate:k,isPending:I}=(0,e1.FE)();g[0]!==N||g[1]!==b||g[2]!==k||g[3]!==y?(t=function(){if(!N||!b)return ee.oR.error("Missing options");k({destination:b,download_url:N},{onSuccess:()=>{y(!1)}})},g[0]=N,g[1]=b,g[2]=k,g[3]=y,g[4]=t):t=g[4];let E=t;if(!C)return null;if(g[5]!==y?(n=()=>y(!1),g[5]=y,g[6]=n):n=g[6],g[7]===Symbol.for("react.memo_cache_sentinel")?(i=(0,h.cn)("border-transparent absolute top-2 right-2 bg-transparent dark:bg-transparent dark:data-[state=unchecked]:bg-transparent","data-[state=unchecked]:bg-transparent data-[state=unchecked]:hover:bg-transparent dark:data-[state=unchecked]:hover:bg-transparent","focus-visible:ring-0 focus-visible:ring-offset-0 focus-visible:ring-offset-transparent"),g[7]=i):i=g[7],g[8]===Symbol.for("react.memo_cache_sentinel")?(s=(0,h.cn)("items-start cursor-pointer transition border-transparent rounded-[--radius] py-1.5 px-2 w-full","bg-gray-50 hover:bg-[--subtle] dark:bg-gray-900","data-[state=checked]:bg-white dark:data-[state=checked]:bg-gray-950","focus:ring-2 ring-transparent dark:ring-transparent outline-none ring-offset-1 ring-offset-[--background] focus-within:ring-2 transition","border border-transparent data-[state=checked]:border-[--brand] data-[state=checked]:ring-offset-0"),g[8]=s):s=g[8],g[9]===Symbol.for("react.memo_cache_sentinel")?(r=e=>e?S(e):{},g[9]=r):r=g[9],g[10]!==C.assets){var _;o=(null==(_=C.assets)?void 0:_.filter(nH).map(nz))||[],g[10]=C.assets,g[11]=o}else o=g[11];g[12]!==N||g[13]!==o?(c=(0,a.jsx)("div",{children:(0,a.jsx)(t7.z,{itemClass:i,itemIndicatorClass:"hidden",itemLabelClass:"font-normal tracking-wide line-clamp-1 truncate flex flex-col items-center data-[state=checked]:text-[--brand] cursor-pointer",itemContainerClass:s,value:N,onValueChange:r,options:o})}),g[12]=N,g[13]=o,g[14]=c):c=g[14];let A="/seanime-".concat(C.version);return g[15]!==b||g[16]!==A?(d=(0,a.jsx)(nL.j,{label:"Select destination",onSelect:j,value:b,rightAddon:A}),g[15]=b,g[16]=A,g[17]=d):d=g[17],g[18]===Symbol.for("react.memo_cache_sentinel")?(u=(0,a.jsx)(D.Ah9,{}),g[18]=u):u=g[18],g[19]!==E||g[20]!==I?(p=(0,a.jsx)("div",{className:"flex gap-2 justify-end mt-2",children:(0,a.jsx)(w.$n,{intent:"white",leftIcon:u,onClick:E,loading:I,children:"Download"})}),g[19]=E,g[20]=I,g[21]=p):p=g[21],g[22]!==v||g[23]!==n||g[24]!==p||g[25]!==c||g[26]!==d?(f=(0,a.jsxs)(ef.a,{open:v,onOpenChange:n,title:"Download new release",contentClass:"space-y-4 max-w-2xl overflow-hidden",children:[c,d,p]}),g[22]=v,g[23]=n,g[24]=p,g[25]=c,g[26]=d,g[27]=f):f=g[27],f}function nz(e){return{label:e.name,value:e.browser_download_url}}function nH(e){return!e.name.endsWith(".txt")}let nK=(0,f.eU)([]),nG=(0,f.eU)(e=>e(nK).length);var nW=n(6759),nB=n(40291);let nq=(0,h.u)({root:(0,tn.F)(["UI-Avatar__root","relative flex shrink-0 overflow-hidden rounded-full"],{variants:{size:{xs:"h-6 w-6",sm:"h-8 w-8",md:"h-10 w-10",lg:"h-14 w-14",xl:"h-20 w-20"}},defaultVariants:{size:"md"}}),image:(0,tn.F)(["UI-Avatar__image","aspect-square h-full w-full"]),fallback:(0,tn.F)(["UI-Avatar__fallback","flex h-full w-full items-center justify-center rounded-full bg-[--muted] text-white dark:text-gray-800 font-semibold"]),fallbackIcon:(0,tn.F)(["UI-Avatar__fallback-icon","fill-transparent"])}),nV=x.forwardRef((e,t)=>{let n,i,s,r,o,c,d,u,m,x,p,f,g,v,y,b,j=(0,l.c)(34);if(j[0]!==e){let{className:t,children:a,imageRef:l,fallbackRef:x,asChild:p,imageClass:h,fallbackClass:f,fallback:g,fallbackIconClass:v,size:y,...b}=e;n=t,d=l,o=x,c=h,s=f,i=g,r=v,m=y,u=b,j[0]=e,j[1]=n,j[2]=i,j[3]=s,j[4]=r,j[5]=o,j[6]=c,j[7]=d,j[8]=u,j[9]=m}else n=j[1],i=j[2],s=j[3],r=j[4],o=j[5],c=j[6],d=j[7],u=j[8],m=j[9];return j[10]!==n||j[11]!==m?(x=(0,h.cn)(nq.root({size:m}),n),j[10]=n,j[11]=m,j[12]=x):x=j[12],j[13]!==c?(p=(0,h.cn)(nq.image(),c),j[13]=c,j[14]=p):p=j[14],j[15]!==d||j[16]!==u||j[17]!==p?(f=(0,a.jsx)(nB._V,{ref:d,className:p,...u}),j[15]=d,j[16]=u,j[17]=p,j[18]=f):f=j[18],j[19]!==s?(g=(0,h.cn)(nq.fallback(),s),j[19]=s,j[20]=g):g=j[20],j[21]!==i||j[22]!==r?(v=!i&&(0,a.jsxs)("svg",{viewBox:"0 0 128 128",className:(0,h.cn)(nq.fallbackIcon(),r),role:"img","aria-label":"avatar",children:[(0,a.jsx)("path",{fill:"currentColor",d:"M103,102.1388 C93.094,111.92 79.3504,118 64.1638,118 C48.8056,118 34.9294,111.768 25,101.7892 L25,95.2 C25,86.8096 31.981,80 40.6,80 L87.4,80 C96.019,80 103,86.8096 103,95.2 L103,102.1388 Z"}),(0,a.jsx)("path",{fill:"currentColor",d:"M63.9961647,24 C51.2938136,24 41,34.2938136 41,46.9961647 C41,59.7061864 51.2938136,70 63.9961647,70 C76.6985159,70 87,59.7061864 87,46.9961647 C87,34.2938136 76.6985159,24 63.9961647,24"})]}),j[21]=i,j[22]=r,j[23]=v):v=j[23],j[24]!==i||j[25]!==o||j[26]!==g||j[27]!==v?(y=(0,a.jsxs)(nB.H4,{ref:o,className:g,children:[v,i]}),j[24]=i,j[25]=o,j[26]=g,j[27]=v,j[28]=y):y=j[28],j[29]!==t||j[30]!==x||j[31]!==f||j[32]!==y?(b=(0,a.jsxs)(nB.bL,{ref:t,className:x,children:[f,y]}),j[29]=t,j[30]=x,j[31]=f,j[32]=y,j[33]=b):b=j[33],b});nV.displayName="Avatar";var nQ=n(17934),n$=n(40957),nY=n(43756),nX=n(21068),nZ=n(24151),nJ=n(73329),n0=n.n(nJ),n1=n(65160),n2=n(38628),n3=n(67187),n4=n(90221);function n5(){var e,t,n,l,i,r,o,c,d,p,f,g,v,b,j,N,S,C,k,I,E,_,A,L,R,P,F;let U=(0,t4.kb)(),z=(0,eK.Ky)(),[H,K]=x.useState(!1),[G,W]=x.useState(!1),B=z.expandSidebarOnHover?!U.isBelowBreakpoint&&!H:!U.isBelowBreakpoint,q=(0,T.useRouter)(),V=(0,T.usePathname)(),$=(0,eq.v1)(),Y=(0,eq.LX)(),X=(0,eq.iZ)(),{setSeaCommandOpen:Z}=(0,nO.W)(),J=(0,tc.Wk)(),ee=(0,m.md)(nG),{mutate:et,data:en,isPending:ea}=(0,eY.W)();x.useEffect(()=>{ea||Y(en)},[ea,en]);let el=(0,m.Xr)(O),[ei,es]=(0,m.fp)(eZ.Q),[er,eo]=(0,m.fp)(n4.gg),ec=(0,n4.zh)(),ed=()=>{!U.isBelowBreakpoint&&z.expandSidebarOnHover&&K(!0)},eu=()=>{H&&z.expandSidebarOnHover&&K(!1)},ex=(0,em.J)({title:"Sign out",description:"Are you sure you want to sign out?",onConfirm:()=>{et()}}),[eh,eg]=x.useState({downloading:0,paused:0,seeding:0});(0,s.oA)({type:u.c.ACTIVE_TORRENT_COUNT_UPDATED,onMessage:e=>{eg(e)}});let{syncIsActive:ev}=e0(),{data:ey}=(0,eX.Og)(),[eb,eS]=x.useState(!1),{mutate:eC,isPending:ek}=(0,y.Z_)(),eI=[{id:"home",iconType:n2.M14,name:"Home",href:"/",isCurrent:"/"===V},{id:"schedule",iconType:ej.IdP,name:"Schedule",href:"/schedule",isCurrent:"/schedule"===V,addon:J>0?(0,a.jsx)(ep.E,{className:"absolute right-0 top-0",size:"sm",intent:"alert-solid",children:J}):void 0},...(null==$||null==(t=$.settings)||null==(e=t.library)?void 0:e.enableManga)?[{id:"manga",iconType:ej.Z5q,name:"Manga",href:"/manga",isCurrent:V.startsWith("/manga")}]:[],{id:"lists",iconType:ew.t6L,name:"My lists",href:"/lists",isCurrent:"/lists"===V},{id:"discover",iconType:ej.Gd$,name:"Discover",href:"/discover",isCurrent:"/discover"===V},...(null==$||null==(l=$.settings)||null==(n=l.library)?void 0:n.torrentProvider)!==nZ.xF.NONE&&(null==$||null==(r=$.settings)||null==(i=r.torrent)?void 0:i.defaultTorrentClient)!==nZ.XH.NONE?[{id:"torrent-list",iconType:(null==$||null==(c=$.settings)||null==(o=c.torrent)?void 0:o.defaultTorrentClient)===nZ.XH.QBITTORRENT?n3.fy_:n3.nfy,name:0!==eh.seeding&&(null==$||null==(p=$.settings)||null==(d=p.torrent)?void 0:d.showActiveTorrentCount)?"Torrent list (".concat(eh.seeding," seeding)"):"Torrent list",href:"/torrent-list",isCurrent:"/torrent-list"===V,addon:eh.downloading+eh.paused>0&&(null==$||null==(g=$.settings)||null==(f=g.torrent)?void 0:f.showActiveTorrentCount)?(0,a.jsx)(ep.E,{className:"absolute right-0 top-0 bg-green-500",size:"sm",intent:"alert-solid",children:eh.downloading+eh.paused}):void 0}]:[],...(null==$||null==(v=$.debridSettings)?void 0:v.enabled)&&(null==$||null==(b=$.debridSettings)?void 0:b.provider)?[{id:"debrid",iconType:n1.hgf,name:"Debrid",href:"/debrid",isCurrent:"/debrid"===V}]:[],...(null==$||null==(N=$.settings)||null==(j=N.library)?void 0:j.libraryPath)?[{id:"scan-summaries",iconType:tO.rlW,name:"Scan summaries",href:"/scan-summaries",isCurrent:"/scan-summaries"===V}]:[],...(null==$||null==(C=$.settings)||null==(S=C.library)?void 0:S.torrentProvider)!==nZ.xF.NONE&&(null==$||null==(I=$.settings)||null==(k=I.library)?void 0:k.libraryPath)?[{id:"auto-downloader",iconType:ej.sOl,name:"Auto Downloader",href:"/auto-downloader",isCurrent:"/auto-downloader"===V,addon:ee>0?(0,a.jsx)(ep.E,{className:"absolute right-0 top-0",size:"sm",intent:"alert-solid",children:ee}):void 0}]:[],{id:"search",iconType:M.CKj,name:"Search",onClick:()=>{U.setOpen(!1),el(!0)}}],eE=x.useMemo(()=>eI.filter(e=>{var t;return!(null==(t=z.unpinnedMenuItems)?void 0:t.includes(e.id))}),[eI,z.unpinnedMenuItems]),e_=x.useMemo(()=>{var e;return(null==(e=z.unpinnedMenuItems)?void 0:e.length)===0||0===eI.length?[]:[{iconType:D.XWt,name:"More",subContent:(0,a.jsx)(e4.m,{items:eI.filter(e=>{var t;return null==(t=z.unpinnedMenuItems)?void 0:t.includes(e.id)}),isSidebar:!0})}]},[eI,z.unpinnedMenuItems,z.hideTopNavbar]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(t4.GK,{className:(0,h.cn)("group/main-sidebar h-full flex flex-col justify-between transition-gpu w-full transition-[width] duration-300 overflow-x-hidden",!U.isBelowBreakpoint&&H&&"w-[260px]",!U.isBelowBreakpoint&&!z.disableSidebarTransparency&&"bg-transparent",!U.isBelowBreakpoint&&!z.disableSidebarTransparency&&z.expandSidebarOnHover&&H&&"bg-[--background] rounded-tr-xl rounded-br-xl border-[--border]"),onMouseEnter:ed,onMouseLeave:eu,children:[!U.isBelowBreakpoint&&z.expandSidebarOnHover&&z.disableSidebarTransparency&&(0,a.jsx)("div",{className:(0,h.cn)("fixed h-full translate-x-0 w-[50px] bg-gradient bg-gradient-to-r via-[--background] from-[--background] to-transparent","group-hover/main-sidebar:translate-x-[250px] transition opacity-0 duration-300 group-hover/main-sidebar:opacity-100")}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:(0,h.cn)("mb-4 p-4 pb-0 flex justify-center w-full",t5.X&&"mt-2"),children:(0,a.jsx)("img",{src:"/seanime-logo.png",alt:"logo",className:"w-15 h-10 transition-all duration-300"})}),(0,a.jsx)(e4.m,{className:"px-4",collapsed:B,itemClass:"relative",itemChevronClass:"hidden",itemIconClass:"transition-transform group-data-[state=open]/verticalMenu_parentItem:rotate-90",items:[...eE,...e_,{iconType:ej.JbZ,name:"Refresh AniList",onClick:()=>{U.setOpen(!1),ek||eC()}}],subContentClass:(0,h.cn)((z.hideTopNavbar||t5.X)&&"border-transparent !border-b-0"),onLinkItemClick:()=>U.setOpen(!1),isSidebar:!0}),(0,a.jsx)(nM,{isCollapsed:B,handleExpandSidebar:()=>{},handleUnexpandedSidebar:()=>{}}),t5.X&&(0,a.jsx)("div",{className:"w-full flex justify-center px-4",children:(0,a.jsx)(n$.j,{side:"right",sideOffset:-8,className:"bg-transparent border-none",trigger:(0,a.jsx)(w.K0,{intent:"gray-basic",className:"!text-[--muted] hover:!text-[--foreground]",icon:(0,a.jsx)(tm._R2,{}),onClick:()=>{q.back()}}),children:(0,a.jsx)(w.K0,{icon:(0,a.jsx)(tm.HNO,{}),intent:"gray-subtle",className:"opacity-50 hover:opacity-100",onClick:()=>{q.forward()}})})}),(0,a.jsx)(n_,{place:"sidebar"})]}),(0,a.jsxs)("div",{className:"flex w-full gap-2 flex-col px-4",children:[t5.X?t5.qe?(0,a.jsx)(nW.gS,{collapsed:B}):t5.nH?(0,a.jsx)(te,{collapsed:B}):null:(0,a.jsx)(nF,{collapsed:B}),(0,a.jsx)("div",{children:(0,a.jsx)(e4.m,{collapsed:B,itemClass:"relative",onMouseEnter:()=>{},onMouseLeave:()=>{},onLinkItemClick:()=>U.setOpen(!1),isSidebar:!0,items:[...(null==$||null==(_=$.settings)||null==(E=_.nakama)?void 0:E.enabled)?[{iconType:eN.u67,iconClass:"size-6",name:"Nakama",isCurrent:er,onClick:()=>{U.setOpen(!1),eo(!0)},addon:(0,a.jsxs)(a.Fragment,{children:[(null==ec?void 0:ec.isHost)&&!!(null==ec||null==(A=ec.connectedPeers)?void 0:A.length)&&(0,a.jsx)(ep.E,{className:"absolute right-0 top-0",size:"sm",intent:"info",children:null==ec||null==(L=ec.connectedPeers)?void 0:L.length}),(null==ec?void 0:ec.isConnectedToHost)&&(0,a.jsx)("div",{className:"absolute right-2 top-2 animate-pulse size-2 bg-green-500 rounded-full"})]})}]:[],{iconType:D.DT2,name:"Extensions",href:"/extensions",isCurrent:V.includes("/extensions"),addon:(null==ey?void 0:ey.length)?(0,a.jsx)(ep.E,{className:"absolute right-0 top-0 bg-red-500 animate-pulse",size:"sm",intent:"alert-solid",children:(null==ey?void 0:ey.length)||1}):void 0},{iconType:n2.fps,name:"Offline",href:"/sync",isCurrent:V.includes("/sync"),addon:ev?(0,a.jsx)(ep.E,{className:"absolute right-0 top-0 bg-blue-500",size:"sm",intent:"alert-solid",children:"1"}):void 0},{iconType:ej.xPd,name:"Settings",href:"/settings",isCurrent:"/settings"===V},...U.isBelowBreakpoint?[{iconType:(null==X?void 0:X.isSimulated)?M.dUr:D.AMx,name:(null==X?void 0:X.isSimulated)?"Sign in":"Sign out",onClick:(null==X?void 0:X.isSimulated)?()=>es(!0):ex.open}]:[]]})}),!X&&(0,a.jsx)("div",{children:(0,a.jsx)(e4.m,{collapsed:B,itemClass:"relative",onMouseEnter:ed,onMouseLeave:eu,onLinkItemClick:()=>U.setOpen(!1),isSidebar:!0,items:[{iconType:M.dUr,name:"Login",onClick:()=>(0,nY.A)(nX.$M)}]})}),!!X&&(0,a.jsx)("div",{className:"flex w-full gap-2 flex-col",children:(0,a.jsx)(nQ.rI,{trigger:(0,a.jsxs)("div",{className:(0,h.cn)("w-full flex p-2 pt-1 items-center space-x-3",{hidden:U.isBelowBreakpoint}),children:[(0,a.jsx)(nV,{size:"sm",className:"cursor-pointer",src:(null==X||null==(P=X.viewer)||null==(R=P.avatar)?void 0:R.medium)||void 0}),H&&(0,a.jsx)("p",{className:"truncate text-sm text-[--muted]",children:null==X||null==(F=X.viewer)?void 0:F.name})]}),open:G,onOpenChange:W,children:X.isSimulated?(0,a.jsxs)(nQ._2,{onClick:()=>es(!0),children:[(0,a.jsx)(D.DLy,{})," Log in with AniList"]}):(0,a.jsxs)(nQ._2,{onClick:ex.open,children:[(0,a.jsx)(D.AMx,{})," Sign out"]})})})]})]}),(0,a.jsx)(ef.a,{title:"Log in with AniList",description:"Using an AniList account is recommended.",open:ei&&(null==X?void 0:X.isSimulated),onOpenChange:e=>es(e),overlayClass:"bg-opacity-95 bg-gray-950",contentClass:"border",children:(0,a.jsxs)("div",{className:"mt-5 text-center space-y-4",children:[(0,a.jsx)(n0(),{href:nX.tL,target:"_blank",children:(0,a.jsx)(w.$n,{leftIcon:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",width:"24",height:"24",viewBox:"0 0 24 24",role:"img",children:(0,a.jsx)("path",{d:"M6.361 2.943 0 21.056h4.942l1.077-3.133H11.4l1.052 3.133H22.9c.71 0 1.1-.392 1.1-1.101V17.53c0-.71-.39-1.101-1.1-1.101h-6.483V4.045c0-.71-.392-1.102-1.101-1.102h-2.422c-.71 0-1.101.392-1.101 1.102v1.064l-.758-2.166zm2.324 5.948 1.688 5.018H7.144z"})}),intent:"white",size:"md",children:"Get AniList token"})}),(0,a.jsxs)(Q.lV,{schema:(0,Q.Jo)(e=>{let{z:t}=e;return t.object({token:t.string().min(1,"Token is required")})}),onSubmit:e=>{eS(!0),q.push("/auth/callback#access_token="+e.token.trim()),es(!1),eS(!1)},children:[(0,a.jsx)(Q.D0.Textarea,{name:"token",label:"Enter the token",fieldClass:"px-4"}),(0,a.jsx)(Q.D0.Submit,{showLoadingOverlayOnSuccess:!0,loading:eb,children:"Continue"})]})]})}),(0,a.jsx)(em.K,{...ex})]})}var n6=n(68205),n8=n(56222),n7=n(18292),n9=n(62024);function ae(e){var t,n,i,s;let r,o,c,d,u,m,p,h,f,g,v,y,b,j,N,S=(0,l.c)(47),{libraryCollection:C,playlist:k,trigger:I}=e,[E,_]=x.useState(!1),[A,T]=x.useState(null!=(t=null==k?void 0:k.name)?t:"");S[0]===Symbol.for("react.memo_cache_sentinel")?(r=[],S[0]=r):r=S[0];let[D,M]=x.useState(r),O=!!k,{mutate:L,isPending:R}=(0,n8._X)(),{mutate:P,isPending:F}=(0,n8.F6)(),{mutate:U,isPending:z}=(0,n8.pZ)();S[1]===Symbol.for("react.memo_cache_sentinel")?(o=function(){T(""),M([])},S[1]=o):o=S[1];let H=o;S[2]!==O||S[3]!==k?(c=()=>{O&&k&&k.episodes&&(T(k.name),M(k.episodes))},S[2]=O,S[3]=k,S[4]=c):c=S[4],S[5]!==E||S[6]!==k?(d=[k,E],S[5]=E,S[6]=k,S[7]=d):d=S[7],x.useEffect(c,d),S[8]!==L||S[9]!==D||S[10]!==O||S[11]!==A||S[12]!==k||S[13]!==U?(u=function(){if(0===A.length)return void ee.oR.error("Please enter a name for the playlist");O&&k?U({dbId:k.dbId,name:A,episodes:D}):(_(!1),L({name:A,episodes:D},{onSuccess:()=>{H()}}))},S[8]=L,S[9]=D,S[10]=O,S[11]=A,S[12]=k,S[13]=U,S[14]=u):u=S[14];let K=u,G=O?"Edit playlist":"Create a playlist";S[15]===Symbol.for("react.memo_cache_sentinel")?(m=e=>_(e),S[15]=m):m=S[15],S[16]===Symbol.for("react.memo_cache_sentinel")?(p=e=>T(e.target.value),S[16]=p):p=S[16],S[17]!==A?(h=(0,a.jsx)(X.k,{label:"Name",value:A,onChange:p}),S[17]=A,S[18]=h):h=S[18],S[19]!==D||S[20]!==C?(f=(0,a.jsx)(n9.er,{episodes:D,setEpisodes:M,libraryCollection:C}),S[19]=D,S[20]=C,S[21]=f):f=S[21],S[22]!==D||S[23]!==(null==C?void 0:C.lists)?(g=null==C||null==(s=C.lists)||null==(i=s.flatMap(at))||null==(n=i.filter(Boolean))?void 0:n.map(e=>(0,a.jsx)(n9.Zf,{entry:e,episodes:D,setEpisodes:M},e.mediaId)),S[22]=D,S[23]=null==C?void 0:C.lists,S[24]=g):g=S[24];let W=0===D.length,B=R||F||z,q=O?"Update":"Create";return S[25]!==K||S[26]!==W||S[27]!==B||S[28]!==q?(v=(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)(w.$n,{disabled:W,onClick:K,loading:B,className:"w-full",children:q})}),S[25]=K,S[26]=W,S[27]=B,S[28]=q,S[29]=v):v=S[29],S[30]!==g||S[31]!==v||S[32]!==h||S[33]!==f?(y=(0,a.jsxs)("div",{className:"space-y-4",children:[h,f,g,v]}),S[30]=g,S[31]=v,S[32]=h,S[33]=f,S[34]=y):y=S[34],S[35]!==P||S[36]!==O||S[37]!==k?(b=O&&(0,a.jsx)(Q.mw,{actionText:"Delete playlist",onDelete:()=>{O&&k&&P({dbId:k.dbId},{onSuccess:()=>{_(!1)}})}}),S[35]=P,S[36]=O,S[37]=k,S[38]=b):b=S[38],S[39]!==y||S[40]!==b?(j=(0,a.jsxs)("div",{className:"space-y-4",children:[y,b]}),S[39]=y,S[40]=b,S[41]=j):j=S[41],S[42]!==E||S[43]!==j||S[44]!==G||S[45]!==I?(N=(0,a.jsx)(ef.a,{title:G,trigger:I,open:E,onOpenChange:m,onInteractOutside:an,contentClass:"max-w-4xl",children:j}),S[42]=E,S[43]=j,S[44]=G,S[45]=I,S[46]=N):N=S[46],N}function at(e){return e.entries}function an(e){return e.preventDefault()}var aa=n(29694),al=n(6708),ai=n(19022);function as(){var e,t,n,i,s,r,o,c,d;let u,m,p,f,g,v,y,b,j,N,S,C,k=(0,l.c)(45);(0,eq.v1)();let{isModalOpen:I,setModalOpen:E,setSelectedMedia:_,selectedMedia:A}=(0,aa.e)(),{data:T}=(0,n6.lD)();e:{if(!(null==T?void 0:T.lists)){u=void 0;break e}if(null==T?void 0:T.stream){let a,l,c,d;if(k[0]!==T.lists||k[1]!==T.stream.anime||k[2]!==T.stream.listData){let l,s=null==(e=T.lists)?void 0:e.find(ac);for(let e of(a=[...null!=(t=null==s?void 0:s.entries)?t:[]],k[4]!==T.stream.anime?(l=null!=(n=T.stream.anime)?n:[],k[4]=T.stream.anime,k[5]=l):l=k[5],l))a.some(t=>t.mediaId===e.id)||a.push({media:e,mediaId:e.id,listData:null==(i=T.stream.listData)?void 0:i[e.id],libraryData:void 0});k[0]=T.lists,k[1]=T.stream.anime,k[2]=T.stream.listData,k[3]=a}else a=k[3];k[6]!==a?(l={type:"CURRENT",status:"CURRENT",entries:a},k[6]=a,k[7]=l):l=k[7];let m=l;k[8]!==T.lists||k[9]!==m?(c=[m,...null!=(o=null==(s=null!=(r=T.lists)?r:[])?void 0:s.filter(ao))?o:[]].filter(Boolean),k[8]=T.lists,k[9]=m,k[10]=c):c=k[10],k[11]!==T||k[12]!==c?(d={...T,lists:c},k[11]=T,k[12]=c,k[13]=d):d=k[13],u=d}else u=T}let D=u;k[14]!==(null==D?void 0:D.lists)?(m=null!=(d=null==D||null==(c=D.lists)?void 0:c.flatMap(ar))?d:[],k[14]=null==D?void 0:D.lists,k[15]=m):m=k[15];let M=m;k[16]!==M||k[17]!==A||k[18]!==E||k[19]!==_?(p=()=>{A&&!M.find(e=>(null==e?void 0:e.mediaId)===A)&&(ee.oR.warning("This anime is not in your library or currently watching collection."),_(null),x.startTransition(()=>{E(!1)}))},k[16]=M,k[17]=A,k[18]=E,k[19]=_,k[20]=p):p=k[20],k[21]!==M||k[22]!==A?(f=[A,M],k[21]=M,k[22]=A,k[23]=f):f=k[23],x.useEffect(p,f),k[24]!==E||k[25]!==_?(g=e=>{E(e),e||_(null)},k[24]=E,k[25]=_,k[26]=g):g=k[26],k[27]===Symbol.for("react.memo_cache_sentinel")?(v=(0,a.jsx)("div",{children:(0,a.jsx)("h4",{className:"flex items-center",children:"Playlists"})}),k[27]=v):v=k[27];let O=A&&"animate-pulse";k[28]!==O?(y=(0,h.cn)("rounded-full",O),k[28]=O,k[29]=y):y=k[29];let L=A?"Add to new Playlist":"Create a Playlist";return k[30]!==y||k[31]!==L?(b=(0,a.jsx)(w.$n,{intent:"white",className:y,children:L}),k[30]=y,k[31]=L,k[32]=b):b=k[32],k[33]!==D||k[34]!==b?(j=(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[v,(0,a.jsx)("div",{className:"flex gap-2 items-center md:pr-8",children:(0,a.jsx)(ae,{libraryCollection:D,trigger:b})})]}),k[33]=D,k[34]=b,k[35]=j):j=k[35],k[36]!==D?(N=(0,a.jsx)("div",{className:"",children:(0,a.jsx)(ad,{libraryCollection:D})}),k[36]=D,k[37]=N):N=k[37],k[38]!==j||k[39]!==N?(S=(0,a.jsxs)("div",{className:"space-y-6",children:[j,N]}),k[38]=j,k[39]=N,k[40]=S):S=k[40],k[41]!==I||k[42]!==S||k[43]!==g?(C=(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(ta._s,{open:I,onOpenChange:g,size:"lg",side:"bottom",contentClass:"",children:S})}),k[41]=I,k[42]=S,k[43]=g,k[44]=C):C=k[44],C}function ar(e){return e.entries}function ao(e){return"CURRENT"!==e.type}function ac(e){return"CURRENT"===e.type}function ad(e){let t,n,i,s,r=(0,l.c)(17),{libraryCollection:o}=e,{data:d,isLoading:u}=(0,n8.PY)(),{selectedMedia:m,setModalOpen:x}=(0,aa.e)(),{startPlaylist:p}=(0,tv.n)();if(u){let e;return r[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(c.kt,{}),r[0]=e):e=r[0],e}if(!(null==d?void 0:d.length)){let e;return r[1]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsxs)("div",{className:"text-center text-[--muted] space-y-1 py-6",children:[(0,a.jsx)(eN.wHW,{className:"mx-auto text-5xl text-[--muted]"}),(0,a.jsx)("div",{children:"No playlists"})]}),r[1]=e):e=r[1],e}if(r[2]===Symbol.for("react.memo_cache_sentinel")?(t={align:"start"},n=(0,a.jsx)(al.h1,{}),r[2]=t,r[3]=n):(t=r[2],n=r[3]),r[4]!==o||r[5]!==d||r[6]!==m||r[7]!==x||r[8]!==p){let e;r[10]!==o||r[11]!==m||r[12]!==x||r[13]!==p?(e=e=>{var t,n,l,i,s;let r=null==(l=e.episodes)||null==(n=l[0])||null==(t=n.episode)?void 0:t.baseAnime;return(0,a.jsx)(al.A7,{className:(0,h.cn)("md:basis-1/3 lg:basis-1/4 2xl:basis-1/6 min-[2000px]:basis-1/6","aspect-[7/6] p-2"),children:(0,a.jsxs)("div",{className:"group/playlist-item flex gap-3 h-full justify-between items-center bg-gray-950 rounded-md transition relative overflow-hidden",children:[((null==r||null==(i=r.coverImage)?void 0:i.large)||(null==r?void 0:r.bannerImage))&&(0,a.jsx)(j.r,{src:(null==r||null==(s=r.coverImage)?void 0:s.extraLarge)||(null==r?void 0:r.bannerImage)||"",placeholder:(0,tb.r)(700,475),sizes:"10rem",fill:!0,alt:"",className:"object-center object-cover z-[1]"}),(0,a.jsx)("div",{className:"absolute inset-0 z-[2] bg-gray-900 opacity-50 hover:opacity-70 transition-opacity flex items-center justify-center"}),(0,a.jsx)("div",{className:"absolute inset-0 z-[6] flex items-center justify-center",children:!m&&(0,a.jsx)("div",{onClick:()=>{p(e),x(!1)},children:(0,a.jsx)(ai.Yay,{className:"block text-5xl cursor-pointer opacity-95 hover:opacity-70 hover:scale-[1.1] transition-all"})})}),(0,a.jsx)("div",{className:"absolute top-2 right-2 z-[6] flex items-center justify-center",children:(0,a.jsx)(ae,{libraryCollection:o,trigger:(0,a.jsx)(w.$n,{className:(0,h.cn)("w-full flex-none rounded-full",m&&"animate-pulse"),leftIcon:m?(0,a.jsx)(ej._rf,{}):(0,a.jsx)(D.VZ_,{}),intent:m?"white":"white-subtle",size:"sm",children:m?"Add to Playlist":"Edit"}),playlist:e})}),(0,a.jsx)("div",{className:"absolute w-full bottom-0 h-fit z-[6]",children:(0,a.jsxs)("div",{className:"space-y-0 pb-3 items-center",children:[(0,a.jsx)("p",{className:"text-md font-bold text-white max-w-lg truncate text-center",children:e.name}),e.episodes&&(0,a.jsxs)("p",{className:"text-sm text-[--muted] font-normal line-clamp-1 text-center",children:[e.episodes.length," episode",e.episodes.length>1?"s":""]})]})}),(0,a.jsx)(n7.H,{})]})},e.dbId)},r[10]=o,r[11]=m,r[12]=x,r[13]=p,r[14]=e):e=r[14],i=d.map(e),r[4]=o,r[5]=d,r[6]=m,r[7]=x,r[8]=p,r[9]=i}else i=r[9];return r[15]!==i?(s=(0,a.jsxs)(al.FN,{className:"w-full max-w-full",gap:"none",opts:t,children:[n,(0,a.jsx)(al.Wk,{children:i})]}),r[15]=i,r[16]=s):s=r[16],s}var au=n(45499),am=n(70274);function ax(e){let{extensionId:t,info:n}=e;(0,T.useRouter)();let l=(0,T.usePathname)(),[i,s]=x.useState(!1),[r,o]=x.useState(""),[c,d]=x.useState(""),[u,m]=x.useState([]),[p,h]=x.useState(n.placeholder),{sendRenderCommandPaletteEvent:f}=(0,na.Zf)(),{sendCommandPaletteInputEvent:g}=(0,na.FS)(),{sendCommandPaletteOpenedEvent:v}=(0,na.aY)(),{sendCommandPaletteClosedEvent:y}=(0,na.vM)(),{sendCommandPaletteItemSelectedEvent:b}=(0,na.fP)();x.useEffect(()=>{if(n.keyboardShortcut)return tN().bind(n.keyboardShortcut,()=>{o(""),x.startTransition(()=>{s(!0)})}),()=>{tN().unbind(n.keyboardShortcut)}},[n.keyboardShortcut]),(0,am.w5)(()=>{i||(o(""),y({},t)),i&&(v({},t),f({},t))},[i,t]),(0,na.Ce)(e=>{g({value:r},t)},t),(0,na.NM)(e=>{o(e.value)},t),(0,na.kF)(e=>{s(!0)},t),(0,na.mU)(e=>{s(!1)},t),(0,na.$n)(e=>{m(e.items),h(e.placeholder)},t);let j=x.useRef(null);function N(){let e=j.current;if(!e)return()=>{};let t=setTimeout(()=>{e.scrollTop=0;let t=e.querySelector("[cmdk-item]");if(t){let e=t.getAttribute("data-value");e&&d(e)}},100);return()=>clearTimeout(t)}x.useEffect(()=>{let e=N();return()=>e()},[r,l]);let w=x.useMemo(()=>{let e={};return u.filter(e=>"includes"===e.filterType?e.value.toLowerCase().includes(r.toLowerCase()):"startsWith"!==e.filterType||e.value.toLowerCase().startsWith(r.toLowerCase())).forEach(t=>{let n=t.heading||"";e[n]||(e[n]=[]),e[n].push(t)}),N(),e},[u,r]);return(0,a.jsxs)(au.Gj,{open:i,onOpenChange:s,commandProps:{value:c,onValueChange:d},overlayClass:"bg-black/30",contentClass:"max-w-2xl",commandClass:"h-[300px]",children:[(0,a.jsx)(au.G7,{placeholder:p||"",value:r,onValueChange:o}),(0,a.jsx)(au.oI,{className:"mb-2",ref:j,children:(0,a.jsx)(np,{registry:nc,children:Object.entries(w).map(e=>{let[n,l]=e;return(0,a.jsx)(au.L$,{heading:n,children:l.map(e=>(0,a.jsx)(au.h_,{value:e.value,onSelect:()=>{b({itemId:e.id},t)},className:"block",children:e.label?e.label:(0,a.jsx)(nm,{data:e.components})},e.id))},n)})})})]})}let ap=(0,f.eU)([]);function ah(){let e,t,n,i,r,o,c=(0,l.c)(11),[d,p]=(0,m.fp)(ap),{sendListCommandPalettesEvent:h}=(0,na.mL)();return(c[0]!==h?(e=()=>{h({},"")},c[0]=h,c[1]=e):e=c[1],c[2]===Symbol.for("react.memo_cache_sentinel")?(t=[],c[2]=t):t=c[2],x.useEffect(e,t),c[3]!==p?(n=(e,t)=>{"q"!==e.keyboardShortcut&&"meta+j"!==e.keyboardShortcut&&p(n=>[...n.filter(e=>e.extensionId!==t),{extensionId:t,...e}].sort(ag))},c[3]=p,c[4]=n):n=c[4],(0,na.KQ)(n,""),c[5]!==p?(i={type:u.c.PLUGIN_UNLOADED,onMessage:e=>{p(t=>t.filter(t=>t.extensionId!==e))}},c[5]=p,c[6]=i):i=c[6],(0,s.oA)(i),d)?(c[7]!==d?(r=d.map(af),c[7]=d,c[8]=r):r=c[8],c[9]!==r?(o=(0,a.jsx)(a.Fragment,{children:r}),c[9]=r,c[10]=o):o=c[10],o):null}function af(e,t){return(0,a.jsx)(ax,{extensionId:e.extensionId,info:e},t)}function ag(e,t){return e.extensionId.localeCompare(t.extensionId,void 0,{numeric:!0})}let av=0;function ay(e){let t=(av++).toString(36);return"".concat("pe","-").concat(e.substring(0,4),"-").concat(t)}function ab(e,t){let n=document.getElementById(e.elementId);n&&n.removeEventListener(e.eventType,e.callback)}function aj(e){e.disconnect()}function aN(e,t,n,a){if(!(e instanceof HTMLElement))return;let l={};if(e.dataset.original)try{l=JSON.parse(e.dataset.original)}catch(e){l={}}l[t]||(l[t]={}),void 0===l[t][n]&&(l[t][n]=a,e.dataset.original=JSON.stringify(l))}function aw(e){return e.target}function aS(e){return e.isIntersecting}function aC(e){}function ak(e){}function aI(e){let t,n,a,i,r,o,c,d,m,p,h,f,g,v,y,b=(0,l.c)(39),{extensionId:j,onUnloaded:N}=e,{handleDOMQuery:w,handleDOMQueryOne:S,handleDOMObserve:C,handleDOMObserveInView:k,handleDOMStopObserve:I,handleDOMCreate:E,handleDOMManipulate:_,cleanup:A}=function(e){let t,n,a,i,r,o,c,d,u,m,p,h,f,g,v,y,b,j,N,w,S,C,k=(0,l.c)(58),{sendPluginMessage:I}=(0,s.Y0)();k[0]===Symbol.for("react.memo_cache_sentinel")?(t=new Map,k[0]=t):t=k[0];let E=(0,x.useRef)(t);k[1]===Symbol.for("react.memo_cache_sentinel")?(n=new Map,k[1]=n):n=k[1];let _=(0,x.useRef)(n);k[2]===Symbol.for("react.memo_cache_sentinel")?(a=new Map,k[2]=a):a=k[2];let A=(0,x.useRef)(a);k[3]===Symbol.for("react.memo_cache_sentinel")?(i=new Map,k[3]=i):i=k[3];let T=(0,x.useRef)(i),D=(0,x.useRef)(null),M=(0,x.useRef)(!1),O=(0,x.useRef)(!1);k[4]===Symbol.for("react.memo_cache_sentinel")?(r=new Set,k[4]=r):r=k[4];let L=(0,x.useRef)(r);k[5]===Symbol.for("react.memo_cache_sentinel")?(o=new Map,k[5]=o):o=k[5];let R=(0,x.useRef)(o);k[6]!==e?(c=t=>{if(E.current.has(t))return E.current.get(t);if(t.id)return E.current.set(t,t.id),t.id;let n=ay(e);return t.id=n,E.current.set(t,n),n},k[6]=e,k[7]=c):c=k[7];let P=c;k[8]!==e||k[9]!==I?(d=(t,n)=>{M.current||I(t,n,e)},k[8]=e,k[9]=I,k[10]=d):d=k[10];let F=d;k[11]!==F?(u=()=>{M.current||O.current||(O.current=!0,F(na.sn.DOMReady,{}))},k[11]=F,k[12]=u):u=k[12];let U=u;k[13]!==P?(m=(e,t)=>{let n={};for(let t=0;t<e.attributes.length;t++){let a=e.attributes[t];n[a.name]=a.value}if(n.id=P(e),e instanceof HTMLElement)for(let t in e.dataset)Object.prototype.hasOwnProperty.call(e.dataset,t)&&(n["data-".concat(t)]=e.dataset[t]||"");return(null==t?void 0:t.identifyChildren)&&e.querySelectorAll("*").forEach(e=>{e.id||P(e)}),{id:n.id,tagName:e.tagName.toLowerCase(),attributes:n,innerHTML:(null==t?void 0:t.withInnerHTML)?e.innerHTML:void 0,outerHTML:(null==t?void 0:t.withOuterHTML)?e.outerHTML:void 0,children:[]}},k[13]=P,k[14]=m):m=k[14];let z=m;k[15]!==z||k[16]!==P||k[17]!==F?(p=()=>{"undefined"!=typeof MutationObserver&&(D.current=new MutationObserver(e=>{if(M.current)return;let t=new Set;e.forEach(e=>{if("childList"===e.type&&e.addedNodes.forEach(e=>{e instanceof Element&&(t.add(e),e.querySelectorAll("*").forEach(e=>t.add(e)))}),"attributes"===e.type||"characterData"===e.type){let n=e.target instanceof Element?e.target:e.target.parentElement;n&&t.add(n)}}),_.current.forEach((e,n)=>{let a=[],l=A.current.get(n)||new Set;if(t.forEach(t=>{t.matches(e.selector)&&(P(t),a.push(t))}),document.querySelectorAll(e.selector).forEach(e=>{let t=P(e);l.has(t)||a.includes(e)||a.push(e)}),a.length>0){let t=a.map(t=>z(t,{withInnerHTML:e.withInnerHTML,withOuterHTML:e.withOuterHTML,identifyChildren:e.identifyChildren}));t.forEach(e=>l.add(e.id)),A.current.set(n,l),e.callback(a),F(na.sn.DOMObserveResult,{observerId:n,elements:t})}})}),D.current.observe(document.body,{childList:!0,subtree:!0,attributes:!0,characterData:!0}))},k[15]=z,k[16]=P,k[17]=F,k[18]=p):p=k[18];let H=p;k[19]!==z||k[20]!==F?(h=e=>{let{selector:t,requestId:n,withInnerHTML:a,identifyChildren:l,withOuterHTML:i}=e;if(M.current)return;let s=Array.from(document.querySelectorAll(t)).map(e=>z(e,{withInnerHTML:a,identifyChildren:l,withOuterHTML:i}));F(na.sn.DOMQueryResult,{requestId:n,elements:s})},k[19]=z,k[20]=F,k[21]=h):h=k[21];let K=h;k[22]!==z||k[23]!==F?(f=e=>{let{selector:t,requestId:n,withInnerHTML:a,identifyChildren:l,withOuterHTML:i}=e;if(M.current)return;let s=document.querySelector(t),r=s?z(s,{withInnerHTML:a,identifyChildren:l,withOuterHTML:i}):null;F(na.sn.DOMQueryOneResult,{requestId:n,element:r})},k[22]=z,k[23]=F,k[24]=f):f=k[24];let G=f;k[25]!==z||k[26]!==P||k[27]!==F?(g=e=>{let{selector:t,observerId:n,withInnerHTML:a,identifyChildren:l,withOuterHTML:i}=e;if(M.current)return;A.current.set(n,new Set),_.current.set(n,{selector:t,withInnerHTML:a,withOuterHTML:i,identifyChildren:l,callback:ak});let s=document.querySelectorAll(t);if(s.length>0){var r;let e=Array.from(s).map(e=>(P(e),e)),t=e.map(e=>z(e,{withInnerHTML:a,identifyChildren:l,withOuterHTML:i})),o=A.current.get(n);t.forEach(e=>o.add(e.id)),null==(r=_.current.get(n))||r.callback(e),F(na.sn.DOMObserveResult,{observerId:n,elements:t})}},k[25]=z,k[26]=P,k[27]=F,k[28]=g):g=k[28];let W=g;k[29]!==z||k[30]!==P||k[31]!==F?(v=e=>{let{selector:t,observerId:n,withInnerHTML:a,identifyChildren:l,withOuterHTML:i,margin:s}=e;if(M.current)return;if(R.current.has(n)){var r;null==(r=R.current.get(n))||r.disconnect(),R.current.delete(n)}A.current.set(n,new Set),_.current.set(n,{selector:t,withInnerHTML:a,withOuterHTML:i,identifyChildren:l,callback:aC});let o=document.querySelectorAll(t),c=new IntersectionObserver(e=>{let t=e.filter(aS).map(aw);if(t.length>0){var s;let e=t.map(e=>z(e,{withInnerHTML:a,withOuterHTML:i,identifyChildren:l})),r=A.current.get(n)||new Set;e.forEach(e=>r.add(e.id)),A.current.set(n,r),null==(s=_.current.get(n))||s.callback(t),F(na.sn.DOMObserveResult,{observerId:n,elements:e})}},{root:null,rootMargin:s,threshold:.1});R.current.set(n,c),o.length>0&&o.forEach(e=>{P(e),c.observe(e)})},k[29]=z,k[30]=P,k[31]=F,k[32]=v):v=k[32];let B=v;k[33]===Symbol.for("react.memo_cache_sentinel")?(y=e=>{let{observerId:t}=e;_.current.delete(t),A.current.delete(t)},k[33]=y):y=k[33];let q=y;k[34]!==z||k[35]!==e||k[36]!==F?(b=t=>{let{tagName:n,requestId:a}=t;if(M.current)return;let l=document.createElement(n),i=ay(e);l.id=i,E.current.set(l,i),L.current.add(i);let s=document.getElementById("plugin-dom-container");s||((s=document.createElement("div")).id="plugin-dom-container",s.style.display="none",document.body.appendChild(s)),s.appendChild(l),F(na.sn.DOMCreateResult,{requestId:a,element:z(l)})},k[34]=z,k[35]=e,k[36]=F,k[37]=b):b=k[37];let V=b;k[38]!==z||k[39]!==F?(j=e=>{if(M.current)return;let{elementId:t,action:n,params:a,requestId:l}=e,i=document.getElementById(t);if(!i)return void F(na.sn.DOMElementUpdated,{elementId:t,action:n,result:void 0,requestId:l});let s=null;switch(n){case"setAttribute":if(i instanceof HTMLElement&&a.name){let e=i.getAttribute(a.name);aN(i,"attribute",a.name,e)}i.setAttribute(a.name,a.value),s=!0;break;case"removeAttribute":if(i instanceof HTMLElement&&a.name){let e=i.getAttribute(a.name);aN(i,"attribute",a.name,e)}i.removeAttribute(a.name);break;case"setInnerHTML":i.innerHTML=a.html;break;case"setOuterHTML":i.outerHTML=a.html;case"appendChild":{let e=document.getElementById(a.childId);e&&i.appendChild(e);break}case"removeChild":{let e=document.getElementById(a.childId);e&&i.contains(e)&&i.removeChild(e);break}case"getText":s=i.textContent;break;case"setText":i instanceof HTMLElement&&aN(i,"text","textContent",i.textContent),i.textContent=a.text;break;case"getAttribute":s=i.getAttribute(a.name);break;case"getAttributes":s={};for(let e=0;e<i.attributes.length;e++){let t=i.attributes[e];s[t.name]=t.value}break;case"hasAttribute":s=i.hasAttribute(a.name);break;case"getProperty":s=i[a.name];break;case"setProperty":i instanceof HTMLElement&&a.name&&aN(i,"property",a.name,i[a.name]),i[a.name]=a.value;break;case"addClass":i.classList.add(...a.classNames);break;case"removeClass":i.classList.remove(...a.classNames);break;case"hasClass":s=i.classList.contains(a.className);break;case"setStyle":i instanceof HTMLElement&&a.property&&aN(i,"style",a.property,i.style.getPropertyValue(a.property)),i.style.setProperty(a.property,a.value);break;case"setCssText":i instanceof HTMLElement&&a.cssText&&aN(i,"style","cssText",i.style.cssText),i.style.cssText=a.cssText;break;case"getStyle":if(a.property)s=i.style.getPropertyValue(a.property);else{s={};for(let e=0;e<i.style.length;e++){let t=i.style[e];s[t]=i.style.getPropertyValue(t)}}break;case"getComputedStyle":s=window.getComputedStyle(i).getPropertyValue(a.property);break;case"append":{let e=document.getElementById(a.childId);e&&i.appendChild(e);break}case"before":{let e=document.getElementById(a.siblingId);e&&i.parentNode&&i.parentNode.insertBefore(e,i);break}case"after":{let e=document.getElementById(a.siblingId);e&&i.parentNode&&i.parentNode.insertBefore(e,i.nextSibling);break}case"remove":i.remove();break;case"getParent":s=i.parentElement?z(i.parentElement,{withInnerHTML:a.withInnerHTML,withOuterHTML:a.withOuterHTML,identifyChildren:a.identifyChildren}):null;break;case"getChildren":s=Array.from(i.children).map(e=>z(e,{withInnerHTML:a.withInnerHTML,withOuterHTML:a.withOuterHTML,identifyChildren:a.identifyChildren}));break;case"query":{let e=Array.from(i.querySelectorAll(a.selector)).map(e=>z(e,{withInnerHTML:a.withInnerHTML,identifyChildren:a.identifyChildren,withOuterHTML:a.withOuterHTML}));F(na.sn.DOMQueryResult,{requestId:a.requestId,elements:e});return}case"queryOne":{let e=i.querySelector(a.selector);i.querySelectorAll(a.selector);let t=e?z(e,{withInnerHTML:a.withInnerHTML,identifyChildren:a.identifyChildren,withOuterHTML:a.withOuterHTML}):null;F(na.sn.DOMQueryOneResult,{requestId:a.requestId,element:t});return}case"addEventListener":{let e=a.listenerId,n=a.event;T.current.set(e,{elementId:t,eventType:n,callback:e=>{let a=function(e){let t={type:e.type,bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed,timeStamp:e.timeStamp};return e instanceof MouseEvent&&(t.clientX=e.clientX,t.clientY=e.clientY,t.screenX=e.screenX,t.screenY=e.screenY,t.altKey=e.altKey,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.metaKey=e.metaKey,t.button=e.button,t.buttons=e.buttons),e instanceof KeyboardEvent&&(t.key=e.key,t.code=e.code,t.location=e.location,t.repeat=e.repeat,t.altKey=e.altKey,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.metaKey=e.metaKey),t}(e);F(na.sn.DOMEventTriggered,{elementId:t,eventType:n,event:a})}}),i.addEventListener(n,T.current.get(e).callback);break}case"removeEventListener":{let e=a.listenerId,t=a.event,n=T.current.get(e);n&&(i.removeEventListener(t,n.callback),T.current.delete(e));break}case"getDataAttribute":i instanceof HTMLElement&&(s=i.dataset[a.key]);break;case"getDataAttributes":s=i instanceof HTMLElement?{...i.dataset}:{};break;case"setDataAttribute":i instanceof HTMLElement&&(a.key&&aN(i,"dataset",a.key,i.dataset[a.key]),i.dataset[a.key]=a.value);break;case"removeDataAttribute":i instanceof HTMLElement&&(a.key&&aN(i,"dataset",a.key,i.dataset[a.key]),delete i.dataset[a.key]);break;case"hasDataAttribute":s=i instanceof HTMLElement&&a.key in i.dataset;break;case"hasStyle":s=""!==i.style.getPropertyValue(a.property);break;case"removeStyle":i instanceof HTMLElement&&a.property&&aN(i,"style",a.property,i.style.getPropertyValue(a.property)),i.style.removeProperty(a.property);break;default:console.warn("Unknown DOM action: ".concat(n))}F(na.sn.DOMElementUpdated,{elementId:t,action:n,result:s,requestId:l})},k[38]=z,k[39]=F,k[40]=j):j=k[40];let Q=j;k[41]!==e?(N=()=>{(0,e5.v)("DOMManager").info("Cleaning up DOMManager for extension",e),M.current=!0,O.current=!1,D.current&&(D.current.disconnect(),D.current=null),R.current.forEach(aj),R.current.clear(),T.current.forEach(ab),L.current.forEach(e=>{let t=document.getElementById(e);t&&(Array.from(T.current.values()).filter(t=>t.elementId===e).forEach(e=>{t.removeEventListener(e.eventType,e.callback)}),t.remove())}),_.current.clear(),T.current.clear(),A.current.clear(),L.current.clear(),E.current.clear();let t=document.getElementById("plugin-dom-container");t&&(!t.hasChildNodes()||0===t.children.length)&&t.remove()},k[41]=e,k[42]=N):N=k[42];let $=N;return k[43]!==$||k[44]!==e||k[45]!==H||k[46]!==U?(w=()=>((0,e5.v)("DOMManager").info("DOMManager hook initialized for extension",e),"complete"===document.readyState?U():window.addEventListener("load",U),H(),()=>{$(),O.current||window.removeEventListener("load",U)}),k[43]=$,k[44]=e,k[45]=H,k[46]=U,k[47]=w):w=k[47],k[48]!==e?(S=[e],k[48]=e,k[49]=S):S=k[49],(0,x.useEffect)(w,S),k[50]!==$||k[51]!==V||k[52]!==Q||k[53]!==W||k[54]!==B||k[55]!==K||k[56]!==G?(C={handleDOMQuery:K,handleDOMQueryOne:G,handleDOMObserve:W,handleDOMObserveInView:B,handleDOMStopObserve:q,handleDOMCreate:V,handleDOMManipulate:Q,cleanup:$},k[50]=$,k[51]=V,k[52]=Q,k[53]=W,k[54]=B,k[55]=K,k[56]=G,k[57]=C):C=k[57],C}(j);return b[0]!==A||b[1]!==j||b[2]!==N?(t={type:u.c.PLUGIN_UNLOADED,onMessage:e=>{e===j&&(A(),N())}},b[0]=A,b[1]=j,b[2]=N,b[3]=t):t=b[3],(0,s.oA)(t),b[4]!==w?(n=e=>{w(e)},b[4]=w,b[5]=n):n=b[5],b[6]!==j||b[7]!==n?(a={extensionId:j,type:na.UH.DOMQuery,onMessage:n},b[6]=j,b[7]=n,b[8]=a):a=b[8],(0,s.hn)(a),b[9]!==S?(i=e=>{S(e)},b[9]=S,b[10]=i):i=b[10],b[11]!==j||b[12]!==i?(r={extensionId:j,type:na.UH.DOMQueryOne,onMessage:i},b[11]=j,b[12]=i,b[13]=r):r=b[13],(0,s.hn)(r),b[14]!==C?(o=e=>{C(e)},b[14]=C,b[15]=o):o=b[15],b[16]!==j||b[17]!==o?(c={extensionId:j,type:na.UH.DOMObserve,onMessage:o},b[16]=j,b[17]=o,b[18]=c):c=b[18],(0,s.hn)(c),b[19]!==k?(d=e=>{k(e)},b[19]=k,b[20]=d):d=b[20],b[21]!==j||b[22]!==d?(m={extensionId:j,type:na.UH.DOMObserveInView,onMessage:d},b[21]=j,b[22]=d,b[23]=m):m=b[23],(0,s.hn)(m),b[24]!==I?(p=e=>{I(e)},b[24]=I,b[25]=p):p=b[25],b[26]!==j||b[27]!==p?(h={extensionId:j,type:na.UH.DOMStopObserve,onMessage:p},b[26]=j,b[27]=p,b[28]=h):h=b[28],(0,s.hn)(h),b[29]!==E?(f=e=>{E(e)},b[29]=E,b[30]=f):f=b[30],b[31]!==j||b[32]!==f?(g={extensionId:j,type:na.UH.DOMCreate,onMessage:f},b[31]=j,b[32]=f,b[33]=g):g=b[33],(0,s.hn)(g),b[34]!==_?(v=e=>{_(e)},b[34]=_,b[35]=v):v=b[35],b[36]!==j||b[37]!==v?(y={extensionId:j,type:na.UH.DOMManipulate,onMessage:v},b[36]=j,b[37]=v,b[38]=y):y=b[38],(0,s.hn)(y),null}function aE(){let e,t,n,i,r,o,c,d,m,p,h=(0,l.c)(21),f=(0,T.useRouter)(),g=(0,T.usePathname)(),v=(0,T.useSearchParams)(),{sendScreenChangedEvent:y}=(0,na.d8)(),{data:b}=(0,eX.nj)();h[0]===Symbol.for("react.memo_cache_sentinel")?(e=[],h[0]=e):e=h[0];let[j,N]=(0,x.useState)(e);return h[1]===Symbol.for("react.memo_cache_sentinel")?(t={type:u.c.PLUGIN_LOADED,onMessage:e=>{(0,x.startTransition)(()=>{N(t=>t.filter(t=>t!==e))})}},h[1]=t):t=h[1],(0,s.oA)(t),h[2]!==g||h[3]!==y?(n=()=>{y({pathname:g,query:window.location.search})},h[2]=g,h[3]=y,h[4]=n):n=h[4],h[5]!==g||h[6]!==v?(i=[g,v],h[5]=g,h[6]=v,h[7]=i):i=h[7],(0,x.useEffect)(n,i),h[8]!==g||h[9]!==y?(r=(e,t)=>{y({pathname:g,query:window.location.search},t)},h[8]=g,h[9]=y,h[10]=r):r=h[10],(0,na.Zp)(r,""),h[11]!==f?(o=e=>{["/entry","/lists","/search","/manga","/settings","/auto-downloader","/debrid","/torrent-list","/schedule","/extensions","/sync","/discover","/scan-summaries"].some(t=>e.path.startsWith(t))&&f.push(e.path)},h[11]=f,h[12]=o):o=h[12],(0,na.KD)(o,""),h[13]!==f?(c=e=>{f.refresh()},h[13]=f,h[14]=c):c=h[14],(0,na.zO)(c,""),h[15]!==b||h[16]!==j?(d=null==b?void 0:b.filter(e=>"plugin"===e.type&&!j.includes(e.id)).map(e=>(0,a.jsx)(aI,{extensionId:e.id,onUnloaded:()=>N(t=>[...t,e.id])},e.id)),h[15]=b,h[16]=j,h[17]=d):d=h[17],h[18]===Symbol.for("react.memo_cache_sentinel")?(m=(0,a.jsx)(ah,{}),h[18]=m):m=h[18],h[19]!==d?(p=(0,a.jsxs)(a.Fragment,{children:[d,m]}),h[19]=d,h[20]=p):p=h[20],p}var a_=n(4130),aA=n(96876),aT=n(91180),aD=n(37723),aM=n(78216),aO=n(26603),aL=n(56859);function aR(e){console.warn(e)}function aP(e){console.log(e)}function aF(e){e&&ee.oR.error(e)}function aU(e){e&&ee.oR.warning(e)}function az(e){e&&ee.oR.success(e)}function aH(e){e&&ee.oR.info(e)}var aK=n(55340),aG=n(25264),aW=n(98833);function aB(){let e,t=(0,l.c)(2),n=(0,eQ.jE)();t[0]!==n?(e={type:u.c.INVALIDATE_QUERIES,onMessage:async e=>{await Promise.all(e.map(async e=>{await n.invalidateQueries({queryKey:[e]})}))}},t[0]=n,t[1]=e):e=t[1],(0,s.oA)(e)}var aq=n(86726),aV=n(21842),aQ=n(42463);let a$=(0,aV.tG)("sea-dismissed-announcements",[]);function aY(){let{data:e,mutate:t}=(0,aq.mu)(),[n,l]=(0,m.fp)(a$),[i,r]=x.useState([]);function o(){t({platform:t5.nH?"denshi":t5.qe?"tauri":"web"})}(0,s.oA)({type:u.c.CHECK_FOR_ANNOUNCEMENTS,onMessage:()=>{o()}}),(0,aQ.A)(()=>{o()}),(0,am.w5)(()=>{e&&((0,e5.v)("Announcement").info("Fetched announcements",e),l(t=>t.filter(t=>e.some(e=>e.id===t))))},[e]);let c=x.useMemo(()=>e?e.filter(e=>!!e.notDismissible||!n.includes(e.id)).sort((e,t)=>t.priority-e.priority):[],[e,n]),d=c.filter(e=>"banner"===e.type),p=c.filter(e=>"dialog"===e.type),f=c.filter(e=>"toast"===e.type),g=e=>{l(t=>[...t,e])},v=e=>{switch(e){case"info":default:return(0,a.jsx)(M.S8s,{className:"size-5 mt-1"});case"warning":case"error":case"critical":return(0,a.jsx)(M.eHT,{className:"size-5 mt-1"})}},y=e=>{switch(e){case"info":default:return"info-basic";case"warning":return"warning-basic";case"error":case"critical":return"alert-basic"}};x.useEffect(()=>{f.forEach(e=>{i.includes(e.id)||(("error"===e.severity||"critical"===e.severity?ee.oR.error:"warning"===e.severity?ee.oR.warning:ee.oR.info)(e.message,{position:"top-right",id:e.id,duration:1/0,action:e.notDismissible?void 0:{label:"OK",onClick:()=>g(e.id)},onDismiss:e.notDismissible?void 0:()=>g(e.id),onAutoClose:e.notDismissible?void 0:()=>g(e.id)}),r(t=>[...t,e.id]))})},[f,i]);let b=e=>{e.notDismissible||g(e.id)},j=e=>{"link"===e.type&&e.url&&window.open(e.url,"_blank")};return(0,a.jsxs)(a.Fragment,{children:[d.map((e,t)=>(0,a.jsx)("div",{className:(0,h.cn)("fixed bottom-0 left-0 right-0 z-[999] bg-[--background] border-b border-[--border] shadow-lg bg-gradient-to-br"),children:(0,a.jsx)(ex.F,{intent:y(e.severity),title:e.title,description:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{children:e.message}),e.actions&&e.actions.length>0&&(0,a.jsx)("div",{className:"flex gap-2",children:e.actions.map((e,t)=>(0,a.jsx)(w.$n,{size:"sm",intent:"white-outline",onClick:()=>j(e),children:e.label},t))})]}),icon:v(e.severity),onClose:e.notDismissible?void 0:()=>g(e.id),className:(0,h.cn)("rounded-none border-0 border-t shadow-[0_0_10px_0_rgba(0,0,0,0.05)] bg-gradient-to-br","critical"===e.severity&&"from-red-950/95 to-red-900/60 dark:text-red-100","error"===e.severity&&"from-red-950/95 to-red-900/60 dark:text-red-100","warning"===e.severity&&"from-amber-950/95 to-amber-900/60 dark:text-amber-100","info"===e.severity&&"from-blue-950/95 to-blue-900/60 dark:text-blue-100")})},e.id+""+String(t))),p.map((e,t)=>(0,a.jsx)(ef.a,{open:!0,onOpenChange:t=>{t||b(e)},hideCloseButton:e.notDismissible,title:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:(0,h.cn)("info"===e.severity&&"text-blue-300","warning"===e.severity&&"text-amber-300","error"===e.severity&&"text-red-300","critical"===e.severity&&"text-red-300"),children:v(e.severity)}),e.title||"Announcement"]}),overlayClass:"bg-gray-950/10",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-[--muted]",children:e.message}),(0,a.jsxs)("div",{className:"flex gap-2 pt-2",children:[e.actions&&e.actions.length>0&&(0,a.jsx)("div",{className:"flex gap-2 flex-wrap",children:e.actions.map((e,t)=>(0,a.jsx)(w.$n,{intent:"gray-outline",onClick:()=>j(e),children:e.label},t))}),(0,a.jsx)("div",{className:"flex-1"}),(0,a.jsx)(w.$n,{intent:"white",onClick:()=>b(e),children:"OK"})]})]})},e.id+""+String(t)))]})}var aX=n(2159),aZ=n(83394),aJ=n(51532),a0=n(98530),a1=n(46383),a2=function(e){return e.LOADED_METADATA="loaded-metadata",e.VIDEO_SEEKED="video-seeked",e.SUBTITLE_FILE_UPLOADED="subtitle-file-uploaded",e.VIDEO_PAUSED="video-paused",e.VIDEO_RESUMED="video-resumed",e.VIDEO_ENDED="video-ended",e.VIDEO_ERROR="video-error",e.VIDEO_CAN_PLAY="video-can-play",e.VIDEO_STARTED="video-started",e.VIDEO_COMPLETED="video-completed",e.VIDEO_TERMINATED="video-terminated",e.VIDEO_TIME_UPDATE="video-time-update",e}(a2||{});let a3=(0,e5.v)("NATIVE PLAYER");function a4(){var e,t,n,l,i,r,o,c,d,p,h,f;(0,eq.v1)();let g=(0,m.md)(aO.O1),{sendMessage:v}=(0,s.Y0)(),y=(0,m.md)(aJ.O_),b=(0,m.md)(a_.Eg),[j,N]=(0,m.fp)(a1.k),[w,S]=(0,m.fp)(a_.p6),C=(0,m.md)(a_.uT),k=(0,m.Xr)(a_.Dw),{watchHistory:I,waitForWatchHistory:E,getEpisodeContinuitySeekTo:_}=(0,aZ.vy)(null==j||null==(t=j.playbackInfo)||null==(e=t.media)?void 0:e.id),{data:A}=(0,a0.nI)(null==j||null==(l=j.playbackInfo)||null==(n=l.media)?void 0:n.idMal,null!=(h=null==j||null==(r=j.playbackInfo)||null==(i=r.episode)?void 0:i.progressNumber)?h:-1),T=(0,eQ.jE)();x.useEffect(()=>{T.invalidateQueries({queryKey:[eB.S.CONTINUITY.GetContinuityWatchHistoryItem.key]})},[j]);let{mutate:D,isPending:M,isSuccess:O}=(0,aX.iL)(null==(c=j.playbackInfo)||null==(o=c.media)?void 0:o.id,null!=(f=null==(p=j.playbackInfo)||null==(d=p.episode)?void 0:d.progressNumber)?f:0,!1),L=()=>{b&&v({type:u.c.NATIVE_PLAYER,payload:{clientId:g,type:a2.VIDEO_TIME_UPDATE,payload:{currentTime:b.currentTime,duration:b.duration,paused:b.paused}}})};function R(){b&&(a3.info("Cleaning up media"),b.pause()),S(!0),N(e=>{e.playbackInfo=null,e.playbackError=null,e.loadingState="Ending stream..."}),setTimeout(()=>{N(e=>{e.active=!1})},700),v({type:u.c.NATIVE_PLAYER,payload:{clientId:g,type:a2.VIDEO_TERMINATED}})}return x.useEffect(()=>{let e=setInterval(L,1e3);return()=>clearInterval(e)},[b]),(0,s.oA)({type:u.c.NATIVE_PLAYER,onMessage:e=>{let{type:t,payload:n}=e;switch(t){case"open-and-await":a3.info("Open and await event received",{payload:n}),N(e=>{e.active=!0,e.loadingState=n,e.playbackInfo=null,e.playbackError=null}),S(!1);break;case"watch":a3.info("Watch event received",{payload:n}),N(e=>{e.playbackInfo=n,e.loadingState=null,e.playbackError=null}),S(!1);break;case"subtitle-event":null==C||C.onSubtitleEvent(n);break;case"add-subtitle-track":a3.info("Add subtitle track event received",n),null==C||C.onTrackAdded(n);break;case"terminate":a3.info("Terminate event received"),R();break;case"error":a3.error("Error event received",n),ee.oR.error("An error occurred while playing the stream. "+n.error),N(e=>{e.playbackError=n.error});break;case"pause":a3.info("Pause event received",n),null==b||b.pause();break;case"resume":a3.info("Play event received",n),null==b||b.play();break;case"seek":if(a3.info("Seek event received",n),b){let e=null==b?void 0:b.currentTime,t=null==b?void 0:b.duration,a=e+n;e&&t&&(b.currentTime=a)}break;case"seek-to":if(a3.info("Seek to event received",n),b){let e=null==b?void 0:b.currentTime,t=null==b?void 0:b.duration;e&&t&&(b.currentTime=n)}}}}),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(a_.ry,{state:j,aniSkipData:A,onTerminateStream:R,onLoadedMetadata:()=>{var e,t,n,a,l,i,s,r;if(b){if(v({type:u.c.NATIVE_PLAYER,payload:{clientId:g,type:a2.LOADED_METADATA,payload:{currentTime:b.currentTime,duration:b.duration,paused:b.paused}}}),null==(e=j.playbackInfo)?void 0:e.isNakamaWatchParty)a3.info("This stream is a watch party, only listen");else if((null==(n=j.playbackInfo)||null==(t=n.episode)?void 0:t.progressNumber)&&(null==I?void 0:I.found)&&(null==(a=I.item)?void 0:a.episodeNumber)===(null==(i=j.playbackInfo)||null==(l=i.episode)?void 0:l.progressNumber)){let e=_(null==(r=j.playbackInfo)||null==(s=r.episode)?void 0:s.progressNumber,null==b?void 0:b.currentTime,null==b?void 0:b.duration);(0,e5.v)("MEDIA PLAYER").info("Watch continuity: Seeking to last watched time",{lastWatchedTime:e}),e>0&&((0,e5.v)("MEDIA PLAYER").info("Watch continuity: Seeking to",e),k({type:"restoreProgress",payload:{time:e}}))}}},onTimeUpdate:()=>{if(!b)return},onEnded:()=>{a3.info("Ended"),v({type:u.c.NATIVE_PLAYER,payload:{clientId:g,type:a2.VIDEO_ENDED,payload:{autoNext:y}}})},onSeeked:e=>{b&&(a3.info("Video seeked to",e),v({type:u.c.NATIVE_PLAYER,payload:{clientId:g,type:a2.VIDEO_SEEKED,payload:{currentTime:e,duration:b.duration}}}))},onCompleted:()=>{var e,t,n,a,l,i,s,r;b&&(v({type:u.c.NATIVE_PLAYER,payload:{clientId:g,type:a2.VIDEO_COMPLETED,payload:{currentTime:b.currentTime,duration:b.duration}}}),(null==(e=j.playbackInfo)?void 0:e.media)&&(null==(t=j.playbackInfo)?void 0:t.episode)&&D({mediaId:null==(a=j.playbackInfo)||null==(n=a.media)?void 0:n.id,totalEpisodes:(null==(i=j.playbackInfo)||null==(l=i.media)?void 0:l.episodes)||0,episodeNumber:null==(r=j.playbackInfo)||null==(s=r.episode)?void 0:s.progressNumber}))},onError:e=>{if(!b)return;let t=e||b.error,n=e||"Unknown error",a="";if(t instanceof MediaError){switch(t.code){case MediaError.MEDIA_ERR_ABORTED:n="Media playback aborted";break;case MediaError.MEDIA_ERR_NETWORK:n="Network error occurred";break;case MediaError.MEDIA_ERR_DECODE:n="Media decode error - codec not supported or corrupted file",a="This is likely a codec compatibility issue.";break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:n="Media format not supported",a="The video codec/container format is not supported.";break;default:n=t.message||"Unknown media error"}a3.error("Media error",{code:null==t?void 0:t.code,message:null==t?void 0:t.message,src:b.src,networkState:b.networkState,readyState:b.readyState})}let l=a?"".concat(n,"\n\n").concat(a):n;a3.error("Media error",l),v({type:u.c.NATIVE_PLAYER,payload:{clientId:g,type:a2.VIDEO_ERROR,payload:{error:l}}})},onPlay:()=>{b&&v({type:u.c.NATIVE_PLAYER,payload:{clientId:g,type:a2.VIDEO_RESUMED,payload:{currentTime:b.currentTime,duration:b.duration}}})},onPause:()=>{b&&v({type:u.c.NATIVE_PLAYER,payload:{clientId:g,type:a2.VIDEO_PAUSED,payload:{currentTime:b.currentTime,duration:b.duration}}})},onFileUploaded:function(e){v({type:u.c.NATIVE_PLAYER,payload:{clientId:g,type:a2.SUBTITLE_FILE_UPLOADED,payload:{filename:e.name,content:e.content}}})}})})}let a5=(0,e5.v)("IndefiniteLoader");function a6(){let e,t,n,i,r,o,c,m=(0,l.c)(10);m[0]===Symbol.for("react.memo_cache_sentinel")?(e=[],m[0]=e):e=m[0];let[p,h]=x.useState(e);return m[1]===Symbol.for("react.memo_cache_sentinel")?(t=()=>{let e=setTimeout(()=>{h([])},18e4);return()=>clearTimeout(e)},m[1]=t):t=m[1],m[2]!==p?(n=[p],m[2]=p,m[3]=n):n=m[3],x.useEffect(t,n),m[4]===Symbol.for("react.memo_cache_sentinel")?(i={type:u.c.SHOW_INDEFINITE_LOADER,onMessage:e=>{e&&(a5.info("Showing indefinite loader",e),h(t=>t.includes(e)?t:[...t,e]))}},m[4]=i):i=m[4],(0,s.oA)(i),m[5]===Symbol.for("react.memo_cache_sentinel")?(r={type:u.c.HIDE_INDEFINITE_LOADER,onMessage:e=>{e&&(a5.info("Hiding indefinite loader",e),h(t=>t.filter(t=>t!==e)))}},m[5]=r):r=m[5],(0,s.oA)(r),m[6]!==p.length?(o=p.length>0&&(0,a.jsx)("div",{className:"w-full bg-gray-950 fixed top-0 left-0 z-[100]",children:(0,a.jsx)(d.z,{size:"xs",isIndeterminate:!0})}),m[6]=p.length,m[7]=o):o=m[7],m[8]!==o?(c=(0,a.jsx)(a.Fragment,{children:o}),m[8]=o,m[9]=c):c=m[9],c}let a8=e=>{let t,n,r,o,c,d,h,f,g,y,b,j,N,w,S,C,k,I,E,_,A,D,M,O,R,F,U,z=(0,l.c)(35),{children:H}=e;(0,aT.m)(),(0,aA.NZ)(),(0,tc.v7)(),function(){let e,t,n,a=(0,l.c)(7),i=(0,T.usePathname)(),r=(0,m.Xr)(nK),o=(0,eQ.jE)(),{data:c}=(0,aD.s3)("/auto-downloader"!==i);a[0]!==o?(e={type:u.c.AUTO_DOWNLOADER_ITEM_ADDED,onMessage:e=>{o.invalidateQueries({queryKey:[eB.S.AUTO_DOWNLOADER.GetAutoDownloaderItems.key]})}},a[0]=o,a[1]=e):e=a[1],(0,s.oA)(e),a[2]!==c||a[3]!==r?(t=()=>{r(null!=c?c:[])},a[2]=c,a[3]=r,a[4]=t):t=a[4],a[5]!==c?(n=[c],a[5]=c,a[6]=n):n=a[6],(0,x.useEffect)(t,n)}(),function(){let e,t,n=(0,l.c)(4),a=(0,eQ.jE)();n[0]!==a?(e={type:u.c.REFRESHED_ANILIST_ANIME_COLLECTION,onMessage:e=>{(async()=>{await a.invalidateQueries({queryKey:[eB.S.ANIME_COLLECTION.GetLibraryCollection.key]}),await a.invalidateQueries({queryKey:[eB.S.ANILIST.GetAnimeCollection.key]}),await a.invalidateQueries({queryKey:[eB.S.ANILIST.GetRawAnimeCollection.key]}),await a.invalidateQueries({queryKey:[eB.S.ANIME_ENTRIES.GetAnimeEntry.key]}),await a.invalidateQueries({queryKey:[eB.S.ANIME_ENTRIES.GetMissingEpisodes.key]}),await a.invalidateQueries({queryKey:[eB.S.ANIME_COLLECTION.GetAnimeCollectionSchedule.key]})})()}},n[0]=a,n[1]=e):e=n[1],(0,s.oA)(e),n[2]!==a?(t={type:u.c.REFRESHED_ANILIST_MANGA_COLLECTION,onMessage:e=>{(async()=>{await a.invalidateQueries({queryKey:[eB.S.MANGA.GetAnilistMangaCollection.key]}),await a.invalidateQueries({queryKey:[eB.S.MANGA.GetMangaEntry.key]})})()}},n[2]=a,n[3]=t):t=n[3],(0,s.oA)(t)}(),function(){let e,t,n,a,i,r,o=(0,l.c)(6);o[0]===Symbol.for("react.memo_cache_sentinel")?(e={type:u.c.INFO_TOAST,onMessage:aH},o[0]=e):e=o[0],(0,s.oA)(e),o[1]===Symbol.for("react.memo_cache_sentinel")?(t={type:u.c.SUCCESS_TOAST,onMessage:az},o[1]=t):t=o[1],(0,s.oA)(t),o[2]===Symbol.for("react.memo_cache_sentinel")?(n={type:u.c.WARNING_TOAST,onMessage:aU},o[2]=n):n=o[2],(0,s.oA)(n),o[3]===Symbol.for("react.memo_cache_sentinel")?(a={type:u.c.ERROR_TOAST,onMessage:aF},o[3]=a):a=o[3],(0,s.oA)(a),o[4]===Symbol.for("react.memo_cache_sentinel")?(i={type:u.c.CONSOLE_LOG,onMessage:aP},o[4]=i):i=o[4],(0,s.oA)(i),o[5]===Symbol.for("react.memo_cache_sentinel")?(r={type:u.c.CONSOLE_WARN,onMessage:aR},o[5]=r):r=o[5],(0,s.oA)(r)}(),function(){let e,t,n,a=(0,l.c)(6),i=(0,eQ.jE)();a[0]!==i?(e={type:u.c.EXTENSIONS_RELOADED,onMessage:()=>{(async()=>{await i.invalidateQueries({queryKey:[eB.S.EXTENSIONS.ListAnimeTorrentProviderExtensions.key]}),await i.invalidateQueries({queryKey:[eB.S.EXTENSIONS.ListMangaProviderExtensions.key]}),await i.invalidateQueries({queryKey:[eB.S.EXTENSIONS.ListOnlinestreamProviderExtensions.key]}),await i.invalidateQueries({queryKey:[eB.S.EXTENSIONS.ListExtensionData.key]}),await i.invalidateQueries({queryKey:[eB.S.EXTENSIONS.GetAllExtensions.key]}),await i.invalidateQueries({queryKey:[eB.S.EXTENSIONS.GetExtensionUserConfig.key]}),await i.invalidateQueries({queryKey:[eB.S.EXTENSIONS.GetExtensionUpdateData.key]}),await i.invalidateQueries({queryKey:[eB.S.EXTENSIONS.ListDevelopmentModeExtensions.key]})})()}},a[0]=i,a[1]=e):e=a[1],(0,s.oA)(e),a[2]!==i?(t={type:u.c.PLUGIN_UNLOADED,onMessage:()=>{(async()=>{await i.invalidateQueries({queryKey:[eB.S.EXTENSIONS.ListDevelopmentModeExtensions.key]})})()}},a[2]=i,a[3]=t):t=a[3],(0,s.oA)(t),a[4]!==i?(n={type:u.c.EXTENSION_UPDATES_FOUND,onMessage:async e=>{await i.invalidateQueries({queryKey:[eB.S.EXTENSIONS.GetExtensionUpdateData.key]}),await i.invalidateQueries({queryKey:[eB.S.EXTENSIONS.GetAllExtensions.key]})}},a[4]=i,a[5]=n):n=a[5],(0,s.oA)(n)}(),function(){let e,t,n=(0,l.c)(4),a=(0,eQ.jE)();n[0]!==a?(e={type:u.c.REFRESHED_MANGA_DOWNLOAD_DATA,onMessage:e=>{(async()=>{await a.invalidateQueries({queryKey:[eB.S.MANGA_DOWNLOAD.GetMangaDownloadsList.key]})})()}},n[0]=a,n[1]=e):e=n[1],(0,s.oA)(e),n[2]!==a?(t={type:u.c.CHAPTER_DOWNLOAD_QUEUE_UPDATED,onMessage:e=>{(async()=>{await a.invalidateQueries({queryKey:[eB.S.MANGA_DOWNLOAD.GetMangaDownloadData.key]}),await a.invalidateQueries({queryKey:[eB.S.MANGA_DOWNLOAD.GetMangaDownloadQueue.key]}),await a.invalidateQueries({queryKey:[eB.S.MANGA_DOWNLOAD.GetMangaDownloadsList.key]})})()}},n[2]=a,n[3]=t):t=n[3],(0,s.oA)(t)}(),function(){let e,t=(0,l.c)(4),n=(0,m.md)(aO.O1),{externalPlayerLink:a}=(0,aM._V)(),{mutate:i}=(0,tu.a8)();t[0]!==n||t[1]!==a||t[2]!==i?(e={type:u.c.EXTERNAL_PLAYER_OPEN_URL,onMessage:e=>{if(!(null==a?void 0:a.length))return void ee.oR.error("External player link is not set.");ee.oR.info("Opening media file in external player."),(0,e5.v)("EXTERNAL PLAYER LINK").info("Opening external player",e);let t=new aL.R(a);t.setEpisodeNumber(e.episodeNumber),t.setMediaTitle(e.mediaTitle),t.setUrl(e.url),(0,nY.A)(t.getFullUrl()),0!=e.mediaId?((0,e5.v)("EXTERNAL PLAYER LINK").info("Starting manual tracking",{mediaId:e.mediaId,episodeNumber:e.episodeNumber,clientId:n||""}),i({mediaId:e.mediaId,episodeNumber:e.episodeNumber,clientId:n||""})):(0,e5.v)("EXTERNAL PLAYER LINK").info("No manual tracking",{url:e.url,mediaId:e.mediaId,episodeNumber:e.episodeNumber})}},t[0]=n,t[1]=a,t[2]=i,t[3]=e):e=t[3],(0,s.oA)(e)}(),function(){let e,t,n,a,i=(0,l.c)(9),r=(0,eQ.jE)();i[0]!==r?(e={type:u.c.SYNC_LOCAL_FINISHED,onMessage:e=>{r.invalidateQueries({queryKey:[eB.S.LOCAL.LocalGetTrackedMediaItems.key]})}},i[0]=r,i[1]=e):e=i[1],(0,s.oA)(e);let[o,c]=x.useState(null);i[2]!==o?(t={type:u.c.SYNC_LOCAL_QUEUE_STATE,onMessage:e=>{(0,e5.v)("SYNC").info("Queue state",o),c(e)}},i[2]=o,i[3]=t):t=i[3],(0,s.oA)(t);let{setSyncIsActive:d}=e0();i[4]!==o||i[5]!==d?(n=()=>{d(!!o&&(Object.keys(o.animeTasks).length>0||Object.keys(o.mangaTasks).length>0))},i[4]=o,i[5]=d,i[6]=n):n=i[6],i[7]!==o?(a=[o],i[7]=o,i[8]=a):a=i[8],x.useEffect(n,a)}(),aB();let K=(0,eq.v1)(),G=(0,T.useRouter)(),W=(0,T.usePathname)(),[,B]=x.useState(!1),q=x.useRef(W);z[0]!==W?(t=()=>{q.current!==W&&"/"!==W&&B(!0),q.current=W},n=[W],z[0]=W,z[1]=t,z[2]=n):(t=z[1],n=z[2]),x.useEffect(t,n),z[3]!==W||z[4]!==G||z[5]!==(null==K?void 0:K.isOffline)?(r=()=>{!(null==K?void 0:K.isOffline)&&W.startsWith("/offline")&&G.push("/")},z[3]=W,z[4]=G,z[5]=null==K?void 0:K.isOffline,z[6]=r):r=z[6];let V=null==K?void 0:K.isOffline;if(z[7]!==W||z[8]!==V?(o=[V,W],z[7]=W,z[8]=V,z[9]=o):o=z[9],x.useEffect(r,o),null==K?void 0:K.isOffline){let e;return z[10]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(aW.q,{}),z[10]=e):e=z[10],e}return z[11]===Symbol.for("react.memo_cache_sentinel")?(D=(0,a.jsx)(L,{}),M=(0,a.jsx)(p,{}),O=(0,a.jsx)(e$,{}),R=(0,a.jsx)(i.U6,{}),c=(0,a.jsx)(as,{}),d=(0,a.jsx)(tv.z,{}),h=(0,a.jsx)(tR,{}),f=(0,a.jsx)(aG.d5,{}),g=(0,a.jsx)(aK.r,{}),y=(0,a.jsx)(eA.M,{}),b=(0,a.jsx)(tE,{}),j=(0,a.jsx)(tf,{}),N=(0,a.jsx)(P.m7,{}),w=(0,a.jsx)(v,{}),S=(0,a.jsx)(nO.Rg,{}),C=(0,a.jsx)(aE,{}),k=t5.nH&&(0,a.jsx)(a_.sY,{children:(0,a.jsx)(a4,{})}),I=(0,a.jsx)(n4.hw,{}),E=(0,a.jsx)(a6,{}),_=(0,a.jsx)(aY,{}),A=(0,a.jsx)(eW,{}),z[11]=c,z[12]=d,z[13]=h,z[14]=f,z[15]=g,z[16]=y,z[17]=b,z[18]=j,z[19]=N,z[20]=w,z[21]=S,z[22]=C,z[23]=k,z[24]=I,z[25]=E,z[26]=_,z[27]=A,z[28]=D,z[29]=M,z[30]=O,z[31]=R):(c=z[11],d=z[12],h=z[13],f=z[14],g=z[15],y=z[16],b=z[17],j=z[18],N=z[19],w=z[20],S=z[21],C=z[22],k=z[23],I=z[24],E=z[25],_=z[26],A=z[27],D=z[28],M=z[29],O=z[30],R=z[31]),z[32]===Symbol.for("react.memo_cache_sentinel")?(F=(0,a.jsx)(t4.yR,{children:(0,a.jsx)(n5,{})}),z[32]=F):F=z[32],z[33]!==H?(U=(0,a.jsxs)(a.Fragment,{children:[D,M,O,R,c,d,h,f,g,y,b,j,N,w,S,C,k,I,E,_,A,(0,a.jsx)(t4.Xv,{children:(0,a.jsxs)(t4.e7,{withSidebar:!0,sidebarSize:"slim",children:[F,(0,a.jsx)(t4.e7,{children:(0,a.jsx)(t4.VZ,{children:H})})]})})]}),z[33]=H,z[34]=U):U=z[34],U};var a7=n(20051);function a9(){var e,t,n,i,s,r;let o,c,d,u,m,p,f,g,v,y,b,j,N,w,S,C,k,I,E,_,A,D,M,O,L,R,P,F,U=(0,l.c)(75),z=(0,eq.v1)(),H=(0,t4.kb)(),K=(0,eK.Ky)(),[G,W]=x.useState(!1),B=K.expandSidebarOnHover?!H.isBelowBreakpoint&&!G:!H.isBelowBreakpoint,{mutate:q}=(0,a7.Uf)(),V=(0,T.usePathname)();U[0]!==H.isBelowBreakpoint||U[1]!==K.expandSidebarOnHover?(o=()=>{!H.isBelowBreakpoint&&K.expandSidebarOnHover&&W(!0)},U[0]=H.isBelowBreakpoint,U[1]=K.expandSidebarOnHover,U[2]=o):o=U[2];let Q=o;U[3]!==G||U[4]!==K.expandSidebarOnHover?(c=()=>{G&&K.expandSidebarOnHover&&W(!1)},U[3]=G,U[4]=K.expandSidebarOnHover,U[5]=c):c=U[5];let $=c;U[6]!==q?(d={title:"Disable offline mode",description:"Are you sure you want to disable offline mode?",actionText:"Yes",actionIntent:"primary",onConfirm:()=>{q({enabled:!1})}},U[6]=q,U[7]=d):d=U[7];let Y=(0,em.J)(d),X=!H.isBelowBreakpoint&&G&&"w-[260px]",Z=!H.isBelowBreakpoint&&!K.disableSidebarTransparency&&"bg-transparent",J=!H.isBelowBreakpoint&&!K.disableSidebarTransparency&&K.expandSidebarOnHover&&"hover:bg-[--background]";U[8]!==X||U[9]!==Z||U[10]!==J?(u=(0,h.cn)("h-full flex flex-col justify-between transition-gpu w-full transition-[width]",X,Z,J),U[8]=X,U[9]=Z,U[10]=J,U[11]=u):u=U[11],U[12]!==H.isBelowBreakpoint||U[13]!==K.disableSidebarTransparency||U[14]!==K.expandSidebarOnHover?(m=!H.isBelowBreakpoint&&K.expandSidebarOnHover&&K.disableSidebarTransparency&&(0,a.jsx)("div",{className:(0,h.cn)("fixed h-full translate-x-0 w-[50px] bg-gradient bg-gradient-to-r via-[--background] from-[--background] to-transparent","group-hover/main-sidebar:translate-x-[250px] transition opacity-0 duration-300 group-hover/main-sidebar:opacity-100")}),U[12]=H.isBelowBreakpoint,U[13]=K.disableSidebarTransparency,U[14]=K.expandSidebarOnHover,U[15]=m):m=U[15],U[16]===Symbol.for("react.memo_cache_sentinel")?(p=(0,a.jsx)("div",{className:"mb-4 p-4 pb-0 flex justify-center w-full",children:(0,a.jsx)("img",{src:"/seanime-logo.png",alt:"logo",className:"w-15 h-10 transition-all duration-300"})}),U[16]=p):p=U[16];let ee="/offline"===V;U[17]!==ee?(f={iconType:n2.yPD,name:"Anime Library",href:"/offline",isCurrent:ee},U[17]=ee,U[18]=f):f=U[18],U[19]!==V||U[20]!==(null==z||null==(t=z.settings)||null==(e=t.library)?void 0:e.enableManga)?(g=(null==z||null==(i=z.settings)||null==(n=i.library)?void 0:n.enableManga)&&{iconType:ej.Z5q,name:"Manga",href:"/offline/manga",isCurrent:V.startsWith("/offline/manga")},U[19]=V,U[20]=null==z||null==(r=z.settings)||null==(s=r.library)?void 0:s.enableManga,U[21]=g):g=U[21],U[22]!==g?(v=[g].filter(Boolean),U[22]=g,U[23]=v):v=U[23];let et=v;U[24]!==f||U[25]!==et?(y=[f,...et].filter(Boolean),U[24]=f,U[25]=et,U[26]=y):y=U[26],U[27]!==H?(b=()=>H.setOpen(!1),U[27]=H,U[28]=b):b=U[28],U[29]!==B||U[30]!==y||U[31]!==b?(j=(0,a.jsx)(e4.m,{className:"px-4",collapsed:B,itemClass:"relative",items:y,onLinkItemClick:b}),U[29]=B,U[30]=y,U[31]=b,U[32]=j):j=U[32],U[33]!==B?(N=(0,a.jsx)(nM,{isCollapsed:B,handleExpandSidebar:lt,handleUnexpandedSidebar:le}),U[33]=B,U[34]=N):N=U[34],U[35]===Symbol.for("react.memo_cache_sentinel")?(w=(0,a.jsx)(n_,{place:"sidebar"}),U[35]=w):w=U[35],U[36]!==j||U[37]!==N?(S=(0,a.jsxs)("div",{children:[p,j,N,w]}),U[36]=j,U[37]=N,U[38]=S):S=U[38],U[39]!==H?(C=()=>H.setOpen(!1),U[39]=H,U[40]=C):C=U[40],U[41]!==Y?(k={iconType:n2.njN,name:"Disable offline mode",onClick:()=>{Y.open()}},U[41]=Y,U[42]=k):k=U[42];let en="/settings"===V;return U[43]!==en?(I={iconType:ej.xPd,name:"Settings",href:"/settings",isCurrent:en},U[43]=en,U[44]=I):I=U[44],U[45]!==k||U[46]!==I?(E=[k,I],U[45]=k,U[46]=I,U[47]=E):E=U[47],U[48]!==B||U[49]!==C||U[50]!==E?(_=(0,a.jsx)("div",{children:(0,a.jsx)(e4.m,{collapsed:B,itemClass:"relative",onLinkItemClick:C,items:E})}),U[48]=B,U[49]=C,U[50]=E,U[51]=_):_=U[51],U[52]!==H.isBelowBreakpoint?(A=(0,h.cn)("w-full flex p-2 pt-1 items-center space-x-2",{hidden:H.isBelowBreakpoint}),U[52]=H.isBelowBreakpoint,U[53]=A):A=U[53],U[54]===Symbol.for("react.memo_cache_sentinel")?(D=(0,a.jsx)(nV,{size:"sm",className:"cursor-pointer"}),U[54]=D):D=U[54],U[55]!==G?(M=G&&(0,a.jsx)("p",{className:"truncate",children:"Offline"}),U[55]=G,U[56]=M):M=U[56],U[57]!==A||U[58]!==M?(O=(0,a.jsx)("div",{className:"flex w-full gap-2 flex-col",children:(0,a.jsxs)("div",{className:A,children:[D,M]})}),U[57]=A,U[58]=M,U[59]=O):O=U[59],U[60]!==_||U[61]!==O?(L=(0,a.jsxs)("div",{className:"flex w-full gap-2 flex-col px-4",children:[_,O]}),U[60]=_,U[61]=O,U[62]=L):L=U[62],U[63]!==Q||U[64]!==$||U[65]!==S||U[66]!==L||U[67]!==u||U[68]!==m?(R=(0,a.jsxs)(t4.GK,{className:u,onMouseEnter:Q,onMouseLeave:$,children:[m,S,L]}),U[63]=Q,U[64]=$,U[65]=S,U[66]=L,U[67]=u,U[68]=m,U[69]=R):R=U[69],U[70]!==Y?(P=(0,a.jsx)(em.K,{...Y}),U[70]=Y,U[71]=P):P=U[71],U[72]!==R||U[73]!==P?(F=(0,a.jsxs)(a.Fragment,{children:[R,P]}),U[72]=R,U[73]=P,U[74]=F):F=U[74],F}function le(){}function lt(){}function ln(e){let t,n,i,s,r,o,c,d,u,m,p,h,f=(0,l.c)(18),{children:g}=e,y=(0,eq.v1)(),b=(0,T.usePathname)(),j=(0,T.useRouter)();aB();let[N,w]=x.useState(!1);f[0]!==b||f[1]!==j?(t=()=>{if(b.startsWith("/offline")||b.startsWith("/settings")||b.startsWith("/mediastream")||b.startsWith("/medialinks"))return void w(!0);j.push("/offline")},f[0]=b,f[1]=j,f[2]=t):t=f[2];let S=null==y?void 0:y.isOffline;if(f[3]!==b||f[4]!==S?(n=[b,S],f[3]=b,f[4]=S,f[5]=n):n=f[5],x.useEffect(t,n),!N){let e;return f[6]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(aW.q,{}),f[6]=e):e=f[6],e}return f[7]===Symbol.for("react.memo_cache_sentinel")?(s=(0,a.jsx)(tE,{}),r=(0,a.jsx)(tf,{}),o=(0,a.jsx)(P.m7,{}),c=(0,a.jsx)(v,{}),d=(0,a.jsx)(nO.Rg,{}),u=(0,a.jsx)(aE,{}),m=t5.nH&&(0,a.jsx)(a_.sY,{children:(0,a.jsx)(a4,{})}),i=(0,a.jsx)(a6,{}),f[7]=i,f[8]=s,f[9]=r,f[10]=o,f[11]=c,f[12]=d,f[13]=u,f[14]=m):(i=f[7],s=f[8],r=f[9],o=f[10],c=f[11],d=f[12],u=f[13],m=f[14]),f[15]===Symbol.for("react.memo_cache_sentinel")?(p=(0,a.jsx)(t4.yR,{children:(0,a.jsx)(a9,{})}),f[15]=p):p=f[15],f[16]!==g?(h=(0,a.jsxs)(a.Fragment,{children:[s,r,o,c,d,u,m,i,(0,a.jsx)(t4.Xv,{children:(0,a.jsxs)(t4.e7,{withSidebar:!0,sidebarSize:"slim",children:[p,(0,a.jsx)(t4.e7,{children:(0,a.jsx)(t4.VZ,{children:g})})]})})]}),f[16]=g,f[17]=h):h=f[17],h}var la=n(7013),ll=n(24038),li=n(84218),ls=n(43826),lr=n(35089),lo=n(73594),lc=n(62361);let ld={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05,delayChildren:.1}},exit:{opacity:0,transition:{staggerChildren:.03,staggerDirection:-1}}},lu={hidden:{opacity:0,y:10},visible:{opacity:1,y:0},exit:{opacity:0,y:-10}},lm={enter:e=>({x:e>0?40:-40,opacity:0}),center:{zIndex:1,x:0,opacity:1},exit:e=>({zIndex:0,x:e<0?40:-40,opacity:0})},lx=[{id:"library",title:"Anime Library",description:"Choose your anime collection folder",icon:D.gNt,gradient:"from-blue-500 to-cyan-500"},{id:"player",title:"Media Player",description:"Configure your video player",icon:D.UIR,gradient:"from-green-500 to-emerald-500"},{id:"torrents",title:"Torrent Setup",description:"Set up downloading",icon:D.Ah9,gradient:"from-orange-500 to-red-500"},{id:"debrid",title:"Debrid Service",description:"Optional premium streaming",icon:n1.pzQ,gradient:"from-indigo-500 to-indigo-500"},{id:"features",title:"Features",description:"Enable additional features",icon:ej.rPP,gradient:"from-teal-500 to-blue-500"}];function lp(e){let t,n,i,s,r=(0,l.c)(7),{currentStep:o,onStepClick:c}=e;return r[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsx)("div",{className:"flex items-center justify-center mb-6",children:(0,a.jsx)("div",{className:"relative mx-auto size-16",children:(0,a.jsx)(li.P.img,{src:"/seanime-logo.png",alt:"Seanime Logo",className:"w-full h-full object-contain",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3}})})}),r[0]=t):t=r[0],r[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsx)("div",{className:"text-center mb-8",children:(0,a.jsx)("p",{className:"text-[--muted] text-sm ",children:"These settings can be changed later"})}),r[1]=n):n=r[1],r[2]!==o||r[3]!==c?(i=lx.map((e,t)=>(0,a.jsxs)("div",{onClick:e=>{c(t)},className:(0,h.cn)("flex flex-col items-center relative group transition-all duration-200 focus:outline-none rounded-lg p-2 w-36","cursor-pointer"),children:[(0,a.jsx)(li.P.div,{className:(0,h.cn)("w-12 h-12 rounded-full flex items-center justify-center mb-3 transition-all duration-200",t<=o?"bg-gradient-to-br from-brand-500/20 to-indigo-500/20 border border-brand-500/20":"bg-[--subtle] text-[--muted]",t<=o&&"group-hover:shadow-md"),initial:{scale:.9},animate:{scale:t===o?1.05:1},transition:{duration:.2},children:(0,a.jsx)(e.icon,{className:"w-6 h-6"})}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("h3",{className:(0,h.cn)("text-sm font-medium transition-colors duration-200 tracking-wide",t<=o?"text-white":"text-[--muted]","group-hover:text-[--brand]"),children:e.title})})]},e.id)),r[2]=o,r[3]=c,r[4]=i):i=r[4],r[5]!==i?(s=(0,a.jsxs)("div",{className:"mb-12",children:[t,n,(0,a.jsx)("div",{className:"flex items-start justify-between max-w-4xl mx-auto px-4 rounded-xl relative",children:i})]}),r[5]=i,r[6]=s):s=r[6],s}function lh(e){let t,n,i,s,r=(0,l.c)(8),{children:c,className:d}=e;return r[0]!==d?(t=(0,h.cn)("relative rounded-xl bg-gray-900/50 backdrop-blur-sm border",d),r[0]=d,r[1]=t):t=r[1],r[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsx)(ll.Z,{spread:40,glow:!0,disabled:!1,proximity:100,inactiveZone:.01,className:"opacity-30"}),r[2]=n):n=r[2],r[3]!==c?(i=(0,a.jsx)(o.Zp,{className:"bg-transparent border-none shadow-none p-6",children:c}),r[3]=c,r[4]=i):i=r[4],r[5]!==t||r[6]!==i?(s=(0,a.jsxs)(li.P.div,{variants:lu,className:t,children:[n,i]}),r[5]=t,r[6]=i,r[7]=s):s=r[7],s}function lf(e){let t,n,i=(0,l.c)(2);return i[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsxs)(li.P.div,{variants:lu,className:"text-center space-y-4",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold",children:"Anime Library"}),(0,a.jsx)("p",{className:"text-[--muted] text-sm max-w-lg mx-auto",children:"Choose the folder where your anime files are stored. This is where Seanime will scan for your collection."})]}),i[0]=t):t=i[0],i[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsxs)(li.P.div,{variants:ld,initial:"hidden",animate:"visible",exit:"exit",className:"space-y-8",children:[t,(0,a.jsx)(lh,{className:"max-w-2xl mx-auto",children:(0,a.jsx)(li.P.div,{variants:lu,children:(0,a.jsx)(Q.D0.DirectorySelector,{name:"libraryPath",label:"Anime Library Path",leftIcon:(0,a.jsx)(D.gNt,{className:"text-blue-500"}),shouldExist:!0,help:"Select the main folder containing your anime collection. You can add more folders later.",className:"w-full"})})})]}),i[1]=n):n=i[1],n}function lg(e){let t,n,i,s,r,o,c,d,u,m,x,p,h,f,g=(0,l.c)(27),{status:v}=e;(0,nt.xW)(),g[0]===Symbol.for("react.memo_cache_sentinel")?(t={name:"defaultPlayer"},g[0]=t):t=g[0];let y=(0,nt.FH)(t);g[1]===Symbol.for("react.memo_cache_sentinel")?(n=t5.nH&&(0,a.jsx)("div",{className:"max-w-3xl mx-auto p-4 rounded-xl border !mb-8 font-medium",children:"Seanime Denshi includes a built-in media player that is enabled by default. You can still configure an external media player."}),g[1]=n):n=g[1],g[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,a.jsxs)(li.P.div,{variants:lu,className:"text-center space-y-4",children:[n,(0,a.jsxs)("h2",{className:"text-3xl font-bold",children:[t5.X?"External ":"","Media Player"]}),(0,a.jsx)("p",{className:"text-[--muted] text-sm max-w-lg mx-auto",children:"Configure your preferred external media player for watching anime and tracking progress automatically."})]}),g[2]=i):i=g[2];let b=(null==v?void 0:v.os)!=="darwin"?"MPV is recommended for better subtitle rendering, torrent streaming.":"Both MPV and IINA are recommended for macOS.";return g[3]===Symbol.for("react.memo_cache_sentinel")?(s=(0,a.jsx)(D.UIR,{className:"text-green-500"}),r={label:"MPV (Recommended)",value:"mpv"},o={label:"VLC",value:"vlc"},g[3]=s,g[4]=r,g[5]=o):(s=g[3],r=g[4],o=g[5]),g[6]!==(null==v?void 0:v.os)?(c=[r,o,...(null==v?void 0:v.os)==="windows"?[{label:"MPC-HC",value:"mpc-hc"}]:[],...(null==v?void 0:v.os)==="darwin"?[{label:"IINA",value:"iina"}]:[]],g[6]=null==v?void 0:v.os,g[7]=c):c=g[7],g[8]!==b||g[9]!==c?(d=(0,a.jsx)(Q.D0.Select,{name:"defaultPlayer",label:"Desktop Media Player",help:b,required:!0,leftIcon:s,options:c}),g[8]=b,g[9]=c,g[10]=d):d=g[10],g[11]!==y?(u="mpv"===y&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:"On Windows, install MPV easily using Scoop or Chocolatey. On macOS, install MPV using Homebrew."}),(0,a.jsxs)(li.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4 p-4 rounded-lg bg-gray-800/30",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(n3.M_L,{className:"w-6 h-6 text-indigo-400"}),(0,a.jsx)("h4",{className:"font-semibold",children:"MPV Configuration"})]}),(0,a.jsx)(Q.D0.Text,{name:"mpvSocket",label:"Socket / Pipe Path",help:"Path for MPV IPC communication"})]},"mpv")]}),g[11]=y,g[12]=u):u=g[12],g[13]!==y?(m="iina"===y&&(0,a.jsxs)(li.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4 p-4 rounded-lg bg-gray-800/30",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(n2._yA,{className:"w-6 h-6 text-blue-400"}),(0,a.jsx)("h4",{className:"font-semibold",children:"IINA Configuration"})]}),(0,a.jsx)(Q.D0.Text,{name:"iinaSocket",label:"Socket / Pipe Path",help:"Path for IINA IPC communication"}),(0,a.jsx)(ex.F,{intent:"info-basic",description:(0,a.jsxs)("p",{children:["For IINA to work correctly with Seanime, make sure ",(0,a.jsx)("strong",{children:"Quit after all windows are closed"})," is ",(0,a.jsx)("span",{className:"underline",children:"checked"})," and ",(0,a.jsx)("strong",{children:"Keep window open after playback finishes"})," is ",(0,a.jsx)("span",{className:"underline",children:"unchecked"})," in your IINA general settings."]})})]},"iina"),g[13]=y,g[14]=m):m=g[14],g[15]!==y?(x="vlc"===y&&(0,a.jsxs)(li.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4 p-4 rounded-lg bg-gray-800/30",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(n3.Fgm,{className:"w-6 h-6 text-orange-500"}),(0,a.jsx)("h4",{className:"font-semibold",children:"VLC Configuration"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(Q.D0.Text,{name:"mediaPlayerHost",label:"Host"}),(0,a.jsx)(Q.D0.Number,{name:"vlcPort",label:"Port",formatOptions:{useGrouping:!1}})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(Q.D0.Text,{name:"vlcUsername",label:"Username"}),(0,a.jsx)(Q.D0.Text,{name:"vlcPassword",label:"Password"})]}),(0,a.jsx)(Q.D0.Text,{name:"vlcPath",label:"VLC Executable Path"})]},"vlc"),g[15]=y,g[16]=x):x=g[16],g[17]!==y?(p="mpc-hc"===y&&(0,a.jsxs)(li.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4 p-4 rounded-lg bg-gray-800/30",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(lo.Fum,{className:"w-6 h-6 text-blue-500"}),(0,a.jsx)("h4",{className:"font-semibold",children:"MPC-HC Configuration"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(Q.D0.Text,{name:"mediaPlayerHost",label:"Host"}),(0,a.jsx)(Q.D0.Number,{name:"mpcPort",label:"Port",formatOptions:{useGrouping:!1}})]}),(0,a.jsx)(Q.D0.Text,{name:"mpcPath",label:"MPC-HC Executable Path"})]},"mpc-hc"),g[17]=y,g[18]=p):p=g[18],g[19]!==u||g[20]!==m||g[21]!==x||g[22]!==p?(h=(0,a.jsxs)(ls.N,{mode:"wait",children:[u,m,x,p]}),g[19]=u,g[20]=m,g[21]=x,g[22]=p,g[23]=h):h=g[23],g[24]!==h||g[25]!==d?(f=(0,a.jsxs)(li.P.div,{variants:ld,initial:"hidden",animate:"visible",exit:"exit",className:"space-y-8",children:[i,(0,a.jsx)(lh,{className:"max-w-2xl mx-auto",children:(0,a.jsxs)(li.P.div,{variants:lu,className:"space-y-6",children:[d,h]})})]}),g[24]=h,g[25]=d,g[26]=f):f=g[26],f}function lv(e){let t,n,i,s,r,o,c,d=(0,l.c)(9);(0,nt.xW)(),d[0]===Symbol.for("react.memo_cache_sentinel")?(t={name:"defaultTorrentClient"},d[0]=t):t=d[0];let u=(0,nt.FH)(t);return d[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsxs)(li.P.div,{variants:lu,className:"text-center space-y-4",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold",children:"Torrent Setup"}),(0,a.jsx)("p",{className:"text-[--muted] text-sm max-w-lg mx-auto",children:"Configure your default client."})]}),d[1]=n):n=d[1],d[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,a.jsx)(lc.RlU,{className:"w-6 h-6 text-blue-500"}),(0,a.jsx)("h3",{className:"text-xl font-semibold",children:"Torrent Client"})]}),s=(0,a.jsx)("p",{className:"text-sm text-[--muted]",children:"Client used to download anime torrents"}),d[2]=i,d[3]=s):(i=d[2],s=d[3]),d[4]===Symbol.for("react.memo_cache_sentinel")?(r=(0,a.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 max-w-6xl mx-auto",children:(0,a.jsx)(lh,{children:(0,a.jsxs)(li.P.div,{variants:lu,className:"space-y-4",children:[i,s,(0,a.jsx)(Q.D0.Select,{name:"defaultTorrentClient",label:"Client",options:[{label:"qBittorrent",value:"qbittorrent"},{label:"Transmission",value:"transmission"},{label:"None",value:"none"}]})]})})}),d[4]=r):r=d[4],d[5]!==u?(o=("qbittorrent"===u||"transmission"===u)&&(0,a.jsx)(lh,{className:"max-w-4xl mx-auto",children:(0,a.jsxs)(li.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"space-y-6",children:["qbittorrent"===u&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(n3.fy_,{className:"w-8 h-8 text-blue-600"}),(0,a.jsx)("h4",{className:"text-xl font-semibold",children:"qBittorrent Settings"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(Q.D0.Text,{name:"qbittorrentHost",label:"Host"}),(0,a.jsx)(Q.D0.Text,{name:"qbittorrentUsername",label:"Username"}),(0,a.jsx)(Q.D0.Text,{name:"qbittorrentPassword",label:"Password"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 lg:grid-cols-[200px_1fr]",children:[(0,a.jsx)(Q.D0.Number,{name:"qbittorrentPort",label:"Port",formatOptions:{useGrouping:!1}}),(0,a.jsx)(Q.D0.Text,{name:"qbittorrentPath",label:"Executable Path"})]})]}),"transmission"===u&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(n3.nfy,{className:"w-8 h-8 text-red-600"}),(0,a.jsx)("h4",{className:"text-xl font-semibold",children:"Transmission Settings"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(Q.D0.Text,{name:"transmissionHost",label:"Host"}),(0,a.jsx)(Q.D0.Text,{name:"transmissionUsername",label:"Username"}),(0,a.jsx)(Q.D0.Text,{name:"transmissionPassword",label:"Password"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 lg:grid-cols-[200px_1fr]",children:[(0,a.jsx)(Q.D0.Number,{name:"transmissionPort",label:"Port",formatOptions:{useGrouping:!1}}),(0,a.jsx)(Q.D0.Text,{name:"transmissionPath",label:"Executable Path"})]})]})]},u)}),d[5]=u,d[6]=o):o=d[6],d[7]!==o?(c=(0,a.jsxs)(li.P.div,{variants:ld,initial:"hidden",animate:"visible",exit:"exit",className:"space-y-8",children:[n,r,(0,a.jsx)(ls.N,{mode:"wait",children:o})]}),d[7]=o,d[8]=c):c=d[8],c}function ly(e){let t,n,i,s,r,o=(0,l.c)(7);o[0]===Symbol.for("react.memo_cache_sentinel")?(t={name:"debridProvider"},o[0]=t):t=o[0];let c=(0,nt.FH)(t);return o[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsxs)(li.P.div,{variants:lu,className:"text-center space-y-4",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold",children:"Debrid Service"}),(0,a.jsx)("p",{className:"text-[--muted] text-sm max-w-lg mx-auto",children:"Debrid services offer faster downloads and instant streaming from the cloud."})]}),o[1]=n):n=o[1],o[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,a.jsx)(Q.D0.Select,{name:"debridProvider",label:"Debrid Service",leftIcon:(0,a.jsx)(n1.pzQ,{className:"text-[--purple]"}),options:[{label:"None",value:"none"},{label:"TorBox",value:"torbox"},{label:"Real-Debrid",value:"realdebrid"}]}),o[2]=i):i=o[2],o[3]!==c?(s="none"!==c&&""!==c&&(0,a.jsx)(li.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4 p-4 rounded-lg bg-gray-800/30",children:(0,a.jsx)(Q.D0.Text,{name:"debridApiKey",label:"API Key",help:"The API key provided by the debrid service."})}),o[3]=c,o[4]=s):s=o[4],o[5]!==s?(r=(0,a.jsxs)(li.P.div,{variants:ld,initial:"hidden",animate:"visible",exit:"exit",className:"space-y-8",children:[n,(0,a.jsx)(lh,{className:"max-w-2xl mx-auto",children:(0,a.jsxs)(li.P.div,{variants:lu,className:"space-y-6",children:[i,(0,a.jsx)(ls.N,{children:s})]})})]}),o[5]=s,o[6]=r):r=o[6],r}function lb(e){let t,n,i,s=(0,l.c)(3);s[0]===Symbol.for("react.memo_cache_sentinel")?(t=[{name:"enableManga",icon:B.vd0,title:"Manga",description:"Read and download manga chapters",gradient:"from-orange-500 to-yellow-700"},{name:"enableTorrentStreaming",icon:D.Ah9,title:"Torrent Streaming",description:"Stream torrents without waiting for download",gradient:"from-cyan-500 to-teal-500"},{name:"enableAdultContent",icon:n1.zeF,title:"NSFW Content",description:"Show adult content in library and search",gradient:"from-red-500 to-pink-500"},{name:"enableOnlinestream",icon:n1.ir4,title:"Online Streaming",description:"Watch anime from online sources",gradient:"from-indigo-500 to-violet-500"},{name:"enableRichPresence",icon:B.O4U,title:"Discord Rich Presence",description:"Show what you're watching on Discord",gradient:"from-indigo-500 to-blue-500"},{name:"enableTranscode",icon:eN.hv2,title:"Transcoding / Direct Play",description:"Stream downloaded files on other devices",gradient:"from-cyan-500 to-indigo-500"}],s[0]=t):t=s[0];let r=t;return s[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsxs)(li.P.div,{variants:lu,className:"text-center space-y-4",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold",children:"Additional Features"}),(0,a.jsx)("p",{className:"text-[--muted] text-sm max-w-lg mx-auto",children:"Choose which additional features you'd like to enable. You can enable or disable these later in settings."})]}),s[1]=n):n=s[1],s[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,a.jsxs)(li.P.div,{variants:ld,initial:"hidden",animate:"visible",exit:"exit",className:"space-y-8",children:[n,(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 max-w-6xl mx-auto",children:r.map(lj)})]}),s[2]=i):i=s[2],i}function lj(e,t){return(0,a.jsx)(li.P.div,{variants:lu,custom:t,children:(0,a.jsx)(Q.D0.Checkbox,{name:e.name,label:(0,a.jsxs)("div",{className:"flex items-start space-x-4 p-4",children:[(0,a.jsx)("div",{className:(0,h.cn)("w-12 h-12 rounded-lg flex items-center justify-center","bg-gradient-to-br ".concat(e.gradient)),children:(0,a.jsx)(e.icon,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"font-semibold text-sm",children:e.title}),(0,a.jsx)("p",{className:"text-xs text-gray-400 mt-1 leading-relaxed",children:e.description})]})]}),size:"lg",labelClass:(0,h.cn)("block cursor-pointer transition-all duration-200 overflow-hidden w-full rounded-xl","bg-gray-900/50 hover:bg-gray-800/80","border border-gray-700/50","data-[checked=true]:bg-gradient-to-br data-[checked=true]:from-gray-900 data-[checked=true]:to-gray-900","data-[checked=true]:border-gray-400"),containerClass:"flex items-center justify-between h-full",className:"absolute top-2 right-2 z-10",fieldClass:"relative"})},e.name)}function lN(e){let{status:t}=e,n=(0,T.useRouter)(),{getDefaultVlcPath:l,getDefaultQBittorrentPath:i,getDefaultTransmissionPath:s}=(0,nZ.iK)(),r=(0,eq.LX)(),{mutate:o,data:c,isPending:d,isSuccess:u}=(0,la.JW)(),[m,p]=x.useState(0),[h,f]=x.useState(0);x.useEffect(()=>{!d&&(null==c?void 0:c.settings)&&(r(c),n.push("/"))},[c,d]);let g=x.useMemo(()=>l(t.os),[t.os]),v=x.useMemo(()=>i(t.os),[t.os]),y=x.useMemo(()=>s(t.os),[t.os]),b=x.useMemo(()=>(0,nZ.Cc)(t.os),[t.os]),j=x.useMemo(()=>(0,nZ.aD)(t.os),[t.os]),N=()=>{m<lx.length-1&&(f(1),p(m+1))},S=()=>{m>0&&(f(-1),p(m-1))},C=e=>{e>=0&&e<lx.length&&(f(e>m?1:-1),p(e))};return d?(0,a.jsx)(aW.q,{}):c?void 0:(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-[--background] via-[--background] to-indigo-900/10 relative",children:[(0,a.jsxs)("div",{className:"fixed h-100vh w-100vw inset-0",children:[(0,a.jsx)("div",{className:"fixed h-100vh w-100vw bg-gray-950/20 z-[1] backdrop-blur-md inset-0"}),(0,a.jsx)(lr.default,{src:"https://wallpaper.forfun.com/fetch/bd/bd5226068e173245023c12b8c24a301e.jpeg?w=1470&r=0.5625",alt:"bg",fill:!0,sizes:"100vw",className:"opacity-[0.05]"})]}),(0,a.jsx)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none"}),(0,a.jsxs)("div",{className:"container max-w-6xl mx-auto px-4 py-8 relative z-10",children:[(0,a.jsx)(Q.lV,{schema:nZ.nG,onSubmit:e=>{m===lx.length-1?o((0,nZ.lA)(e)):N()},defaultValues:{mediaPlayerHost:"127.0.0.1",vlcPort:8080,mpcPort:13579,defaultPlayer:"mpv",vlcPath:g,qbittorrentPath:v,qbittorrentHost:"127.0.0.1",qbittorrentPort:8081,transmissionPath:y,transmissionHost:"127.0.0.1",transmissionPort:9091,mpcPath:"C:/Program Files/MPC-HC/mpc-hc64.exe",torrentProvider:nZ.r5,mpvSocket:b,iinaSocket:j,enableRichPresence:!1,autoScan:!1,enableManga:!0,enableOnlinestream:!1,enableAdultContent:!0,enableTorrentStreaming:!0,enableTranscode:!1,debridProvider:"none",debridApiKey:"",nakamaUsername:"",enableWatchContinuity:!0},children:e=>(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)(lp,{currentStep:m,totalSteps:lx.length,onStepClick:C}),(0,a.jsx)(ls.N,{mode:"wait",custom:h,children:(0,a.jsxs)(li.P.div,{custom:h,variants:lm,initial:"enter",animate:"center",exit:"exit",transition:{x:{duration:.3,ease:"easeInOut"},opacity:{duration:.2}},className:"",children:[0===m&&(0,a.jsx)(lf,{form:e}),1===m&&(0,a.jsx)(lg,{form:e,status:t}),2===m&&(0,a.jsx)(lv,{form:e}),3===m&&(0,a.jsx)(ly,{form:e}),4===m&&(0,a.jsx)(lb,{form:e})]},m)}),(0,a.jsxs)(li.P.div,{className:"flex justify-between items-center max-w-2xl mx-auto pt-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:[(0,a.jsx)(w.$n,{type:"button",intent:"gray-outline",onClick:e=>{e.preventDefault(),S()},disabled:0===m,className:"flex items-center space-x-2",leftIcon:(0,a.jsx)(D.MQY,{className:"text-xl"}),children:"Previous"}),m===lx.length-1?(0,a.jsx)(w.$n,{type:"submit",className:"flex items-center bg-gradient-to-r from-brand-600 to-indigo-600 hover:ring-2 ring-brand-600",loading:d,rightIcon:(0,a.jsx)(D.wDW,{className:"size-6"}),children:(0,a.jsx)("span",{children:"Launch Seanime"})}):(0,a.jsx)(w.$n,{type:"button",intent:"gray-glass",onClick:e=>{e.preventDefault(),N()},className:"flex items-center space-x-2",rightIcon:(0,a.jsx)(D.XWt,{className:"text-xl"}),children:"Next"})]})]})}),(0,a.jsx)(li.P.p,{className:"text-center text-[--muted] mt-12",initial:{opacity:0},animate:{opacity:1},transition:{delay:1},children:"By 5rahim"})]})]})}function lw(e){var t;let n,i,r,c,d,p,h,f=(0,l.c)(43),{host:g,children:v}=e,y=(0,T.usePathname)(),b=(0,T.useRouter)(),j=(0,eq.v1)(),N=(0,eq.LX)(),S=(0,m.md)(eZ.uQ),{data:C,isLoading:k,refetch:I}=(0,aq.wy)();f[0]!==C||f[1]!==N?(n=()=>{C&&N(C)},f[0]=C,f[1]=N,f[2]=n):n=f[2],f[3]!==C?(i=[C],f[3]=C,f[4]=i):i=f[4],x.useEffect(n,i),f[5]!==I?(r={type:u.c.ANILIST_DATA_LOADED,onMessage:()=>{(0,e5.v)("Data Wrapper").info("Anilist data loaded, refetching server status"),I()}},f[5]=I,f[6]=r):r=f[6],(0,s.oA)(r);let[E,_]=x.useState(!1);f[7]!==S||f[8]!==y||f[9]!==j?(c=()=>{j&&((null==j?void 0:j.serverHasPassword)&&!S&&"/public/auth"!==y?(window.location.href="/public/auth",_(!1),console.warn("Redirecting to auth")):_(!0))},f[7]=S,f[8]=y,f[9]=j,f[10]=c):c=f[10];let A=null==j?void 0:j.serverHasPassword;f[11]!==S||f[12]!==y||f[13]!==A?(d=[A,S,y],f[11]=S,f[12]=y,f[13]=A,f[14]=d):d=f[14],x.useEffect(c,d);let D=x.useRef(null);f[15]!==I||f[16]!==(null==j?void 0:j.serverReady)?(p=()=>((null==j?void 0:j.serverReady)||(D.current=setInterval(()=>{(0,e5.v)("Data Wrapper").info("Refetching server status"),I()},2e3)),()=>{(0,e5.v)("Data Wrapper").info("Clearing interval"),D.current&&(clearInterval(D.current),D.current=null)}),f[15]=I,f[16]=null==j?void 0:j.serverReady,f[17]=p):p=f[17];let M=null==j?void 0:j.serverReady;if(f[18]!==M?(h=[M],f[18]=M,f[19]=h):h=f[19],x.useEffect(p,h),k||!j||!E){let e;return f[20]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(aW.q,{}),f[20]=e):e=f[20],e}if(!(null==j?void 0:j.serverReady)){let e;return f[21]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(aW.q,{title:"L o a d i n g"}),f[21]=e):e=f[21],e}if(y.startsWith("/auth/callback"))return v;if(!(null==j?void 0:j.settings)){let e;return f[22]!==j?(e=(0,a.jsx)(lN,{status:j}),f[22]=j,f[23]=e):e=f[23],e}if(null==j?void 0:j.updating){let e;return f[24]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsxs)("div",{className:"container max-w-3xl py-10",children:[(0,a.jsx)("div",{className:"mb-4 flex justify-center w-full",children:(0,a.jsx)("img",{src:"/seanime-logo.png",alt:"logo",className:"w-14 h-auto"})}),(0,a.jsx)("p",{className:"text-center text-lg",children:"Seanime is currently updating. Refresh the page once the update is complete and the connection has been reestablished."})]}),f[24]=e):e=f[24],e}if(!(null==j||null==(t=j.mediastreamSettings)?void 0:t.transcodeEnabled)&&y.startsWith("/mediastream")){let e;return f[25]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(tD.D,{title:"Transcoding not enabled"}),f[25]=e):e=f[25],e}if((null==j?void 0:j.user)||"127.0.0.1:43211"!==g||t5.X){if(!(null==j?void 0:j.user)){let e,t,n,l,i,s,r,c;return f[33]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsx)("div",{className:"mb-4 flex justify-center w-full",children:(0,a.jsx)("img",{src:"/logo.png",alt:"logo",className:"w-24 h-auto"})}),e=(0,a.jsx)("h3",{children:"Welcome!"}),f[33]=e,f[34]=t):(e=f[33],t=f[34]),f[35]===Symbol.for("react.memo_cache_sentinel")?(n=(0,a.jsx)(n0(),{href:nX.tL,target:"_blank",children:(0,a.jsx)(w.$n,{leftIcon:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",width:"24",height:"24",viewBox:"0 0 24 24",role:"img",children:(0,a.jsx)("path",{d:"M6.361 2.943 0 21.056h4.942l1.077-3.133H11.4l1.052 3.133H22.9c.71 0 1.1-.392 1.1-1.101V17.53c0-.71-.39-1.101-1.1-1.101h-6.483V4.045c0-.71-.392-1.102-1.101-1.102h-2.422c-.71 0-1.101.392-1.101 1.102v1.064l-.758-2.166zm2.324 5.948 1.688 5.018H7.144z"})}),intent:"white",size:"md",children:"Get AniList token"})}),f[35]=n):n=f[35],f[36]===Symbol.for("react.memo_cache_sentinel")?(l=(0,Q.Jo)(lS),f[36]=l):l=f[36],f[37]!==b?(i=e=>{b.push("/auth/callback#access_token="+e.token.trim())},f[37]=b,f[38]=i):i=f[38],f[39]===Symbol.for("react.memo_cache_sentinel")?(s=(0,a.jsx)(Q.D0.Textarea,{name:"token",label:"Enter the token",fieldClass:"px-4"}),r=(0,a.jsx)(Q.D0.Submit,{showLoadingOverlayOnSuccess:!0,children:"Continue"}),f[39]=s,f[40]=r):(s=f[39],r=f[40]),f[41]!==i?(c=(0,a.jsx)("div",{className:"container max-w-3xl py-10",children:(0,a.jsx)(o.Zp,{className:"md:py-10",children:(0,a.jsx)(t4.KZ,{children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[t,e,n,(0,a.jsxs)(Q.lV,{schema:l,onSubmit:i,children:[s,r]})]})})})}),f[41]=i,f[42]=c):c=f[42],c}}else{let e,t,n,l,i;return f[26]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsx)("div",{className:"mb-4 flex justify-center w-full",children:(0,a.jsx)("img",{src:"/logo.png",alt:"logo",className:"w-24 h-auto"})}),e=(0,a.jsx)("h3",{children:"Welcome!"}),f[26]=e,f[27]=t):(e=f[26],t=f[27]),f[28]!==(null==j?void 0:j.anilistClientId)?(n=()=>{let e=(null==j?void 0:j.anilistClientId)?"https://anilist.co/api/v2/oauth/authorize?client_id=".concat(null==j?void 0:j.anilistClientId,"&response_type=token"):nX.$M;window.open(e,"_self")},f[28]=null==j?void 0:j.anilistClientId,f[29]=n):n=f[29],f[30]===Symbol.for("react.memo_cache_sentinel")?(l=(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",width:"24",height:"24",viewBox:"0 0 24 24",role:"img",children:(0,a.jsx)("path",{d:"M6.361 2.943 0 21.056h4.942l1.077-3.133H11.4l1.052 3.133H22.9c.71 0 1.1-.392 1.1-1.101V17.53c0-.71-.39-1.101-1.1-1.101h-6.483V4.045c0-.71-.392-1.102-1.101-1.102h-2.422c-.71 0-1.101.392-1.101 1.102v1.064l-.758-2.166zm2.324 5.948 1.688 5.018H7.144z"})}),f[30]=l):l=f[30],f[31]!==n?(i=(0,a.jsx)("div",{className:"container max-w-3xl py-10",children:(0,a.jsx)(o.Zp,{className:"md:py-10",children:(0,a.jsx)(t4.KZ,{children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[t,e,(0,a.jsx)(w.$n,{onClick:n,leftIcon:l,intent:"primary",size:"xl",children:"Log in with AniList"})]})})})}),f[31]=n,f[32]=i):i=f[32],i}return v}function lS(e){let{z:t}=e;return t.object({token:t.string().min(1,"Token is required")})}function lC(e){let t,n,i,s,r,o=(0,l.c)(14),{children:c}=e,d=(0,eq.v1)(),[u,m]=x.useState("");if(o[0]===Symbol.for("react.memo_cache_sentinel")?(t=()=>{var e,t;m((null==(t=window)||null==(e=t.location)?void 0:e.host)||"")},n=[],o[0]=t,o[1]=n):(t=o[0],n=o[1]),x.useEffect(t,n),null==d?void 0:d.isOffline){let e,t,n;return o[2]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(nD,{}),o[2]=e):e=o[2],o[3]!==c?(t=(0,a.jsx)(ln,{children:(0,a.jsxs)("div",{"data-offline-layout-container":!0,className:"h-auto",children:[e,(0,a.jsx)("div",{"data-offline-layout-content":!0,children:c})]})}),o[3]=c,o[4]=t):t=o[4],o[5]!==u||o[6]!==t?(n=(0,a.jsx)(lw,{host:u,children:t}),o[5]=u,o[6]=t,o[7]=n):n=o[7],n}return o[8]===Symbol.for("react.memo_cache_sentinel")?(i=(0,a.jsx)(nD,{}),o[8]=i):i=o[8],o[9]!==c?(s=(0,a.jsx)(a8,{children:(0,a.jsxs)("div",{"data-main-layout-container":!0,className:"h-auto",children:[i,(0,a.jsx)("div",{"data-main-layout-content":!0,children:c})]})}),o[9]=c,o[10]=s):s=o[10],o[11]!==u||o[12]!==s?(r=(0,a.jsx)(lw,{host:u,children:s}),o[11]=u,o[12]=s,o[13]=r):r=o[13],r}let lk="force-static"},62322:(e,t,n)=>{"use strict";n.d(t,{W:()=>u,v:()=>d});var a=n(19749),l=n(7675),i=n(74889),s=n(96826),r=n(46278),o=n(6066),c=n(69554);function d(){let e,t,n,d,u=(0,a.c)(10),m=(0,r.jE)(),x=(0,o.useRouter)(),p=(0,s.LX)();return u[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.AUTH.Login.key],u[0]=e):e=u[0],u[1]!==m||u[2]!==x||u[3]!==p?(t=async e=>{e&&(c.oR.success("Successfully authenticated"),await m.invalidateQueries({queryKey:[i.S.ANIME_COLLECTION.GetLibraryCollection.key]}),await m.invalidateQueries({queryKey:[i.S.ANILIST.GetRawAnimeCollection.key]}),await m.invalidateQueries({queryKey:[i.S.ANILIST.GetAnimeCollection.key]}),await m.invalidateQueries({queryKey:[i.S.MANGA.GetMangaCollection.key]}),p(e),x.push("/"),m.invalidateQueries({queryKey:[i.S.ANIME_ENTRIES.GetMissingEpisodes.key]}),m.invalidateQueries({queryKey:[i.S.ANIME_ENTRIES.GetAnimeEntry.key]}),m.invalidateQueries({queryKey:[i.S.MANGA.GetMangaEntry.key]}))},u[1]=m,u[2]=x,u[3]=p,u[4]=t):t=u[4],u[5]!==x?(n=async e=>{c.oR.error(e.message),x.push("/")},u[5]=x,u[6]=n):n=u[6],u[7]!==t||u[8]!==n?(d={endpoint:i.S.AUTH.Login.endpoint,method:i.S.AUTH.Login.methods[0],mutationKey:e,onSuccess:t,onError:n},u[7]=t,u[8]=n,u[9]=d):d=u[9],(0,l.qk)(d)}function u(){let e,t,n=(0,a.c)(4),d=(0,r.jE)(),u=(0,o.useRouter)();return(0,s.LX)(),n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.AUTH.Logout.key],n[0]=e):e=n[0],n[1]!==d||n[2]!==u?(t={endpoint:i.S.AUTH.Logout.endpoint,method:i.S.AUTH.Logout.methods[0],mutationKey:e,onSuccess:async()=>{c.oR.success("Successfully logged out"),await d.invalidateQueries({queryKey:[i.S.ANIME_COLLECTION.GetLibraryCollection.key]}),await d.invalidateQueries({queryKey:[i.S.ANILIST.GetRawAnimeCollection.key]}),await d.invalidateQueries({queryKey:[i.S.ANILIST.GetAnimeCollection.key]}),await d.invalidateQueries({queryKey:[i.S.MANGA.GetMangaCollection.key]}),u.push("/"),d.invalidateQueries({queryKey:[i.S.ANIME_ENTRIES.GetMissingEpisodes.key]}),d.invalidateQueries({queryKey:[i.S.ANIME_ENTRIES.GetAnimeEntry.key]}),d.invalidateQueries({queryKey:[i.S.MANGA.GetMangaEntry.key]})}},n[1]=d,n[2]=u,n[3]=t):t=n[3],(0,l.qk)(t)}},63188:(e,t,n)=>{Promise.resolve().then(n.bind(n,40275))},98833:(e,t,n)=>{"use strict";n.d(t,{q:()=>u});var a=n(95155),l=n(19749),i=n(58036),s=n(42692),r=n(84127),o=n(2091),c=n(94077),d=n(35089);function u(e){let t,n,u,x,p,h=(0,l.c)(9),{refetch:f,title:g}=e;h[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsx)(d.default,{src:"/seanime-logo.png",alt:"Loading...",priority:!0,width:100,height:100,className:"animate-pulse z-[1]"}),n=(0,a.jsx)(i.N,{}),h[0]=t,h[1]=n):(t=h[0],n=h[1]);let v=null!=g?g:"S e a n i m e";return h[2]!==v?(u=(0,a.jsx)(s.W,{className:"text-lg mt-2 text-[--muted] animate-pulse z-[1]",words:v}),h[2]=v,h[3]=u):u=h[3],h[4]!==f?(x=c.X&&!!f&&(0,a.jsx)(r.$n,{onClick:m,className:"mt-4 z-[1]",intent:"gray-outline",size:"sm",children:"Reload"}),h[4]=f,h[5]=x):x=h[5],h[6]!==u||h[7]!==x?(p=(0,a.jsxs)(o.p8,{showSpinner:!1,children:[t,n,u,x]}),h[6]=u,h[7]=x,h[8]=p):p=h[8],p}function m(){return window.location.reload()}n(12115)}},e=>{var t=t=>e(e.s=t);e.O(0,[7518,3873,5271,3380,844,9204,6446,2150,6711,585,5479,4506,5897,8087,5760,3603,7753,2362,4613,512,9910,8429,7949,8481,2202,4777,386,7825,1805,5290,4762,4218,4791,1626,6905,9986,1597,7528,5045,9690,9325,9360,1334,1298,5340,4101,1029,8668,2624,1675,1078,1683,5334,6862,4033,9484,9832,5565,2975,7363,5667,1749,9033,8441,6891,7358],()=>t(63188)),_N_E=e.O()}]);