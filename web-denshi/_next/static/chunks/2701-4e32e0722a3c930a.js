"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2701],{58443:(e,l,n)=>{n.d(l,{v:()=>L});var i=n(95155),a=n(19749),t=n(90984),r=n(36945),s=n(61585),o=n(45754),d=n(84127),u=n(6708),c=n(91360),m=n(17934),p=n(80743),g=n(29724),v=n(12115),b=n(43994);function h(e){let l,n,t,r=(0,a.c)(13),{collectionList:s,streamingMediaIds:d,showStatuses:u,type:c}=e,m="grid"===c?"space-y-8":"space-y-4";if(r[0]===Symbol.for("react.memo_cache_sentinel")?(l={initial:{opacity:0,y:60},animate:{opacity:1,y:0},exit:{opacity:0,scale:.99},transition:{duration:.25}},r[0]=l):l=r[0],r[1]!==s||r[2]!==u||r[3]!==d||r[4]!==c){let e;r[6]!==u||r[7]!==d||r[8]!==c?(e=e=>{var l;return(null==(l=e.entries)?void 0:l.length)?(0,i.jsx)(f,{list:e,streamingMediaIds:d,showStatuses:u,type:c},e.type):null},r[6]=u,r[7]=d,r[8]=c,r[9]=e):e=r[9],n=s.map(e),r[1]=s,r[2]=u,r[3]=d,r[4]=c,r[5]=n}else n=r[5];return r[10]!==m||r[11]!==n?(t=(0,i.jsx)(o.f,{className:m,"data-library-collection-lists":!0,...l,children:n},"library-collection-lists"),r[10]=m,r[11]=n,r[12]=t):t=r[12],t}function y(e){var l,n,a,t,s,d;let{collectionList:m,isLoading:p,streamingMediaIds:g,showStatuses:b,type:h}=e,y=v.useMemo(()=>m.filter(e=>!!b&&!!e.type&&b.includes(e.type)),[m,b]);return(0,i.jsxs)(o.f,{className:"grid"===h?"space-y-8":"space-y-4","data-library-filtered-lists":!0,initial:{opacity:0,y:60},animate:{opacity:1,y:0},exit:{opacity:0,scale:.99},transition:{duration:.25},children:["grid"===h&&(0,i.jsx)(r.xt,{itemCount:null!=(d=null==y||null==(l=y.flatMap(e=>e.entries))?void 0:l.length)?d:0,children:null==y||null==(a=y.flatMap(e=>e.entries))||null==(n=a.filter(Boolean))?void 0:n.map(e=>(0,i.jsx)(x,{entry:e,streamingMediaIds:g,type:h},e.mediaId))}),"carousel"===h&&(0,i.jsxs)(u.FN,{className:(0,c.cn)("w-full max-w-full !mt-0"),gap:"xl",opts:{align:"start",dragFree:!0},autoScroll:!1,children:[(0,i.jsx)(u.h1,{className:"-top-2"}),(0,i.jsx)(u.Wk,{className:"px-6",children:null==y||null==(s=y.flatMap(e=>e.entries))||null==(t=s.filter(Boolean))?void 0:t.map(e=>(0,i.jsx)(x,{entry:e,streamingMediaIds:g,type:h},e.mediaId))})]})]},"library-filtered-lists")}let f=v.memo(e=>{var l,n,s;let o,h,y,f,j,I,A,E,w,L=(0,a.c)(30),{list:S,streamingMediaIds:C,showStatuses:D,type:k}=e,M="CURRENT"===S.type,[T,_]=(0,g.fp)(t.DZ);if(D&&S.type&&!D.includes(S.type))return null;let R=S.type,B=S.type;return L[0]===Symbol.for("react.memo_cache_sentinel")?(o=(0,c.cn)("p-0 m-0"),L[0]=o):o=L[0],L[1]!==S.type?(h=(0,p.me)(S.type),L[1]=S.type,L[2]=h):h=L[2],L[3]!==h?(y=(0,i.jsx)("h2",{className:o,children:h}),L[3]=h,L[4]=y):y=L[4],L[5]!==k?(f="grid"===k&&(0,i.jsx)("div",{className:"flex flex-1"}),L[5]=k,L[6]=f):f=L[6],L[7]!==M||L[8]!==T||L[9]!==_?(j=M&&(0,i.jsx)(m.rI,{trigger:(0,i.jsx)(d.K0,{intent:"white-basic",size:"xs",className:"mt-1",icon:(0,i.jsx)(b.Oev,{})}),children:(0,i.jsx)(m._2,{onClick:()=>{_(N)},children:T.continueWatchingOnly?"Show all":"Show unwatched only"})}),L[7]=M,L[8]=T,L[9]=_,L[10]=j):j=L[10],L[11]!==S.type||L[12]!==y||L[13]!==f||L[14]!==j?(I=(0,i.jsxs)("div",{className:"flex gap-3 items-center","data-library-collection-list-item-header":!0,"data-list-type":B,children:[y,f,j]}),L[11]=S.type,L[12]=y,L[13]=f,L[14]=j,L[15]=I):I=L[15],L[16]!==S.entries||L[17]!==S.type||L[18]!==C||L[19]!==k?(A="grid"===k&&(0,i.jsx)(r.xt,{itemCount:(null==S||null==(l=S.entries)?void 0:l.length)||0,"data-library-collection-list-item-media-card-lazy-grid":!0,"data-list-type":S.type,children:null==(n=S.entries)?void 0:n.map(e=>(0,i.jsx)(x,{entry:e,streamingMediaIds:C,type:k},e.mediaId))}),L[16]=S.entries,L[17]=S.type,L[18]=C,L[19]=k,L[20]=A):A=L[20],L[21]!==S.entries||L[22]!==C||L[23]!==k?(E="carousel"===k&&(0,i.jsxs)(u.FN,{className:(0,c.cn)("w-full max-w-full !mt-0"),gap:"xl",opts:{align:"start",dragFree:!0},autoScroll:!1,children:[(0,i.jsx)(u.h1,{className:"-top-2"}),(0,i.jsx)(u.Wk,{className:"px-6",children:null==(s=S.entries)?void 0:s.map(e=>(0,i.jsx)(x,{entry:e,streamingMediaIds:C,type:k},e.mediaId))})]}),L[21]=S.entries,L[22]=C,L[23]=k,L[24]=E):E=L[24],L[25]!==S.type||L[26]!==E||L[27]!==I||L[28]!==A?(w=(0,i.jsxs)(v.Fragment,{children:[I,A,E]},R),L[25]=S.type,L[26]=E,L[27]=I,L[28]=A,L[29]=w):w=L[29],w}),x=v.memo(e=>{var l;let n,t=(0,a.c)(7),{entry:r,streamingMediaIds:o,type:d}=e,u="carousel"===d?"basis-[200px] md:basis-[250px] mx-2 mt-8 mb-0":void 0,c=!!(null==o?void 0:o.length)&&!o.includes(r.mediaId)&&(null==(l=r.listData)?void 0:l.status)==="CURRENT";return t[0]!==r.libraryData||t[1]!==r.listData||t[2]!==r.media||t[3]!==r.nakamaLibraryData||t[4]!==u||t[5]!==c?(n=(0,i.jsx)(s.V,{media:r.media,listData:r.listData,libraryData:r.libraryData,nakamaLibraryData:r.nakamaLibraryData,showListDataButton:!0,withAudienceScore:!1,type:"anime",containerClassName:u,showLibraryBadge:c}),t[0]=r.libraryData,t[1]=r.listData,t[2]=r.media,t[3]=r.nakamaLibraryData,t[4]=u,t[5]=c,t[6]=n):n=t[6],n});function N(e){e.continueWatchingOnly=!e.continueWatchingOnly}var j=n(37191),I=n(77717),A=n(14370),E=n(91332),w=n(43826);function L(e){var l,n,r,s;let d,u,m,p=(0,a.c)(23),{genres:b,collectionList:f,filteredCollectionList:x,isLoading:N,streamingMediaIds:j,showStatuses:A,type:L}=e,k=void 0===L?"grid":L,M=(0,E.Ky)(),[T]=(0,g.fp)(t.DZ);if(N){let e,l,n,a;p[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,i.jsx)(I.E,{className:"h-12 w-full max-w-lg relative"}),p[0]=e):e=p[0];let t="carousel"===k&&"grid-cols-1";return p[1]!==t?(l=(0,c.cn)("grid h-[22rem] min-[2000px]:h-[24rem] grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-7 min-[2000px]:grid-cols-8 gap-4",t),p[1]=t,p[2]=l):l=p[2],p[3]!==k?(n=("carousel"===k?[2]:[1,2,3,4,5,6,7,8]).map(C),p[3]=k,p[4]=n):n=p[4],p[5]!==l||p[6]!==n?(a=(0,i.jsx)(v.Fragment,{children:(0,i.jsxs)("div",{className:"p-4 space-y-4 relative z-[4]",children:[e,(0,i.jsx)("div",{className:l,children:n})]})}),p[5]=l,p[6]=n,p[7]=a):a=p[7],a}return p[8]!==f||p[9]!==b||p[10]!==M.disableLibraryScreenGenreSelector?(d=!M.disableLibraryScreenGenreSelector&&(null==(n=f.flatMap(S))?void 0:n.length)>2&&(0,i.jsx)(D,{genres:b}),p[8]=f,p[9]=b,p[10]=M.disableLibraryScreenGenreSelector,p[11]=d):d=p[11],p[12]!==f||p[13]!==x||p[14]!==N||p[15]!==(null==(l=T.genre)?void 0:l.length)||p[16]!==A||p[17]!==j||p[18]!==k?(u=(0,i.jsx)(o.f,{className:"px-4 space-y-8 relative z-[4]","data-library-collection-lists-container":!0,children:(0,i.jsx)(w.N,{mode:"wait",initial:!1,children:(null==(r=T.genre)?void 0:r.length)?(0,i.jsx)(y,{collectionList:x,isLoading:N,streamingMediaIds:j,showStatuses:A,type:k},"library-filtered-lists"):(0,i.jsx)(h,{collectionList:f,isLoading:N,streamingMediaIds:j,showStatuses:A,type:k},"library-collection-lists")})},"library-collection-lists"),p[12]=f,p[13]=x,p[14]=N,p[15]=null==(s=T.genre)?void 0:s.length,p[16]=A,p[17]=j,p[18]=k,p[19]=u):u=p[19],p[20]!==d||p[21]!==u?(m=(0,i.jsxs)(i.Fragment,{children:[d,u]}),p[20]=d,p[21]=u,p[22]=m):m=p[22],m}function S(e){return e.entries}function C(e,l){return(0,i.jsx)(I.E,{className:(0,c.cn)("h-[22rem] min-[2000px]:h-[24rem] col-span-1 aspect-[6/7] flex-none rounded-[--radius-md] relative overflow-hidden","[&:nth-child(8)]:hidden min-[2000px]:[&:nth-child(8)]:block","[&:nth-child(7)]:hidden 2xl:[&:nth-child(7)]:block","[&:nth-child(6)]:hidden xl:[&:nth-child(6)]:block","[&:nth-child(5)]:hidden xl:[&:nth-child(5)]:block","[&:nth-child(4)]:hidden lg:[&:nth-child(4)]:block","[&:nth-child(3)]:hidden md:[&:nth-child(3)]:block")},l)}function D(e){let l,n,r,s=(0,a.c)(12),{genres:d}=e,[u,c]=(0,g.fp)(t.ZG),m=(0,g.Xr)(t.DZ),p=(0,A.d)(u,200);if(s[0]!==u||s[1]!==m?(l=()=>{m(u)},s[0]=u,s[1]=m,s[2]=l):l=s[2],s[3]!==p?(n=[p],s[3]=p,s[4]=n):n=s[4],v.useEffect(l,n),!d.length)return null;if(s[5]!==d||s[6]!==u||s[7]!==c){let e;s[9]!==u||s[10]!==c?(e=e=>{var l,n;return{name:e,isCurrent:null!=(n=null==(l=u.genre)?void 0:l.includes(e))&&n,onClick:()=>c(l=>{var n,i;(null==(n=l.genre)?void 0:n.includes(e))?l.genre=null==(i=l.genre)?void 0:i.filter(l=>l!==e):l.genre=[...l.genre||[],e]})}},s[9]=u,s[10]=c,s[11]=e):e=s[11],r=(0,i.jsx)(o.f,{className:"space-y-3 lg:space-y-6 relative z-[4]","data-library-genre-selector-container":!0,children:(0,i.jsx)(j.H,{items:[...d.map(e)]})}),s[5]=d,s[6]=u,s[7]=c,s[8]=r}else r=s[8];return r}},64629:(e,l,n)=>{n.d(l,{F:()=>f,v:()=>h});var i=n(95155),a=n(86531),t=n(99639),r=n(14680),s=n(91360),o=n(90711),d=n(91332),u=n(94077),c=n(42500),m=n(29724),p=n(84218),g=n(43826),v=n(12115),b=n(37178);let h=(0,c.eU)({bannerImage:null,episodeImage:null}),y=p.P.create(r.r);function f(e){let{list:l}=e,n=(0,d.Ky)(),r=(0,m.md)(h),[c,f]=(0,v.useState)(null),[x,N]=(0,v.useState)(null),[j,I]=(0,v.useState)(!1),A=(0,m.Xr)(a.f),E=(null==r?void 0:r.bannerImage)||(null==r?void 0:r.episodeImage)||"",w=n.mediaPageBannerType===d.px.HideWhenUnavailable&&!(null==r?void 0:r.bannerImage)||n.mediaPageBannerType===d.px.Hide,L=n.mediaPageBannerType===d.px.BlurWhenUnavailable&&!(null==r?void 0:r.bannerImage)||n.mediaPageBannerType===d.px.Blur;(0,v.useEffect)(()=>{r!=c&&(null===c?f(E):f(null))},[r]),v.useLayoutEffect(()=>{let e=setTimeout(()=>{r!=c&&(f(E),A(l.find(e=>{var l,n,i,a;return(null==(l=e.baseAnime)?void 0:l.bannerImage)===(null==r?void 0:r.episodeImage)||(null==(i=e.baseAnime)||null==(n=i.coverImage)?void 0:n.extraLarge)===(null==r?void 0:r.episodeImage)||(null==(a=e.episodeMetadata)?void 0:a.image)===(null==r?void 0:r.episodeImage)})||null))},600);return()=>{clearTimeout(e)}},[r]),(0,v.useEffect)(()=>{c&&(N(c),A(l.find(e=>{var l,n,i,a;return(null==(l=e.baseAnime)?void 0:l.bannerImage)===c||(null==(i=e.baseAnime)||null==(n=i.coverImage)?void 0:n.extraLarge)===c||(null==(a=e.episodeMetadata)?void 0:a.image)===c})||null))},[c]);let{y:S}=(0,b.A)();return((0,v.useEffect)(()=>{S>100?I(!0):I(!1)},[S>100]),r)?(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{"data-library-header-container":!0,className:(0,s.cn)("LIB_HEADER_CONTAINER __header h-[25rem] z-[1] !mt-0 !pt-0 top-0 w-full absolute group/library-header pointer-events-none",!n.libraryScreenCustomBackgroundImage&&"fixed",!!n.libraryScreenCustomBackgroundImage&&u.X&&"top-[-2rem]"),children:[(0,i.jsx)("div",{"data-library-header-banner-top-gradient":!0,className:(0,s.cn)("w-full z-[3] absolute bottom-[-10rem] h-[10rem] bg-gradient-to-b from-[--background] via-transparent via-100% to-transparent",!n.disableSidebarTransparency&&t.j)}),(0,i.jsxs)(p.P.div,{"data-library-header-inner-container":!0,initial:{opacity:0},animate:{opacity:1,y:0},exit:{opacity:0},transition:{duration:1,delay:.2},className:(0,s.cn)("LIB_HEADER_INNER_CONTAINER h-full z-[0] w-full flex-none object-cover object-center absolute top-0 overflow-hidden bg-[--background]",!n.disableSidebarTransparency&&t.j),children:[!n.disableSidebarTransparency&&(0,i.jsx)("div",{"data-library-header-banner-inner-container-top-gradient":!0,className:"hidden lg:block h-full absolute z-[2] w-[20%] opacity-70 left-0 top-0 bg-gradient bg-gradient-to-r from-[var(--background)] to-transparent"}),(0,i.jsx)("div",{"data-library-header-banner-inner-container-bottom-gradient":!0,className:"w-full z-[3] opacity-50 absolute top-0 h-[5rem] bg-gradient-to-b from-[--background] via-transparent via-100% to-transparent"}),(0,i.jsx)(g.N,{children:!!c&&(0,i.jsx)(p.P.div,{"data-library-header-image-container":!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:.4},transition:{duration:.5},children:(0,i.jsx)(y,{"data-library-header-banner-image":!0,src:(0,o.VG)(c||x),alt:"banner image",fill:!0,quality:100,priority:!0,sizes:"100vw",className:(0,s.cn)("object-cover object-center z-[1] opacity-100 transition-opacity duration-700",!n.libraryScreenCustomBackgroundImage&&"scroll-locked-offset",(w||L)&&"opacity-15",{"opacity-5":j}),initial:{scale:1.01,y:0},animate:{scale:Math.min(1+2e-4*S,1.03)},exit:{scale:1.01,y:0},transition:{duration:.6,ease:"easeOut"}})},"library-header-banner-image-container")}),(0,i.jsx)("div",{"data-library-header-banner-bottom-gradient":!0,className:"LIB_HEADER_IMG_BOTTOM_FADE w-full z-[2] absolute bottom-0 h-[20rem] lg:h-[15rem] bg-gradient-to-t from-[--background] lg:via-opacity-50 lg:via-10% to-transparent"})]})]})}):null}},86531:(e,l,n)=>{n.d(l,{P:()=>w,f:()=>E});var i=n(95155),a=n(19749),t=n(83394),r=n(64629),s=n(78216),o=n(13029),d=n(83563),u=n(96826),c=n(59271),m=n(45754),p=n(14680),g=n(42692),v=n(6708),b=n(14370),h=n(99288),y=n(91332),f=n(50943),x=n(42500),N=n(29724),j=n(6066),I=n(12115),A=n(66873);let E=(0,x.eU)(null);function w(e){let l,n,o,u,x,A,w,D,k,M,T=(0,a.c)(45),{episodes:_,linkTemplate:R,withTitle:B}=e,W=(0,j.useRouter)(),F=(0,y.Ky)(),{data:O}=(0,t.H_)(),P=(0,N.Xr)(r.v),[z]=(0,N.fp)(E);T[0]===Symbol.for("react.memo_cache_sentinel")?(l=[],T[0]=l):l=T[0];let[U,G]=I.useState(l);T[1]===Symbol.for("react.memo_cache_sentinel")?(n=[],T[1]=n):n=T[1];let[H,X]=I.useState(n),Z=(0,b.d)(H,500),{width:K}=(0,f.lW)();T[2]!==_?(o=()=>{G(_.map(S))},u=[_],T[2]=_,T[3]=o,T[4]=u):(o=T[3],u=T[4]),I.useEffect(o,u),T[5]!==U?(x=()=>{let e=new IntersectionObserver(e=>{e.forEach(e=>{let l=U.findIndex(l=>l.current===e.target);-1!==l&&(e.isIntersecting?X(e=>e.includes(l)?e:[...e,l]):X(e=>e.filter(e=>e!==l)))})},{threshold:.5});return U.forEach(l=>{l.current&&e.observe(l.current)}),()=>{U.forEach(l=>{l.current&&e.unobserve(l.current)})}},T[5]=U,T[6]=x):x=T[6],T[7]!==U||T[8]!==K?(A=[U,K],T[7]=U,T[8]=K,T[9]=A):A=T[9],I.useEffect(x,A);let q=I.useRef(null);T[10]!==Z||T[11]!==_||T[12]!==P?(w=()=>{if(0===Z.length)return;let e=Z;q.current&&Z.length>1&&(e=Z.filter(e=>{var l,n,i,a;return(null==(n=_[e])||null==(l=n.baseAnime)?void 0:l.id)!==(null==(a=q.current)||null==(i=a.baseAnime)?void 0:i.id)})),0===e.length&&(e=Z);let l=_[e[Math.floor(Math.random()*e.length)]];if(l){var n,i,a,t;P({bannerImage:(null==(n=l.baseAnime)?void 0:n.bannerImage)||null,episodeImage:(null==(i=l.baseAnime)?void 0:i.bannerImage)||(null==(t=l.baseAnime)||null==(a=t.coverImage)?void 0:a.extraLarge)||null}),q.current=l}},D=[Z,_,P],T[10]=Z,T[11]=_,T[12]=P,T[13]=w,T[14]=D):(w=T[13],D=T[14]),I.useEffect(w,D);let{setPlayNext:V}=(0,s.p$)(),{inject:$,remove:J}=(0,d.H)();if(T[15]!==_||T[16]!==$||T[17]!==J||T[18]!==W||T[19]!==V?(M=()=>($("continue-watching",{items:_.map(e=>{var l,n,a;return{data:e,id:"".concat((null==(l=e.localFile)?void 0:l.path)||(null==(a=e.baseAnime)||null==(n=a.title)?void 0:n.userPreferred)||"","-").concat(e.episodeNumber||1),value:"".concat(e.episodeNumber||1),heading:"Continue Watching",priority:100,render:()=>{var l,n,a;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"w-12 aspect-[6/5] flex-none rounded-[--radius-md] relative overflow-hidden",children:(0,i.jsx)(p.r,{src:(null==(l=e.episodeMetadata)?void 0:l.image)||"",alt:"episode image",fill:!0,className:"object-center object-cover"})}),(0,i.jsxs)("div",{className:"flex gap-1 items-center w-full",children:[(0,i.jsx)("p",{className:"max-w-[70%] truncate",children:(null==(a=e.baseAnime)||null==(n=a.title)?void 0:n.userPreferred)||""}),"\xa0-\xa0",(0,h.Sv)(e.baseAnime)?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("p",{className:"text-[--muted]",children:"Movie"})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("p",{className:"text-[--muted]",children:"Ep"}),(0,i.jsx)("span",{children:e.episodeNumber})]})]})]})},onSelect:()=>{var l;return V(null==(l=e.baseAnime)?void 0:l.id,()=>{var l;W.push("/entry?id=".concat(null==(l=e.baseAnime)?void 0:l.id))})}}}),filter:L,priority:100}),()=>J("continue-watching")),k=[_,$,J,W,V],T[15]=_,T[16]=$,T[17]=J,T[18]=W,T[19]=V,T[20]=k,T[21]=M):(k=T[20],M=T[21]),I.useEffect(M,k),_.length>0){let e,l,n,a,t,r,s;if(T[22]===Symbol.for("react.memo_cache_sentinel")?(e=(0,i.jsx)("h2",{"data-continue-watching-title":!0,children:"Continue watching"}),T[22]=e):e=T[22],T[23]!==(null==z?void 0:z.baseAnime)||T[24]!==F.libraryScreenBannerType||T[25]!==B){var Q,Y;l=F.libraryScreenBannerType===y.H4.Dynamic&&(null==z?void 0:z.baseAnime)&&B&&(0,i.jsx)(g.W,{"data-continue-watching-media-title":!0,words:(null==z||null==(Y=z.baseAnime)||null==(Q=Y.title)?void 0:Q.userPreferred)||"",className:"w-full text-xl lg:text-[2.8rem] lg:max-w-[50%] h-[3.3rem] !mt-1 line-clamp-1 truncate leading-[3rem] text-ellipsis hidden lg:block pb-1"}),T[23]=null==z?void 0:z.baseAnime,T[24]=F.libraryScreenBannerType,T[25]=B,T[26]=l}else l=T[26];if(T[27]===Symbol.for("react.memo_cache_sentinel")?(n={align:"start"},T[27]=n):n=T[27],T[28]===Symbol.for("react.memo_cache_sentinel")?(a=(0,i.jsx)(v.h1,{}),T[28]=a):a=T[28],T[29]!==U||T[30]!==_||T[31]!==R||T[32]!==F.smallerEpisodeCarouselSize||T[33]!==O){let e;T[35]!==U||T[36]!==R||T[37]!==F.smallerEpisodeCarouselSize||T[38]!==O?(e=(e,l)=>{var n,a;return(0,i.jsx)(v.A7,{className:(0,c.pF)(F.smallerEpisodeCarouselSize),children:(0,i.jsx)(C,{episode:e,mRef:U[l],overrideLink:R,watchHistory:O},(null==(n=e.localFile)?void 0:n.path)||"")},(null==e||null==(a=e.localFile)?void 0:a.path)||l)},T[35]=U,T[36]=R,T[37]=F.smallerEpisodeCarouselSize,T[38]=O,T[39]=e):e=T[39],t=_.map(e),T[29]=U,T[30]=_,T[31]=R,T[32]=F.smallerEpisodeCarouselSize,T[33]=O,T[34]=t}else t=T[34];return T[40]!==t?(r=(0,i.jsxs)(v.FN,{className:"w-full max-w-full",gap:"md",opts:n,autoScroll:!0,autoScrollDelay:8e3,children:[a,(0,i.jsx)(v.Wk,{children:t})]}),T[40]=t,T[41]=r):r=T[41],T[42]!==l||T[43]!==r?(s=(0,i.jsxs)(m.f,{className:"space-y-3 lg:space-y-6 p-4 relative z-[4]","data-continue-watching-container":!0,children:[e,l,r]}),T[42]=l,T[43]=r,T[44]=s):s=T[44],s}return null}function L(e){var l;let{item:n,input:i}=e;return!i||n.value.toLowerCase().includes(i.toLowerCase())||(0,A.q)(null==(l=n.data.baseAnime)?void 0:l.title,i)}function S(){return I.createRef()}let C=I.memo(e=>{var l,n,d,c,m,p,g,v,b,h,y,f,x,A,w,L,S,C,D,k,M,T;let _,R,B,W,F,O,P,z,U=(0,a.c)(41),{episode:G,mRef:H,overrideLink:X,watchHistory:Z}=e,K=(0,u.v1)(),q=(0,j.useRouter)(),V=(0,N.Xr)(r.v),$=(0,N.Xr)(E);U[0]!==G||U[1]!==$||U[2]!==V?(_=()=>{V(e=>{if((null==e?void 0:e.episodeImage)===null){var l,n,i,a;return{bannerImage:(null==(l=G.baseAnime)?void 0:l.bannerImage)||null,episodeImage:(null==(n=G.baseAnime)?void 0:n.bannerImage)||(null==(a=G.baseAnime)||null==(i=a.coverImage)?void 0:i.extraLarge)||null}}return e}),$(e=>null===e?G:e)},U[0]=G,U[1]=$,U[2]=V,U[3]=_):_=U[3],U[4]===Symbol.for("react.memo_cache_sentinel")?(R=[],U[4]=R):R=U[4],I.useEffect(_,R);let{setPlayNext:J}=(0,s.p$)(),Q=(null==(l=G.localFile)?void 0:l.path)||"",Y=(null==(n=G.episodeMetadata)?void 0:n.image)||(null==(d=G.baseAnime)?void 0:d.bannerImage)||(null==(m=G.baseAnime)||null==(c=m.coverImage)?void 0:c.extraLarge),ee=G.episodeTitle||(null==G||null==(g=G.baseAnime)||null==(p=g.title)?void 0:p.userPreferred),el=G.displayTitle,en=G.isInvalid,ei=null==(v=G.baseAnime)?void 0:v.episodes,ea=G.progressNumber,et=G.episodeNumber,er=null==(b=G.episodeMetadata)?void 0:b.length,es=G.episodeNumber!==G.progressNumber,eo=(null==(h=G.baseAnime)?void 0:h.id)||0;U[5]!==G.episodeNumber||U[6]!==eo||U[7]!==Z?(B=(0,t.hH)(Z,eo,G.episodeNumber),U[5]=G.episodeNumber,U[6]=eo,U[7]=Z,U[8]=B):B=U[8];let ed=(null==(y=G.baseAnime)?void 0:y.id)||0;U[9]!==G.episodeNumber||U[10]!==ed||U[11]!==Z?(W=(0,t.pj)(Z,ed,G.episodeNumber),U[9]=G.episodeNumber,U[10]=ed,U[11]=Z,U[12]=W):W=U[12];let eu=(null==G||null==(f=G.baseAnime)?void 0:f.id)||0,ec=null==G||null==(A=G.baseAnime)||null==(x=A.coverImage)?void 0:x.medium,em=null==G||null==(L=G.baseAnime)||null==(w=L.title)?void 0:w.userPreferred;return U[13]!==eu||U[14]!==ec||U[15]!==em?(F={id:eu,image:ec,title:em},U[13]=eu,U[14]=ec,U[15]=em,U[16]=F):F=U[16],U[17]!==(null==(S=G.baseAnime)?void 0:S.bannerImage)||U[18]!==(null==(D=G.baseAnime)||null==(C=D.coverImage)?void 0:C.extraLarge)||U[19]!==V?(O=()=>{I.startTransition(()=>{var e,l,n,i;V({bannerImage:(null==(e=G.baseAnime)?void 0:e.bannerImage)||null,episodeImage:(null==(l=G.baseAnime)?void 0:l.bannerImage)||(null==(i=G.baseAnime)||null==(n=i.coverImage)?void 0:n.extraLarge)||null})})},U[17]=null==(k=G.baseAnime)?void 0:k.bannerImage,U[18]=null==(T=G.baseAnime)||null==(M=T.coverImage)?void 0:M.extraLarge,U[19]=V,U[20]=O):O=U[20],U[21]!==G.baseAnime||U[22]!==X||U[23]!==q||U[24]!==(null==K?void 0:K.isOffline)||U[25]!==J?(P=()=>{var e,l;X?J(null==(l=G.baseAnime)?void 0:l.id,()=>{var e;q.push(X.replace("{id}",(null==(e=G.baseAnime)?void 0:e.id)?String(G.baseAnime.id):""))}):J(null==(e=G.baseAnime)?void 0:e.id,()=>{var e,l;(null==K?void 0:K.isOffline)?q.push("/offline/entry/anime?id=".concat(null==(l=G.baseAnime)?void 0:l.id)):q.push("/entry?id=".concat(null==(e=G.baseAnime)?void 0:e.id))})},U[21]=G.baseAnime,U[22]=X,U[23]=q,U[24]=null==K?void 0:K.isOffline,U[25]=J,U[26]=P):P=U[26],U[27]!==G||U[28]!==H||U[29]!==er||U[30]!==es||U[31]!==B||U[32]!==W||U[33]!==F||U[34]!==O||U[35]!==P||U[36]!==Q||U[37]!==Y||U[38]!==ee||U[39]!==ei?(z=(0,i.jsx)(o.U,{episode:G,image:Y,topTitle:ee,title:el,isInvalid:en,progressTotal:ei,progressNumber:ea,episodeNumber:et,length:er,hasDiscrepancy:es,percentageComplete:B,minutesRemaining:W,anime:F,onMouseEnter:O,allowAnimeInfo:!0,mRef:H,onClick:P},Q),U[27]=G,U[28]=H,U[29]=er,U[30]=es,U[31]=B,U[32]=W,U[33]=F,U[34]=O,U[35]=P,U[36]=Q,U[37]=Y,U[38]=ee,U[39]=ei,U[40]=z):z=U[40],z})},90984:(e,l,n)=>{n.d(l,{DZ:()=>p,VI:()=>v,ZG:()=>g});var i=n(68205),a=n(83394),t=n(75006),r=n(96826),s=n(85210),o=n(91332),d=n(47555),u=n(29724),c=n(12115);let m={...s.Bq,sorting:"TITLE",continueWatchingOnly:!1},p=(0,d.E)(m),g=(0,d.E)(m);function v(){var e,l,n,d,m,g,v,b,h,y,f,x,N,j,I;let A=(0,r.v1)(),E=(0,u.Xr)(t.Zp),{animeLibraryCollectionDefaultSorting:w,continueWatchingDefaultSorting:L}=(0,o.Ky)(),{data:S}=(0,a.H_)(),{data:C,isLoading:D}=(0,i.lD)(),k=c.useMemo(()=>{if(C)if(!C.stream)return C;else{var e,l,n,i,a,t,r;let s=null==(e=C.lists)?void 0:e.find(e=>"CURRENT"===e.type),o=[...null!=(n=null==s?void 0:s.entries)?n:[]];for(let e of null!=(i=C.stream.anime)?i:[])o.some(l=>l.mediaId===e.id)||o.push({media:e,mediaId:e.id,listData:null==(a=C.stream.listData)?void 0:a[e.id],libraryData:void 0});return{...C,lists:[{type:"CURRENT",status:"CURRENT",entries:o},...null!=(r=null==(l=null!=(t=C.lists)?t:[])?void 0:l.filter(e=>"CURRENT"!==e.type))?r:[]].filter(Boolean)}}},[C]);c.useEffect(()=>{k&&E(k)},[k]);let M=(0,u.md)(p),T=c.useMemo(()=>{if(!k||!k.lists)return[];let e=k.lists.map(e=>{var l,n,i,a,t,r,o;if(!e)return e;let d={...s.Bq,continueWatchingOnly:M.continueWatchingOnly,sorting:w},u=[...null!=(i=k.continueWatchingList)?i:[]];if(k.stream)for(let e of null!=(t=null==(a=k.stream)?void 0:a.continueWatchingList)?t:[])u=[...u,e];let c=(0,s.TI)(e.entries,d,null==A||null==(n=A.settings)||null==(l=n.anilist)?void 0:l.enableAdultContent,u,S);return 0===c.length&&d.continueWatchingOnly&&(d={...d,continueWatchingOnly:!1},c=(0,s.TI)(e.entries,d,null==A||null==(o=A.settings)||null==(r=o.anilist)?void 0:r.enableAdultContent,u,S)),{type:e.type,status:e.status,entries:c}});return[e.find(e=>"CURRENT"===e.type),e.find(e=>"PAUSED"===e.type),e.find(e=>"PLANNING"===e.type),e.find(e=>"COMPLETED"===e.type),e.find(e=>"DROPPED"===e.type)].filter(Boolean)},[k,M,w,null==A||null==(l=A.settings)||null==(e=l.anilist)?void 0:e.enableAdultContent]),_=c.useMemo(()=>{if(!k||!k.lists)return[];let e=k.lists.map(e=>{var l,n;if(!e)return e;let i={...M,sorting:w},a=(0,s.TI)(e.entries,i,null==A||null==(n=A.settings)||null==(l=n.anilist)?void 0:l.enableAdultContent,k.continueWatchingList,S);return{type:e.type,status:e.status,entries:a}});return[e.find(e=>"CURRENT"===e.type),e.find(e=>"PAUSED"===e.type),e.find(e=>"PLANNING"===e.type),e.find(e=>"COMPLETED"===e.type),e.find(e=>"DROPPED"===e.type)].filter(Boolean)},[k,M,null==A||null==(d=A.settings)||null==(n=d.anilist)?void 0:n.enableAdultContent,S]),R=c.useMemo(()=>{var e,l,n,i,a;if(!(null==k?void 0:k.continueWatchingList))return[];let t=[...k.continueWatchingList];if(k.stream)for(let e of null!=(a=k.stream.continueWatchingList)?a:[])t=[...t,e];let r=T.flatMap(e=>e.entries);return(t=(0,s.Hy)(t,L,r,S),!(null==A||null==(l=A.settings)||null==(e=l.anilist)?void 0:e.enableAdultContent)||(null==A||null==(i=A.settings)||null==(n=i.anilist)?void 0:n.blurAdultContent))?t.filter(e=>{var l;return(null==(l=e.baseAnime)?void 0:l.isAdult)===!1}):t},[null==k?void 0:k.stream,T,null==k?void 0:k.continueWatchingList,L,null==A||null==(g=A.settings)||null==(m=g.anilist)?void 0:m.enableAdultContent,null==A||null==(b=A.settings)||null==(v=b.anilist)?void 0:v.blurAdultContent,S]);return{libraryGenres:c.useMemo(()=>{var e;return null==(e=[...new Set(null==_?void 0:_.flatMap(e=>{var l,n;return null!=(n=null==(l=e.entries)?void 0:l.flatMap(e=>{var l;return null==(l=e.media)?void 0:l.genres}))?n:[]}))].filter(Boolean))?void 0:e.sort((e,l)=>e.localeCompare(l))},[_]),isLoading:D,libraryCollectionList:T,filteredLibraryCollectionList:_,continueWatchingList:R,unmatchedLocalFiles:null!=(f=null==k?void 0:k.unmatchedLocalFiles)?f:[],ignoredLocalFiles:null!=(x=null==k?void 0:k.ignoredLocalFiles)?x:[],unmatchedGroups:null!=(N=null==k?void 0:k.unmatchedGroups)?N:[],unknownGroups:null!=(j=null==k?void 0:k.unknownGroups)?j:[],streamingMediaIds:null!=(I=null==k||null==(y=k.stream)||null==(h=y.anime)?void 0:h.map(e=>e.id))?I:[],hasEntries:T.some(e=>{var l;return(null==(l=e.entries)?void 0:l.length)>0}),isStreamingOnly:T.every(e=>{var l;return null==(l=e.entries)?void 0:l.every(e=>!e.libraryData)}),isNakamaLibrary:c.useMemo(()=>{var e,l;return null!=(l=null==k||null==(e=k.lists)?void 0:e.some(e=>{var l;return null==(l=e.entries)?void 0:l.some(e=>!!e.nakamaLibraryData)}))&&l},[null==k?void 0:k.lists])}}}}]);